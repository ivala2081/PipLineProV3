const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/pages-systemmonitor-V7hER3rb.js","js/vendor-react-X8uUzP0t.js","js/contexts-9IXokeH-.js","js/components-modern-DxUcFm15.js","js/components-ui-BYXC3pAy.js","js/vendor-utils-CtF19A-_.js","js/vendor-charts-recharts-ipxjOH9-.js","js/vendor-i18n-DHLiip7K.js","js/DatabaseManagement-BqygyNGA.js","js/SecurityManagement-BSAXkLJN.js"])))=>i.map(i=>d[i]);
import{j as e,r as s,T as t,aQ as a,o as r,aR as n,H as l,F as i,R as c,u as o,aH as d,ae as m,ad as x,aS as g,C as h,aT as u,aU as p,d as j,aV as y,E as f,I as b,f as v,aW as N,aO as w,P as _,c as k,aX as S,D as C,X as D,k as E,Z as R,a2 as A,U as T,n as $,_ as F,p as U,v as L,h as z,aY as P,m as O,S as M,aZ as I,B as q,a_ as B,a$ as H,x as K,y as Y,b0 as V,J as W,b1 as J,i as G,q as Q,l as Z,e as X,a as ee,s as se,b2 as te,b3 as ae,a5 as re,b as ne,b4 as le,a0 as ie,b5 as ce,b6 as oe,b7 as de,b8 as me,b9 as xe,ba as ge,Q as he,bb as ue,bc as pe,a8 as je,bd as ye,ac as fe,V as be,be as ve}from"./vendor-react-X8uUzP0t.js";import{M as Ne,l as we,U as _e,d as ke,a as Se,f as Ce,e as De,g as Ee,A as Re,P as Ae,C as Te,h as $e,_ as Fe,i as Ue,b as Le,j as ze}from"./components-modern-DxUcFm15.js";import{b as Pe,a as Oe}from"./contexts-9IXokeH-.js";import{l as Me,m as Ie,n as qe,o as Be,p as He,A as Ke,q as Ye,L as Ve,I as We,r as Je,a as Ge,d as Qe,f as Ze,g as Xe,B as es,e as ss,s as ts,t as as,u as rs,v as ns,w as ls,C as is,b as cs}from"./components-ui-BYXC3pAy.js";import{R as os,B as ds,b as ms,X as xs,Y as gs,T as hs,d as us,P as ps,a as js,C as ys,A as fs,e as bs,S as vs,f as Ns}from"./vendor-charts-recharts-ipxjOH9-.js";import{T as ws}from"./components-trust-CB39-DvV.js";const _s=({size:s="md",variant:t="default",message:a="Loading...",className:r="",fullScreen:n=!1,showDots:l=!1,showBar:i=!1,indeterminate:c=!1})=>{const o=n?"business-loading-overlay":"flex items-center justify-center";return e.jsx("div",{className:`${o} ${r}`,role:"status","aria-live":"polite","aria-label":a,children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[l?e.jsxs("div",{className:"business-loading-dots business-loading-dots-primary",children:[e.jsx("div",{className:"business-loading-dots-dot"}),e.jsx("div",{className:"business-loading-dots-dot"}),e.jsx("div",{className:"business-loading-dots-dot"})]}):i?e.jsx("div",{className:"business-loading-bar",children:e.jsx("div",{className:"business-loading-bar-progress"})}):e.jsx("div",{className:l?`business-loading-dots business-loading-dots-${t}`:i?`business-loading-bar business-loading-bar-${c?"indeterminate":t}`:`${{sm:"business-loading-spinner-sm",md:"business-loading-spinner-md",lg:"business-loading-spinner-lg",xl:"business-loading-spinner-xl"}[s]} ${{default:"business-loading-spinner",primary:"business-loading-spinner-primary",success:"business-loading-spinner-success",warning:"business-loading-spinner-warning",error:"business-loading-spinner-error",neutral:"business-loading-spinner-neutral"}[t]}`,"aria-hidden":"true"}),a&&e.jsx("p",{className:"text-sm text-gray-600 font-medium","aria-live":"polite",children:a})]})})};class ks extends s.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null,errorId:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e,errorId:`error_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}componentDidCatch(e,s){fetch("/api/v1/monitoring/client-log",{method:"POST",keepalive:!0,headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"EnhancedErrorBoundary.tsx:componentDidCatch",message:"React error boundary caught error",data:{message:e?.message||"Unknown",errorName:e?.name,hasStack:!!e?.stack,errorStack:e?.stack?.substring(0,500),componentStack:s?.componentStack?.substring(0,500),href:"undefined"!=typeof window?window.location.href:null},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"C,E"})}).catch(()=>{}),this.props.onError?.(e,s),this.setState({errorInfo:s}),this.reportError(e,s)}reportError=async(e,s)=>{try{(new Date).toISOString()}catch(t){}};handleRetry=()=>{this.setState({hasError:!1,error:null,errorInfo:null,errorId:null})};handleGoHome=()=>{window.location.href="/"};handleGoBack=()=>{window.history.back()};handleCopyError=()=>{if(this.state.error){const e=`\nError ID: ${this.state.errorId}\nMessage: ${this.state.error.message}\nStack: ${this.state.error.stack}\nComponent Stack: ${this.state.errorInfo?.componentStack}\nTimestamp: ${(new Date).toISOString()}\nURL: ${window.location.href}\n      `.trim();navigator.clipboard.writeText(e).then(()=>{alert("Error details copied to clipboard")}).catch(()=>{const s=document.createElement("textarea");s.value=e,document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s),alert("Error details copied to clipboard")})}};render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{style:{minHeight:"100vh",backgroundColor:"#f9fafb",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem"},children:e.jsxs("div",{className:"max-w-2xl w-full bg-white rounded-2xl shadow-xl border border-gray-200 p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(t,{className:"w-10 h-10 text-red-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Oops! Something went wrong"}),e.jsx("p",{className:"text-gray-600",children:"We encountered an unexpected error. Don't worry, we've been notified and are working to fix it."})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(a,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Error Details"})]}),e.jsx("p",{className:"text-sm text-gray-600 font-mono",children:this.state.error?.message||"Unknown error occurred"}),this.state.errorId&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Error ID: ",this.state.errorId]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-6",children:[e.jsxs("button",{onClick:this.handleRetry,className:"flex-1 flex items-center justify-center gap-2 bg-gray-600 text-white px-4 py-3 rounded-lg font-medium hover:bg-gray-700 transition-colors",children:[e.jsx(r,{className:"w-4 h-4"}),"Try Again"]}),e.jsxs("button",{onClick:this.handleGoBack,className:"flex-1 flex items-center justify-center gap-2 bg-gray-600 text-white px-4 py-3 rounded-lg font-medium hover:bg-gray-700 transition-colors",children:[e.jsx(n,{className:"w-4 h-4"}),"Go Back"]}),e.jsxs("button",{onClick:this.handleGoHome,className:"flex-1 flex items-center justify-center gap-2 bg-green-600 text-white px-4 py-3 rounded-lg font-medium hover:bg-green-700 transition-colors",children:[e.jsx(l,{className:"w-4 h-4"}),"Go Home"]})]}),e.jsx("div",{className:"flex items-center justify-center gap-4 text-sm",children:e.jsxs("button",{onClick:this.handleCopyError,className:"flex items-center gap-2 text-gray-500 hover:text-gray-700 transition-colors",children:[e.jsx(i,{className:"w-4 h-4"}),"Copy Error Details"]})}),e.jsx("div",{className:"mt-6 text-center text-sm text-gray-500",children:e.jsx("p",{children:"If this problem persists, please contact support with the Error ID above."})})]})}):this.props.children}}class Ss extends c.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,s){we.error("ModernDashboard Error:",e,s)}render(){return this.state.hasError&&this.state.error?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-2xl w-full bg-white shadow-lg rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(t,{className:"w-6 h-6 text-red-500"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Dashboard Error"})]}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Failed to load Modern Dashboard:"}),e.jsxs("pre",{className:"bg-gray-100 p-4 rounded text-sm overflow-auto max-h-96 whitespace-pre-wrap",children:[this.state.error.message,"\n\n",this.state.error.stack]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700",children:"Reload Page"})]})}):this.props.children}}const Cs=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{Pe();const{user:s}=Oe();return e.jsx(Ss,{children:e.jsx(Ne,{user:s||void 0})})}},Symbol.toStringTag,{value:"Module"})),Ds=Object.freeze(Object.defineProperty({__proto__:null,default:function(){return null}},Symbol.toStringTag,{value:"Module"})),Es=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const[a,r]=s.useState(""),[n,l]=s.useState(""),[i,c]=s.useState(!1),[S,C]=s.useState(!1),[D,E]=s.useState(!1),[R,A]=s.useState({}),[T,$]=s.useState(0),[F,U]=s.useState(!1),[L,z]=s.useState(null),[P,O]=s.useState(0),[M,I]=s.useState(!1),[q,B]=s.useState(0),[H,K]=s.useState(navigator.onLine),[Y,V]=s.useState(new Date),[W,J]=s.useState(!1),[G,Q]=s.useState(new Date),[Z,X]=s.useState("operational"),ee=s.useRef(null),se=s.useRef(null),te=s.useRef([]),{login:ae,isAuthenticated:re}=Oe(),{t:ne,currentLanguage:le,setLanguage:ie}=Pe(),ce=o(),oe=d();return s.useEffect(()=>{if(re){const e=oe.state?.from?.pathname||"/dashboard";ce(e,{replace:!0})}},[re,ce,oe]),s.useEffect(()=>{const e=localStorage.getItem("pipeline_remember_user");e&&(r(e),C(!0))},[]),s.useEffect(()=>{if(!F||!L)return;const e=setInterval(()=>{const e=Date.now(),s=Math.max(0,Math.ceil((L.getTime()-e)/1e3));O(s),s<=0&&(U(!1),z(null),$(0))},1e3);return()=>clearInterval(e)},[F,L,ne]),s.useEffect(()=>{const e=setInterval(()=>{Q(new Date),V(new Date)},1e3);return()=>clearInterval(e)},[]),s.useEffect(()=>{const e=()=>K(!0),s=()=>K(!1);return window.addEventListener("online",e),window.addEventListener("offline",s),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}},[]),s.useEffect(()=>{ee.current&&ee.current.focus()},[]),e.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f9fafb",padding:"1rem",position:"relative"},className:"min-h-screen flex items-center justify-center bg-gray-50 p-4 relative",children:[e.jsxs("div",{className:"absolute top-4 right-4 flex items-center gap-2 bg-card border rounded-lg px-3 py-2 shadow-sm",children:[H?e.jsx(m,{className:"w-4 h-4 text-green-500"}):e.jsx(x,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:ne(H?"login.online":"login.offline")})]}),e.jsxs("div",{className:"absolute top-4 left-4 flex items-center gap-2 bg-card border rounded-lg px-3 py-2 shadow-sm",children:[e.jsx(g,{className:"w-4 h-4 "+("operational"===Z?"text-green-500":"maintenance"===Z?"text-yellow-500":"text-red-500")}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["operational"===Z&&ne("login.systemOperational"),"maintenance"===Z&&ne("login.systemMaintenance"),"issues"===Z&&ne("login.systemIssues")]})]}),e.jsxs("div",{className:"w-full max-w-md space-y-6 relative z-10",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center",children:e.jsx("img",{src:"/plogo.png",alt:"PipLinePro Logo",className:"w-24 h-24 object-contain"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-3xl font-semibold tracking-tight",children:"PipLinePro"}),e.jsx("p",{className:"text-muted-foreground",children:ne("login.systemTitle")})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(h,{className:"w-4 h-4"}),e.jsx("span",{children:G.toLocaleTimeString("tr"===le?"tr-TR":"en-US")})]}),e.jsx("div",{className:"w-px h-4 bg-border"}),e.jsx("span",{children:G.toLocaleDateString("tr"===le?"tr-TR":"en-US")})]})]}),e.jsx("div",{className:"flex items-center justify-center gap-2",children:e.jsxs(Me,{value:le,onValueChange:ie,children:[e.jsxs(Ie,{className:"w-auto border-0 bg-transparent hover:bg-muted/50 transition-colors",children:[e.jsx(u,{className:"w-4 h-4 mr-1"}),e.jsx(qe,{})]}),e.jsxs(Be,{children:[e.jsx(He,{value:"en",children:"English"}),e.jsx(He,{value:"tr",children:"TÃ¼rkÃ§e"})]})]})}),F&&e.jsxs(Ke,{variant:"destructive",children:[e.jsx(p,{className:"h-4 w-4"}),e.jsx(Ye,{children:ne("login.accountLockedMessage",{minutes:Math.ceil(P/60),seconds:P%60})})]}),!H&&e.jsxs(Ke,{className:"border-orange-200 bg-orange-50",children:[e.jsx(x,{className:"h-4 w-4 text-orange-600"}),e.jsx(Ye,{className:"text-orange-800",children:ne("login.offlineMode")})]}),e.jsx(_e,{variant:"elevated",size:"md",padding:"lg",className:"shadow-md bg-white",header:{title:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-5 h-5"}),ne("login.signIn")]}),description:ne("login.signInDescription")},children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return a.trim()?a.length<3&&(e.username=ne("login.usernameMinLength")):e.username=ne("login.usernameRequired"),n?n.length<5&&(e.password=ne("login.passwordMinLength")):e.password=ne("login.passwordRequired"),A(e),0===Object.keys(e).length})()){A({}),E(!0);try{const e=await ae(a,n,S),s={timestamp:new Date,success:e.success,ip:"192.168.1.100"};if(te.current.push(s),!e.success)throw new Error(e.message||ne("login.invalidCredentials"));{S?localStorage.setItem("pipeline_remember_user",a):localStorage.removeItem("pipeline_remember_user"),$(0);const e=oe.state?.from?.pathname||"/dashboard";ce(e,{replace:!0})}}catch(s){$(T+1);{const e=s instanceof Error?s.message:ne("login.loginFailed");A({general:e})}}finally{E(!1)}}},className:"space-y-4",children:[R.general&&e.jsxs(Ke,{variant:"destructive",children:[e.jsx(t,{className:"h-4 w-4"}),e.jsx(Ye,{children:R.general})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Ve,{htmlFor:"username",className:"flex items-center gap-1",children:[e.jsx(j,{className:"w-4 h-4"}),ne("login.username"),e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(We,{ref:ee,id:"username",type:"text",placeholder:ne("login.usernamePlaceholder"),value:a,onChange:e=>r(e.target.value),disabled:D||F,className:"bg-input-background transition-all "+(R.username?"border-destructive focus-visible:ring-destructive":""),autoComplete:"username",onKeyDown:e=>{"Enter"===e.key&&se.current&&se.current.focus()}}),R.username&&e.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[e.jsx(t,{className:"w-3 h-3"}),R.username]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Ve,{htmlFor:"password",className:"flex items-center gap-1",children:[e.jsx(p,{className:"w-4 h-4"}),ne("login.password"),e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(We,{ref:se,id:"password",type:i?"text":"password",placeholder:ne("login.passwordPlaceholder"),value:n,onChange:e=>{return s=e.target.value,l(s),void B((e=>{let s=0;return e.length>=6&&(s+=25),/[A-Z]/.test(e)&&(s+=25),/[0-9]/.test(e)&&(s+=25),/[^A-Za-z0-9]/.test(e)&&(s+=25),s})(s));var s},onKeyDown:e=>{if(e.getModifierState){const s=e.getModifierState("CapsLock");I(s)}if("Enter"===e.key&&!D&&!F&&a&&n&&H){e.preventDefault();const s=e.currentTarget.closest("form");s&&s.requestSubmit()}},onKeyPress:e=>{const s=e.getModifierState&&e.getModifierState("CapsLock");I(s)},disabled:D||F,className:"bg-input-background pr-10 transition-all "+(R.password?"border-destructive focus-visible:ring-destructive":""),autoComplete:"current-password"}),e.jsx(ke,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>c(!i),disabled:D||F,children:i?e.jsx(y,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(f,{className:"h-4 w-4 text-muted-foreground"})})]}),n&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:ne("login.passwordStrength")}),e.jsx("span",{className:"text-xs text-muted-foreground",children:(de=q,ne(de<25?"login.passwordWeak":de<50?"login.passwordFair":de<75?"login.passwordGood":"login.passwordStrong"))})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-1.5",children:e.jsx("div",{className:`h-1.5 rounded-full transition-all duration-300 ${(e=>e<25?"bg-red-500":e<50?"bg-orange-500":e<75?"bg-yellow-500":"bg-green-500")(q)}`,style:{width:`${q}%`}})})]}),R.password&&e.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[e.jsx(t,{className:"w-3 h-3"}),R.password]}),M&&e.jsxs("p",{className:"text-sm text-orange-600 flex items-center gap-1",children:[e.jsx(b,{className:"w-3 h-3"}),ne("login.capsLockOn")]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Je,{id:"remember",checked:S,onCheckedChange:e=>C(!0===e),disabled:D||F}),e.jsx(Ve,{htmlFor:"remember",className:"text-sm cursor-pointer text-muted-foreground",children:ne("login.rememberMe")})]}),T>0&&e.jsx("span",{className:"text-xs text-orange-600",children:ne("login.failedAttempts",{count:T})})]}),e.jsx(ke,{type:"button",variant:"ghost",size:"sm",onClick:()=>J(!W),className:"w-full text-muted-foreground hover:text-foreground",icon:e.jsx(v,{className:"w-4 h-4"}),iconPosition:"left",children:ne(W?"login.hideAdvanced":"login.showAdvanced")}),W&&e.jsxs("div",{className:"p-3 bg-muted/30 rounded-lg space-y-3 border",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:ne("login.advancedOptions")}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:ne("login.twoFactorAuth")})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:ne("login.notConfigured")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:ne("login.sessionDuration")})]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["8 ",ne("login.hours")]})]})]}),e.jsx(ke,{type:"submit",variant:"primary",size:"lg",className:"w-full",disabled:D||F||!a||!n||!H,loading:D,icon:D?void 0:e.jsx(w,{className:"w-4 h-4"}),iconPosition:"left",children:ne(D?"login.signingIn":"login.signIn")})]}),te.current.length>0&&e.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg border border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(_,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:ne("login.recentActivity")})]}),e.jsx("div",{className:"space-y-1",children:te.current.slice(-3).map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.success?e.jsx(k,{className:"w-3 h-3 text-green-500"}):e.jsx(t,{className:"w-3 h-3 text-red-500"}),e.jsx("span",{className:"text-muted-foreground",children:s.timestamp.toLocaleTimeString()})]}),e.jsx("span",{className:s.success?"text-green-600":"text-red-600",children:s.success?ne("login.success"):ne("login.failed")})]},a))})]})]})}),e.jsxs("div",{className:"text-center space-y-2 text-xs text-muted-foreground",children:[e.jsxs("p",{children:["Â© 2024 PipLinePro ",ne("login.allRightsReserved")]}),e.jsx("p",{children:ne("login.secureTreasuryManagement")}),e.jsxs("p",{className:"flex items-center justify-center gap-1",children:[e.jsx(_,{className:"w-3 h-3"}),ne("login.encryptedConnection")]})]})]})]});var de}},Symbol.toStringTag,{value:"Module"}));function Rs(e){const[t,a]=S(),r=()=>t.get("tab")||e,[n,l]=s.useState(r()),i=s.useRef(r());s.useEffect(()=>{i.current=n},[n]),s.useEffect(()=>{const e=t.get("tab");e&&e!==i.current&&(l(e),i.current=e)},[t]);const c=s.useCallback(e=>{const s=e;l(s);const r=new URLSearchParams(t);r.set("tab",s),a(r,{replace:!0})},[t,a]);return[n,c]}const As=({isOpen:t,onClose:a,onRateSelect:r,currentAmount:n,transactionDate:l})=>{const[i,c]=s.useState(null),[o,d]=s.useState(""),[m,x]=s.useState(!1),[g,u]=s.useState(null),[p,j]=s.useState("");s.useEffect(()=>{t&&(async()=>{try{x(!0),u(null);const e=await Se.get("/exchange-rates/current"),s=await Se.parseResponse(e);if(e.ok&&s.success&&s.rate){const e={rate:s.rate.rate,timestamp:s.rate.created_at,source:s.rate.source,change_24h:s.rate.change_24h,volume:s.rate.volume};c(e),d(s.rate.rate.toFixed(4)),j(new Date(s.rate.created_at).toLocaleString())}else u(`Failed to fetch current exchange rate: ${s.message||"Unknown error"}`)}catch(e){u(`Unable to fetch current exchange rate: ${e instanceof Error?e.message:"Network error"}`)}finally{x(!1)}})()},[t]);const y=e=>(n*e).toFixed(2);return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl border border-gray-200 max-w-md w-full max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 bg-gradient-to-r from-slate-50 via-white to-indigo-50 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center mr-3",children:e.jsx(C,{className:"h-4 w-4 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Currency Conversion"}),e.jsx("p",{className:"text-sm text-gray-600",children:"USD to TRY Exchange Rate"})]})]}),e.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-all duration-200",children:e.jsx(D,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:e.jsxs("div",{className:"p-6 space-y-6",children:[g&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-red-700",children:g})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Transaction Details"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Amount (USD):"}),e.jsxs("span",{className:"font-medium text-gray-900",children:["$",n.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Date:"}),e.jsx("span",{className:"font-medium text-gray-900",children:l})]})]})]}),m?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Fetching current rate..."})]}):i?e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Current Market Rate"}),e.jsxs("div",{className:"flex items-center text-xs text-gray-700",children:[e.jsx(h,{className:"h-3 w-3 mr-1"}),"Updated: ",p]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["1 USD = â‚º",i.rate.toFixed(4)]}),(s=>{if(!s)return null;const t=s>0;return e.jsxs("div",{className:"flex items-center text-sm "+(t?"text-green-600":"text-red-600"),children:[e.jsx(E,{className:"h-3 w-3 mr-1 "+(t?"":"rotate-180")}),t?"+":"",s.toFixed(4)," (24h)"]})})(i.change_24h)]}),e.jsxs("div",{className:"text-sm text-gray-700",children:[e.jsxs("span",{className:"font-medium",children:["$",n.toFixed(2)," USD"]}),e.jsx("span",{className:"mx-2",children:"â†’"}),e.jsxs("span",{className:"font-bold",children:["â‚º",y(i.rate)]})]})]}),e.jsxs("button",{onClick:()=>{i&&(r(i.rate),a())},className:"w-full mt-4 bg-gray-600 text-white py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors duration-200 flex items-center justify-center",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Use Current Rate"]})]}):null,e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Custom Exchange Rate"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Manual Rate (1 USD = ? TRY)"}),e.jsx("input",{type:"number",step:"0.0001",min:"0",value:o,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-gray-500",placeholder:"Enter exchange rate..."})]}),o&&parseFloat(o)>0&&e.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:e.jsxs("div",{className:"text-sm text-gray-700",children:[e.jsxs("span",{className:"font-medium",children:["$",n.toFixed(2)," USD"]}),e.jsx("span",{className:"mx-2",children:"â†’"}),e.jsxs("span",{className:"font-bold text-gray-900",children:["â‚º",y(parseFloat(o))]})]})}),e.jsxs("button",{onClick:()=>{const e=parseFloat(o);e>0&&(r(e),a())},disabled:!o||parseFloat(o)<=0,className:"w-full bg-gray-600 text-white py-2 px-4 rounded-lg hover:bg-gray-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors duration-200 flex items-center justify-center",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Apply Custom Rate"]})]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-yellow-800",children:["ðŸ’¡ ",e.jsx("strong",{children:"Tip:"})," For historical transactions, you may want to use the exchange rate that was applicable on the transaction date rather than the current rate."]})})]})}),e.jsx("div",{className:"border-t border-gray-200 px-6 py-4 bg-gray-50 flex-shrink-0",children:e.jsx("div",{className:"flex justify-end space-x-3",children:e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors duration-200",children:"Cancel"})})})]})}):null},Ts=({transaction:t,onSave:a,onCancel:r,dropdownOptions:n={categories:[],psps:[],payment_methods:[],companies:[],currencies:[]}})=>{const[l,i]=s.useState({client_name:t.client_name||"",company:t.company||t.company_order||"",iban:t.iban||"",payment_method:t.payment_method||"",category:t.category||"",amount:t.amount?.toString()||"",currency:t.currency||"TL",psp:t.psp||"",notes:t.notes||"",date:t.date?t.date.split("T")[0]:(new Date).toISOString().split("T")[0]}),[c,o]=s.useState(!1),[d,m]=s.useState(""),[x,g]=s.useState(""),[h,u]=s.useState(!1),[p,j]=s.useState("");s.useEffect(()=>{i({client_name:t.client_name||"",company:t.company||t.company_order||"",iban:t.iban||"",payment_method:t.payment_method||"",category:t.category||"",amount:t.amount?.toString()||"",currency:t.currency||"TL",psp:t.psp||"",notes:t.notes||"",date:t.date?t.date.split("T")[0]:(new Date).toISOString().split("T")[0]})},[t]);const y={payment_methods:[...new Set([...n.payment_methods||[],...t.payment_method?[t.payment_method]:[]])],categories:[...new Set([...n.categories||[],...t.category?[t.category]:[]])],psps:[...new Set([...n.psps||[],...t.psp?[t.psp]:[]])],companies:[...new Set([...n.companies||[],...t.company?[t.company]:[],...t.company_order?[t.company_order]:[]])]},[f,b]=s.useState(!1),[v,N]=s.useState(null),[w,_]=s.useState(!1),[S,E]=s.useState(!1),[T,$]=s.useState(t.exchange_rate?.toString()||""),[F,U]=s.useState(t.exchange_rate?.toString()||""),[L,z]=s.useState(null),[P,O]=s.useState(!1);s.useEffect(()=>{"EUR"!==l.currency&&"USD"!==l.currency||!l.date?_(!1):_(!0)},[l.currency,l.date]);const M=(e,s)=>{i(t=>({...t,[e]:s})),N(null),"amount"!==e&&"currency"!==e||(z(null),O(!1)),"currency"===e&&"USD"===s&&E(!0)};return e.jsxs("div",{className:"max-h-[80vh] overflow-y-auto overflow-x-hidden pr-2 edit-form-scroll",children:[e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),l.client_name.trim()?!l.amount||0===parseFloat(l.amount)||isNaN(parseFloat(l.amount))?(N("Amount cannot be zero."),0):"EUR"!==l.currency||T?"USD"!==l.currency||F||(N("Please enter the USD exchange rate."),0):(N("Please enter the EUR exchange rate."),0):(N("Client name is required."),0)){b(!0),N(null);try{const e={...l,company_order:l.company,amount:parseFloat(l.amount),eur_rate:"EUR"===l.currency?parseFloat(T):void 0,usd_rate:"USD"===l.currency?parseFloat(F):void 0,...h&&x&&parseFloat(x)>0&&{manual_commission_rate:parseFloat(x),use_manual_commission:!0}},s=await Se.put(`/transactions/${t.id}`,e);if(s.ok&&s.data){const e=s.data;e.transaction?a(e.transaction):"success"===e.status?e.id?a(e):N("Transaction update succeeded but data format is unexpected."):N(e.message||e.error||"Failed to update transaction.")}else{const e=s.data||{};N(e.message||e.error||`Failed to update transaction. Status: ${s.status}`)}}catch(s){N(s?.message||s?.data?.message||s?.data?.error||"An error occurred while updating the transaction.")}finally{b(!1)}}},className:"space-y-6",noValidate:!0,children:[v&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(R,{className:"h-5 w-5 text-red-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:v})]})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-4",children:"Client Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Client Name *"}),e.jsx("input",{type:"text",value:l.client_name,onChange:e=>M("client_name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company"}),e.jsxs("select",{value:l.company,onChange:e=>M("company",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",children:[e.jsx("option",{value:"",children:"Select Company"}),y?.companies?.map(s=>e.jsx("option",{value:s,children:s},s))||[]]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"IBAN"}),e.jsx("input",{type:"text",value:l.iban,onChange:e=>M("iban",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",placeholder:"Enter IBAN"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Method"}),e.jsxs("select",{value:l.payment_method,onChange:e=>M("payment_method",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",children:[e.jsx("option",{value:"",children:"Select Payment Method"}),y?.payment_methods?.map(s=>e.jsx("option",{value:s,children:s},s))||[]]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-4",children:"Transaction Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category *"}),e.jsxs("select",{value:l.category,onChange:e=>M("category",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",required:!0,children:[e.jsx("option",{value:"",children:"Select Category"}),y?.categories?.map(s=>e.jsx("option",{value:s,children:s},s))||[]]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"PSP"}),e.jsxs("select",{value:l.psp,onChange:e=>M("psp",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",children:[e.jsx("option",{value:"",children:"Select PSP"}),y?.psps?.map(s=>e.jsx("option",{value:s,children:s},s))||[]]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount *"}),e.jsx("input",{type:"number",step:"0.01",value:l.amount,onChange:e=>M("amount",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Currency"}),e.jsxs("select",{value:l.currency,onChange:e=>M("currency",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",children:[e.jsx("option",{value:"TL",children:"TL"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"EUR",children:"EUR"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transaction Date"}),e.jsx("input",{type:"date",value:l.date,onChange:e=>M("date",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500"})]})]})]}),w&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-4",children:"Exchange Rate"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:["EUR"===l.currency&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"EUR Rate (1 EUR = ? TL)"}),e.jsx("input",{type:"number",step:"0.0001",min:"0",value:T,onChange:e=>{$(e.target.value),z(null),O(!1)},className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",required:!0})]}),"USD"===l.currency&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"USD Rate (1 USD = ? TL)"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[e.jsx("input",{type:"number",step:"0.0001",min:"0",value:F,onChange:e=>{U(e.target.value),z(null),O(!1)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500 min-w-0",required:!0}),e.jsxs("button",{type:"button",onClick:()=>E(!0),className:"px-4 py-2 bg-gray-100 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200 flex items-center justify-center space-x-2 whitespace-nowrap",children:[e.jsx(C,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Get Rate"})]})]}),F&&e.jsxs("p",{className:"text-xs text-gray-600 mt-1 break-words",children:["$",l.amount||0," USD = â‚º",((parseFloat(l.amount)||0)*(parseFloat(F)||0)).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{const e=parseFloat(l.amount)||0;let s=0;if("USD"===l.currency?s=parseFloat(F)||0:"EUR"===l.currency&&(s=parseFloat(T)||0),s>0&&e>0){const t=e*s,a=0;z({amount_try:t,commission_try:a,net_amount_try:t-a}),O(!0),N(null)}else N("Please enter valid amount and exchange rate.")},disabled:!l.amount||"USD"===l.currency&&!F||"EUR"===l.currency&&!T,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2 whitespace-nowrap",children:e.jsx("span",{children:"Apply Exchange Rate"})}),P&&e.jsx("span",{className:"text-sm text-green-600 font-medium text-center sm:text-right",children:"âœ“ Rate applied successfully"})]}),L&&e.jsxs("div",{className:"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg overflow-hidden",children:[e.jsx("h5",{className:"text-sm font-medium text-green-800 mb-3",children:"Converted Amounts (Turkish Lira)"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1 sm:gap-2",children:[e.jsx("span",{className:"text-green-700 text-sm",children:"Amount:"}),e.jsxs("span",{className:"font-medium text-green-900 text-sm break-all",children:["â‚º",L.amount_try.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1 sm:gap-2",children:[e.jsx("span",{className:"text-green-700 text-sm",children:"Commission:"}),e.jsxs("span",{className:"font-medium text-green-900 text-sm break-all",children:["â‚º",L.commission_try.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1 sm:gap-2",children:[e.jsx("span",{className:"text-green-700 text-sm",children:"Net Amount:"}),e.jsxs("span",{className:"font-medium text-green-900 text-sm break-all",children:["â‚º",L.net_amount_try.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),e.jsx("div",{className:"mt-3 pt-2 border-t border-green-200",children:e.jsxs("div",{className:"text-xs text-green-600 break-words",children:["Exchange Rate: 1 ",l.currency," = â‚º","USD"===l.currency?F:T]})})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Manual Commission"}),h&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-green-700 bg-green-100 rounded-full",children:[e.jsx(k,{className:"h-3 w-3"}),"Active"]})]}),h?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",step:"0.01",value:x,onChange:e=>g(e.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Commission %"}),e.jsx("button",{type:"button",onClick:()=>{u(!1),o(!1),m(""),g(""),j("")},className:"px-3 py-2 text-sm font-medium text-gray-600 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:"Disable"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Overrides automatic PSP commission rate"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"password",value:d,onChange:e=>m(e.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Security code"}),e.jsx("button",{type:"button",onClick:()=>{"4561"===d?(u(!0),j(""),o(!0)):(j("Invalid security code. Please try again."),u(!1))},className:"px-3 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:ring-1 focus:ring-blue-500",children:"Enable"})]}),p&&e.jsx("p",{className:"text-xs text-red-600",children:p})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-4",children:"Additional Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx("textarea",{value:l.notes,onChange:e=>M("notes",e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",placeholder:"Enter transaction notes..."})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[e.jsxs("button",{type:"button",onClick:r,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:[e.jsx(D,{className:"h-4 w-4 mr-2 inline"}),"Cancel"]}),e.jsx("button",{type:"submit",disabled:f,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 disabled:opacity-50 disabled:cursor-not-allowed",children:f?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"h-4 w-4 mr-2 inline"}),"Save Changes"]})})]})]}),e.jsx(As,{isOpen:S,onClose:()=>E(!1),onRateSelect:e=>{U(e.toString()),E(!1),z(null),O(!1)},currentAmount:parseFloat(l.amount)||0,transactionDate:l.date})]})},$s={gray:{text:"text-gray-600",bg:"bg-gray-50",iconBg:"bg-gray-100"},green:{text:"text-green-600",bg:"bg-green-50",iconBg:"bg-green-100"},purple:{text:"text-purple-600",bg:"bg-purple-50",iconBg:"bg-purple-100"},orange:{text:"text-orange-600",bg:"bg-orange-50",iconBg:"bg-orange-100"},red:{text:"text-red-600",bg:"bg-red-50",iconBg:"bg-red-100"},teal:{text:"text-teal-600",bg:"bg-teal-50",iconBg:"bg-teal-100"},indigo:{text:"text-indigo-600",bg:"bg-indigo-50",iconBg:"bg-indigo-100"},pink:{text:"text-pink-600",bg:"bg-pink-50",iconBg:"bg-pink-100"}},Fs=({title:t,value:a,icon:r,color:n,subtitle:l,className:i="",animated:c=!1,animationDuration:o=400,showGlass:d=!1})=>{const m=$s[n],x="string"==typeof a?parseFloat(a.replace(/[^\d.-]/g,""))||0:a,g=((e,t={})=>{const{duration:a=400,easing:r="easeOut",decimals:n=0,prefix:l="",suffix:i="",separator:c=","}=t,[o,d]=s.useState(0),[m,x]=s.useState(!1),g=s.useRef(),h=s.useRef(),u=s.useRef(0),p={linear:e=>e,easeOut:e=>1-Math.pow(1-e,5),easeIn:e=>Math.pow(e,3),easeInOut:e=>e<.5?4*Math.pow(e,3):1-Math.pow(-2*e+2,3)/2},j=s=>{h.current||(h.current=s);const t=s-h.current,n=Math.min(t/a,1),l=p[r](n),i=u.current+(e-u.current)*l,c=Math.abs(i)>1e3?Math.round(i):i;d(c),n<1?g.current=requestAnimationFrame(j):(d(e),x(!1),g.current=void 0,h.current=void 0)};return s.useEffect(()=>{if(g.current&&cancelAnimationFrame(g.current),e!==o&&0!==e)return x(!0),u.current=o,h.current=void 0,g.current=requestAnimationFrame(j),()=>{g.current&&cancelAnimationFrame(g.current)};d(e)},[e]),s.useEffect(()=>()=>{g.current&&cancelAnimationFrame(g.current)},[]),{displayValue:(e=>{const s=e.toFixed(n).split(".");s[0]=s[0].replace(/\B(?=(\d{3})+(?!\d))/g,c);const t=s.join(".");return`${l}${t}${i}`})(o),rawValue:o,isAnimating:m,targetValue:e}})(x,{duration:o,easing:"easeOut",decimals:0,prefix:"string"==typeof a&&a.includes("â‚º")?"â‚º":"",suffix:"string"==typeof a&&a.includes("%")?"%":""}),h=c&&!isNaN(x)?g.displayValue:a,u=d?"glass-card card-hover-subtle":"";return e.jsxs(_e,{variant:"elevated",className:`relative overflow-hidden shadow-premium ${u} ${i}`,children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 ${m.bg} rounded-full -translate-y-16 translate-x-16`}),e.jsxs(Ge,{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:`w-12 h-12 ${m.bg} rounded-xl flex items-center justify-center shadow-lg`,children:e.jsx(r,{className:`h-6 w-6 ${m.text}`})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:t}),e.jsx("p",{className:"text-lg font-bold text-gray-900 transition-all duration-75 ease-out",style:{fontVariantNumeric:"tabular-nums",willChange:c?"contents":"auto"},children:h}),l&&e.jsx("p",{className:"text-xs text-gray-500",children:l})]})]})]})},Us=({className:s="",width:t,height:a,rounded:r="md",animate:n="shimmer",delay:l=0})=>e.jsx("div",{className:`bg-gray-200 ${{none:"",sm:"rounded-sm",md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl","2xl":"rounded-2xl",full:"rounded-full"}[r]} ${{pulse:"animate-pulse",wave:"animate-pulse",shimmer:"skeleton-shimmer"}[n]} ${s}`,style:{width:t,height:a,animationDelay:`${l}ms`}}),Ls=({variant:s="default",delay:t=0})=>{const a=t;return"compact"===s?e.jsx("div",{className:"bg-white rounded-md border border-gray-200 p-2.5 animate-pulse",style:{animationDelay:`${a}ms`},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Us,{className:"w-6 h-6",rounded:"md",delay:a+100}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(Us,{className:"h-3 w-20 mb-1",delay:a+200}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Us,{className:"h-4 w-16",delay:a+300}),e.jsx(Us,{className:"h-3 w-8",delay:a+400})]})]})]})}):"minimal"===s?e.jsx("div",{className:"bg-white rounded-md border border-gray-200 p-3 animate-pulse",style:{animationDelay:`${a}ms`},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Us,{className:"w-6 h-6",rounded:"md",delay:a+100}),e.jsxs("div",{children:[e.jsx(Us,{className:"h-3 w-20 mb-1",delay:a+200}),e.jsx(Us,{className:"h-4 w-24",delay:a+300})]})]}),e.jsx(Us,{className:"h-3 w-12",delay:a+400})]})}):"gradient"===s?e.jsxs("div",{className:"bg-gradient-to-br from-gray-100 to-gray-200 rounded-lg shadow-sm p-4 animate-pulse",style:{animationDelay:`${a}ms`},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(Us,{className:"w-8 h-8 bg-white/20",rounded:"lg",delay:a+100}),e.jsx(Us,{className:"h-4 w-16 bg-white/20",rounded:"full",delay:a+200})]}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(Us,{className:"h-3 w-24 bg-white/20",delay:a+300}),e.jsx(Us,{className:"h-5 w-32 bg-white/20",delay:a+400}),e.jsx(Us,{className:"h-3 w-20 bg-white/20",delay:a+500})]})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 animate-pulse",style:{animationDelay:`${a}ms`},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(Us,{className:"w-8 h-8",rounded:"lg",delay:a+100}),e.jsx(Us,{className:"h-4 w-16",rounded:"full",delay:a+200})]}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(Us,{className:"h-3 w-24",delay:a+300}),e.jsx(Us,{className:"h-5 w-32",delay:a+400}),e.jsx(Us,{className:"h-3 w-20",delay:a+500})]})]})},zs=({rows:s=5,columns:t=5,showHeader:a=!0,delay:r=0})=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden animate-pulse",style:{animationDelay:`${r}ms`},children:[a&&e.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:e.jsx("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${t}, 1fr)`},children:[...Array(t)].map((s,t)=>e.jsx(Us,{className:"h-4 w-20",delay:r+50*t},t))})}),e.jsx("div",{className:"divide-y divide-gray-200",children:[...Array(s)].map((s,a)=>e.jsx("div",{className:"px-6 py-4",children:e.jsx("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${t}, 1fr)`},children:[...Array(t)].map((s,t)=>e.jsx("div",{className:"flex items-center",children:0===t?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Us,{className:"w-8 h-8",rounded:"full",delay:r+100*a+50*t}),e.jsx(Us,{className:"h-4 w-24",delay:r+100*a+50*t+25})]}):e.jsx(Us,{className:"h-4 w-16",delay:r+100*a+50*t})},t))})},a))})]}),Ps=({type:s="line",showLegend:t=!0,delay:a=0})=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6 animate-pulse",style:{animationDelay:`${a}ms`},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx(Us,{className:"h-6 w-32 mb-2",delay:a+100}),e.jsx(Us,{className:"h-4 w-48",delay:a+200})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Us,{className:"h-8 w-20",rounded:"lg",delay:a+300}),e.jsx(Us,{className:"h-8 w-8",rounded:"lg",delay:a+350})]})]}),e.jsxs("div",{className:"h-80 bg-gray-50 rounded-lg p-4 relative overflow-hidden",children:["pie"===s?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(Us,{className:"w-48 h-48",rounded:"full",delay:a+400})}):e.jsx("div",{className:"h-full flex items-end justify-between gap-2",children:[...Array(12)].map((s,t)=>e.jsx("div",{className:"flex-1 flex flex-col justify-end",children:e.jsx(Us,{className:"w-full",height:60*Math.random()+20+"%",delay:a+400+50*t})},t))}),"pie"!==s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute bottom-4 left-4 right-4 h-px bg-gray-300"}),e.jsx("div",{className:"absolute bottom-4 left-4 top-4 w-px bg-gray-300"})]})]}),t&&e.jsx("div",{className:"mt-4 flex flex-wrap gap-4",children:[...Array("pie"===s?5:3)].map((s,t)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Us,{className:"w-3 h-3",rounded:"full",delay:a+600+50*t}),e.jsx(Us,{className:"h-4 w-16",delay:a+625+50*t})]},t))})]}),Os=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((s,t)=>e.jsx(Ls,{delay:100*t},t))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx(Ps,{type:"pie",delay:200}),e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((s,t)=>e.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200 animate-pulse",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Us,{className:"w-10 h-10",rounded:"full",delay:300+50*t}),e.jsxs("div",{children:[e.jsx(Us,{className:"h-4 w-24 mb-1",delay:325+50*t}),e.jsx(Us,{className:"h-3 w-16",delay:350+50*t})]})]}),e.jsx(Us,{className:"h-6 w-20",delay:375+50*t})]})},t))})]}),e.jsx(zs,{rows:8,columns:7,delay:500})]}),Ms=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((s,t)=>e.jsx(Ls,{delay:100*t},t))}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((s,t)=>e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-200 animate-pulse",style:{animationDelay:200+100*t+"ms"},children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Us,{className:"w-14 h-14",rounded:"2xl",delay:250+100*t}),e.jsxs("div",{children:[e.jsx(Us,{className:"h-6 w-20 mb-2",delay:275+100*t}),e.jsx(Us,{className:"h-4 w-32",delay:300+100*t})]})]})}),e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((s,a)=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-xl",children:[e.jsx(Us,{className:"h-4 w-24",delay:325+100*t+25*a}),e.jsx(Us,{className:"h-4 w-16",delay:350+100*t+25*a})]},a))})]},t))})]}),Is={primary:{iconBg:"bg-blue-50",icon:"text-blue-600",accent:"#2D5EFF"},success:{iconBg:"bg-green-50",icon:"text-green-600",accent:"#16A34A"},warning:{iconBg:"bg-amber-50",icon:"text-amber-600",accent:"#F59E0B"},danger:{iconBg:"bg-red-50",icon:"text-red-600",accent:"#DC2626"},neutral:{iconBg:"bg-gray-50",icon:"text-gray-600",accent:"#6B7280"},turquoise:{iconBg:"bg-teal-50",icon:"text-teal-600",accent:"#2CC5A7"},gray:{iconBg:"bg-gray-50",icon:"text-gray-600",accent:"#6B7280"},green:{iconBg:"bg-green-50",icon:"text-green-600",accent:"#16A34A"},red:{iconBg:"bg-red-50",icon:"text-red-600",accent:"#DC2626"},purple:{iconBg:"bg-purple-50",icon:"text-purple-600",accent:"#7C3AED"},orange:{iconBg:"bg-orange-50",icon:"text-orange-600",accent:"#F59E0B"},indigo:{iconBg:"bg-indigo-50",icon:"text-indigo-600",accent:"#4F46E5"},teal:{iconBg:"bg-teal-50",icon:"text-teal-600",accent:"#2CC5A7"},pink:{iconBg:"bg-pink-50",icon:"text-pink-600",accent:"#EC4899"}},qs=s.memo(({title:s,value:t,icon:a,variant:r="default",color:n="primary",loading:l=!1,subtitle:i,onClick:c,className:o=""})=>{const d=Is[n]||Is.primary,m=!!c;if(l)return e.jsx(Ls,{variant:r});const x=()=>{const s=a;return e.jsx(s,{style:{width:"var(--icon-default)",height:"var(--icon-default)"}})},g=`\n    enterprise-card\n    ${m?"cursor-pointer":""}\n    ${o}\n  `;switch(r){case"gradient":return e.jsxs("div",{className:`${g} enterprise-card enterprise-card-gradient`,onClick:c,children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("div",{className:"rounded-lg flex items-center justify-center backdrop-blur-sm",style:{width:"var(--space-8)",height:"var(--space-8)",backgroundColor:"rgba(255, 255, 255, 0.2)"},children:e.jsx("div",{className:"text-white",children:x()})})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"text-sm font-medium text-white/90",children:s}),e.jsx("p",{className:"text-lg font-semibold text-white",children:t}),i&&e.jsx("p",{className:"text-xs text-white/70",children:i})]})]});case"minimal":return e.jsx("div",{className:`${g} enterprise-card-compact`,onClick:c,children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`${d.iconBg} rounded-md flex items-center justify-center`,style:{width:"var(--space-6)",height:"var(--space-6)"},children:e.jsx("div",{className:d.icon,children:x()})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:s}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:t}),i&&e.jsx("p",{className:"text-xs text-gray-500",children:i})]})]})})});case"compact":return e.jsx("div",{className:`${g} enterprise-card-compact`,onClick:c,style:{padding:"var(--space-2)"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`${d.iconBg} rounded-md flex items-center justify-center`,style:{width:"var(--space-6)",height:"var(--space-6)"},children:e.jsx("div",{className:d.icon,children:x()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide truncate",children:s}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:t})}),i&&e.jsx("p",{className:"text-xs text-gray-500 truncate",children:i})]})]})});default:return e.jsxs("div",{className:g,onClick:c,children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("div",{className:`${d.iconBg} rounded-lg flex items-center justify-center`,style:{width:"var(--space-8)",height:"var(--space-8)"},children:e.jsx("div",{className:d.icon,children:x()})})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:s}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:t}),i&&e.jsx("p",{className:"text-xs text-gray-500",children:i})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 opacity-0 group-hover:opacity-100 transition-opacity duration-200",style:{backgroundColor:d.accent}})]})}});qs.displayName="StandardMetricsCard";const Bs=Object.freeze(Object.defineProperty({__proto__:null,default:function(){o();const{t:t}=Pe(),[a,n]=s.useState([]),[l,i]=s.useState(""),[c,d]=s.useState("all"),[m,x]=s.useState("all"),[g,h]=s.useState("all"),[u,p]=s.useState(!1),[j,y]=s.useState(!1),[b,v]=Rs("overview"),N=()=>{try{const e=localStorage.getItem("systemDepartments");if(e)return JSON.parse(e)}catch(e){}return["Conversion","Retention","Marketing","Research","Operation","Management","Facility"]},[w,_]=s.useState(N());s.useEffect(()=>{const e=()=>{_(N())};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]);const[k,S]=s.useState({startDate:"",companyName:"",nickname:"",salary:0,insurance:!1,name:"",email:"",phone:"",role:"",department:""}),R=a.filter(e=>{const s=e.name.toLowerCase().includes(l.toLowerCase())||e.email.toLowerCase().includes(l.toLowerCase()),t="all"===c||e.status===c,a="all"===m||e.department===m,r="all"===g||e.department===g;return s&&t&&a&&r}),A=R.length,W=R.filter(e=>"active"===e.status).length,J=R.reduce((e,s)=>e+s.totalTransactions,0),G=R.length>0?Math.round(R.reduce((e,s)=>e+s.performance,0)/R.length):0,Q=()=>{y(!0)},Z=()=>{y(!1),S({startDate:"",companyName:"",nickname:"",salary:0,insurance:!1,name:"",email:"",phone:"",role:"",department:""})},X=(e,s)=>{S(t=>({...t,[e]:s}))};return e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(T,{className:"h-8 w-8 text-gray-600"}),"Agent Management"]}),e.jsx("p",{className:"text-gray-600",children:"Team management"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ke,{variant:"outline",size:"sm",onClick:()=>{const e=[["Name","Email","Phone","Role","Department","Status","Hire Date","Total Transactions","Performance","Company","Nickname","Salary","Insurance"].join(","),...a.map(e=>[`"${e.name}"`,`"${e.email}"`,`"${e.phone}"`,`"${e.role}"`,`"${e.department}"`,`"${e.status}"`,`"${e.hireDate}"`,e.totalTransactions,e.performance,`"${e.companyName||""}"`,`"${e.nickname||""}"`,e.salary||0,e.insurance?"Yes":"No"].join(","))].join("\n"),s=new Blob([e],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a"),r=URL.createObjectURL(s);t.setAttribute("href",r),t.setAttribute("download",`agents_export_${(new Date).toISOString().split("T")[0]}.csv`),t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t)},icon:e.jsx($,{className:"h-4 w-4"}),iconPosition:"left",children:"Export"}),e.jsx(ke,{variant:"primary",size:"sm",onClick:Q,icon:e.jsx(F,{className:"h-4 w-4"}),iconPosition:"left",children:"Add Agent"})]})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"bg-gray-50/50 border border-gray-200/60 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("span",{className:"font-medium",children:["Active Agents: ",W]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full"}),e.jsxs("span",{className:"font-medium",children:[t("dashboard.total_transactions"),": ",J.toLocaleString()]})]})]})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100/50 px-6 py-2",children:e.jsxs("nav",{className:"flex space-x-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>v("overview"),className:"tab-button px-6 py-3 rounded-xl font-medium text-sm transition-all duration-200 flex items-center gap-2 "+("overview"===b?"bg-white text-gray-600 shadow-md border border-gray-200":"text-gray-600 hover:text-gray-800 hover:bg-white/50"),children:[e.jsx(U,{className:"h-4 w-4"}),"Overview"]}),"overview"===b&&e.jsx("button",{onClick:()=>{window.location.reload()},className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-white/60 rounded-lg transition-all duration-200 hover:shadow-sm",title:"Refresh Overview data",children:e.jsx(r,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>v("agents"),className:"tab-button px-6 py-3 rounded-xl font-medium text-sm transition-all duration-200 flex items-center gap-2 "+("agents"===b?"bg-white text-gray-600 shadow-md border border-gray-200":"text-gray-600 hover:text-gray-800 hover:bg-white/50"),children:[e.jsx(T,{className:"h-4 w-4"}),"Agents"]}),"agents"===b&&e.jsx("button",{onClick:()=>{window.location.reload()},className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-white/60 rounded-lg transition-all duration-200 hover:shadow-sm",title:"Refresh Agents data",children:e.jsx(r,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>v("analytics"),className:"tab-button px-6 py-3 rounded-xl font-medium text-sm transition-all duration-200 flex items-center gap-2 "+("analytics"===b?"bg-white text-gray-600 shadow-md border border-gray-200":"text-gray-600 hover:text-gray-800 hover:bg-white/50"),children:[e.jsx(L,{className:"h-4 w-4"}),"Analytics"]}),"analytics"===b&&e.jsx("button",{onClick:()=>{window.location.reload()},className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-white/60 rounded-lg transition-all duration-200 hover:shadow-sm",title:"Refresh Analytics data",children:e.jsx(r,{className:"h-4 w-4"})})]})]})})}),"overview"===b&&e.jsx("div",{children:e.jsxs(_e,{variant:"elevated",className:"mb-6",children:[e.jsxs(Qe,{children:[e.jsxs(Ze,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5 text-gray-600"}),"Performance Overview"]}),e.jsx(Xe,{children:"Key metrics and performance indicators for your agent team"})]}),e.jsx(Ge,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(qs,{title:"Total Agents",value:A,subtitle:"+5.2% from last month",icon:T,color:"primary",variant:"default"}),e.jsx(qs,{title:"Active Agents",value:W,subtitle:"+8.7% from last month",icon:z,color:"success",variant:"default"}),e.jsx(qs,{title:t("dashboard.total_transactions"),value:J.toLocaleString(),subtitle:"+12.3% from last month",icon:C,color:"orange",variant:"default"}),e.jsx(qs,{title:"Avg. Performance",value:`${G}%`,subtitle:"+3.1% from last month",icon:P,color:"purple",variant:"default"})]})})]})}),"agents"===b&&e.jsx("div",{children:e.jsxs(_e,{variant:"elevated",className:"mb-6",children:[e.jsxs(Qe,{children:[e.jsxs(Ze,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5 text-gray-600"}),"Agent Management"]}),e.jsx(Xe,{children:"Search, filter, and manage your agent team"})]}),e.jsxs(Ge,{children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:[e.jsx("div",{className:"p-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-5 w-5 text-gray-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Filters"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",[l,c,m].filter(e=>e&&"all"!==e).length," ","active)"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(es,{variant:"outline",size:"sm",onClick:()=>{i(""),d("all"),x("all"),h("all")},className:"flex items-center gap-2","aria-label":"Reset filters",children:"Reset"}),e.jsxs(es,{variant:"outline",size:"sm",onClick:()=>p(!u),className:"flex items-center gap-2","aria-label":u?"Hide filters":"Show filters",children:[e.jsx(O,{className:"h-4 w-4 transition-transform duration-200 "+(u?"rotate-180":""),"aria-hidden":"true"}),u?"Hide":"Show"," Filters"]})]})]})}),u&&e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Agents"}),e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by name or email...",value:l,onChange:e=>i(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:c,onChange:e=>d(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),e.jsxs("select",{value:m,onChange:e=>x(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",children:[e.jsx("option",{value:"all",children:"All Departments"}),w.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"px-8 py-6 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-gray-100/50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-700 rounded-xl flex items-center justify-center shadow-sm",children:e.jsx(T,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Agents"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage and view all agent records"})]})]})}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("div",{className:"bg-white px-4 py-2 rounded-xl border border-gray-200 shadow-sm",children:e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[R.length," agent",1!==R.length?"s":""]})})})]})}),e.jsx("div",{className:"px-8 py-4 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-gray-100/30",children:e.jsxs("nav",{className:"flex space-x-1 overflow-x-auto",children:[e.jsxs("button",{onClick:()=>h("all"),className:"tab-button px-4 py-2 rounded-lg font-medium text-sm transition-all duration-200 flex items-center gap-2 whitespace-nowrap "+("all"===g?"bg-gray-600 text-white shadow-md":"text-gray-600 hover:text-gray-800 hover:bg-white/50"),children:[e.jsx(T,{className:"h-4 w-4"}),"All Departments",e.jsx("span",{className:"ml-1 px-2 py-0.5 text-xs bg-white/20 rounded-full",children:a.length})]}),w.map(s=>{const t=(e=>{switch(e){case"Conversion":return E;case"Retention":return V;case"Marketing":return U;case"Research":return M;case"Operation":return z;case"Management":return T;default:return q}})(s);return e.jsxs("button",{onClick:()=>h(s),className:"tab-button px-4 py-2 rounded-lg font-medium text-sm transition-all duration-200 flex items-center gap-2 whitespace-nowrap "+(g===s?"bg-gray-600 text-white shadow-md":"text-gray-600 hover:text-gray-800 hover:bg-white/50"),children:[e.jsx(t,{className:"h-4 w-4"}),s,e.jsx("span",{className:"ml-1 px-2 py-0.5 text-xs bg-white/20 rounded-full",children:a.filter(e=>e.department===s).length})]},s)})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-3 w-3"}),"Agent"]})}),e.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-3 w-3"}),"Contact"]})}),e.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-3 w-3"}),"Role & Department"]})}),e.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-3 w-3"}),"Performance"]})}),e.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-3 w-3"}),"Transactions"]})}),e.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-3 w-3"}),"Status"]})}),e.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-3 w-3"}),"Actions"]})})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:R.map((s,t)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-all duration-200 group "+(t%2==0?"bg-white":"bg-gray-50/30"),children:[e.jsx("td",{className:"px-8 py-5 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-500 to-gray-600 rounded-xl flex items-center justify-center shadow-sm",children:e.jsx("span",{className:"text-white font-semibold text-sm",children:s.name.split(" ").map(e=>e[0]).join("")})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:s.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Hired: ",new Date(s.hireDate).toLocaleDateString()]})]})]})}),e.jsxs("td",{className:"px-8 py-5 whitespace-nowrap",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-900 font-medium",children:s.email})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx(H,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-500",children:s.phone})]})]}),e.jsxs("td",{className:"px-8 py-5 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:s.role}),e.jsx("div",{className:"text-sm text-gray-500",children:s.department})]}),e.jsx("td",{className:"px-8 py-5 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2.5 mr-3",children:e.jsx("div",{className:"h-2.5 rounded-full transition-all duration-300 "+(s.performance>=90?"bg-green-500":s.performance>=70?"bg-yellow-500":"bg-red-500"),style:{width:`${s.performance}%`}})}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900 min-w-[3rem]",children:[s.performance,"%"]})]})}),e.jsx("td",{className:"px-8 py-5 whitespace-nowrap",children:e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:s.totalTransactions.toLocaleString()})}),e.jsx("td",{className:"px-8 py-5 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex px-3 py-1 text-xs font-semibold rounded-full "+("active"===s.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})}),e.jsx("td",{className:"px-8 py-5 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-50 rounded transition-colors duration-200",title:"View Details",children:e.jsx(f,{className:"h-3.5 w-3.5"})}),e.jsx("button",{className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors duration-200",title:"Edit Agent",children:e.jsx(K,{className:"h-3.5 w-3.5"})}),e.jsx("button",{className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors duration-200",title:"Delete Agent",children:e.jsx(Y,{className:"h-3.5 w-3.5"})})]})})]},s.id))})]})}),0===R.length&&e.jsxs("div",{className:"text-center py-16 px-6",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(T,{className:"h-10 w-10 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:l||"all"!==c||"all"!==m||"all"!==g?"No agents found":"No agents yet"}),e.jsx("p",{className:"text-gray-500 mb-6 max-w-md mx-auto",children:l||"all"!==c||"all"!==m||"all"!==g?"Try adjusting your search criteria or filters to find what you're looking for.":"Start building your team by adding your first agent to the system."}),e.jsxs("button",{onClick:Q,className:"inline-flex items-center px-6 py-3 border border-transparent rounded-lg text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors shadow-sm",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Add Your First Agent"]})]}),R.length>0&&e.jsx("div",{className:"px-6 py-4 border-t border-gray-100 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-700",children:[e.jsxs("span",{children:["Showing ",R.length," agent",1!==R.length?"s":""]}),e.jsxs("span",{className:"font-semibold",children:["Avg Performance: ",G,"%"]})]})})]})]})]})}),"analytics"===b&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Agent Analytics"}),e.jsx("p",{className:"text-gray-600",children:"Analytics content will be implemented here."})]})}),j&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Add New Agent"}),e.jsx("button",{onClick:Z,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:e.jsx(D,{className:"h-5 w-5"})})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),e.jsx("input",{type:"text",value:k.name,onChange:e=>X("name",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",placeholder:"Enter full name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",value:k.email,onChange:e=>X("email",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",placeholder:"Enter email address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone *"}),e.jsx("input",{type:"tel",value:k.phone,onChange:e=>X("phone",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",placeholder:"Enter phone number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date *"}),e.jsx("input",{type:"date",value:k.startDate,onChange:e=>X("startDate",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Company Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Name"}),e.jsx("input",{type:"text",value:k.companyName,onChange:e=>X("companyName",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",placeholder:"Enter company name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nickname"}),e.jsx("input",{type:"text",value:k.nickname,onChange:e=>X("nickname",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",placeholder:"Enter nickname"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Role & Department"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role *"}),e.jsxs("select",{value:k.role,onChange:e=>X("role",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",children:[e.jsx("option",{value:"",children:"Select role"}),e.jsx("option",{value:"Senior Agent",children:"Senior Agent"}),e.jsx("option",{value:"Agent",children:"Agent"}),e.jsx("option",{value:"Junior Agent",children:"Junior Agent"}),e.jsx("option",{value:"Team Lead",children:"Team Lead"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department *"}),e.jsxs("select",{value:k.department,onChange:e=>X("department",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",children:[e.jsx("option",{value:"",children:"Select department"}),w.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Financial Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Salary (â‚º)"}),e.jsx("input",{type:"number",value:k.salary,onChange:e=>X("salary",parseFloat(e.target.value)||0),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",placeholder:"Enter salary amount"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Insurance"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"insurance",checked:!0===k.insurance,onChange:()=>X("insurance",!0),className:"h-4 w-4 text-gray-600 focus:ring-gray-500 border-gray-300"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Yes"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"insurance",checked:!1===k.insurance,onChange:()=>X("insurance",!1),className:"h-4 w-4 text-gray-600 focus:ring-gray-500 border-gray-300"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"No"})]})]})]})]})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-100",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:Z,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200",children:"Cancel"}),e.jsx("button",{onClick:()=>{const e={id:Date.now(),...k,status:"active",hireDate:k.startDate,totalTransactions:0,performance:85};n(s=>[...s,e]),S({startDate:"",companyName:"",nickname:"",salary:0,insurance:!1,name:"",email:"",phone:"",role:"",department:""}),y(!1)},disabled:!(k.name&&k.email&&k.phone&&k.startDate&&k.role&&k.department),className:"flex-1 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Add Agent"})]})})]})})]})]})}},Symbol.toStringTag,{value:"Module"})),Hs=e=>0===e?"text-gray-500":e<=2?"text-green-600":e<=5?"text-yellow-600":e<=10?"text-orange-600":"text-red-600",Ks=e=>0===e?"bg-gray-100 text-gray-600":e<=2?"bg-green-100 text-green-800":e<=5?"bg-yellow-100 text-yellow-800":e<=10?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800",Ys=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{isAuthenticated:a,isLoading:n}=Oe(),{t:l}=Pe(),i=o(),d=(e,s)=>"TETHER"===s.toUpperCase()?De(e):Ce(e,"â‚º"),[m,x]=s.useState([]),[g,u]=s.useState(!0),[p,j]=s.useState(null),[y,f]=s.useState(""),[b,v]=s.useState("all"),[N,w]=s.useState(!1);s.useState(!1);const[k,S]=Rs("overview");s.useEffect(()=>{"trust"===k&&i("/trust",{replace:!0})},[k,i]);const[T,F]=s.useState(!1);s.useState("idle"),s.useState(!1);const[P,O]=s.useState(!1),[M,I]=s.useState(null),[q,B]=s.useState(null),[H,Y]=s.useState([]),[re,ne]=s.useState(!1),[le,ie]=s.useState((new Date).getFullYear()),[ce,oe]=s.useState((new Date).getMonth()+1),[de,me]=s.useState(new Set),[xe,ge]=s.useState(1),[he]=s.useState(10);s.useState("30"),s.useState(""),s.useState(""),s.useState(!1);const[ue,pe]=s.useState(null),[je,ye]=s.useState([]),[fe,be]=s.useState(!1);s.useState({}),s.useState({});const[ve,Ne]=s.useState({}),[we,ke]=s.useState([]),[Ee,Re]=s.useState(!1),[Ae,Te]=s.useState(null),[$e,Fe]=s.useState({}),[Ue,Le]=s.useState(!1),[ze,Me]=s.useState([]),[Ie,qe]=s.useState(!1),[Be,He]=s.useState(null),[Ke,Ye]=s.useState(!1),[Ve,Je]=s.useState(null),[ls,is]=s.useState(""),[cs,ws]=s.useState(!1),[_s,ks]=s.useState(!1),[Ss,Cs]=s.useState(null),[Ds,Es]=s.useState(""),[As,Ts]=s.useState(!1),[$s,Us]=s.useState(""),[Ls,zs]=s.useState(!1),[Ps,Os]=s.useState(null),[Is,qs]=s.useState(""),[Bs,Ys]=s.useState(!1),[Vs,Ws]=s.useState(""),[Js,Gs]=s.useState({startDate:"",endDate:"",psp:"",type:"",page:1}),Qs=(e,s,t)=>{const a=((e,s)=>{const t=new Date(e,s,0).getDate(),a=[];for(let r=1;r<=t;r++){const t=new Date(e,s-1,r),n=`${e}-${String(s).padStart(2,"0")}-${String(r).padStart(2,"0")}`;a.push({date:n,day:r,dayName:t.toLocaleDateString("tr-TR",{weekday:"short"}),isWeekend:0===t.getDay()||6===t.getDay()})}return a})(s,t),r=e.daily_breakdown||[],n=new Map;return r.forEach(e=>{n.set(e.date,e)}),a.map(e=>{const s=n.get(e.date);return s?{...s,day:e.day,dayName:e.dayName,isWeekend:e.isWeekend}:{date:e.date,day:e.day,dayName:e.dayName,isWeekend:e.isWeekend,yatimim:0,cekme:0,toplam:0,komisyon:0,net:0,tahs_tutari:0,kasa_top:0,devir:0,transaction_count:0}})};s.useEffect(()=>{window.scrollTo({top:0,behavior:"instant"})},[]),s.useEffect(()=>{a&&!n&&(j(null),Zs(),"overview"===k&&st())},[a,n,k]),s.useEffect(()=>{"monthly"===k&&a&&!n&&(et(le,ce),rt(Js.page))},[k,a,n,le,ce,Js.startDate,Js.endDate,Js.psp,Js.type]),s.useEffect(()=>{const e=e=>{a&&!n&&(Zs(!0),"overview"===k&&st(!0))};return window.addEventListener("transactionsUpdated",e),()=>{window.removeEventListener("transactionsUpdated",e)}},[a,n,k]),s.useEffect(()=>()=>{Se.clearCacheForUrl("psp_summary_stats"),Se.clearCacheForUrl("ledger-data")},[]);const Zs=async(e=!1)=>{try{u(!0),j(null),e&&Se.clearCacheForUrl("psp_summary_stats");const s=await Se.get("/transactions/psp_summary_stats");if(401===s.status)return;const t=Se.parseResponse(s);if(200===s.status&&t){const e=(Array.isArray(t)?t:[]).map(e=>({psp:e.psp||"Unknown",total_amount:e.total_amount||0,total_commission:e.total_commission||0,total_net:e.total_net||0,total_allocations:e.total_allocations||0,total_deposits:e.total_deposits||0,total_withdrawals:e.total_withdrawals||0,transaction_count:e.transaction_count||0,commission_rate:e.commission_rate||0}));x(e)}else{const e=t&&"object"==typeof t&&"message"in t?t.message:"Failed to load PSP data";j(e),x([])}}catch(s){j(`Failed to load PSP data: ${s instanceof Error?s.message:"Unknown error"}`),x([])}finally{u(!1)}},Xs=(e,s)=>{if(0===s)return"Normal";const t=e/s;return t>.3?"Critical":t>.2?"High":t>.1?"Medium":"Normal"},et=async(e,s,t=!1,a=!0)=>{try{ne(!0),j(null);const r=`/transactions/psp_monthly_stats?year=${e}&month=${s}${a?"&include_daily=true":"&include_daily=false"}${t?`&_t=${Date.now()}`:""}`,n=await Se.get(r,void 0,!t);if(401===n.status)return;if(!n.ok){const e=await n.json().catch(()=>({}));throw new Error(e.message||`HTTP ${n.status}: ${n.statusText}`)}const l=await Se.parseResponse(n);let i=[];if(Array.isArray(l))i=l;else if(l&&Array.isArray(l.data))i=l.data;else if(l&&"object"==typeof l){const e=["psps","psp_data","monthly_data","results"];for(const s of e)if(Array.isArray(l[s])){i=l[s];break}}Y(i),0===i.length?j(`No PSP data available for ${new Date(e,s-1).toLocaleString("default",{month:"long",year:"numeric"})}`):j(null)}catch(r){const e=r instanceof Error?r.message:"Failed to fetch monthly data";j(e),Y([])}finally{ne(!1)}},st=async(e=!1)=>{be(!0);try{e&&Se.clearCacheForUrl("ledger-data");const t=await Se.get("/analytics/ledger-data",void 0,!e);if(t.ok){const e=await Se.parseResponse(t),s=e.ledger_data||[];ye(s);const a={};if(s.forEach(e=>{Object.entries(e.psps).forEach(([s,t])=>{const r=`${e.date}-${s}`,n=t;a[r]=n.allocation||0})}),Ne(a),tt(s,m),e&&"object"==typeof e&&"validation_errors"in e){const s=e.validation_errors;Array.isArray(s)&&s.length>0?j(`Data loaded with warnings: ${s.join(", ")}`):j(null)}else j(null)}else{let e="Failed to fetch ledger data";try{const s=await Se.parseResponse(t).catch(()=>({}));s&&"object"==typeof s&&"error"in s?e=s.error||e:404===t.status&&(e="Ledger data endpoint not found. Please check backend configuration.")}catch(s){404===t.status&&(e="Ledger data endpoint not found. Please check backend configuration.")}j(e)}}catch(t){const e=t?.message||"Network error occurred";e.includes("bulunamadÄ±")||e.includes("404")||e.includes("Not Found")?j("Endpoint bulunamadÄ±. Backend servisinin Ã§alÄ±ÅŸtÄ±ÄŸÄ±ndan emin olun."):j(`Failed to load ledger data: ${e}`),ye([])}finally{be(!1)}},tt=s.useCallback((e,s)=>{const t=new Map;e.forEach(e=>{Object.entries(e.psps).forEach(([s,a])=>{t.has(s)||t.set(s,{psp:s,total_deposits:0,total_withdrawals:0,total_net:0,total_allocations:0,total_rollover:0,transaction_count:0,average_transaction:0,last_activity:e.date_str});const r=t.get(s);r.total_deposits+=a.deposit||0,r.total_withdrawals+=a.withdraw||0,r.total_net+=a.net||0,r.transaction_count+=a.transaction_count||1,r.last_activity=e.date_str})}),t.forEach(e=>{const t=s.find(s=>s.psp===e.psp);e.total_allocations=t?.total_allocations||0,e.average_transaction=e.transaction_count>0?e.total_net/e.transaction_count:0,e.total_rollover=e.total_net-e.total_allocations});const a=Array.from(t.values());ke(a)},[]),at=()=>{Re(!1),Te(null),Fe({})},rt=async(e=1)=>{qe(!0);try{const s=new URLSearchParams({page:e.toString(),per_page:"50"});Js.startDate&&s.append("start_date",Js.startDate),Js.endDate&&s.append("end_date",Js.endDate),Js.psp&&s.append("psp",Js.psp),Js.type&&s.append("type",Js.type);const t=await Se.get(`/analytics/unified-history?${s}`);if(t.ok){const e=await Se.parseResponse(t);if(e&&"object"==typeof e&&"success"in e&&e.success){const s=e.data||[];Me(s),He(e.pagination||null)}else e&&"object"==typeof e&&"error"in e&&j(e.error||"Failed to load history data")}else{const e=await Se.parseResponse(t).catch(()=>({}));j(e?.error||"Failed to fetch history data")}}catch(s){const e=s instanceof Error?s.message:"Failed to fetch history data";j(e),Me([]),He(null)}finally{qe(!1)}},nt=(e,s)=>{const t={...Js,[e]:s,page:1};Gs(t),rt(1)},lt=e=>{Gs(s=>({...s,page:e})),rt(e)},it=async e=>{try{const s=new URLSearchParams({format:e});Js.startDate&&s.append("start_date",Js.startDate),Js.endDate&&s.append("end_date",Js.endDate),Js.psp&&s.append("psp",Js.psp),Js.type&&s.append("type",Js.type);const t=await Se.get(`/analytics/unified-history/export?${s}`,{responseType:"blob"});if(t.ok){const s=window.URL.createObjectURL(await t.blob()),a=document.createElement("a");a.href=s,a.setAttribute("download",`unified_history_${(new Date).toISOString().split("T")[0]}.${e}`),document.body.appendChild(a),a.click(),a.remove(),window.URL.revokeObjectURL(s)}}catch(s){}},ct=async(e,s,t)=>{let a=0;for(;a<=2;)try{if(a>0)try{Se.clearToken?.(),await Se.get("/auth/csrf-token"),await new Promise(e=>setTimeout(e,300))}catch(r){}const l=await Se.post("/analytics/update-allocation",{date:e,psp:s,allocation:t});if(!l.ok){let e="Allocation kaydedilemedi",s="";try{const t=await Se.parseResponse(l);if((t?.csrf_error||t?.error?.includes("CSRF")||t?.error?.includes("token")||t?.error?.includes("Security token")||t?.message?.includes("CSRF")||t?.message?.includes("token"))&&a<2){a++;continue}e=t?.error||t?.message||e,s=t?.details||t?.message||""}catch(n){if(a<2){a++;continue}e=`HTTP ${l.status}`}const t=s?`${e} - ${s}`:e;throw new Error(t)}try{return await Se.parseResponse(l)||{success:!0}}catch(n){return{success:!0}}}catch(l){if((l?.message?.includes("CSRF")||l?.message?.includes("token")||l?.message?.includes("Security token"))&&a<2){a++,await new Promise(e=>setTimeout(e,300));continue}throw l.message?l:new Error("AÄŸ hatasÄ± veya istek baÅŸarÄ±sÄ±z oldu")}throw new Error("GÃ¼venlik token hatasÄ± - LÃ¼tfen sayfayÄ± yenileyin ve tekrar deneyin")},ot=()=>{Ye(!1),Je(null),is("")},dt=()=>{ks(!1),Cs(null),Es(""),Us("")},mt=()=>{zs(!1),Os(null),qs(""),Ws("")},xt=()=>{O(!1),I(null),B(null),pe(null)},gt=e=>new Intl.NumberFormat("en-US").format(e),ht=Array.isArray(m)?m.filter(e=>{const s=e.psp.toLowerCase().includes(y.toLowerCase()),t="all"===b||e.psp===b;return s&&t}):[];return ht.reduce((e,s)=>e+s.total_amount,0),ht.reduce((e,s)=>e+s.total_commission,0),ht.reduce((e,s)=>e+s.total_net,0),ht.reduce((e,s)=>e+s.transaction_count,0),!Array.isArray(m)||new Set(m.map(e=>e.psp)),n||g?e.jsx(Ms,{}):p?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(R,{className:"h-10 w-10 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Error Loading Data"}),e.jsx("p",{className:"text-gray-600 mb-6",children:p}),e.jsxs("button",{onClick:()=>Zs(!0),className:"inline-flex items-center gap-2 px-6 py-3 bg-accent-600 text-white rounded-lg hover:bg-accent-700 transition-colors duration-200",children:[e.jsx(r,{className:"h-4 w-4"}),"Try Again"]})]})}):e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx(ss,{title:l("ledger.psp_ledger"),description:l("ledger.psp_transactions_balances"),icon:W,actions:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(es,{variant:"outline",size:"default",onClick:async()=>{w(!0);try{const e=[Zs(!0),st(!0)];"monthly"===k&&e.push(et(le,ce,!0)),await Promise.all(e)}finally{w(!1)}},disabled:N,className:"flex items-center gap-2 h-10 px-4 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-sm",children:[e.jsx(r,{className:"h-4 w-4 "+(N?"animate-spin":"")}),l(N?"ledger.refreshing":"ledger.refresh")]}),e.jsxs(es,{variant:"outline",size:"default",onClick:()=>{try{const e=["Date","PSP","Deposits","Withdrawals","Total","Commission","Net","Allocation","Rollover","Risk Level"],s=[];je.forEach(e=>{Object.entries(e.psps).forEach(([t,a])=>{const r=(a.net||0)-(a.allocation||0),n=Xs(r,a.net||0);s.push([e.date_str,t,a.deposit||0,a.withdraw||0,a.toplam||0,a.komisyon||0,a.net||0,a.allocation||0,r,n])})});const t=[e,...s].map(e=>e.map(e=>`"${e}"`).join(",")).join("\n"),a=new Blob([t],{type:"text/csv;charset=utf-8;"}),r=window.URL.createObjectURL(a),n=document.createElement("a");n.href=r,n.download=`ledger_export_${(new Date).toISOString().split("T")[0]}.csv`,n.click(),window.URL.revokeObjectURL(r)}catch(e){alert(l("ledger.export_failed"))}},className:"flex items-center gap-2 h-10 px-4 hover:bg-gray-50 hover:border-gray-300 transition-all shadow-sm",children:[e.jsx($,{className:"h-4 w-4"}),l("ledger.export")]})]})})}),e.jsx("div",{className:"p-6",children:e.jsxs(ts,{value:k,onValueChange:S,className:"w-full",children:[e.jsxs(as,{className:"grid w-full grid-cols-3 bg-gray-50/80 border border-gray-200/60 rounded-lg shadow-sm",children:[e.jsxs(rs,{value:"overview",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg",children:[e.jsx(J,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-gray-700"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:l("tabs.overview")})]}),e.jsxs(rs,{value:"monthly",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg",children:[e.jsx(G,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-gray-700"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:l("tabs.monthly")})]}),e.jsxs(rs,{value:"analytics",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg",children:[e.jsx(U,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-gray-700"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:l("tabs.analytics")})]})]}),e.jsxs(ns,{value:"overview",className:"mt-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5 text-gray-600"}),l("ledger.psp_overview")]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:l("ledger.key_performance_all_psps")})]}),e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(Fs,{title:l("ledger.total_psps"),value:gt(m.length),subtitle:l("ledger.active_providers"),icon:W,color:"gray",animated:!0,animationDuration:500}),(()=>{const s=je.reduce((e,s)=>(Object.entries(s.psps).forEach(([s,t])=>{const a=(t.net||0)-(t.allocation||0),r=Xs(a,t.net||0);"Critical"===r?e.critical++:"High"===r?e.high++:"Medium"===r?e.medium++:e.normal++,e.totalRollover+=a}),e),{critical:0,high:0,medium:0,normal:0,totalRollover:0}),a=s.critical>0||s.high>0,r=a?"red":"green",n=a?t:_,i=a?`${s.critical+s.high}`:"0",c=a?`${s.critical} critical, ${s.high} high`:"Healthy levels";return e.jsx(Fs,{title:l("ledger.rollover_risk"),value:i,subtitle:c,icon:n,color:r,animated:!0,animationDuration:500})})(),e.jsx(Fs,{title:l("ledger.total_allocations"),value:Ce(m.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.total_allocations),0),"â‚º"),subtitle:l("ledger.funds_allocated"),icon:Q,color:"orange",animated:!0,animationDuration:500}),e.jsx(Fs,{title:l("ledger.total_rollover"),value:Ce(m.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.total_allocations-s.total_net),0),"â‚º"),subtitle:l("ledger.available_balance"),icon:z,color:"purple",animated:!0,animationDuration:500})]})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-gray-600"}),l("ledger.psp_overview_cards")]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:`${m.length} ${l("ledger.psp_count")} - ${l("ledger.all_available_data")}`})]}),e.jsxs("div",{children:[fe?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(s=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 space-y-4 animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-5 bg-gray-200 rounded w-24 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-100 rounded w-32"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-16 bg-gray-100 rounded"}),e.jsx("div",{className:"h-16 bg-gray-100 rounded"})]})]},s))}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map((s,t)=>{const a=(e=>{const s=[W,Q,z,ae,U,te];return s[e.length%s.length]})(s.psp)||W,r=s.total_net-s.total_allocations,n=s.total_net>0?r/s.total_net*100:0,i=r>0;return e.jsxs("div",{className:"bg-white rounded-xl shadow-md hover:shadow-xl transition-all duration-300 group border border-gray-100 hover:border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-100 bg-gradient-to-br from-white to-gray-50/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center shadow-sm group-hover:shadow-md transition-shadow",children:e.jsx(a,{className:"h-6 w-6 text-gray-600 group-hover:scale-110 transition-transform"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 group-hover:text-gray-700 transition-colors",children:s.psp}),e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:l("ledger.payment_provider")})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold "+(i?"text-green-600":"text-red-600"),children:[n.toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-gray-500 font-medium",children:l("ledger.rollover_rate")})]})]})}),e.jsxs("div",{className:"p-6 space-y-4 bg-white",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-xl border border-gray-100 hover:border-gray-200 transition-all group/metric",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:l("ledger.total_deposits")}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:d(s.total_deposits,s.psp)})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:l("ledger.total_withdrawals")}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:d(s.total_withdrawals,s.psp)})]})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:l("ledger.net_amount")}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:d(s.total_net,s.psp)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:l("ledger.allocations")}),e.jsx("div",{className:"text-sm font-semibold text-warning-600",children:d(s.total_allocations,s.psp)})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:l("ledger.rollover")}),e.jsx("div",{className:"text-sm font-semibold "+(i?"text-success-600":"text-destructive-600"),children:d(r,s.psp)})]})]})]}),e.jsx("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-600",children:l("ledger.total_transactions")}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:gt(s.transaction_count)})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-600",children:l("ledger.avg_transaction")}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:d(s.transaction_count>0?s.total_net/s.transaction_count:0,s.psp)})]})]})})]},s.psp)})}),0===m.length&&!fe&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(W,{className:"h-10 w-10 text-gray-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:l("ledger.no_psp_data_available")}),e.jsx("p",{className:"text-sm text-gray-600 max-w-md mx-auto mb-6",children:l("ledger.no_psp_data_desc")}),e.jsxs("div",{className:"flex flex-col items-center gap-3 text-xs text-gray-500 max-w-sm mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full"}),e.jsx("span",{children:"Transaction data appears automatically when processed"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full"}),e.jsx("span",{children:"Use the refresh button to update statistics"})]})]})]})]})]})]}),e.jsxs(ns,{value:"monthly",className:"mt-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden",children:[e.jsx("div",{className:"bg-slate-100 px-6 py-3 border-b border-slate-300",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-700 rounded-lg flex items-center justify-center",children:e.jsx(G,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 tracking-tight",children:l("ledger.monthly_psp_report")}),e.jsx("p",{className:"text-sm text-slate-600",children:l("tabs.monthly_desc")})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Year:"}),e.jsx("select",{value:le,onChange:e=>ie(parseInt(e.target.value)),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",children:Array.from({length:5},(e,s)=>(new Date).getFullYear()-s).map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Month:"}),e.jsx("select",{value:ce,onChange:e=>oe(parseInt(e.target.value)),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",children:Array.from({length:12},(e,s)=>s+1).map(s=>e.jsx("option",{value:s,children:new Date(2024,s-1).toLocaleString("default",{month:"long"})},s))})]}),e.jsxs(es,{onClick:()=>et(le,ce,!0),variant:"outline",size:"sm",className:"flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:re,children:[e.jsx(r,{className:"h-4 w-4 "+(re?"animate-spin":"")}),re?"Refreshing...":"Refresh"]})]})]})}),re?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r,{className:"h-5 w-5 animate-spin text-slate-600"}),e.jsx("span",{className:"text-slate-600",children:"Loading monthly data..."})]})}):p?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(R,{className:"h-8 w-8 text-red-500"})}),e.jsx("h3",{className:"text-lg font-medium text-red-900 mb-2",children:"Error Loading Monthly Data"}),e.jsx("p",{className:"text-red-600 mb-4",children:p}),e.jsxs(es,{onClick:()=>et(le,ce,!0),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(r,{className:"h-4 w-4"}),"Try Again"]})]}):0===H.length?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(G,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:l("ledger.no_psp_data_available")}),e.jsx("p",{className:"text-slate-600 mb-4",children:l("ledger.no_psp_data")}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Selected: ",new Date(le,ce-1).toLocaleString("default",{month:"long",year:"numeric"})]})]}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-100 border-b border-slate-300",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider w-12"}),e.jsx("th",{className:"text-left py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[180px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-3.5 w-3.5 text-slate-600"}),l("ledger.psp_count")]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[120px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx(E,{className:"h-3.5 w-3.5 text-slate-600"}),"YATIRIM"]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[120px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx(Z,{className:"h-3.5 w-3.5 text-slate-600"}),"Ã‡EKME"]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[120px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx(C,{className:"h-3.5 w-3.5 text-slate-600"}),"TOPLAM"]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[140px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[T?e.jsx("div",{className:"animate-spin h-3.5 w-3.5 border-2 border-slate-600 border-t-transparent rounded-full"}):e.jsx(z,{className:"h-3.5 w-3.5 text-slate-600"}),e.jsx("span",{children:"KOMÄ°SYON"})]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[120px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx(V,{className:"h-3.5 w-3.5 text-slate-600"}),"NET"]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[140px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx(Q,{className:"h-3.5 w-3.5 text-slate-600"}),"TAHS TUTARI"]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[120px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx(U,{className:"h-3.5 w-3.5 text-slate-600"}),"KASA TOP"]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[120px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx(r,{className:"h-3.5 w-3.5 text-slate-600"}),"DEVÄ°R"]})})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200",children:H.filter(e=>e&&e.psp).slice((xe-1)*he,xe*he).map((s,t)=>e.jsxs(c.Fragment,{children:[e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"py-4 px-6",children:e.jsx("button",{onClick:()=>{return e=s.psp,void me(s=>{const t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t});var e},className:"p-1.5 hover:bg-slate-200 rounded transition-colors",title:de.has(s.psp)?"Collapse details":"Expand details",children:de.has(s.psp)?e.jsx(X,{className:"h-3.5 w-3.5 text-slate-600"}):e.jsx(ee,{className:"h-3.5 w-3.5 text-slate-600"})})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded flex items-center justify-center",children:e.jsx(W,{className:"h-4 w-4 text-slate-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-slate-900 text-sm",children:s.psp}),e.jsxs("div",{className:"text-xs text-slate-500",children:[s.transaction_count||0," txns"]})]})]})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:d(s.yatimim||0,s.psp)})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:d(s.cekme||0,s.psp)})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:d(s.toplam||0,s.psp)})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:d(s.komisyon||0,s.psp)}),void 0!==s.commission_rate&&"TETHER"!==s.psp.toUpperCase()&&e.jsxs("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-slate-200 text-slate-700",children:[s.commission_rate,"%"]})]})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:d(s.net||0,s.psp)})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:d(s.tahs_tutari||0,s.psp)})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:d(s.kasa_top||0,s.psp)})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsx("span",{className:"font-semibold text-sm "+((s.devir||0)>=0?"text-slate-900":"text-red-700"),children:d(s.devir||0,s.psp)})})]}),de.has(s.psp)&&e.jsx("tr",{className:"bg-gray-50",children:e.jsx("td",{colSpan:10,className:"py-6 px-6",children:e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-xl border border-slate-200/60 shadow-lg shadow-slate-200/20",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50 rounded-t-xl",children:e.jsxs("h4",{className:"text-sm font-bold text-slate-800 flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-800 rounded-lg flex items-center justify-center",children:e.jsx(G,{className:"h-4 w-4 text-white"})}),"Daily Transaction Breakdown - ",s.psp,e.jsxs("span",{className:"ml-auto text-xs font-medium text-slate-600 bg-slate-200/60 px-3 py-1 rounded-full",children:[Qs(s,le,ce).length," days"]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gradient-to-r from-slate-50 to-slate-100/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"YATIRIM"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"Ã‡EKME"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"TOPLAM"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{children:"KOMÄ°SYON"}),e.jsx("span",{className:"text-xs font-normal text-slate-500 normal-case",children:"Deposits Only"})]})}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"NET"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"TAHS TUTARI"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"KASA TOP"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"DEVÄ°R"}),e.jsx("th",{className:"text-center py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"Tx Count"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100/60",children:Qs(s,le,ce).map((t,a)=>e.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors duration-150 "+(t.transaction_count>0?a%2==0?"bg-white/50":"bg-slate-50/30":t.isWeekend?"bg-orange-50/30":"bg-gray-50/20"),children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full "+(t.transaction_count>0?"bg-blue-400":t.isWeekend?"bg-orange-300":"bg-gray-300")}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-medium text-slate-800 text-sm",children:[t.day," ",t.dayName]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(t.date).toLocaleDateString("tr-TR")})]})]})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsx("span",{className:"font-mono text-sm font-semibold "+(t.transaction_count>0?"text-emerald-700":"text-gray-400"),children:d(t.yatimim||0,s.psp)})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsx("span",{className:"font-mono text-sm font-semibold "+(t.transaction_count>0?"text-red-700":"text-gray-400"),children:d(t.cekme||0,s.psp)})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsx("span",{className:"font-mono text-sm font-bold "+(t.transaction_count>0?"text-slate-800":"text-gray-400"),children:d(t.toplam||0,s.psp)})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-mono text-sm font-semibold ${t.transaction_count>0?Hs(s.commission_rate||0):"text-gray-400"}`,children:d(t.komisyon||0,s.psp)}),"TETHER"===s.psp.toUpperCase()?e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:"Internal KASA"}):void 0!==s.commission_rate?e.jsxs("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium ${Ks(s.commission_rate)}`,children:[s.commission_rate,"%"]}):null]}),e.jsx("span",{className:"text-xs text-slate-500 mt-1",children:"Deposits Only"})]})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsx("span",{className:"font-mono text-sm font-semibold "+(t.transaction_count>0?"text-blue-700":"text-gray-400"),children:d(t.net||0,s.psp)})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("span",{className:"font-mono text-sm font-semibold "+(t.transaction_count>0?"text-purple-700":"text-gray-400"),children:d(t.tahs_tutari||0,s.psp)}),e.jsx("button",{onClick:()=>((e,s,t)=>{Je({psp:e,date:s,currentAmount:t}),is(t.toString()),Ye(!0)})(s.psp,t.date,t.tahs_tutari||0),className:"p-1.5 hover:bg-purple-100 rounded-md transition-colors duration-200 group opacity-70 hover:opacity-100",title:"Edit allocation amount",children:e.jsx(K,{className:"h-4 w-4 text-purple-600 group-hover:text-purple-700"})})]})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("span",{className:"font-mono text-sm font-semibold "+(t.transaction_count>0?"text-indigo-700":"text-gray-400"),children:d(t.kasa_top||0,s.psp)}),e.jsx("button",{onClick:()=>((e,s,t)=>{Os({psp:e,date:s,currentAmount:t}),qs(t.toString()),Ws(""),zs(!0)})(s.psp,t.date,t.kasa_top||0),className:"p-1.5 hover:bg-indigo-100 rounded-md transition-colors duration-200 group opacity-70 hover:opacity-100",title:"Edit KASA TOP amount",children:e.jsx(K,{className:"h-4 w-4 text-indigo-600 group-hover:text-indigo-700"})})]})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("span",{className:"font-mono text-sm font-semibold "+(t.transaction_count>0?(t.devir||0)>=0?"text-emerald-700":"text-red-700":"text-gray-400"),children:d(t.devir||0,s.psp)}),e.jsx("button",{onClick:()=>((e,s,t)=>{Cs({psp:e,date:s,currentAmount:t}),Es(t.toString()),Us(""),ks(!0)})(s.psp,t.date,t.devir||0),className:"p-1.5 hover:bg-emerald-100 rounded-md transition-colors duration-200 group opacity-70 hover:opacity-100",title:"Edit Devir amount",children:e.jsx(K,{className:"h-4 w-4 text-emerald-600 group-hover:text-emerald-700"})})]})}),e.jsx("td",{className:"py-3 px-4 text-center",children:e.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 rounded-full text-xs font-medium "+(t.transaction_count>0?"bg-slate-100 text-slate-700":"bg-gray-50 text-gray-400"),children:t.transaction_count||0})})]},t.date))}),e.jsx("tfoot",{className:"bg-gradient-to-r from-slate-100 to-slate-200/60 border-t border-slate-200",children:e.jsxs("tr",{className:"font-bold",children:[e.jsx("td",{className:"py-4 px-4 text-slate-800",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-slate-400 rounded-full"}),"Daily Totals"]})}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-emerald-800 text-sm",children:d(Qs(s,le,ce).reduce((e,s)=>e+(s.yatimim||0),0),s.psp)}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-red-800 text-sm",children:d(Qs(s,le,ce).reduce((e,s)=>e+(s.cekme||0),0),s.psp)}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-slate-800 text-sm",children:d(Qs(s,le,ce).reduce((e,s)=>e+(s.toplam||0),0),s.psp)}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-amber-800 text-sm",children:d(Qs(s,le,ce).reduce((e,s)=>e+(s.komisyon||0),0),s.psp)}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-blue-800 text-sm",children:d(Qs(s,le,ce).reduce((e,s)=>e+(s.net||0),0),s.psp)}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-purple-800 text-sm",children:d(Qs(s,le,ce).reduce((e,s)=>e+(s.tahs_tutari||0),0),s.psp)}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-indigo-800 text-sm",children:d((()=>{const e=Qs(s,le,ce),t=e[e.length-1];return t?.kasa_top||0})(),s.psp)}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-slate-800 text-sm",children:d((()=>{const e=Qs(s,le,ce),t=e[e.length-1];return t?.devir||0})(),s.psp)}),e.jsx("td",{className:"py-4 px-4 text-center",children:e.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 bg-slate-300 rounded-full text-xs font-bold text-slate-800",children:Qs(s,le,ce).reduce((e,s)=>e+(s.transaction_count||0),0)})})]})})]})})]})})},`${s.psp}-daily`)]},s.psp))})]}),H.length>he&&e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 bg-slate-50 border-t border-slate-200",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:["Showing ",(xe-1)*he+1," to ",Math.min(xe*he,H.length)," of ",H.length," PSPs"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(es,{onClick:()=>ge(Math.max(1,xe-1)),disabled:1===xe,variant:"outline",size:"sm",className:"flex items-center gap-1",children:[e.jsx(se,{className:"h-4 w-4"}),"Previous"]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.ceil(H.length/he)},(e,s)=>s+1).map(s=>e.jsx(es,{onClick:()=>ge(s),variant:xe===s?"default":"outline",size:"sm",className:"w-10",children:s},s))}),e.jsxs(es,{onClick:()=>ge(Math.min(Math.ceil(H.length/he),xe+1)),disabled:xe===Math.ceil(H.length/he),variant:"outline",size:"sm",className:"flex items-center gap-1",children:["Next",e.jsx(ee,{className:"h-4 w-4"})]})]})]}),e.jsx("table",{className:"w-full",children:e.jsx("tfoot",{className:"bg-gradient-to-r from-slate-100 via-slate-200/80 to-slate-100 border-t-2 border-slate-300",children:e.jsxs("tr",{className:"font-bold",children:[e.jsx("td",{className:"py-6 px-6"}),e.jsx("td",{className:"py-6 px-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-slate-600 to-slate-700 rounded-lg flex items-center justify-center shadow-lg",children:e.jsx(U,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-900 text-sm font-bold",children:"MONTHLY TOTALS"}),e.jsxs("div",{className:"text-xs text-slate-600",children:[H.length," PSPs"]})]})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold text-emerald-800",children:Ce(H.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.yatimim||0),0))}),e.jsx("span",{className:"text-xs text-emerald-700/70 font-medium",children:l("ledger.total_deposits")})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold text-red-800",children:Ce(H.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.cekme||0),0))}),e.jsx("span",{className:"text-xs text-red-700/70 font-medium",children:l("ledger.total_withdrawals")})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold text-slate-900",children:Ce(H.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.toplam||0),0))}),e.jsx("span",{className:"text-xs text-slate-700/70 font-medium",children:"Net Total"})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold text-amber-800",children:Ce(H.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.komisyon||0),0))}),e.jsx("span",{className:"text-xs text-amber-700/70 font-medium",children:l("ledger.total_commission")})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold text-blue-800",children:Ce(H.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.net||0),0))}),e.jsx("span",{className:"text-xs text-blue-700/70 font-medium",children:"Net Amount"})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold text-purple-800",children:Ce(H.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.tahs_tutari||0),0))}),e.jsx("span",{className:"text-xs text-purple-700/70 font-medium",children:l("ledger.total_allocations")})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold text-indigo-800",children:Ce(H.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.kasa_top||0),0))}),e.jsx("span",{className:"text-xs text-indigo-700/70 font-medium",children:l("ledger.total_revenue")})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold "+(H.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.kasa_top||0),0)-H.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.tahs_tutari||0),0)>=0?"text-emerald-800":"text-red-800"),children:Ce(H.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.kasa_top||0),0)-H.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.tahs_tutari||0),0))}),e.jsx("span",{className:"text-xs font-medium "+(H.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.kasa_top||0),0)-H.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.tahs_tutari||0),0)>=0?"text-emerald-700/70":"text-red-700/70"),children:"Total Rollover"})]})})]})})})]})]}),e.jsx("div",{className:"mt-6",children:e.jsxs(_e,{variant:"elevated",className:"mb-6",children:[e.jsxs(Qe,{children:[e.jsxs(Ze,{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-5 w-5 text-gray-600"}),"Audit History"]}),e.jsx(Xe,{children:"Complete audit trail of all manual overrides (Allocation, Devir, KASA TOP) with filtering and export capabilities"})]}),e.jsxs(Ge,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx(We,{type:"date",value:Js.startDate,onChange:e=>nt("startDate",e.target.value),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx(We,{type:"date",value:Js.endDate,onChange:e=>nt("endDate",e.target.value),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:l("ledger.psp_filter")}),e.jsx(We,{type:"text",placeholder:l("ledger.filter_by_psp"),value:Js.psp,onChange:e=>nt("psp",e.target.value),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type Filter"}),e.jsxs("select",{value:Js.type,onChange:e=>nt("type",e.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"allocation",children:"Allocation"}),e.jsx("option",{value:"devir",children:"Devir"}),e.jsx("option",{value:"kasa_top",children:"KASA TOP"})]})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsxs(es,{onClick:()=>it("csv"),variant:"outline",className:"flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4"}),"CSV"]}),e.jsxs(es,{onClick:()=>it("json"),variant:"outline",className:"flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4"}),"JSON"]})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:Ie?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(r,{className:"h-6 w-6 animate-spin text-gray-400"}),e.jsx("span",{className:"ml-2 text-gray-500",children:"Loading history data..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:l("ledger.psp_name")}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Created At"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Updated At"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:0===ze.length?e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:[e.jsx(h,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"No history found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your filters or check back later"})]})}):ze.map((s,t)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+("Allocation"===s.type?"bg-purple-100 text-purple-800":"Devir"===s.type?"bg-emerald-100 text-emerald-800":"bg-indigo-100 text-indigo-800"),children:s.type})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:new Date(s.date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4 text-gray-400"}),s.psp_name]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-semibold text-gray-900",children:Ce(s.amount,"â‚º")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(s.created_at).toLocaleString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(s.updated_at).toLocaleString()})]},`${s.id}-${t}`))})]})}),Be&&Be.pages>1&&e.jsx("div",{className:"bg-gray-50 px-6 py-3 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",(Be.page-1)*Be.per_page+1," to"," ",Math.min(Be.page*Be.per_page,Be.total)," of"," ",Be.total," entries"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(es,{variant:"outline",size:"sm",onClick:()=>lt(Be.page-1),disabled:!Be.has_prev,children:"Previous"}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",Be.page," of ",Be.pages]}),e.jsx(es,{variant:"outline",size:"sm",onClick:()=>lt(Be.page+1),disabled:!Be.has_next,children:"Next"})]})]})})]})})]})]})})]}),e.jsxs(ns,{value:"analytics",className:"mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(U,{className:"h-6 w-6 text-gray-600"}),"Analytics Dashboard"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive insights and performance metrics"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(es,{onClick:()=>{Zs(!0),st(!0)},variant:"outline",size:"default",className:"flex items-center gap-2 h-10 px-4 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 transition-all shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",disabled:fe,children:[e.jsx(r,{className:"h-4 w-4 "+(fe?"animate-spin":"")}),fe?"Refreshing...":"Refresh Data"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(Fs,{title:l("ledger.total_volume"),value:Ce(m.reduce((e,s)=>e+s.total_amount,0),"â‚º"),subtitle:l("ledger.all_psps_combined"),icon:C,color:"indigo",animated:!0,animationDuration:500}),e.jsx(Fs,{title:l("ledger.active_psps"),value:m.length.toString(),subtitle:l("ledger.payment_providers"),icon:W,color:"green",animated:!0,animationDuration:500}),e.jsx(Fs,{title:l("ledger.avg_commission_rate"),value:`${(m.reduce((e,s)=>e+s.commission_rate,0)/m.length||0).toFixed(1)}%`,subtitle:l("ledger.weighted_average"),icon:V,color:"orange",animated:!0,animationDuration:500}),e.jsx(Fs,{title:l("ledger.total_transactions"),value:gt(m.reduce((e,s)=>e+s.transaction_count,0)),subtitle:l("ledger.all_time"),icon:z,color:"purple",animated:!0,animationDuration:500})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(_e,{variant:"elevated",className:"p-6",children:[e.jsxs(Qe,{className:"pb-4",children:[e.jsxs(Ze,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5 text-gray-600"}),l("ledger.psp_performance_comparison")]}),e.jsx(Xe,{children:l("ledger.net_amounts_transaction_counts")})]}),e.jsx(Ge,{children:e.jsx("div",{className:"h-80",children:e.jsx(os,{width:"100%",height:"100%",children:e.jsxs(ds,{data:m.map(e=>({name:e.psp,net:e.total_net,transactions:e.transaction_count,commission:e.total_commission})),children:[e.jsx(ms,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(xs,{dataKey:"name",tick:{fontSize:12},angle:-45,textAnchor:"end",height:80}),e.jsx(gs,{tick:{fontSize:12}}),e.jsx(hs,{formatter:(e,s)=>["net"===s||"commission"===s?Ce(Number(e),"â‚º"):e,"net"===s?"Net Amount":"transactions"===s?"Transactions":"Commission"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(us,{dataKey:"net",fill:"#3b82f6",radius:[4,4,0,0]})]})})})})]}),e.jsxs(_e,{variant:"elevated",className:"p-6",children:[e.jsxs(Qe,{className:"pb-4",children:[e.jsxs(Ze,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-5 w-5 text-gray-600"}),l("ledger.psp_market_share")]}),e.jsx(Xe,{children:l("ledger.distribution_total_volume")})]}),e.jsx(Ge,{children:e.jsx("div",{className:"h-80",children:e.jsx(os,{width:"100%",height:"100%",children:e.jsxs(ps,{children:[e.jsx(js,{data:m.map(e=>({name:e.psp,value:e.total_amount,net:e.total_net})),cx:"50%",cy:"50%",labelLine:!1,label:({name:e,percent:s})=>`${e} ${(100*s).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:m.map((s,t)=>e.jsx(ys,{fill:`hsl(${60*t}, 70%, 50%)`},`cell-${t}`))}),e.jsx(hs,{formatter:e=>[Ce(Number(e),"â‚º"),"Total Amount"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}})]})})})})]})]}),e.jsxs(_e,{variant:"elevated",className:"p-6",children:[e.jsxs(Qe,{className:"pb-4",children:[e.jsxs(Ze,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-5 w-5 text-gray-600"}),"Daily Transaction Trends"]}),e.jsx(Xe,{children:"Net amounts and transaction counts over time"})]}),e.jsx(Ge,{children:e.jsx("div",{className:"h-80",children:e.jsx(os,{width:"100%",height:"100%",children:e.jsxs(fs,{data:je.map(e=>({date:new Date(e.date).toLocaleDateString("en-US",{month:"short",day:"numeric"}),net:e.totals.net,transactions:e.totals.total_psp,commission:e.totals.commission})),children:[e.jsx(ms,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(xs,{dataKey:"date",tick:{fontSize:12}}),e.jsx(gs,{tick:{fontSize:12}}),e.jsx(hs,{formatter:(e,s)=>["net"===s||"commission"===s?Ce(Number(e),"â‚º"):e,"net"===s?"Net Amount":"transactions"===s?"Transactions":"Commission"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(bs,{type:"monotone",dataKey:"net",stackId:"1",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.6}),e.jsx(bs,{type:"monotone",dataKey:"commission",stackId:"2",stroke:"#f59e0b",fill:"#f59e0b",fillOpacity:.6})]})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(_e,{variant:"elevated",className:"p-6",children:[e.jsxs(Qe,{className:"pb-4",children:[e.jsxs(Ze,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5 text-gray-600"}),l("ledger.allocation_vs_net")]}),e.jsx(Xe,{children:l("ledger.allocation_vs_net_desc")})]}),e.jsx(Ge,{children:e.jsx("div",{className:"h-80",children:e.jsx(os,{width:"100%",height:"100%",children:e.jsxs(vs,{data:m.map(e=>({net:e.total_net,allocation:e.total_allocations,psp:e.psp,rollover:e.total_net-e.total_allocations})),children:[e.jsx(ms,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(xs,{type:"number",dataKey:"net",name:"Net Amount",tick:{fontSize:12},tickFormatter:e=>Ce(e,"â‚º")}),e.jsx(gs,{type:"number",dataKey:"allocation",name:"Allocation",tick:{fontSize:12},tickFormatter:e=>Ce(e,"â‚º")}),e.jsx(hs,{formatter:(e,s)=>[Ce(Number(e),"â‚º"),"net"===s?"Net Amount":"allocation"===s?"Allocation":"Rollover"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(Ns,{dataKey:"allocation",fill:"#3b82f6",r:6})]})})})})]}),e.jsxs(_e,{variant:"elevated",className:"p-6",children:[e.jsxs(Qe,{className:"pb-4",children:[e.jsxs(Ze,{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5 text-gray-600"}),l("ledger.rollover_analysis")]}),e.jsx(Xe,{children:l("ledger.rollover_risk_levels")})]}),e.jsx(Ge,{children:e.jsx("div",{className:"h-80",children:e.jsx(os,{width:"100%",height:"100%",children:e.jsxs(ds,{data:m.map(e=>{const s=e.total_net-e.total_allocations,t=e.total_net>0?s/e.total_net*100:0;return{name:e.psp,rollover:s,percentage:t,color:s>0?"#ef4444":"#10b981"}}),children:[e.jsx(ms,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(xs,{dataKey:"name",tick:{fontSize:12},angle:-45,textAnchor:"end",height:80}),e.jsx(gs,{tick:{fontSize:12}}),e.jsx(hs,{formatter:(e,s)=>["rollover"===s?Ce(Number(e),"â‚º"):`${Number(e).toFixed(1)}%`,"rollover"===s?"Rollover Amount":"Rollover %"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(us,{dataKey:"rollover",fill:"#3b82f6",radius:[4,4,0,0]})]})})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4 lg:gap-6",children:[e.jsxs(_e,{variant:"elevated",className:"p-6",children:[e.jsxs(Qe,{className:"pb-4",children:[e.jsxs(Ze,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5 text-gray-600"}),l("ledger.commission_rates_comparison")]}),e.jsx(Xe,{children:l("ledger.commission_rates_all_psps")})]}),e.jsx(Ge,{children:e.jsx("div",{className:"h-64 sm:h-72 lg:h-80",children:e.jsx(os,{width:"100%",height:"100%",children:e.jsxs(ds,{data:m.map(e=>({psp:e.psp,rate:e.commission_rate,deposits:e.total_deposits,commission:e.total_commission})),children:[e.jsx(ms,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(xs,{dataKey:"psp",tick:{fontSize:10},angle:-45,textAnchor:"end",height:60,interval:0}),e.jsx(gs,{tick:{fontSize:10},tickFormatter:e=>`${e}%`,width:40}),e.jsx(hs,{formatter:(e,s)=>["rate"===s?`${e}%`:Ce(Number(e),"â‚º"),"rate"===s?"Commission Rate":"deposits"===s?"Total Deposits":"Commission Amount"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(us,{dataKey:"rate",fill:"#f59e0b",radius:[4,4,0,0],name:"Commission Rate"})]})})})})]}),e.jsxs(_e,{variant:"elevated",className:"p-6",children:[e.jsxs(Qe,{className:"pb-4",children:[e.jsxs(Ze,{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5 text-gray-600"}),l("ledger.commission_vs_deposits")]}),e.jsx(Xe,{children:l("ledger.commission_vs_deposits_desc")})]}),e.jsx(Ge,{children:e.jsx("div",{className:"h-64 sm:h-72 lg:h-80",children:e.jsx(os,{width:"100%",height:"100%",children:e.jsxs(vs,{data:m.map(e=>({deposits:e.total_deposits,commission:e.total_commission,psp:e.psp,rate:e.commission_rate})),children:[e.jsx(ms,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(xs,{type:"number",dataKey:"deposits",name:"Total Deposits",tick:{fontSize:10},tickFormatter:e=>Ce(e,"â‚º"),width:60}),e.jsx(gs,{type:"number",dataKey:"commission",name:"Commission",tick:{fontSize:10},tickFormatter:e=>Ce(e,"â‚º"),width:60}),e.jsx(hs,{formatter:(e,s)=>["deposits"===s||"commission"===s?Ce(Number(e),"â‚º"):e,"deposits"===s?"Total Deposits":"commission"===s?"Commission Amount":"rate"===s?"Commission Rate":"PSP"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(Ns,{dataKey:"commission",fill:"#f59e0b",r:6})]})})})})]})]}),e.jsxs(_e,{variant:"elevated",className:"p-6",children:[e.jsxs(Qe,{className:"pb-4",children:[e.jsxs(Ze,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5 text-gray-600"}),"Commission Rate Comparison"]}),e.jsx(Xe,{children:"Detailed comparison of commission rates and their impact"})]}),e.jsx(Ge,{children:e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs("table",{className:"w-full min-w-[600px]",children:[e.jsx("thead",{className:"bg-gradient-to-r from-slate-50 to-slate-100/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:l("ledger.psp")}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:l("ledger.commission_rate")}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:l("ledger.total_deposits")}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:l("ledger.commission_amount")}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"Efficiency"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100/60",children:m.sort((e,s)=>s.commission_rate-e.commission_rate).map((s,t)=>{const a=s.total_deposits>0?s.total_commission/s.total_deposits*100:0;return e.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors duration-150 "+(t%2==0?"bg-white/50":"bg-slate-50/30"),children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${Ks(s.commission_rate).split(" ")[0]}`}),e.jsx("span",{className:"font-medium text-slate-800 text-sm",children:s.psp})]})}),e.jsx("td",{className:"py-3 px-4 text-right",children:"TETHER"===s.psp.toUpperCase()?e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Internal KASA"}):e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${Ks(s.commission_rate)}`,children:[s.commission_rate,"%"]})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsx("span",{className:"font-mono text-sm font-semibold text-slate-800",children:Ce(s.total_deposits)})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsx("span",{className:`font-mono text-sm font-semibold ${Hs(s.commission_rate)}`,children:Ce(s.total_commission||0)})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsxs("span",{className:"text-sm font-medium text-slate-600",children:[a.toFixed(2),"%"]})})]},s.psp)})})]})})})]}),e.jsxs(_e,{variant:"elevated",className:"p-6",children:[e.jsxs(Qe,{className:"pb-4",children:[e.jsxs(Ze,{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-5 w-5 text-gray-600"}),"Performance Insights"]}),e.jsx(Xe,{children:"Key findings and recommendations based on current data"})]}),e.jsx(Ge,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-600 rounded-lg flex items-center justify-center",children:e.jsx(E,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Top Performer"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Highest net amount"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:m.length>0?m.reduce((e,s)=>s.total_net>e.total_net?s:e).psp:"N/A"}),e.jsx("p",{className:"text-sm text-gray-700",children:m.length>0?Ce(m.reduce((e,s)=>s.total_net>e.total_net?s:e).total_net,"â‚º"):"â‚º0"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-600 rounded-lg flex items-center justify-center",children:e.jsx(V,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Most Efficient"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Best allocation ratio"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:m.length>0?m.reduce((e,s)=>(s.total_net>0?s.total_allocations/s.total_net:0)>(e.total_net>0?e.total_allocations/e.total_net:0)?s:e).psp:"N/A"}),e.jsx("p",{className:"text-sm text-gray-700",children:m.length>0?`${(m.reduce((e,s)=>(s.total_net>0?s.total_allocations/s.total_net:0)>(e.total_net>0?e.total_allocations/e.total_net:0)?s:e).total_net>0?m.reduce((e,s)=>(s.total_net>0?s.total_allocations/s.total_net:0)>(e.total_net>0?e.total_allocations/e.total_net:0)?s:e).total_allocations/m.reduce((e,s)=>(s.total_net>0?s.total_allocations/s.total_net:0)>(e.total_net>0?e.total_allocations/e.total_net:0)?s:e).total_net*100:0).toFixed(1)}%`:"0%"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-600 rounded-lg flex items-center justify-center",children:e.jsx(t,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Risk Alert"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Highest rollover"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:m.length>0?m.reduce((e,s)=>s.total_allocations-s.total_net>e.total_allocations-e.total_net?s:e).psp:"N/A"}),e.jsx("p",{className:"text-sm text-gray-700",children:m.length>0?Ce(m.reduce((e,s)=>s.total_allocations-s.total_net>e.total_allocations-e.total_net?s:e).total_allocations-m.reduce((e,s)=>s.total_allocations-s.total_net>e.total_allocations-e.total_net?s:e).total_net,"â‚º"):"â‚º0"})]})]})]})})]})]})]})}),P&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-300",onClick:e=>{e.target===e.currentTarget&&xt()},onKeyDown:e=>{"Escape"===e.key&&xt()},tabIndex:-1,children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-5 border-b border-gray-100",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-xl flex items-center justify-center",children:e.jsx(W,{className:"h-5 w-5 text-blue-600"})}),"psp"===ue?.type?`${l("ledger.psp_details")}: ${ue.psp}`:`${l("ledger.psp_details")}: ${ue?.date} - ${ue?.psp}`]}),e.jsx("button",{onClick:xt,className:"h-10 w-10 p-0 hover:bg-gray-100 rounded-xl transition-colors flex items-center justify-center",children:e.jsx(D,{className:"h-5 w-5 text-gray-500"})})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:ue?.error?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(R,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-red-600",children:ue.error})]}):ue?.transactions?.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:l("ledger.total_transactions")}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:ue.transactions.length})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:l("ledger.total_amount")}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ce(ue.transactions.reduce((e,s)=>e+(s.amount||0),0),"â‚º")})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:l("ledger.total_commission")}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ce(ue.transactions.reduce((e,s)=>e+(s.commission||0),0),"â‚º")})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Commission"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Net Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ue.transactions.map((s,t)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(s.date||s.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Ce(s.amount||0,"â‚º")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Ce(s.commission||0,"â‚º")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Ce(s.net_amount||0,"â‚º")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full "+("DEP"===s.category?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:"DEP"===s.category?"Deposit":"Withdrawal"})})]},s.id||`${s.date||s.created_at}-${s.amount}-${t}`))})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No transactions found"})]})})]})}),Ee&&Ae&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-300",onClick:e=>{e.target===e.currentTarget&&at()},onKeyDown:e=>{"Escape"===e.key&&at()},tabIndex:-1,children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-5xl w-full max-h-[92vh] overflow-hidden animate-in zoom-in-95 duration-300",children:[e.jsx("div",{className:"px-10 py-8 border-b border-gray-100 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center shadow-sm",children:e.jsx(W,{className:"h-8 w-8 text-gray-700"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 tracking-tight",children:l("ledger.bulk_allocation")}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(G,{className:"h-4 w-4 text-gray-500"}),e.jsx("p",{className:"text-base text-gray-600 font-medium",children:je.find(e=>e.date===Ae)?.date_str})]})]})]}),e.jsx("button",{onClick:at,className:"w-12 h-12 rounded-xl bg-gray-100/80 hover:bg-gray-200/80 flex items-center justify-center transition-all duration-200 hover:scale-105",children:e.jsx(D,{className:"h-6 w-6 text-gray-600"})})]})}),e.jsx("div",{className:"px-10 py-8 max-h-[60vh] overflow-y-auto",children:e.jsx("div",{className:"space-y-4",children:m.map((s,t)=>{const a=`${Ae}-${s.psp}`,r=$e[a]||0,n=je.find(e=>e.date===Ae),i=n?.psps[s.psp],c=i?.net||0,o=i?.allocation||0,d=o-c,m=s.total_allocations-s.total_net,x=!!i;return e.jsx("div",{className:"group bg-white shadow-sm rounded-2xl p-8 hover:shadow-lg hover:shadow-gray-100/20 transition-all duration-300 hover:-translate-y-0.5",style:{animationDelay:50*t+"ms"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl flex items-center justify-center shadow-sm transition-all duration-200 "+(x?"bg-gray-100 group-hover:bg-gray-200":"bg-gray-100"),children:e.jsx(W,{className:"h-7 w-7 transition-colors duration-200 "+(x?"text-gray-700":"text-gray-500")})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("h4",{className:"text-lg font-bold text-gray-900",children:s.psp}),!x&&e.jsx("span",{className:"px-3 py-1.5 text-xs font-semibold bg-gray-100 text-gray-700 rounded-full border border-gray-200",children:l("ledger.no_activity")}),x&&e.jsx("span",{className:"px-3 py-1.5 text-xs font-semibold bg-gray-100 text-gray-700 rounded-full border border-gray-200",children:l("ledger.active")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-warning-50/80 rounded-xl p-4 border border-warning-200",children:[e.jsx("div",{className:"text-xs font-medium text-warning-600 uppercase tracking-wide mb-1",children:l("ledger.allocations")}),e.jsx("div",{className:"text-lg font-bold text-warning-700",children:Ce(x?o:s.total_allocations,"â‚º")})]}),e.jsxs("div",{className:"rounded-xl p-4 border "+((x?d:m)>0?"bg-destructive-50/80 border-destructive-200":"bg-success-50/80 border-success-200"),children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:l("ledger.rollover")}),e.jsx("div",{className:"text-lg font-bold "+((x?d:m)>0?"text-destructive-600":"text-success-600"),children:Ce(x?d:m,"â‚º")})]})]})]})]})}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"text-right",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:l("ledger.new_allocation")}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:r,onChange:e=>((e,s)=>{if(!Ae)return;const t=`${Ae}-${e}`;Fe(e=>({...e,[t]:s}))})(s.psp,parseFloat(e.target.value)||0),className:"w-40 px-5 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-right font-bold text-lg transition-all duration-200 bg-white shadow-sm",placeholder:"0.00",step:"0.01"}),e.jsx("div",{className:"absolute inset-y-0 right-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-sm font-bold text-gray-500",children:"â‚º"})})]})})]})})]})},s.psp)})})}),e.jsx("div",{className:"px-10 py-8 border-t border-gray-100 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-xl flex items-center justify-center",children:e.jsx(W,{className:"h-5 w-5 text-gray-700"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold text-gray-700",children:[Object.keys($e).length," ",l("ledger.psps_selected")]}),e.jsx("div",{className:"text-xs text-gray-500",children:l("ledger.ready_for_allocation")})]})]}),e.jsx("div",{className:"h-8 w-px bg-gray-200"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(C,{className:"h-5 w-5 text-green-700"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700",children:l("ledger.total_allocation")}),e.jsx("div",{className:"text-lg font-bold text-green-600",children:Ce(Object.values($e).reduce((e,s)=>e+s,0),"â‚º")})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:at,className:"px-8 py-3 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-xl transition-all duration-200 font-semibold shadow-sm hover:shadow",children:l("common.cancel")}),e.jsx("button",{onClick:async()=>{if(Ae){Le(!0);try{const e=Object.entries($e).map(async([e,s])=>{const t=e.lastIndexOf("-"),a=e.substring(0,t),r=e.substring(t+1);return ct(a,r,s)});await Promise.all(e),Ne(e=>({...e,...$e})),Re(!1),Te(null),Fe({}),await Promise.all([st(!0),Zs(!0)])}catch(e){}finally{Le(!1)}}},disabled:Ue,className:"px-8 py-3 bg-gray-700 text-white rounded-xl hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center gap-3 font-semibold shadow-lg hover:shadow-xl hover:-translate-y-0.5",children:Ue?e.jsxs(e.Fragment,{children:[e.jsx(r,{className:"h-5 w-5 animate-spin"}),l("ledger.processing")]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"h-5 w-5"}),l("ledger.apply_allocations")]})})]})]})})]})}),Ke&&Ve&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-md w-full animate-in zoom-in-95 duration-300",children:[e.jsx("div",{className:"px-8 py-6 border-b border-gray-100 bg-gray-50 rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-2xl flex items-center justify-center shadow-sm",children:e.jsx(K,{className:"h-6 w-6 text-gray-700"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 tracking-tight",children:l("ledger.edit_allocation")}),e.jsxs("p",{className:"text-sm text-gray-600 font-medium",children:[Ve.psp," - ",new Date(Ve.date).toLocaleDateString("tr-TR")]})]})]}),e.jsx("button",{onClick:ot,className:"w-10 h-10 rounded-xl bg-gray-100/80 hover:bg-gray-200/80 flex items-center justify-center transition-all duration-200 hover:scale-105",children:e.jsx(D,{className:"h-5 w-5 text-gray-600"})})]})}),e.jsx("div",{className:"px-8 py-6",children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:l("ledger.allocation_amount_try")}),e.jsx("input",{type:"number",value:ls,onChange:e=>is(e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all duration-200 text-lg font-mono",placeholder:l("ledger.enter_allocation_amount"),min:"0",step:"0.01",autoFocus:!0,disabled:cs}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[l("ledger.current_amount"),": ",Ce(Ve.currentAmount,"â‚º")]})]})})}),e.jsx("div",{className:"px-8 py-6 border-t border-gray-100 bg-gray-50/50 rounded-b-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:ot,className:"px-6 py-3 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-all duration-200 font-semibold shadow-sm hover:shadow",children:l("common.cancel")}),e.jsx("button",{onClick:async()=>{if(!Ve)return;const e=parseFloat(ls);if(isNaN(e)||e<0)alert(l("ledger.enter_valid_amount"));else{ws(!0);try{await ct(Ve.date,Ve.psp,e),await Promise.all([et(le,ce,!0),st(!0),rt(Js.page)]),ot(),alert(l("ledger.allocation_updated"))}catch(s){const e=s?.message||l("ledger.failed_update_allocation");alert(`${l("ledger.failed_update_allocation")}\n\nDetay: ${e}`)}finally{ws(!1)}}},disabled:cs,className:"px-6 py-3 bg-gray-700 text-white rounded hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center gap-3 font-semibold shadow-lg hover:shadow-xl hover:-translate-y-0.5",children:cs?e.jsxs(e.Fragment,{children:[e.jsx(r,{className:"h-4 w-4 animate-spin"}),l("ledger.updating")]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"h-4 w-4"}),l("ledger.update_allocation")]})})]})})]})}),_s&&Ss&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-md w-full animate-in zoom-in-95 duration-300",children:[e.jsx("div",{className:"px-8 py-6 border-b border-gray-100 bg-gray-50 rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-2xl flex items-center justify-center shadow-sm",children:e.jsx(K,{className:"h-6 w-6 text-gray-700"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 tracking-tight",children:l("ledger.edit_devir_amount")}),e.jsxs("p",{className:"text-sm text-gray-600 font-medium",children:[Ss.psp," - ",new Date(Ss.date).toLocaleDateString("tr-TR")]})]})]}),e.jsx("button",{onClick:dt,className:"w-10 h-10 rounded-xl bg-gray-100/80 hover:bg-gray-200/80 flex items-center justify-center transition-all duration-200 hover:scale-105",children:e.jsx(D,{className:"h-5 w-5 text-gray-600"})})]})}),e.jsx("div",{className:"px-8 py-6",children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:l("ledger.devir_amount_try")}),e.jsx("input",{type:"number",value:Ds,onChange:e=>Es(e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-all duration-200 text-lg font-mono",placeholder:l("ledger.enter_devir_amount"),step:"0.01",autoFocus:!0}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[l("ledger.current_amount"),": ",Ce(Ss.currentAmount,"â‚º")]})]})})}),e.jsx("div",{className:"px-8 py-6 border-t border-gray-100 bg-gray-50/50 rounded-b-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:dt,className:"px-6 py-3 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-all duration-200 font-semibold shadow-sm hover:shadow",children:l("common.cancel")}),e.jsx("button",{onClick:async()=>{if(!Ss)return;const e=parseFloat(Ds);if(isNaN(e))alert(l("ledger.enter_valid_amount"));else{Ts(!0);try{const t={date:Ss.date,psp:Ss.psp,devir_amount:e},a=await Se.post("/analytics/update-devir",t);if(a.ok)try{await Se.parseResponse(a),await Promise.all([et(le,ce,!0),st(!0),rt(Js.page)]),await new Promise(e=>setTimeout(e,500)),dt(),alert(l("ledger.devir_updated"))}catch(s){await Promise.all([et(le,ce,!0),st(!0),rt(Js.page)]),dt(),alert(l("ledger.devir_updated"))}else try{const e=await Se.parseResponse(a),s=e?.error||e?.message||`HTTP ${a.status}`;alert(`${l("ledger.failed_update_devir")}: ${s}`)}catch(s){alert(`${l("ledger.failed_update_devir")}: HTTP ${a.status}`)}}catch(t){const e=t?.message||t?.toString()||"Network error";alert(`${l("ledger.failed_save_devir")}\n\nDetay: ${e}`)}finally{Ts(!1)}}},disabled:As,className:"px-6 py-3 bg-gray-700 text-white rounded hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center gap-3 font-semibold shadow-lg hover:shadow-xl hover:-translate-y-0.5",children:As?e.jsxs(e.Fragment,{children:[e.jsx(r,{className:"h-4 w-4 animate-spin"}),l("ledger.updating")]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"h-4 w-4"}),l("ledger.update_devir")]})})]})})]})}),Ls&&Ps&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-md w-full animate-in zoom-in-95 duration-300",children:[e.jsx("div",{className:"px-8 py-6 border-b border-gray-100 bg-gray-50 rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-2xl flex items-center justify-center shadow-sm",children:e.jsx(K,{className:"h-6 w-6 text-gray-700"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 tracking-tight",children:l("ledger.edit_kasa_top_amount")}),e.jsxs("p",{className:"text-sm text-gray-600 font-medium",children:[Ps.psp," - ",new Date(Ps.date).toLocaleDateString("tr-TR")]})]})]}),e.jsx("button",{onClick:mt,className:"w-10 h-10 rounded-xl bg-gray-100/80 hover:bg-gray-200/80 flex items-center justify-center transition-all duration-200 hover:scale-105",children:e.jsx(D,{className:"h-5 w-5 text-gray-600"})})]})}),e.jsx("div",{className:"px-8 py-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:l("ledger.secret_code")}),e.jsx("input",{type:"password",value:Vs,onChange:e=>Ws(e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-all duration-200 text-lg font-mono",placeholder:l("ledger.enter_secret_code"),autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:l("ledger.kasa_top_amount_try")}),e.jsx("input",{type:"number",value:Is,onChange:e=>qs(e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-all duration-200 text-lg font-mono",placeholder:l("ledger.enter_kasa_top_amount"),step:"0.01"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[l("ledger.current_amount"),": ",Ce(Ps.currentAmount,"â‚º")]})]})]})}),e.jsx("div",{className:"px-8 py-6 border-t border-gray-100 bg-gray-50/50 rounded-b-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:mt,className:"px-6 py-3 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-all duration-200 font-semibold shadow-sm hover:shadow",children:l("common.cancel")}),e.jsx("button",{onClick:async()=>{if(!Ps)return;if("4561"!==Vs)return void alert(l("ledger.invalid_secret_kasa"));const e=parseFloat(Is);if(isNaN(e))alert(l("ledger.enter_valid_amount"));else{Ys(!0);try{const t={date:Ps.date,psp:Ps.psp,kasa_top_amount:e},a=await Se.post("/analytics/update-kasa-top",t);if(a.ok)try{await Se.parseResponse(a),await Promise.all([et(le,ce,!0),st(!0),rt(Js.page)]),await new Promise(e=>setTimeout(e,500)),mt(),alert(l("ledger.kasa_updated"))}catch(s){await Promise.all([et(le,ce,!0),st(!0),rt(Js.page)]),mt(),alert(l("ledger.kasa_updated"))}else try{const e=await Se.parseResponse(a),s=e?.error||e?.message||`HTTP ${a.status}`;alert(`${l("ledger.failed_update_kasa")}: ${s}`)}catch(s){alert(`${l("ledger.failed_update_kasa")}: HTTP ${a.status}`)}}catch(t){const e=t?.message||t?.toString()||"Network error";alert(`${l("ledger.failed_save_kasa")}\n\nDetay: ${e}`)}finally{Ys(!1)}}},disabled:Bs||"4561"!==Vs,className:"px-6 py-3 bg-gray-700 text-white rounded hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center gap-3 font-semibold shadow-lg hover:shadow-xl hover:-translate-y-0.5",children:Bs?e.jsxs(e.Fragment,{children:[e.jsx(r,{className:"h-4 w-4 animate-spin"}),l("ledger.updating")]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"h-4 w-4"}),l("ledger.update_kasa_top")]})})]})})]})})]})}},Symbol.toStringTag,{value:"Module"})),Vs=c.memo(function(){const[t,a]=S(),n=o(),[l,c]=Rs("general"),{t:d,currentLanguage:m,setLanguage:x,supportedLanguages:g}=Pe(),[j,y]=s.useState(!1),f=m||"en",b=g||{en:{flag:"ðŸ‡ºðŸ‡¸",name:"English"},tr:{flag:"ðŸ‡¹ðŸ‡·",name:"TÃ¼rkÃ§e"}};s.useEffect(()=>{const e=t.get("tab"),s=t.get("view");if("admin"===e){const e=new URLSearchParams;return s&&e.set("view",s),void n("/admin/settings"+(e.toString()?`?${e.toString()}`:""),{replace:!0})}e&&["general","dropdowns","departments","notifications","integrations","translations"].includes(e)&&c(e)},[]),s.useEffect(()=>{const e=e=>{j&&(e.target.closest(".custom-dropdown-container")||y(!1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[j]);const[N,w]=s.useState({}),[_,C]=s.useState(!1),[R,L]=s.useState(!1),[P,O]=s.useState(!1);s.useState(null);const[M,B]=s.useState(null),[V,J]=s.useState({field_name:"",value:"",commission_rate:""}),[G,Q]=s.useState(""),[Z,ee]=s.useState(["Conversion","Retention","Marketing","Research","Operation","Management","Facility"]),[se,te]=s.useState(!1),[ce,oe]=s.useState(!1),[de,me]=s.useState(""),[xe,ge]=s.useState(""),[he,ue]=s.useState(!1),pe=[{value:"payment_method",label:d("settings.payment_method"),requiresCommission:!1,isStatic:!0,staticValues:["Bank","Credit card","Tether"]},{value:"currency",label:d("settings.currency"),requiresCommission:!1,isStatic:!0,staticValues:["TL","USD","EUR"]},{value:"category",label:d("settings.category"),requiresCommission:!1,isStatic:!0,staticValues:["DEP","WD"]},{value:"psp",label:d("settings.psp_kasa"),requiresCommission:!0,isStatic:!1,isProtected:!1},{value:"company",label:d("settings.company"),requiresCommission:!1,isStatic:!1,isProtected:!1}],je=async()=>{try{C(!0);const e=await Se.get("/transactions/dropdown-options");if(e.ok){const s=await Se.parseResponse(e);w(s||{})}}catch(e){}finally{C(!1)}},ye=async()=>{try{te(!0);const e=localStorage.getItem("systemDepartments");if(e)ee(JSON.parse(e));else{const e=["Conversion","Retention","Marketing","Research","Operation","Management","Facility"];ee(e),localStorage.setItem("systemDepartments",JSON.stringify(e))}}catch(e){}finally{te(!1)}},fe=e=>{e?(me(e),ue(!0)):(ge(""),ue(!1)),oe(!0)};s.useEffect(()=>{"dropdowns"===l&&je(),"departments"===l&&ye()},[l]),ls([{key:"1",ctrlKey:!0,action:()=>c("general")},{key:"2",ctrlKey:!0,action:()=>c("dropdowns")},{key:"3",ctrlKey:!0,action:()=>c("departments")},{key:"4",ctrlKey:!0,action:()=>c("admin")},{key:"5",ctrlKey:!0,action:()=>c("notifications")},{key:"6",ctrlKey:!0,action:()=>c("integrations")},{key:"7",ctrlKey:!0,action:()=>c("translations")}]);const be=[{id:"general",label:d("settings.general"),icon:v,content:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(is,{className:"border border-gray-200 shadow-sm",children:[e.jsx(Qe,{className:"border-b border-gray-100 bg-gray-50/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(W,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx(Ze,{className:"text-lg font-semibold text-gray-900",children:d("settings.company_information")}),e.jsx(Xe,{className:"text-sm text-gray-600",children:d("settings.order_invest_pipeline_collab")})]})]})}),e.jsxs(Ge,{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-md",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-2 uppercase tracking-wide",children:d("settings.company_name")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-base font-semibold text-gray-900",children:"Order Invest"}),e.jsx("span",{className:"text-gray-400",children:"Ã—"}),e.jsx("span",{className:"text-base font-semibold text-gray-700",children:"PipLine"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:d("settings.strategic_partnership")})]}),e.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-md",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-2 uppercase tracking-wide",children:d("settings.contact_email")}),e.jsx(We,{type:"email",placeholder:"contact@orderinvest.com",className:"bg-white border-gray-300"})]})]}),e.jsx("div",{className:"mt-4 p-4 bg-slate-50 border border-slate-200 rounded-md",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"text-slate-600 mt-0.5",children:e.jsx(z,{className:"h-4 w-4"})}),e.jsxs("div",{className:"text-sm text-slate-700",children:[e.jsx("p",{className:"font-medium mb-1",children:d("settings.partnership_overview")}),e.jsx("p",{className:"text-xs leading-relaxed text-slate-600",children:d("settings.partnership_description")})]})]})})]})]}),e.jsxs(is,{className:"border border-gray-200 shadow-sm",children:[e.jsx(Qe,{className:"border-b border-gray-100 bg-gray-50/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(u,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx(Ze,{className:"text-lg font-semibold text-gray-900",children:d("settings.system_preferences")}),e.jsx(Xe,{className:"text-sm text-gray-600",children:d("settings.configure_system")})]})]})}),e.jsxs(Ge,{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-md",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-2 uppercase tracking-wide",children:d("settings.timezone")}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors bg-white text-sm text-gray-900 appearance-none cursor-pointer",style:{zIndex:9999},children:[e.jsx("option",{className:"bg-white text-gray-900",children:"Europe/Istanbul (UTC+3)"}),e.jsx("option",{className:"bg-white text-gray-900",children:"UTC"}),e.jsx("option",{className:"bg-white text-gray-900",children:"Europe/London (UTC+0)"}),e.jsx("option",{className:"bg-white text-gray-900",children:"America/New_York (UTC-5)"}),e.jsx("option",{className:"bg-white text-gray-900",children:"Asia/Dubai (UTC+4)"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:d("settings.default_europe_istanbul")})]}),e.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-md",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-2 uppercase tracking-wide",children:d("settings.language")}),e.jsx("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors bg-white text-sm text-gray-900 appearance-none cursor-pointer",style:{zIndex:9999},value:f,onChange:e=>(async e=>{try{await x(e)}catch(s){}})(e.target.value),children:Object.entries(b).map(([s,t])=>e.jsxs("option",{value:s,className:"bg-white text-gray-900",children:[t.flag," ",t.name]},s))}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:d("settings.primary_turkish")})]})]}),e.jsx("div",{className:"mt-4 p-4 bg-slate-50 border border-slate-200 rounded-md",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"text-slate-600 mt-0.5",children:e.jsx(z,{className:"h-4 w-4"})}),e.jsxs("div",{className:"text-sm text-slate-700",children:[e.jsx("p",{className:"font-medium mb-1",children:d("settings.currency_standard")}),e.jsx("p",{className:"text-xs leading-relaxed text-slate-600",children:d("settings.currency_standard_desc")})]})]})})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs(es,{size:"lg",className:"px-8 py-3 bg-slate-700 hover:bg-slate-800 text-white font-medium",children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),d("settings.save_config_changes")]})})]})},{id:"dropdowns",label:d("settings.dropdown_management"),icon:re,content:e.jsxs("div",{className:"space-y-6",children:[e.jsx(is,{className:"border border-gray-200 shadow-sm",children:e.jsx(Qe,{className:"border-b border-gray-100 bg-gray-50/50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(re,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx(Ze,{className:"text-lg font-semibold text-gray-900",children:d("settings.dropdown_management")}),e.jsx(Xe,{className:"text-sm text-gray-600",children:d("settings.manage_dropdown_options")})]})]}),e.jsxs(es,{onClick:()=>{Q(""),L(!0)},className:"bg-slate-700 hover:bg-slate-800 text-white",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),d("settings.add_new_option")]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(is,{className:"border border-gray-200",children:e.jsx(Ge,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-slate-700 font-semibold text-base",children:"â‚º"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide",children:d("settings.currency_options")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.currency?.length||0})]})]})})}),e.jsx(is,{className:"border border-gray-200",children:e.jsx(Ge,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-slate-700 font-semibold text-base",children:"ðŸ’³"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide",children:d("settings.payment_methods")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.payment_method?.length||0})]})]})})}),e.jsx(is,{className:"border border-gray-200",children:e.jsx(Ge,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-slate-700 font-semibold text-base",children:"ðŸ¢"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide",children:d("settings.psp_kasa")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.psp?.length||0})]})]})})}),e.jsx(is,{className:"border border-gray-200",children:e.jsx(Ge,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-slate-700 font-semibold text-base",children:"ðŸ“Š"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide",children:d("common.total_options")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Object.values(N).reduce((e,s)=>e+(s?.length||0),0)})]})]})})})]}),_?e.jsx(LoadingState,{message:d("settings.loading_configuration_data")||"Loading configuration data..."}):e.jsxs(is,{className:"border border-gray-200 overflow-hidden",children:[e.jsx(Qe,{className:"px-6 py-4 border-b border-gray-200 bg-gray-50/50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Ze,{className:"text-base font-semibold text-gray-900",children:d("settings.configuration_categories")}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(cs,{variant:"secondary",className:"text-xs bg-slate-100 text-slate-700",children:[Object.values(N).reduce((e,s)=>e+(s?.length||0),0)," ",d("settings.total_items")]})})]})}),e.jsx(Ge,{className:"p-0",children:e.jsx("div",{className:"divide-y divide-gray-100",children:pe.map(s=>e.jsxs("div",{className:"p-6 hover:bg-gray-50 transition-colors duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-600 to-gray-600 rounded-lg flex items-center justify-center shadow-sm",children:e.jsx(re,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h5",{className:"text-lg font-bold text-gray-900",children:s.label}),s.isProtected&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-amber-100 text-amber-700 rounded-full text-xs font-medium",children:[e.jsx(Shield,{className:"h-3 w-3"}),d("settings.protected")]})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsx("span",{className:"text-sm text-gray-600",children:s.isStatic?`${s.staticValues?.length||0} ${d("settings.fixed_options")}`:`${N[s.value]?.length||0} ${d("settings.options_configured")}`}),s.isStatic&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:d("settings.fixed_values")}),s.isProtected&&!s.isStatic&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-amber-100 text-amber-800",children:[e.jsx(Shield,{className:"h-3 w-3 mr-1"}),d("settings.protected")]}),s.requiresCommission&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:d("settings.commission_required")})]})]})]}),!s.isStatic&&e.jsxs(ke,{variant:"outline",size:"sm",onClick:()=>{J(e=>({...e,field_name:s.value})),L(!0)},icon:e.jsx(F,{className:"h-4 w-4"}),iconPosition:"left",children:["Add ",s.label]})]}),s.isStatic?e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:s.staticValues?.map((s,t)=>e.jsx("div",{className:"bg-white rounded-lg p-3 border border-gray-200 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-semibold text-gray-900 text-sm",children:s}),e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:d("settings.protected")})]}),e.jsx("p",{className:"text-xs text-gray-500",children:d("settings.static_value")})]}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx(p,{className:"h-4 w-4 text-gray-400"})})]})},t))})}):N[s.value]?.length>0?e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:N[s.value].map(t=>e.jsx("div",{className:"bg-white rounded-lg p-3 border border-gray-200 hover:border-gray-300 hover:shadow-sm transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-semibold text-gray-900 text-sm",children:t.value}),"TETHER"===t.value.toUpperCase()?e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:"Internal KASA"}):null!==t.commission_rate&&void 0!==t.commission_rate?e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:[(100*Number(t.commission_rate)).toFixed(1),"%"]}):null,s.isProtected&&e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-amber-100 text-amber-800",children:[e.jsx(Shield,{className:"h-3 w-3 mr-1"}),d("settings.protected")]})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["ID: ",t.id," â€¢ ",d("settings.created"),": ",t.created_at?new Date(t.created_at).toLocaleDateString():"N/A"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),((e,s)=>{B(e);const t=e.commission_rate?(100*parseFloat(e.commission_rate.toString())).toString():"";J({field_name:s,value:e.value,commission_rate:t}),Q(""),O(!0)})(t,s.value)},className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-50 rounded transition-colors duration-200",title:d("settings.edit_option"),type:"button",children:e.jsx(K,{className:"h-4 w-4"})}),e.jsx("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),(async(e,s)=>{const t=pe.find(e=>e.value===s);if(t?.isProtected){const s=d("settings.delete_protected_warning",{field:t?.label||"Unknown"});if("DELETE"!==prompt(s))return void alert(d("settings.must_type_delete"));if(!confirm(d("settings.final_delete_warning",{option:e.value,field:t?.label||"Unknown"})))return void alert(d("settings.deletion_cancelled"))}else if(!confirm("Are you sure you want to delete this option?"))return;try{Se.clearToken();const s=await Se.delete(`/transactions/dropdown-options/${e.id}`);if(s.ok)await je(),Se.clearToken();else{let e="Failed to delete option";try{const t=s.data||{};e=t.error||t.message||e}catch(a){}}}catch(r){}})(t,s.value)},className:"p-1.5 rounded transition-colors duration-200 "+(s.isProtected?"text-red-400 hover:text-red-600 hover:bg-red-50":"text-gray-400 hover:text-red-600 hover:bg-red-50"),title:s.isProtected?d("settings.protected_option_warning"):d("settings.delete_option"),type:"button",children:e.jsx(Y,{className:"h-4 w-4"})})]})]})},t.id))})}):e.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(re,{className:"h-8 w-8 text-gray-400"})}),e.jsxs("h6",{className:"text-gray-600 font-medium mb-1",children:["No ",s.label," configured"]}),e.jsxs("p",{className:"text-sm text-gray-500 mb-3",children:["Start building your ",s.label.toLowerCase()," configuration"]}),e.jsxs("button",{onClick:()=>L(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors duration-200 font-medium text-sm",children:[e.jsx(F,{className:"h-4 w-4"}),"Add First ",s.label]})]})]},s.value))})})]})]})},{id:"departments",label:d("settings.departments"),icon:W,content:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(_e,{variant:"elevated",className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gray-100 rounded-full -translate-y-16 translate-x-16"}),e.jsx(Ge,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-700 to-gray-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx(W,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx(Ze,{className:"text-2xl font-bold text-gray-900",children:d("settings.department_management")}),e.jsx(Xe,{className:"text-gray-600 font-medium",children:d("settings.organizational_structure_desc")})]})]}),e.jsx(ke,{variant:"primary",size:"lg",onClick:()=>fe(),icon:e.jsx(F,{className:"h-5 w-5"}),iconPosition:"left",className:"px-6 py-3 font-semibold shadow-lg hover:shadow-lg",children:d("settings.add_new_department")})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs(_e,{variant:"outlined",className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-gray-100 rounded-full -translate-y-8 translate-x-8"}),e.jsx(Ge,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(W,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:d("settings.total_departments")}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:Z.length})]})]})})]}),e.jsxs(_e,{variant:"outlined",className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-slate-100 rounded-full -translate-y-8 translate-x-8"}),e.jsx(Ge,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(T,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:d("settings.active_teams")}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:Z.filter(e=>["Conversion","Retention","Marketing","Research","Operation"].includes(e)).length})]})]})})]}),e.jsxs(_e,{variant:"outlined",className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-slate-100 rounded-full -translate-y-8 translate-x-8"}),e.jsx(Ge,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(q,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:d("settings.support_functions")}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:Z.filter(e=>["Management","Facility"].includes(e)).length})]})]})})]})]}),se?e.jsx(LoadingState,{message:d("settings.loading_organizational_structure")||"Loading organizational structure..."}):e.jsxs(_e,{variant:"outlined",className:"overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-gray-50 to-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:d("settings.organizational_structure")}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-xs text-gray-500 bg-white px-2 py-1 rounded-full border border-gray-200",children:[Z.length," ",d("settings.departments")]})})]})}),0===Z.length?e.jsxs("div",{className:"text-center py-12 px-6",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(W,{className:"h-10 w-10 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:d("settings.no_departments_configured")}),e.jsx("p",{className:"text-gray-500 mb-6 max-w-md mx-auto text-sm",children:d("settings.start_building_organizational_structure")}),e.jsxs("button",{onClick:()=>fe(),className:"inline-flex items-center px-6 py-3 border border-transparent rounded-lg text-sm font-medium text-white bg-gradient-to-r from-gray-700 to-gray-600 hover:from-gray-800 hover:to-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors shadow-sm",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),d("settings.create_first_department")]})]}):e.jsx("div",{className:"divide-y divide-gray-100",children:Z.map((s,t)=>e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-600 to-gray-600 rounded-lg flex items-center justify-center shadow-sm",children:e.jsx(W,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-bold text-gray-900",children:s}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[d("settings.department_id"),": ",t+1]}),["Conversion","Retention","Marketing","Research","Operation"].includes(s)&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:d("settings.core_team")}),["Management","Facility"].includes(s)&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:d("settings.support_function")})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>fe(s),className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 font-medium text-sm",title:d("settings.edit"),children:[e.jsx(K,{className:"h-4 w-4"}),d("settings.edit")]}),e.jsxs("button",{onClick:()=>(async e=>{if(confirm(`Are you sure you want to delete the department "${e}"? This action cannot be undone.`))try{const s=Z.filter(s=>s!==e);ee(s),localStorage.setItem("systemDepartments",JSON.stringify(s))}catch(s){}})(s),className:"inline-flex items-center gap-2 px-4 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors duration-200 font-medium text-sm",title:d("settings.delete"),children:[e.jsx(Y,{className:"h-4 w-4"}),d("settings.delete")]})]})]})},t))})]})]})},{id:"notifications",label:d("settings.notifications"),icon:ne,content:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 border border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-700 rounded-lg flex items-center justify-center shadow-sm",children:e.jsx(ne,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:d("settings.notifications_title")}),e.jsx("p",{className:"text-sm text-gray-600",children:d("settings.configure_notifications")})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white rounded-lg p-5 border border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-gray-500 to-gray-600 rounded-lg flex items-center justify-center",children:e.jsx(I,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:d("settings.email_notifications_title")}),e.jsx("p",{className:"text-xs text-gray-500",children:d("settings.receive_important_updates")})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer"}),e.jsx("div",{className:"w-10 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-orange-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-gray-500"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg p-5 border border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-700 rounded-lg flex items-center justify-center",children:e.jsx(H,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:d("settings.sms_notifications_title")}),e.jsx("p",{className:"text-xs text-gray-500",children:d("settings.urgent_alerts_text")})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer"}),e.jsx("div",{className:"w-10 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-orange-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-gray-500"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg p-5 border border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-700 rounded-lg flex items-center justify-center",children:e.jsx(ne,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:d("settings.push_notifications_title")}),e.jsx("p",{className:"text-xs text-gray-500",children:d("settings.realtime_browser_notifications")})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer"}),e.jsx("div",{className:"w-10 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-orange-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-gray-500"})]})]})})]})]})})},{id:"integrations",label:d("settings.integrations"),icon:u,content:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-gray-50 rounded-xl p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-700 to-gray-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx(u,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:d("settings.system_integrations")}),e.jsx("p",{className:"text-gray-600 font-medium",children:d("settings.connect_external_services")})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-gray-50 to-gray-50",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:d("settings.api_integrations")}),e.jsx("p",{className:"text-sm text-gray-600",children:d("settings.connect_external_data_sources")})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(E,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 text-sm",children:d("settings.exchange_rate_apis")}),e.jsx("p",{className:"text-xs text-gray-500",children:d("settings.realtime_currency_conversion")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:d("settings.active")}),e.jsx("button",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 text-xs font-medium",children:d("settings.configure")})]})]})}),e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(W,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 text-sm",children:d("settings.banking_apis")}),e.jsx("p",{className:"text-xs text-gray-500",children:d("settings.account_balance_sync")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:d("settings.pending")}),e.jsx("button",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 text-xs font-medium",children:d("settings.setup")})]})]})}),e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(U,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 text-sm",children:d("settings.market_data_apis")}),e.jsx("p",{className:"text-xs text-gray-500",children:d("settings.stock_prices_analytics")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:d("settings.inactive")}),e.jsx("button",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 text-xs font-medium",children:d("settings.enable")})]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:d("settings.data_integrations")}),e.jsx("p",{className:"text-sm text-gray-600",children:d("settings.import_export_external_data")})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(i,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 text-sm",children:d("settings.excel_csv_import")}),e.jsx("p",{className:"text-xs text-gray-500",children:d("settings.bulk_transaction_import")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:d("settings.active")}),e.jsx("button",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 text-xs font-medium",children:d("settings.manage")})]})]})}),e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(r,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 text-sm",children:d("settings.database_sync")}),e.jsx("p",{className:"text-xs text-gray-500",children:d("settings.realtime_data_sync")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:d("settings.active")}),e.jsx("button",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 text-xs font-medium",children:d("settings.monitor")})]})]})}),e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx($,{className:"h-5 w-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 text-sm",children:d("settings.report_export")}),e.jsx("p",{className:"text-xs text-gray-500",children:d("settings.automated_report_generation")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:d("settings.active")}),e.jsx("button",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 text-xs font-medium",children:d("settings.configure")})]})]})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:d("settings.integration_health_status")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg border border-slate-200",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(k,{className:"h-5 w-5 text-slate-700"})}),e.jsx("p",{className:"text-sm font-medium text-slate-700",children:d("settings.active")}),e.jsxs("p",{className:"text-xs text-slate-700",children:["4 ",d("settings.integrations")]})]}),e.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:[e.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(h,{className:"h-5 w-5 text-yellow-600"})}),e.jsx("p",{className:"text-sm font-medium text-yellow-800",children:d("settings.pending")}),e.jsxs("p",{className:"text-xs text-yellow-600",children:["1 ",d("settings.integrations")]})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(le,{className:"h-5 w-5 text-gray-600"})}),e.jsx("p",{className:"text-sm font-medium text-gray-800",children:d("settings.inactive")}),e.jsxs("p",{className:"text-xs text-gray-600",children:["1 ",d("settings.integrations")]})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(U,{className:"h-5 w-5 text-gray-600"})}),e.jsx("p",{className:"text-sm font-medium text-gray-800",children:d("settings.total")}),e.jsxs("p",{className:"text-xs text-gray-600",children:["6 ",d("settings.integrations")]})]})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-gray-50 rounded-xl p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:d("settings.need_more_integrations")}),e.jsx("p",{className:"text-sm text-gray-600",children:d("settings.contact_integration_team")})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 font-medium text-sm",children:d("settings.view_documentation")}),e.jsx("button",{className:"px-6 py-2 bg-gradient-to-r from-gray-700 to-gray-600 text-white rounded-lg hover:from-gray-800 hover:to-gray-700 transition-all duration-200 font-medium text-sm",children:d("settings.request_integration")})]})]})})]})}];return e.jsx(ks,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx(ss,{title:d("settings.title"),description:d("settings.config"),icon:v,actions:e.jsxs(es,{variant:"outline",size:"sm",onClick:()=>{"dropdowns"===l?je():"departments"===l&&ye()},className:"border-gray-300 hover:bg-gray-50",children:[e.jsx(r,{className:"h-4 w-4 mr-2"}),d("settings.refresh")]})})}),e.jsxs(ts,{value:l,onValueChange:c,className:"w-full",children:[e.jsxs(as,{className:"grid w-full grid-cols-5 bg-gray-50/80 border border-gray-200/60 rounded-lg shadow-sm p-[2px] overflow-hidden",children:[e.jsxs(rs,{value:"general",className:"flex items-center gap-2",children:[e.jsx(v,{className:"h-4 w-4"}),d("tabs.general")]}),e.jsxs(rs,{value:"dropdowns",className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),d("tabs.dropdowns")]}),e.jsxs(rs,{value:"departments",className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4"}),d("tabs.departments")]}),e.jsxs(rs,{value:"notifications",className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-4 w-4"}),d("tabs.notifications")]}),e.jsxs(rs,{value:"integrations",className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4"}),d("tabs.integrations")]})]}),be.map(s=>e.jsx(ns,{value:s.id,className:"mt-6",children:s.content},s.id))]}),R&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",onClick:()=>L(!1),children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full relative",onClick:e=>e.stopPropagation(),children:[e.jsx("div",{className:"p-5 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:d("settings.add_option")}),e.jsx(ke,{variant:"ghost",size:"sm",onClick:()=>L(!1),icon:e.jsx(D,{className:"h-4 w-4"}),children:d("common.close")})]})}),e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{className:"relative custom-dropdown-container",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:d("settings.field_type")}),e.jsxs("div",{className:"relative custom-dropdown-container",children:[e.jsxs("button",{type:"button",onClick:()=>y(!j),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 bg-white text-gray-900 cursor-pointer text-left flex items-center justify-between hover:border-gray-400 transition-colors",children:[e.jsx("span",{className:V.field_name?"text-gray-900":"text-gray-500",children:V.field_name?pe.find(e=>e.value===V.field_name)?.label:d("settings.select_field_type")}),e.jsx(X,{className:"h-4 w-4 text-gray-500 transition-transform "+(j?"rotate-180":"")})]}),j&&e.jsx("div",{className:"absolute z-[10001] w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-auto",children:e.jsx("div",{className:"py-1",children:pe.filter(e=>!e.isStatic).map(s=>e.jsxs("button",{type:"button",onClick:()=>{J(e=>({...e,field_name:s.value})),y(!1)},className:"w-full px-3 py-2 text-left hover:bg-gray-100 transition-colors flex items-center justify-between "+(V.field_name===s.value?"bg-gray-50 text-gray-900 font-medium":"text-gray-700"),children:[e.jsx("span",{children:s.label}),V.field_name===s.value&&e.jsx(ie,{className:"h-4 w-4 text-gray-600"})]},s.value))})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:d("settings.option_value")}),e.jsx(We,{type:"text",value:V.value,onChange:e=>J(s=>({...s,value:e.target.value})),placeholder:d("settings.enter_option_value")})]}),pe.find(e=>e.value===V.field_name)?.requiresCommission&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:d("settings.commission_rate_required")}),e.jsx(We,{type:"number",step:"0.01",min:"0",max:"100",value:V.commission_rate,onChange:e=>J(s=>({...s,commission_rate:e.target.value})),placeholder:d("settings.enter_commission_placeholder"),required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:d("settings.commission_help")})]}),pe.find(e=>e.value===V.field_name)?.isProtected&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[d("settings.security_code")," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(We,{type:"password",value:G,onChange:e=>Q(e.target.value),placeholder:d("settings.enter_security_code"),required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:d("settings.security_code_required_info")})]})]}),e.jsxs("div",{className:"p-5 border-t border-gray-100 flex gap-3",children:[e.jsx(ke,{variant:"outline",onClick:()=>L(!1),className:"flex-1",children:d("common.cancel")}),e.jsx(ke,{variant:"primary",onClick:async()=>{if(!V.field_name)return;const e=pe.find(e=>e.value===V.field_name);if(e?.isProtected){if(!G.trim())return;if("4561"!==G.trim())return}if(!V.value.trim())return;if((N[V.field_name]||[]).find(e=>e.value===V.value.trim()))return;let s=null;if("psp"===V.field_name){if(!V.commission_rate||""===V.commission_rate.trim())return void alert("Commission rate is required for PSP options");let e=parseFloat(V.commission_rate);if(isNaN(e))return void alert("Commission rate must be a valid number");if(e>1&&(e/=100),e<0||e>1)return void alert("Commission rate must be between 0 and 100% (enter as decimal: 0.025 for 2.5% or as percentage: 2.5)");s=e.toString()}try{const e=await Se.post("/transactions/dropdown-options",{field_name:V.field_name,value:V.value.trim(),commission_rate:s});if(e.ok||201===e.status)L(!1),J({field_name:"",value:"",commission_rate:""}),Q(""),await je();else{let s=d("settings.failed_to_add_option");try{const t=e.data||{};s=t.error||t.message||s}catch(t){}alert(s)}}catch(a){}},disabled:!V.field_name||!V.value||pe.find(e=>e.value===V.field_name)?.requiresCommission&&!V.commission_rate||pe.find(e=>e.value===V.field_name)?.isProtected&&!G,className:"flex-1",children:d("settings.add_option")})]})]})}),P&&M&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",onClick:()=>O(!1),children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full relative",onClick:e=>e.stopPropagation(),children:[e.jsx("div",{className:"p-5 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:d("settings.edit_option")}),e.jsx(ke,{variant:"ghost",size:"sm",onClick:()=>O(!1),icon:e.jsx(D,{className:"h-4 w-4"}),children:d("common.close")})]})}),e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:d("settings.field_type")}),e.jsx(We,{type:"text",value:pe.find(e=>e.value===V.field_name)?.label||V.field_name,className:"bg-gray-50",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:d("settings.option_value")}),e.jsx(We,{type:"text",value:V.value,onChange:e=>J(s=>({...s,value:e.target.value})),placeholder:d("settings.enter_option_value")})]}),pe.find(e=>e.value===V.field_name)?.requiresCommission&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:d("settings.commission_rate_required")}),e.jsx(We,{type:"number",step:"0.01",min:"0",max:"100",value:V.commission_rate,onChange:e=>J(s=>({...s,commission_rate:e.target.value})),placeholder:d("settings.enter_commission_placeholder"),required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:d("settings.commission_help")})]}),pe.find(e=>e.value===V.field_name)?.isProtected&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[d("settings.security_code")," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(We,{type:"password",value:G,onChange:e=>Q(e.target.value),placeholder:d("settings.enter_security_code"),required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:d("settings.security_code_edit_info")})]})]}),e.jsxs("div",{className:"p-5 border-t border-gray-100 flex gap-3",children:[e.jsx(ke,{variant:"outline",onClick:()=>O(!1),className:"flex-1",children:d("common.cancel")}),e.jsx(ke,{variant:"primary",onClick:async()=>{if(!M)return;const e=pe.find(e=>e.value===V.field_name);if(e?.isProtected){if(!G.trim())return void alert(d("settings.security_code_required"));if("4561"!==G.trim())return void alert(d("settings.invalid_security_code"))}if((N[V.field_name]||[]).find(e=>e.value===V.value.trim()&&e.id!==M.id))return void alert(d("settings.option_value_exists").replace("{value}",V.value.trim()).replace("{field}",e?.label||V.field_name));if(!V.value.trim())return;let s=null;if("psp"===V.field_name){if(!V.commission_rate||""===V.commission_rate.trim())return void alert("Commission rate is required for PSP options");let e=parseFloat(V.commission_rate);if(isNaN(e))return void alert("Commission rate must be a valid number");if(e>1&&(e/=100),e<0||e>1)return void alert("Commission rate must be between 0 and 100% (enter as decimal: 0.025 for 2.5% or as percentage: 2.5)");s=e.toString()}try{const e=await Se.put(`/transactions/dropdown-options/${M.id}`,{value:V.value.trim(),commission_rate:s});if(e.ok){try{await Se.parseResponse(e)}catch(t){}O(!1),B(null),J({field_name:"",value:"",commission_rate:""}),Q("");try{C(!0);const e=await Se.get("/transactions/dropdown-options");if(e.ok){const s=await Se.parseResponse(e);w(s||{})}}catch(a){await je()}finally{C(!1)}Se.clearToken()}else{let s="Failed to update option";try{const t=e.data||{};s=t.error||t.message||s}catch(t){}}}catch(r){const e=r instanceof Error?r.message:"Failed to update option. Please try again.";alert(e)}},disabled:!V.value||pe.find(e=>e.value===V.field_name)?.requiresCommission&&!V.commission_rate||pe.find(e=>e.value===V.field_name)?.isProtected&&!G,className:"flex-1",children:d("settings.edit_option")})]})]})}),ce&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:()=>oe(!1),children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",onClick:e=>e.stopPropagation(),children:[e.jsx("div",{className:"p-5 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:d(he?"settings.edit_department":"settings.add_new_department")}),e.jsx(ke,{variant:"ghost",size:"sm",onClick:()=>oe(!1),icon:e.jsx(D,{className:"h-4 w-4"}),children:d("settings.close")})]})}),e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:d("settings.department_name")}),e.jsx(We,{type:"text",value:he?de:xe,onChange:e=>he?me(e.target.value):ge(e.target.value),placeholder:d("settings.enter_department_name"),autoFocus:!0})]}),e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-5 h-5 bg-gray-100 rounded-full flex items-center justify-center mt-0.5",children:e.jsx("span",{className:"text-gray-600 text-xs font-bold",children:"i"})}),e.jsxs("div",{className:"text-sm text-gray-800",children:[e.jsx("p",{className:"font-medium mb-1",children:d("settings.department_management")}),e.jsx("p",{className:"text-xs",children:d(he?"settings.edit_department_info":"settings.add_department_info")})]})]})})]}),e.jsxs("div",{className:"p-5 border-t border-gray-100 flex gap-3",children:[e.jsx(ke,{variant:"outline",onClick:()=>oe(!1),className:"flex-1",children:d("common.cancel")}),e.jsx(ke,{variant:"primary",onClick:he?async()=>{if(de.trim())try{const e=Z.find(e=>e!==de);if(!e)return void alert(d("settings.department_not_found"));if(Z.includes(de.trim())&&de.trim()!==e)return void alert(d("settings.department_name_exists"));const s=Z.map(s=>s===e?de.trim():s);ee(s),localStorage.setItem("systemDepartments",JSON.stringify(s)),me(""),ue(!1),oe(!1)}catch(e){}}:async()=>{if(xe.trim())try{if(Z.includes(xe.trim()))return void alert(d("settings.department_exists"));const e=[...Z,xe.trim()];ee(e),localStorage.setItem("systemDepartments",JSON.stringify(e)),ge(""),oe(!1)}catch(e){}},disabled:he?!de.trim():!xe.trim(),className:"flex-1",children:d(he?"settings.update_department":"settings.add_department")})]})]})})]})})}),Ws=Object.freeze(Object.defineProperty({__proto__:null,default:Vs},Symbol.toStringTag,{value:"Module"})),Js=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{t:t}=Pe();o();const[a,n]=s.useState([]),[l,i]=s.useState(!0),[c,d]=s.useState(""),[m,x]=s.useState(!1),[g,h]=s.useState(!1),[u,y]=s.useState(!1),[b,v]=s.useState(!1),[N,w]=s.useState(null),[_,S]=s.useState([]),[C,D]=s.useState(!1),[E,R]=s.useState({username:"",email:"",password:"",role:"user",admin_level:0,is_active:!0}),$=async()=>{i(!0);try{const e=await Se.get("/api/v1/users/");e.data.success&&n(e.data.users)}catch(e){}finally{i(!1)}};s.useEffect(()=>{$()},[]);const U=a.filter(e=>e.username.toLowerCase().includes(c.toLowerCase())||e.email&&e.email.toLowerCase().includes(c.toLowerCase())),L=async e=>{w(e),y(!0),D(!0);try{const s=await Se.get(`/api/v1/users/${e.id}/sessions`);s.data.success&&S(s.data.sessions)}catch(s){}finally{D(!1)}},z=e=>{switch(e.toLowerCase()){case"admin":return"bg-purple-100 text-purple-800";case"user":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},P=e=>e?new Date(e).toLocaleString():"Never";return e.jsx(ks,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx(ss,{title:"User Management",description:"Manage system users, their accounts, and permissions",icon:T})}),e.jsxs("div",{className:"mb-6 flex items-center justify-between gap-4",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(We,{type:"text",placeholder:"Search users by username or email...",value:c,onChange:e=>d(e.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(es,{onClick:$,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(r,{className:"h-4 w-4"}),"Refresh"]}),e.jsxs(es,{onClick:()=>{R({username:"",email:"",password:"",role:"user",admin_level:0,is_active:!0}),x(!0)},className:"flex items-center gap-2 bg-slate-700 hover:bg-slate-800",children:[e.jsx(F,{className:"h-4 w-4"}),"Add User"]})]})]}),e.jsxs(is,{children:[e.jsxs(Qe,{children:[e.jsxs(Ze,{children:["Users (",U.length,")"]}),e.jsx(Xe,{children:"All system users and their status"})]}),e.jsx(Ge,{children:l?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(r,{className:"h-6 w-6 animate-spin text-gray-400"})}):0===U.length?e.jsx("div",{className:"text-center py-12 text-gray-500",children:c?"No users found matching your search":"No users found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Username"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Email"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Role"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Last Login"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Sessions"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:U.map(s=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.username}),s.admin_level>0&&e.jsx(cs,{className:"bg-purple-100 text-purple-800 text-xs",children:s.admin_title})]})}),e.jsx("td",{className:"py-3 px-4 text-gray-600",children:s.email||e.jsx("span",{className:"text-gray-400",children:"No email"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx(cs,{className:z(s.role),children:s.role})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.is_active?e.jsxs(cs,{className:"bg-green-100 text-green-800 flex items-center gap-1",children:[e.jsx(k,{className:"h-3 w-3"}),"Active"]}):e.jsxs(cs,{className:"bg-red-100 text-red-800 flex items-center gap-1",children:[e.jsx(ce,{className:"h-3 w-3"}),"Inactive"]}),s.account_locked_until&&e.jsxs(cs,{className:"bg-orange-100 text-orange-800 flex items-center gap-1",children:[e.jsx(p,{className:"h-3 w-3"}),"Locked"]})]})}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:P(s.last_login)}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("button",{onClick:()=>L(s),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:[s.active_sessions_count||0," active"]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(es,{variant:"ghost",size:"sm",onClick:()=>L(s),title:t("user_management.view_sessions"),children:e.jsx(f,{className:"h-4 w-4"})}),e.jsx(es,{variant:"ghost",size:"sm",onClick:()=>(e=>{w(e),R({username:e.username,email:e.email||"",password:"",role:e.role,admin_level:e.admin_level,is_active:e.is_active}),h(!0)})(s),title:t("user_management.edit_user"),children:e.jsx(K,{className:"h-4 w-4"})}),e.jsx(es,{variant:"ghost",size:"sm",onClick:()=>(e=>{w(e),R({...E,password:""}),v(!0)})(s),title:"Reset Password",children:e.jsx(oe,{className:"h-4 w-4"})}),s.account_locked_until&&e.jsx(es,{variant:"ghost",size:"sm",onClick:()=>(async e=>{try{const s=await Se.post(`/api/v1/users/${e.id}/unlock`);s.data.success?$():alert(s.data.error||"Failed to unlock user")}catch(s){alert(s.response?.data?.error||"Failed to unlock user")}})(s),title:"Unlock Account",className:"text-orange-600 hover:text-orange-800",children:e.jsx(de,{className:"h-4 w-4"})}),e.jsx(es,{variant:"ghost",size:"sm",onClick:()=>(async e=>{try{const s=await Se.post(`/api/v1/users/${e.id}/toggle-active`);s.data.success?$():alert(s.data.error||t("user_management.failed_to_update_status"))}catch(s){alert(s.response?.data?.error||t("user_management.failed_to_update_status"))}})(s),title:s.is_active?"Deactivate":"Activate",className:s.is_active?"text-orange-600":"text-green-600",children:s.is_active?e.jsx(ce,{className:"h-4 w-4"}):e.jsx(me,{className:"h-4 w-4"})}),e.jsx(es,{variant:"ghost",size:"sm",onClick:()=>(async e=>{if(confirm(t("user_management.confirm_delete",{username:e.username})))try{const s=await Se.delete(`/api/v1/users/${e.id}`);s.data.success?$():alert(s.data.error||t("user_management.failed_to_delete"))}catch(s){alert(s.response?.data?.error||t("user_management.failed_to_delete"))}})(s),title:t("user_management.delete_user"),className:"text-red-600 hover:text-red-800",children:e.jsx(Y,{className:"h-4 w-4"})})]})})]},s.id))})]})})})]}),e.jsx(Ee,{isOpen:m,onClose:()=>x(!1),title:"Add New User",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Username ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(We,{type:"text",value:E.username,onChange:e=>R({...E,username:e.target.value}),placeholder:"Enter username",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx(We,{type:"email",value:E.email,onChange:e=>R({...E,email:e.target.value}),placeholder:"Enter email (optional)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(We,{type:"password",value:E.password,onChange:e=>R({...E,password:e.target.value}),placeholder:"Enter password (min 6 characters)",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),e.jsxs("select",{value:E.role,onChange:e=>R({...E,role:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-slate-500",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"viewer",children:"Viewer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admin Level"}),e.jsxs("select",{value:E.admin_level,onChange:e=>R({...E,admin_level:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-slate-500",children:[e.jsx("option",{value:"0",children:"Regular User (0)"}),e.jsx("option",{value:"1",children:"Main Admin (1)"}),e.jsx("option",{value:"2",children:"Secondary Admin (2)"}),e.jsx("option",{value:"3",children:"Sub Admin (3)"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"is_active_add",checked:E.is_active,onChange:e=>R({...E,is_active:e.target.checked}),className:"rounded border-gray-300"}),e.jsx("label",{htmlFor:"is_active_add",className:"text-sm text-gray-700",children:"Active Account"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(es,{variant:"outline",onClick:()=>x(!1),children:t("common.cancel")}),e.jsxs(es,{onClick:async()=>{try{const e=await Se.post("/api/v1/users/",E);e.data.success?(x(!1),R({username:"",email:"",password:"",role:"user",admin_level:0,is_active:!0}),$()):alert(e.data.error||t("user_management.failed_to_create"))}catch(e){alert(e.response?.data?.error||t("user_management.failed_to_create"))}},className:"bg-slate-700 hover:bg-slate-800",children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),t("user_management.create_user")]})]})]})}),e.jsx(Ee,{isOpen:g,onClose:()=>h(!1),title:`${t("user_management.edit_user")}: ${N?.username}`,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Username ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(We,{type:"text",value:E.username,onChange:e=>R({...E,username:e.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx(We,{type:"email",value:E.email,onChange:e=>R({...E,email:e.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),e.jsxs("select",{value:E.role,onChange:e=>R({...E,role:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-slate-500",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"viewer",children:"Viewer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admin Level"}),e.jsxs("select",{value:E.admin_level,onChange:e=>R({...E,admin_level:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-slate-500",disabled:0===N?.admin_level,children:[e.jsx("option",{value:"0",children:"Regular User (0)"}),e.jsx("option",{value:"1",children:"Main Admin (1)"}),e.jsx("option",{value:"2",children:"Secondary Admin (2)"}),e.jsx("option",{value:"3",children:"Sub Admin (3)"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"is_active_edit",checked:E.is_active,onChange:e=>R({...E,is_active:e.target.checked}),className:"rounded border-gray-300",disabled:0===N?.admin_level}),e.jsx("label",{htmlFor:"is_active_edit",className:"text-sm text-gray-700",children:"Active Account"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(es,{variant:"outline",onClick:()=>h(!1),children:t("common.cancel")}),e.jsxs(es,{onClick:async()=>{if(N)try{const e={username:E.username,email:E.email,role:E.role,admin_level:E.admin_level,is_active:E.is_active},s=await Se.put(`/api/v1/users/${N.id}`,e);s.data.success?(h(!1),w(null),$()):alert(s.data.error||t("user_management.failed_to_update"))}catch(e){alert(e.response?.data?.error||t("user_management.failed_to_update"))}},className:"bg-slate-700 hover:bg-slate-800",children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),t("user_management.save_changes")]})]})]})}),e.jsx(Ee,{isOpen:b,onClose:()=>v(!1),title:t("user_management.reset_password_for",{username:N?.username||""}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:e.jsx("p",{className:"text-sm text-blue-800",children:t("user_management.enter_new_password")})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t("user_management.new_password")," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(We,{type:"password",value:E.password,onChange:e=>R({...E,password:e.target.value}),placeholder:t("user_management.enter_new_password_placeholder"),required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(es,{variant:"outline",onClick:()=>v(!1),children:t("common.cancel")}),e.jsxs(es,{onClick:async()=>{if(N)if(!E.password||E.password.length<6)alert("Password must be at least 6 characters long");else try{const e=await Se.post(`/api/v1/users/${N.id}/reset-password`,{password:E.password});e.data.success?(v(!1),R({...E,password:""}),alert("Password reset successfully")):alert(e.data.error||"Failed to reset password")}catch(e){alert(e.response?.data?.error||"Failed to reset password")}},className:"bg-slate-700 hover:bg-slate-800",children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),t("user_management.reset_password")]})]})]})}),e.jsx(Ee,{isOpen:u,onClose:()=>y(!1),title:t("user_management.sessions_for",{username:N?.username||""}),size:"large",children:e.jsxs("div",{className:"space-y-4",children:[C?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(r,{className:"h-6 w-6 animate-spin text-gray-400"})}):0===_.length?e.jsx("div",{className:"text-center py-12 text-gray-500",children:t("user_management.no_sessions_found")}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-2 px-4 font-medium text-gray-700",children:t("user_management.status")}),e.jsx("th",{className:"text-left py-2 px-4 font-medium text-gray-700",children:t("user_management.ip_address")}),e.jsx("th",{className:"text-left py-2 px-4 font-medium text-gray-700",children:t("user_management.user_agent")}),e.jsx("th",{className:"text-left py-2 px-4 font-medium text-gray-700",children:t("user_management.created")}),e.jsx("th",{className:"text-left py-2 px-4 font-medium text-gray-700",children:t("user_management.last_active")})]})}),e.jsx("tbody",{children:_.map(s=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("td",{className:"py-2 px-4",children:s.is_active?e.jsx(cs,{className:"bg-green-100 text-green-800",children:t("user_management.active")}):e.jsx(cs,{className:"bg-gray-100 text-gray-800",children:t("user_management.inactive")})}),e.jsx("td",{className:"py-2 px-4 text-sm text-gray-600",children:s.ip_address||"N/A"}),e.jsx("td",{className:"py-2 px-4 text-sm text-gray-600",children:s.user_agent?e.jsx("span",{className:"max-w-xs truncate block",title:s.user_agent,children:s.user_agent}):"N/A"}),e.jsx("td",{className:"py-2 px-4 text-sm text-gray-600",children:P(s.created_at)}),e.jsx("td",{className:"py-2 px-4 text-sm text-gray-600",children:P(s.last_active)})]},s.id))})]})}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(es,{variant:"outline",onClick:()=>y(!1),children:t("common.close")})})]})})]})})}},Symbol.toStringTag,{value:"Module"})),Gs=new class{apiClient;constructor(){this.apiClient=new Re("/api/v1")}async makeRequest(e,s={}){try{const t=(s.method||"GET").toUpperCase();let a;if(s.body)try{a=JSON.parse(s.body)}catch{a=s.body}const r=await this.apiClient.request(e,t,a);return r.data||r}catch(t){throw t}}async getStatus(){return this.makeRequest("/api/v1/exchange-rates/status")}async fetchRate(e){const s=await this.makeRequest("/api/v1/exchange-rates/current");return s.success&&s.rate?{status:"success",message:s.message||"Rate fetched successfully",rate:{...s.rate,currency_pair:e.currency_pair}}:{status:"error",message:s.message||"Failed to fetch rate"}}async getDailySummaryRates(e){const s=await this.makeRequest("/api/v1/exchange-rates/current");return s.success&&s.rate?{status:"success",message:s.message||"Rate fetched successfully",rates:{USDTRY:{...s.rate,currency_pair:"USDTRY"}}}:{status:"error",message:s.message||"Failed to fetch rates"}}async updateManualRate(e){return{status:"error",message:"Manual rate updates not currently supported"}}async refreshRates(e){const s=await this.makeRequest("/api/v1/exchange-rates/update",{method:"POST"});return s.success?{status:"success",message:s.message||"Rates refreshed successfully"}:{status:"error",message:s.message||"Failed to refresh rates"}}async getHistory(e){const s=new URLSearchParams({start_date:e.start_date,end_date:e.end_date});return e.currency_pair&&s.append("currency_pair",e.currency_pair),this.makeRequest(`/api/v1/exchange-rates/history?${s}`)}async getMissingRates(e){return{status:"success",message:"No missing rates detected",missing_dates:[]}}async getRate(e,s){try{return(await this.fetchRate({date:s,currency_pair:e})).rate||null}catch(t){return null}}async getRatesForDate(e){try{const s=await this.getDailySummaryRates({date:e});return s.rates&&"object"==typeof s.rates&&!Array.isArray(s.rates)?s.rates:{}}catch(s){return{}}}formatCurrencyPair(e){const[s,t]=e.split("/");return`${s} â†’ ${t}`}getSourceDisplayName(e){switch(e.toLowerCase()){case"yfinance":return"Yahoo Finance";case"manual":return"Manual Override";case"tcmb":return"TCMB";default:return e}}getQualityDisplayName(e){switch(e.toLowerCase()){case"closing_price":return"Closing Price";case"closest_available":return"Closest Available";case"manual":return"Manual";default:return e}}getQualityColor(e){switch(e.toLowerCase()){case"closing_price":return"text-green-600";case"closest_available":return"text-yellow-600";case"manual":return"text-blue-600";default:return"text-gray-600"}}getSourceIcon(e){switch(e.toLowerCase()){case"yfinance":return"ðŸ“Š";case"manual":return"âœï¸";case"tcmb":return"ðŸ›ï¸";default:return"ðŸ“ˆ"}}validateRate(e,s){const[t,a]={"USD/TRY":[1,100],"EUR/TRY":[1,150],"GBP/TRY":[1,200]}[s]||[.1,1e3];return e<=0?{isValid:!1,warning:"Rate must be positive"}:e<t||e>a?{isValid:!0,warning:`${s} rate (${e}) seems unusual (expected ${t}-${a})`}:{isValid:!0}}formatRate(e,s){const[t,a]=s.split("/");return"TRY"===a?`${e.toFixed(4)} ${a}`:`${e.toFixed(2)} ${a}`}calculateConvertedAmount(e,s){return e*s}getSupportedPairs(){return["USD/TRY","EUR/TRY","GBP/TRY"]}isSupportedPair(e){return this.getSupportedPairs().includes(e)}},Qs=new class{isMonitoring=!1;checkInterval=null;lastHealthStatus=null;startMonitoring(e=3e4){this.isMonitoring||(this.isMonitoring=!0,this.performHealthCheck(),this.checkInterval=setInterval(()=>{this.performHealthCheck()},e))}stopMonitoring(){this.isMonitoring&&(this.isMonitoring=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null))}async performHealthCheck(){const e=[],s=[],t={backend:!1,frontend:!1,session:!1,csrf:!1,timestamp:(new Date).toISOString()};try{try{const a=await Se.get("/health");t.backend=a.ok,a.ok||(e.push("Backend is not responding"),s.push("Check if the Flask server is running"))}catch(a){e.push("Cannot connect to backend"),s.push("Restart the Flask server")}try{const a=await fetch("/api/v1/health");t.frontend=a.ok,a.ok||(e.push("Frontend proxy is not working"),s.push("Check Vite configuration and restart frontend"))}catch(a){e.push("Frontend proxy connection failed"),s.push("Restart the frontend development server")}try{const a=await Se.get("/auth/check");t.session=a.ok,a.ok||(e.push("Session is invalid or expired"),s.push("User should log in again"))}catch(a){e.push("Session check failed"),s.push("Clear browser cookies and log in again")}try{const a=await Se.get("/auth/csrf-token");if(a.ok){const r=Se.parseResponse(a);t.csrf=!!r.csrf_token,r.csrf_token||(e.push("CSRF token generation failed"),s.push("Refresh the page to get a new token"))}else e.push("CSRF token endpoint not responding"),s.push("Check backend CSRF configuration")}catch(a){e.push("CSRF token check failed"),s.push("Refresh the page and try again")}}catch(a){e.push("Health check process failed"),s.push("Check browser console for errors")}return this.logHealthStatus(t,e,s),this.lastHealthStatus=t,{status:t,issues:e,recommendations:s}}logHealthStatus(e,s,t){Object.values(e).every(Boolean)&&s.length}getLastHealthStatus(){return this.lastHealthStatus}isHealthy(){return!!this.lastHealthStatus&&Object.values(this.lastHealthStatus).every(Boolean)}async refreshSession(){try{return Se.clearToken(),!!(await Se.get("/api/v1/auth/csrf-token")).ok}catch(e){return!1}}async testTransactionCreation(){try{const e={client_name:"HEALTH CHECK TEST",amount:"1.00",currency:"TL",payment_method:"BANKA",category:"DEP",psp:"#61",iban:"IBAN",company_order:"TEST COMPANY",date:(new Date).toISOString().split("T")[0],notes:"Health check test transaction"},s=await Se.post("/transactions",e);return!!s.ok&&!!Se.parseResponse(s).success}catch(e){return!1}}};"undefined"!=typeof window&&setTimeout(()=>{Qs.startMonitoring()},5e3);const Zs=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{t:a}=Pe(),{isAuthenticated:l,isLoading:c}=Oe(),d=o(),[m,x]=s.useState(!1),[g,h]=s.useState(!1),[p,y]=s.useState(null),[f,N]=s.useState(!1),[w,_]=s.useState({}),[S,R]=s.useState(!1),T={currency:[{id:1,value:"TL"},{id:2,value:"USD"},{id:3,value:"EUR"}],payment_method:[{id:1,value:"Bank"},{id:2,value:"Credit card"},{id:3,value:"Tether"}],psp:[],company:[]},[$,U]=s.useState({has_rates:!1}),[L,z]=s.useState(!1),[P,O]=s.useState(!1),[M,I]=s.useState(""),[B,H]=s.useState(""),[K,Y]=s.useState("saved"),[V,J]=s.useState(!1),[Z,X]=s.useState(""),[ee,se]=s.useState(""),[te,ae]=s.useState(!1),[re,ne]=s.useState(""),[le,ie]=s.useState({client_name:"",company:"",date:"",amount:"",payment_method:"",currency:"",category:"",psp:"",notes:"",eur_rate:"",usd_rate:""}),ce="addTransaction_autoSave";s.useEffect(()=>{const e=localStorage.getItem(ce);if(e)try{const s=JSON.parse(e);ie(s)}catch(s){localStorage.removeItem(ce)}},[]),s.useEffect(()=>{const e=setTimeout(()=>{if(le.client_name||le.amount||le.date){Y("saving");try{localStorage.setItem(ce,JSON.stringify(le)),Y("saved")}catch(e){Y("error")}}},2e3);return()=>clearTimeout(e)},[le]),s.useEffect(()=>{!l||c||S||(oe(),Qs.performHealthCheck().then(e=>{e.issues.length}))},[l,c,S]),s.useEffect(()=>{if(l&&!c&&!S){const e=setTimeout(()=>{S||oe()},1e3);return()=>clearTimeout(e)}},[l,c,S]);const oe=async()=>{try{x(!0),y(null);const e=await Se.get("/transactions/dropdown-options");if(e.ok&&e.data){const s=e.data;if(!s||"object"!=typeof s)throw new Error("Invalid data format received from API");_(s),R(!0)}else e.status,y(`Dropdown seÃ§enekleri yÃ¼klenemedi (Status: ${e.status}). LÃ¼tfen sayfayÄ± yenileyin.`)}catch(e){const s=e?.message||"Bilinmeyen hata",t=e?.status?` (Status: ${e.status})`:"";_(T),R(!0),y(`${a("transactions.add_transaction_form.errors.dropdown_load_failed")} (${s}${t})`),setTimeout(()=>{y(null)},5e3)}finally{x(!1)}},de=(e,s)=>{if(ie(t=>({...t,[e]:s})),"currency"===e&&"USD"===s&&O(!0),"currency"===e||"date"===e){const t={...le,[e]:s};me(t.currency,t.date)}},me=async(e,s)=>{const t=e||le.currency,a=s||le.date;"EUR"!==t&&"USD"!==t||!a?z(!1):(z(!0),await he(a,t))},he=async(e,s)=>{try{if(I("Checking existing rates..."),"EUR"===s){const s=await Gs.fetchRate({date:e,currency_pair:"EUR/TRY"});if("success"===s.status&&s.rate?.rate){const e=s.rate.rate;I(`âœ“ EUR/TRY rate fetched: ${e}`),U({has_rates:!0,eur_rate:e}),ie(s=>({...s,eur_rate:e.toString()}))}else I(`âš  EUR/TRY rate not found for ${e}.`),U({has_rates:!1}),ie(e=>({...e,eur_rate:"0.00"}))}if("USD"===s){const s=await Gs.fetchRate({date:e,currency_pair:"USD/TRY"});if("success"===s.status&&s.rate?.rate){const e=s.rate.rate;I(`âœ“ USD/TRY rate fetched: ${e}`),ie(s=>({...s,usd_rate:e.toString()}))}else I(`âš  USD/TRY rate not found for ${e}.`),ie(e=>({...e,usd_rate:"0.00"}))}}catch(t){I(`âœ— Error: ${t}`)}},ue=()=>{d("/clients")};return c||m?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsx(_e,{className:"max-w-sm w-full text-center",variant:"elevated",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(r,{className:"h-8 w-8 text-blue-600 animate-spin"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:a("transactions.add_transaction_form.loading_form")}),e.jsx("p",{className:"text-gray-600",children:a("transactions.add_transaction_form.loading_message")})]})]})})}):f?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsx(_e,{className:"max-w-md w-full text-center",variant:"elevated",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(k,{className:"h-10 w-10 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:a("transactions.add_transaction_form.success_title")}),e.jsx("p",{className:"text-gray-600",children:a("transactions.add_transaction_form.success_message")})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(ke,{variant:"primary",size:"lg",onClick:()=>d("/clients"),icon:e.jsx(i,{className:"h-4 w-4"}),className:"flex-1",children:a("transactions.add_transaction_form.view_clients")}),e.jsx(ke,{variant:"outline",size:"lg",onClick:()=>{ie({client_name:"",company:"",date:"",amount:"",payment_method:"",currency:"",category:"",psp:"",notes:"",eur_rate:"",usd_rate:""}),N(!1),y(null),R(!1),H(""),localStorage.removeItem(ce),Y("saved")},icon:e.jsx(F,{className:"h-4 w-4"}),className:"flex-1",children:a("transactions.add_transaction_form.add_another")})]})]})})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"flex items-center justify-between h-16",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(ke,{variant:"ghost",size:"sm",onClick:ue,icon:e.jsx(n,{className:"h-4 w-4"}),className:"text-gray-600 hover:text-gray-900",children:a("transactions.add_transaction_form.back_to_transactions")}),e.jsx("div",{className:"h-6 w-px bg-gray-300"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-700 rounded-lg flex items-center justify-center shadow-sm",children:e.jsx(i,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:a("transactions.add_transaction_form.title")}),e.jsx("p",{className:"text-sm text-gray-500",children:a("transactions.add_transaction_form.subtitle")})]})]})]})})})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"space-y-6",children:[p&&e.jsx(_e,{variant:"outlined",className:"border-red-200 bg-red-50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(t,{className:"h-4 w-4 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-red-900",children:a("transactions.add_transaction_form.validation_error")}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:p})]})]})}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),le.client_name.trim())if(!le.amount||parseFloat(le.amount)<=0)y(a("transactions.add_transaction_form.validation.amount_required"));else if(le.date)if(le.currency)if(le.category)if(["WD","DEP"].includes(le.category))if(["TL","USD","EUR"].includes(le.currency))if("EUR"!==le.currency||le.eur_rate)if("USD"!==le.currency||le.usd_rate)try{if(h(!0),y(null),!(await Se.get("/auth/check")).ok&&!(await Se.refreshSession()))return y(a("transactions.add_transaction_form.errors.csrf_error")),void h(!1);let e=null;try{const s=await Se.get("/auth/csrf-token");if(s.ok){const t=await Se.parseResponse(s);t.csrf_token&&(e=t.csrf_token,localStorage.setItem("csrf_token",e))}}catch(s){await Se.refreshSession()&&(e=localStorage.getItem("csrf_token"))}if(!e){if(!(await Se.refreshSession()))return y(a("transactions.add_transaction_form.errors.csrf_error")),void h(!1);e=localStorage.getItem("csrf_token")}const l={...le};"USD"===le.currency&&le.usd_rate&&(l.exchange_rate=le.usd_rate),"EUR"===le.currency&&le.eur_rate&&(l.exchange_rate=le.eur_rate),te&&ee&&parseFloat(ee)>0&&(l.manual_commission_rate=parseFloat(ee),l.use_manual_commission=!0);let i=null,c=0;const o=2;for(;c<=o;)try{if(c>0)try{const s=await Se.get("/auth/csrf-token");if(s.ok){const t=await Se.parseResponse(s);t.csrf_token&&(e=t.csrf_token,localStorage.setItem("csrf_token",e))}}catch(s){}if(i=await Se.post("/transactions/",l),i&&i.ok)break;if(i&&!i.ok&&i.data){const e=i.data;if((403===i.status||400===i.status&&(e.csrf_error||"CSRF validation failed"===e.error||"Invalid CSRF token"===e.error||e.message?.includes("CSRF")||e.message?.includes("Security token")))&&(e.new_token&&localStorage.setItem("csrf_token",e.new_token),c<o))try{if(await Se.refreshSession()){c++,await new Promise(e=>setTimeout(e,500));continue}}catch(t){}}if(i&&(401===i.status||400===i.status||403===i.status)&&c<o){try{await Se.refreshSession()||await Qs.refreshSession()}catch(t){if(c===o-1)return y("Session expired. Please refresh the page and try again."),void h(!1)}c++,await new Promise(e=>setTimeout(e,500));continue}break}catch(r){if(c<o){c++,await new Promise(e=>setTimeout(e,1e3));continue}throw r}if(!i)throw new Error("Failed to get response from server after all retry attempts");if(!i.ok){let e=a("transactions.add_transaction_form.errors.failed_to_add");try{const s=i.data;400!==i.status&&403!==i.status||!(s.csrf_error||"CSRF validation failed"===s.error||s.message?.includes("CSRF")||s.message?.includes("Security token"))?s?.error?.message?e=s.error.message:s?.error?e="string"==typeof s.error?s.error:JSON.stringify(s.error):s?.message?e=s.message:"string"==typeof s&&(e=s):e=s.message||a("transactions.add_transaction_form.errors.csrf_error")}catch(n){}throw new Error(`Server error (${i.status}): ${e}`)}const d=Se.parseResponse(i);if(i.ok&&(d&&"object"==typeof d&&"success"in d&&d.success||d&&"object"==typeof d&&"id"in d||d&&"object"==typeof d&&"transaction"in d)){N(!0),localStorage.removeItem(ce),Y("saved");const e=d?.transaction?.id||d?.id||d?.data?.id;setTimeout(()=>{window.dispatchEvent(new CustomEvent("transactionsUpdated",{detail:{action:"create",transactionId:e}}))},500),ie({client_name:"",company:"",date:"",amount:"",payment_method:"",currency:"",category:"",psp:"",notes:"",eur_rate:"",usd_rate:""}),H("")}else{const e=d?.error?.message||d?.error||d?.message||a("transactions.add_transaction_form.errors.failed_to_add");y(e)}}catch(r){if(r instanceof Error){const e=r.message;e.includes("CSRF")||e.includes("Security token")?y(a("transactions.add_transaction_form.errors.csrf_error")):e.includes("Authentication")||e.includes("login")?y(a("transactions.add_transaction_form.errors.session_expired")):e.includes("401")||e.includes("unauthorized")?y(a("transactions.add_transaction_form.errors.authentication_required")):e.includes("308")||e.includes("redirect")?y(a("transactions.add_transaction_form.errors.url_redirect")):e.includes("404")?y(a("transactions.add_transaction_form.errors.endpoint_not_found")):e.includes("500")?y(a("transactions.add_transaction_form.errors.server_error")):e.includes("403")?y(a("transactions.add_transaction_form.errors.access_denied")):y(`${a("transactions.add_transaction_form.errors.failed_to_add")}: ${e}`)}else y(a("transactions.add_transaction_form.errors.failed_to_add_retry"))}finally{h(!1)}else y(a("transactions.add_transaction_form.validation.usd_rate_required"));else y(a("transactions.add_transaction_form.validation.eur_rate_required"));else y(a("transactions.add_transaction_form.validation.currency_invalid"));else y(a("transactions.add_transaction_form.validation.category_invalid"));else y(a("transactions.add_transaction_form.validation.category_required"));else y(a("transactions.add_transaction_form.validation.currency_required"));else y(a("transactions.add_transaction_form.validation.date_required"));else y(a("transactions.add_transaction_form.validation.client_name_required"))},className:"space-y-6",children:[e.jsx(_e,{header:{title:a("transactions.add_transaction_form.basic_information"),description:a("transactions.add_transaction_form.basic_information_desc")},children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[a("transactions.add_transaction_form.client_name")," *"]}),e.jsxs("div",{className:"relative",children:[e.jsx(j,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",value:le.client_name,onChange:e=>de("client_name",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white",placeholder:a("transactions.add_transaction_form.client_name_placeholder"),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[a("transactions.add_transaction_form.transaction_date")," *"]}),e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"date",value:le.date,onChange:e=>de("date",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[a("transactions.add_transaction_form.amount")," *"]}),e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"0.01",value:le.amount,onChange:e=>de("amount",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white",placeholder:a("transactions.add_transaction_form.amount_placeholder"),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[a("transactions.add_transaction_form.currency")," *"]}),e.jsxs("div",{className:"relative",children:[e.jsx(u,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none z-10"}),e.jsxs("select",{value:le.currency,onChange:e=>de("currency",e.target.value),className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white appearance-none cursor-pointer",required:!0,disabled:!S,children:[e.jsx("option",{value:"",children:a(S?"transactions.add_transaction_form.select_currency":"transactions.add_transaction_form.loading")}),w.currency&&w.currency.length>0?w.currency.map(s=>e.jsx("option",{value:s.value,children:s.value},s.id)):S?[e.jsx("option",{value:"TL",children:"TL"},"TL"),e.jsx("option",{value:"USD",children:"USD"},"USD"),e.jsx("option",{value:"EUR",children:"EUR"},"EUR")]:null]}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})]})}),e.jsx(_e,{header:{title:a("transactions.add_transaction_form.payment_information"),description:a("transactions.add_transaction_form.payment_information_desc")},children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[a("transactions.add_transaction_form.payment_method")," *"]}),e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none z-10"}),e.jsxs("select",{value:le.payment_method,onChange:e=>de("payment_method",e.target.value),className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white appearance-none cursor-pointer",required:!0,disabled:!S,children:[e.jsx("option",{value:"",children:a(S?"transactions.add_transaction_form.select_payment_method":"transactions.add_transaction_form.loading")}),w.payment_method&&w.payment_method.length>0?w.payment_method.map(s=>e.jsx("option",{value:s.value,children:s.value},s.id)):S?[e.jsx("option",{value:"Bank",children:"Bank"},"Bank"),e.jsx("option",{value:"Credit card",children:"Credit card"},"CreditCard"),e.jsx("option",{value:"Tether",children:"Tether"},"Tether")]:null]}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[a("transactions.add_transaction_form.transaction_category")," *"]}),e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none z-10"}),e.jsxs("select",{value:le.category,onChange:e=>de("category",e.target.value),className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white appearance-none cursor-pointer",required:!0,children:[e.jsx("option",{value:"",children:a("transactions.add_transaction_form.select_category")}),e.jsx("option",{value:"WD",children:a("transactions.add_transaction_form.category_wd")}),e.jsx("option",{value:"DEP",children:a("transactions.add_transaction_form.category_dep")})]}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 bg-blue-50 p-2 rounded-lg",children:[e.jsx(b,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{children:a("transactions.add_transaction_form.category_info")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a("transactions.add_transaction_form.psp_kasa")}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none z-10"}),e.jsxs("select",{value:le.psp,onChange:e=>de("psp",e.target.value),className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white appearance-none cursor-pointer",disabled:!S,children:[e.jsx("option",{value:"",children:a(S?"transactions.add_transaction_form.select_psp_kasa":"transactions.add_transaction_form.loading")}),w.psp&&w.psp.length>0?w.psp.map(s=>e.jsx("option",{value:s.value,children:s.value},s.id)):null]}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})]})}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:a("transactions.add_transaction_form.manual_commission")}),te&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-green-700 bg-green-100 rounded-full",children:[e.jsx(k,{className:"h-3 w-3"}),a("transactions.add_transaction_form.active")]})]}),te?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",step:"0.01",value:ee,onChange:e=>se(e.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:a("transactions.add_transaction_form.commission_percent")}),e.jsx("button",{type:"button",onClick:()=>{ae(!1),J(!1),X(""),se(""),ne("")},className:"px-3 py-2 text-sm font-medium text-gray-600 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:a("transactions.add_transaction_form.disable")})]}),e.jsx("p",{className:"text-xs text-gray-500",children:a("transactions.add_transaction_form.commission_override_info")})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"password",value:Z,onChange:e=>X(e.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:a("transactions.add_transaction_form.security_code")}),e.jsx("button",{type:"button",onClick:()=>{"4561"===Z?(ae(!0),ne(""),J(!0)):(ne(a("transactions.add_transaction_form.invalid_security_code")),ae(!1))},className:"px-3 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:ring-1 focus:ring-blue-500",children:a("transactions.add_transaction_form.enable")})]}),re&&e.jsx("p",{className:"text-xs text-red-600",children:re})]})]}),e.jsx(_e,{header:{title:a("transactions.add_transaction_form.company_information"),description:a("transactions.add_transaction_form.company_information_desc")},children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a("transactions.add_transaction_form.company")}),e.jsxs("div",{className:"relative",children:[e.jsx(W,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none z-10"}),e.jsxs("select",{value:le.company,onChange:e=>de("company",e.target.value),className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white appearance-none cursor-pointer",disabled:!S,children:[e.jsx("option",{value:"",children:a(S?"transactions.add_transaction_form.select_company":"transactions.add_transaction_form.loading")}),w.company&&w.company.length>0?w.company.map(s=>e.jsx("option",{value:s.value,children:s.value},s.id)):null]}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})}),e.jsx(_e,{header:{title:a("transactions.add_transaction_form.additional_information"),description:a("transactions.add_transaction_form.additional_information_desc")},children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a("transactions.add_transaction_form.transaction_notes")}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx("textarea",{value:le.notes,onChange:e=>de("notes",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white resize-none",placeholder:a("transactions.add_transaction_form.notes_placeholder"),rows:4})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 bg-gray-50 p-2 rounded-lg",children:[e.jsx(b,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:a("transactions.add_transaction_form.notes_info")})]})]})}),L&&e.jsx(_e,{variant:"outlined",className:"border-amber-200 bg-amber-50",header:{title:a("transactions.add_transaction_form.exchange_rates_required"),description:a("transactions.add_transaction_form.exchange_rates_desc")},children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-amber-100 border border-amber-200 rounded-lg",children:[e.jsx(t,{className:"h-5 w-5 text-amber-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-800 font-medium",children:a("transactions.add_transaction_form.exchange_rates_warning")}),e.jsx("p",{className:"text-amber-700 text-sm mt-1",children:a("transactions.add_transaction_form.exchange_rates_warning_desc")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:["EUR"===le.currency&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a("transactions.add_transaction_form.eur_to_tl_rate")}),e.jsxs("div",{className:"relative",children:[e.jsx(E,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"0.0001",min:"0",value:le.eur_rate,onChange:e=>de("eur_rate",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white",placeholder:a("transactions.add_transaction_form.rate_placeholder"),required:"EUR"===le.currency})]}),e.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-2 rounded-lg",children:a("transactions.add_transaction_form.rate_auto_fetch_info")})]}),"USD"===le.currency&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a("transactions.add_transaction_form.usd_to_tl_rate")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(E,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"0.0001",min:"0",value:le.usd_rate,onChange:e=>de("usd_rate",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white",placeholder:a("transactions.add_transaction_form.rate_placeholder")})]}),e.jsx(ke,{type:"button",variant:"success",size:"sm",onClick:()=>O(!0),icon:e.jsx(C,{className:"h-4 w-4"}),children:a("transactions.add_transaction_form.get_rate")}),e.jsx(ke,{type:"button",variant:"outline",size:"sm",onClick:()=>{const e=parseFloat(le.amount||"0"),s=parseFloat(le.usd_rate||"0");!isNaN(e)&&!isNaN(s)&&s>0?H((e*s).toFixed(2)):H("")},icon:e.jsx(r,{className:"h-4 w-4"}),children:a("transactions.add_transaction_form.apply")})]}),B&&e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-green-800",children:[e.jsxs("strong",{children:[a("transactions.add_transaction_form.converted_tl_amount"),":"]})," ",B]})}),e.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-2 rounded-lg",children:a("transactions.add_transaction_form.rate_auto_fetch_info")})]})]}),M&&e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(b,{className:"h-5 w-5 text-blue-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-800 font-medium",children:a("transactions.add_transaction_form.rate_validation")}),e.jsx("p",{className:"text-blue-700 text-sm",children:M})]})]})})]})}),e.jsx(_e,{className:"bg-gray-50",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(ke,{type:"button",variant:"outline",size:"lg",onClick:ue,className:"flex-1",icon:e.jsx(D,{className:"h-4 w-4"}),children:a("transactions.add_transaction_form.cancel")}),e.jsx(ke,{type:"submit",variant:"primary",size:"lg",disabled:g,loading:g,className:"flex-1",icon:e.jsx(A,{className:"h-4 w-4"}),children:a(g?"transactions.add_transaction_form.adding_transaction":"transactions.add_transaction_form.add_transaction")})]})})]}),e.jsx(_e,{header:{title:a("transactions.add_transaction_form.dropdown_management"),description:a("transactions.add_transaction_form.dropdown_management_desc")},children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(ke,{variant:"success",size:"lg",onClick:()=>d("/settings?tab=dropdowns"),icon:e.jsx(v,{className:"h-4 w-4"}),className:"mx-auto",children:a("transactions.add_transaction_form.manage_dropdown_options")}),e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3 text-left",children:[e.jsx(b,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-blue-900 mb-1",children:a("transactions.add_transaction_form.customize_dropdown_title")}),e.jsx("p",{className:"text-blue-800",children:a("transactions.add_transaction_form.customize_dropdown_desc")})]})]})})]})})]})}),e.jsx(As,{isOpen:P,onClose:()=>O(!1),onRateSelect:e=>{ie(s=>({...s,usd_rate:e.toString()})),O(!1)},currentAmount:parseFloat(le.amount)||0,transactionDate:le.date})]})}},Symbol.toStringTag,{value:"Module"})),Xs=Object.freeze(Object.defineProperty({__proto__:null,default:function(){return e.jsx("div",{className:"p-6",children:e.jsx(Ae,{theme:"slate-blue",minHeightScreen:!0,children:e.jsx(ws,{})})})}},Symbol.toStringTag,{value:"Module"})),et=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{Pe();const[t,a]=s.useState(!1);return s.useEffect(()=>{window.scrollTo({top:0,behavior:"instant"})},[]),e.jsxs("div",{className:"p-6 animate-in fade-in duration-300",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(he,{className:"h-8 w-8 text-gray-600"}),"AI Assistant"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Ask questions and get intelligent insights about your business"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-semibold "+(t?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"),children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full "+(t?"bg-yellow-500":"bg-green-500 animate-pulse")}),t?"Paused":"Active"]}),e.jsx(es,{variant:"outline",size:"sm",onClick:()=>{a(!t)},className:"h-8 w-8 p-0",title:t?"Resume":"Pause","aria-label":t?"Resume AI assistant":"Pause AI assistant",children:t?e.jsx(ue,{className:"w-4 h-4","aria-hidden":"true"}):e.jsx(pe,{className:"w-4 h-4","aria-hidden":"true"})}),e.jsx(es,{variant:"outline",size:"sm",onClick:()=>{a(!1)},className:"h-8 w-8 p-0",title:"Reset","aria-label":"Reset AI assistant",children:e.jsx(je,{className:"w-4 h-4","aria-hidden":"true"})})]})]})}),e.jsx("div",{className:"rounded-lg overflow-hidden min-h-[calc(100vh-200px)]",children:e.jsx(Te,{apiKey:$e.API_KEY,className:"future-chat-interface h-full"})})]})}},Symbol.toStringTag,{value:"Module"})),st=s.lazy(()=>Fe(()=>import("./pages-systemmonitor-V7hER3rb.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])).catch(s=>({default:()=>e.jsx("div",{className:"p-6 text-red-600",children:"Failed to load System Monitor component"})}))),tt=s.lazy(()=>Fe(()=>import("./DatabaseManagement-BqygyNGA.js"),__vite__mapDeps([8,1,3,2,7,4,5,6])).catch(s=>({default:()=>e.jsx("div",{className:"p-6 text-red-600",children:"Failed to load Database Management component"})}))),at=s.lazy(()=>Fe(()=>import("./SecurityManagement-BSAXkLJN.js"),__vite__mapDeps([9,1,3,2,7,4,5,6])).catch(s=>({default:()=>e.jsx("div",{className:"p-6 text-red-600",children:"Failed to load Security Management component"})}))),rt=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{t:t}=Pe(),a=o(),[n,l]=S(),[i,c]=s.useState("home");s.useEffect(()=>{const e=n.get("view");c("monitor"===e||"database"===e||"security"===e?e:"home")},[n]);const d=e=>{const s=new URLSearchParams(n);"home"===e?s.delete("view"):s.set("view",e),l(s,{replace:!0})};return e.jsx(ks,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx(ss,{title:t("settings.admin"),description:t("settings.system_administration"),icon:_})}),"home"===i&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-all duration-200 hover:border-gray-300 hover:shadow-sm",onClick:()=>a("/admin/organizations"),children:[e.jsx(q,{className:"h-7 w-7 text-blue-600 mb-2"}),e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:"Organizations"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Manage organizations and subscriptions"})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-all duration-200 hover:border-gray-300 hover:shadow-sm",onClick:()=>a("/admin/users"),children:[e.jsx(T,{className:"h-7 w-7 text-green-600 mb-2"}),e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:"Users"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Manage user accounts and permissions"})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-all duration-200 hover:border-gray-300 hover:shadow-sm",onClick:()=>a("/admin/permissions"),children:[e.jsx(_,{className:"h-7 w-7 text-gray-600 mb-2"}),e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:t("settings.permissions")}),e.jsx("p",{className:"text-xs text-gray-500",children:t("settings.configure_access_controls")})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-all duration-200 hover:border-gray-300 hover:shadow-sm",onClick:()=>d("monitor"),children:[e.jsx(ye,{className:"h-7 w-7 text-gray-600 mb-2"}),e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:t("settings.system_monitor")}),e.jsx("p",{className:"text-xs text-gray-500",children:t("settings.realtime_system_monitoring")})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-all duration-200 hover:border-gray-300 hover:shadow-sm",onClick:()=>d("database"),children:[e.jsx(fe,{className:"h-7 w-7 text-gray-600 mb-2"}),e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:t("settings.database")}),e.jsx("p",{className:"text-xs text-gray-500",children:t("settings.database_management")})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-all duration-200 hover:border-gray-300 hover:shadow-sm",onClick:()=>d("security"),children:[e.jsx(_,{className:"h-7 w-7 text-gray-600 mb-2"}),e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:t("settings.security")}),e.jsx("p",{className:"text-xs text-gray-500",children:t("settings.security_config")})]})]}),"home"!==i&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>d("home"),className:"inline-flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:[e.jsx("span",{children:"â†"}),"Back"]}),e.jsx("div",{className:"h-6 w-px bg-gray-300"}),e.jsxs("div",{className:"flex items-center gap-2",children:["monitor"===i&&e.jsx(ye,{className:"h-5 w-5 text-slate-700"}),"database"===i&&e.jsx(fe,{className:"h-5 w-5 text-slate-700"}),"security"===i&&e.jsx(_,{className:"h-5 w-5 text-slate-700"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"monitor"===i?"System Monitor":"database"===i?"Database Management":"Security Management"})]})]}),e.jsx("div",{className:"database"===i?"bg-white rounded-lg border border-gray-200 overflow-hidden p-6":"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsx(ks,{children:e.jsxs(s.Suspense,{fallback:"database"===i?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(r,{className:"h-8 w-8 animate-spin text-slate-700"})}):e.jsx(_s,{}),children:["monitor"===i&&e.jsx(st,{}),"database"===i&&e.jsx(tt,{}),"security"===i&&e.jsx(at,{})]})})})]})]})})}},Symbol.toStringTag,{value:"Module"})),nt=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const[t,a]=s.useState([]),[r,n]=s.useState(!0),[l,i]=s.useState(!1),[c,o]=s.useState(""),[d,m]=s.useState(!1),[x,g]=s.useState(null),[h,u]=s.useState({name:"",slug:"",subscription_tier:"free",max_users:1,max_transactions_per_month:100,max_psp_connections:1,contact_email:""});s.useEffect(()=>{p()},[]);const p=async()=>{try{n(!0);const e=await Ue.get("/organizations"),s=e.data?.organizations||[];a(s)}catch(e){alert(`Failed to fetch organizations: ${e.data?.error||e.message||"Unknown error"}`)}finally{n(!1)}},j=()=>{m(!1),g(null),u({name:"",slug:"",subscription_tier:"free",max_users:1,max_transactions_per_month:100,max_psp_connections:1,contact_email:""})},y=t.filter(e=>e.name.toLowerCase().includes(c.toLowerCase())||e.slug.toLowerCase().includes(c.toLowerCase()));return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto space-y-6",children:[e.jsx(ss,{title:"Organizations",description:"Manage organizations and their subscriptions",icon:q,actions:!d&&e.jsx(ke,{onClick:()=>{g(null),u({name:"",slug:"",subscription_tier:"free",max_users:1,max_transactions_per_month:100,max_psp_connections:1,contact_email:""}),m(!0)},icon:e.jsx(F,{className:"w-4 h-4"}),children:"Create Organization"}),showDivider:!0}),!d&&e.jsx("div",{className:"max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx(We,{type:"text",placeholder:"Search organizations...",value:c,onChange:e=>o(e.target.value),className:"pl-10"})]})}),d&&e.jsxs(_e,{variant:"outlined",className:"border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:x?"Edit Organization":"Create New Organization"}),e.jsx("button",{onClick:j,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",title:"Close",children:e.jsx(D,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{let e;i(!0),e=x?await Ue.put(`/organizations/${x.id}`,h):await Ue.post("/organizations",h),e.data?.success&&alert(`Organization ${x?"updated":"created"} successfully!`),m(!1),g(null),u({name:"",slug:"",subscription_tier:"free",max_users:1,max_transactions_per_month:100,max_psp_connections:1,contact_email:""}),await p()}catch(s){const e=s.data?.error||s.response?.data?.error||s.message||"Failed to save organization",t=s.status||s.response?.status||"Unknown";alert(`Error: ${e}\n\nStatus: ${t}\n\nPlease check:\n1. You are logged in as a Super Admin (admin_level 0 or 1)\n2. The organization name and slug are valid\n3. The slug is unique\n4. Check browser console for more details`)}finally{i(!1)}},className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Organization Name *"}),e.jsx(We,{type:"text",value:h.name,onChange:e=>u({...h,name:e.target.value}),placeholder:"Company ABC",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Slug (URL-friendly) *"}),e.jsx(We,{type:"text",value:h.slug,onChange:e=>u({...h,slug:e.target.value.toLowerCase().replace(/[^a-z0-9-]/g,"")}),placeholder:"company-abc",required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Lowercase letters, numbers, and hyphens only"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subscription Tier"}),e.jsxs(Me,{value:h.subscription_tier,onChange:e=>u({...h,subscription_tier:e.target.value}),children:[e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"starter",children:"Starter"}),e.jsx("option",{value:"pro",children:"Pro"}),e.jsx("option",{value:"enterprise",children:"Enterprise"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Email"}),e.jsx(We,{type:"email",value:h.contact_email,onChange:e=>u({...h,contact_email:e.target.value}),placeholder:"contact@company.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Users"}),e.jsx(We,{type:"number",value:h.max_users,onChange:e=>u({...h,max_users:parseInt(e.target.value)||1}),min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Transactions/Month"}),e.jsx(We,{type:"number",value:h.max_transactions_per_month,onChange:e=>u({...h,max_transactions_per_month:parseInt(e.target.value)||100}),min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max PSP Connections"}),e.jsx(We,{type:"number",value:h.max_psp_connections,onChange:e=>u({...h,max_psp_connections:parseInt(e.target.value)||1}),min:"1"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(ke,{type:"button",variant:"secondary",onClick:j,disabled:l,children:"Cancel"}),e.jsx(ke,{type:"submit",disabled:l,loading:l,icon:l?e.jsx(be,{className:"w-4 h-4 animate-spin"}):e.jsx(A,{className:"w-4 h-4"}),children:x?"Update Organization":"Create Organization"})]})]})]}),!d&&e.jsx(e.Fragment,{children:r?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(be,{className:"w-6 h-6 animate-spin text-gray-400"}),e.jsx("span",{className:"ml-2 text-gray-500",children:"Loading organizations..."})]}):0===y.length?e.jsxs(_e,{variant:"outlined",className:"text-center py-12",children:[e.jsx(q,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 mb-2",children:c?"No organizations found matching your search.":"No organizations yet."}),!c&&e.jsx(ke,{variant:"outline",onClick:()=>m(!0),className:"mt-4",children:"Create Your First Organization"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:y.map(s=>{return e.jsxs(_e,{variant:"outlined",className:"hover:shadow-md transition-all duration-200 border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(q,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.name}),e.jsx("code",{className:"text-xs text-gray-500 bg-gray-50 px-2 py-0.5 rounded mt-1 block",children:s.slug})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>(e=>{g(e),u({name:e.name,slug:e.slug,subscription_tier:e.subscription_tier,max_users:e.max_users,max_transactions_per_month:e.max_transactions_per_month,max_psp_connections:e.max_psp_connections,contact_email:e.contact_email||""}),m(!0)})(s),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Edit",children:e.jsx(ve,{className:"w-4 h-4"})}),1!==s.id&&e.jsx("button",{onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this organization? This action cannot be undone."))try{await Ue.delete(`/organizations/${e}`),p()}catch(s){alert(s.response?.data?.error||"Failed to delete organization")}})(s.id),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete",children:e.jsx(Y,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Tier:"}),(a=s.subscription_tier,e.jsx(Le,{variant:{free:"secondary",starter:"outline",pro:"default",enterprise:"default"}[a]||"secondary",size:"sm",children:a.toUpperCase()}))]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Status:"}),(t=s.subscription_status,e.jsx(Le,{variant:{active:"success",suspended:"warning",cancelled:"destructive"}[t]||"secondary",size:"sm",children:t}))]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(T,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{children:["Max ",s.max_users," users"]})]}),s.contact_email&&e.jsx("div",{className:"text-xs text-gray-500 pt-2 border-t border-gray-100",children:s.contact_email}),e.jsxs("div",{className:"text-xs text-gray-400 pt-2 border-t border-gray-100",children:["Created ",new Date(s.created_at).toLocaleDateString()]})]})]},s.id);var t,a})})})]})}},Symbol.toStringTag,{value:"Module"})),lt=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const[t,a]=s.useState([]),[r,n]=s.useState([]),[l,i]=s.useState(!0),[c,o]=s.useState(!1),[d,m]=s.useState(""),[x,g]=s.useState("all"),[h,u]=s.useState("all"),[p,j]=s.useState(!1),[y,f]=s.useState(null),[b,v]=s.useState({username:"",email:"",password:"",organization_id:"",admin_level:3,role:"user",is_active:!0});s.useEffect(()=>{N(),w()},[]);const N=async()=>{try{i(!0);const e=await Ue.get("/users");a(e.users||[])}catch(e){}finally{i(!1)}},w=async()=>{try{const e=await Ue.get("/organizations"),s=e.data?.organizations||[];n(s)}catch(e){}},k=()=>{j(!1),f(null),v({username:"",email:"",password:"",organization_id:"",admin_level:3,role:"user",is_active:!0})},S=t.filter(e=>{const s=e.username.toLowerCase().includes(d.toLowerCase())||e.email?.toLowerCase().includes(d.toLowerCase())||e.organization_name?.toLowerCase().includes(d.toLowerCase()),t="all"===x||e.organization_id?.toString()===x,a="all"===h||"active"===h&&e.is_active||"inactive"===h&&!e.is_active;return s&&t&&a}),C=[{key:"user",label:"User",render:(s,t)=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.username}),t.email&&e.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1 mt-1",children:[e.jsx(I,{className:"w-3 h-3"}),t.email]})]})},{key:"organization",label:"Organization",render:(s,t)=>t.organization_name?e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-900",children:[e.jsx(q,{className:"w-4 h-4 text-gray-400"}),t.organization_name]}):e.jsx("span",{className:"text-sm text-gray-400",children:"No org"})},{key:"admin_level",label:"Admin Level",render:(s,t)=>{return(a=t.admin_level)<=1?e.jsx(Le,{variant:"destructive",size:"sm",children:"Super Admin"}):2===a?e.jsx(Le,{variant:"info",size:"sm",children:"Org Admin"}):e.jsx(Le,{variant:"secondary",size:"sm",children:"User"});var a}},{key:"status",label:"Status",render:(s,t)=>t.is_active?e.jsxs(Le,{variant:"success",size:"sm",className:"flex items-center gap-1 w-fit",children:[e.jsx(me,{className:"w-3 h-3"}),"Active"]}):e.jsxs(Le,{variant:"destructive",size:"sm",className:"flex items-center gap-1 w-fit",children:[e.jsx(ce,{className:"w-3 h-3"}),"Inactive"]})},{key:"created",label:"Created",render:(s,t)=>e.jsx("span",{className:"text-sm text-gray-500",children:new Date(t.created_at).toLocaleDateString()})},{key:"actions",label:"Actions",render:(s,t)=>e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>(e=>{f(e),v({username:e.username,email:e.email||"",password:"",organization_id:e.organization_id?.toString()||"",admin_level:e.admin_level,role:e.role,is_active:e.is_active}),j(!0)})(t),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Edit",children:e.jsx(ve,{className:"w-4 h-4"})}),t.is_active?e.jsx("button",{onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this user? This action cannot be undone."))try{await Ue.delete(`/users/${e}`),N()}catch(s){alert(s.response?.data?.error||"Failed to delete user")}})(t.id),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete",children:e.jsx(Y,{className:"w-4 h-4"})}):e.jsx("button",{onClick:()=>(async e=>{try{await Ue.post(`/users/${e}/activate`),N()}catch(s){alert(s.response?.data?.error||"Failed to activate user")}})(t.id),className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors",title:"Activate",children:e.jsx(me,{className:"w-4 h-4"})})]})}];return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto space-y-6",children:[e.jsx(ss,{title:"Users",description:"Manage user accounts and permissions",icon:_,actions:!p&&e.jsx(ke,{onClick:()=>{f(null),v({username:"",email:"",password:"",organization_id:"",admin_level:3,role:"user",is_active:!0}),j(!0)},icon:e.jsx(F,{className:"w-4 h-4"}),children:"Create User"}),showDivider:!0}),!p&&e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx(We,{type:"text",placeholder:"Search users...",value:d,onChange:e=>m(e.target.value),className:"pl-10"})]})}),e.jsxs(Me,{value:x,onChange:e=>g(e.target.value),className:"w-full md:w-48",children:[e.jsx("option",{value:"all",children:"All Organizations"}),r.map(s=>e.jsx("option",{value:s.id.toString(),children:s.name},s.id))]}),e.jsxs(Me,{value:h,onChange:e=>u(e.target.value),className:"w-full md:w-40",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),p&&e.jsxs(_e,{variant:"outlined",className:"border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:y?"Edit User":"Create New User"}),e.jsx("button",{onClick:k,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",title:"Close",children:e.jsx(D,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{o(!0);const e={...b,organization_id:b.organization_id?parseInt(b.organization_id):null};if(y)e.password||delete e.password,await Ue.put(`/users/${y.id}`,e);else{if(!e.password)return void alert("Password is required for new users");await Ue.post("/users",e)}k(),N()}catch(s){alert(s.response?.data?.error||"Failed to save user")}finally{o(!1)}},className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username *"}),e.jsx(We,{type:"text",value:b.username,onChange:e=>v({...b,username:e.target.value}),placeholder:"john.doe",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx(We,{type:"email",value:b.email,onChange:e=>v({...b,email:e.target.value}),placeholder:"john@company.com"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Password ",y?"(leave blank to keep current)":"*"]}),e.jsx(We,{type:"password",value:b.password,onChange:e=>v({...b,password:e.target.value}),placeholder:y?"Leave blank to keep current":"Enter password",required:!y})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Organization"}),e.jsxs(Me,{value:b.organization_id,onChange:e=>v({...b,organization_id:e.target.value}),children:[e.jsx("option",{value:"",children:"No Organization"}),r.map(s=>e.jsx("option",{value:s.id.toString(),children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Level"}),e.jsxs(Me,{value:b.admin_level.toString(),onChange:e=>v({...b,admin_level:parseInt(e.target.value)}),children:[e.jsx("option",{value:"0",children:"Super Admin (Level 0)"}),e.jsx("option",{value:"1",children:"Main Admin (Level 1)"}),e.jsx("option",{value:"2",children:"Org Admin (Level 2)"}),e.jsx("option",{value:"3",children:"Regular User (Level 3)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),e.jsxs(Me,{value:b.role,onChange:e=>v({...b,role:e.target.value}),children:[e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"viewer",children:"Viewer"})]})]}),e.jsx("div",{className:"col-span-2",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:b.is_active,onChange:e=>v({...b,is_active:e.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Active"})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(ke,{type:"button",variant:"secondary",onClick:k,disabled:c,children:"Cancel"}),e.jsx(ke,{type:"submit",disabled:c,loading:c,icon:c?e.jsx(be,{className:"w-4 h-4 animate-spin"}):e.jsx(A,{className:"w-4 h-4"}),children:y?"Update User":"Create User"})]})]})]}),!p&&e.jsx(e.Fragment,{children:l?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(be,{className:"w-6 h-6 animate-spin text-gray-400"}),e.jsx("span",{className:"ml-2 text-gray-500",children:"Loading users..."})]}):0===S.length?e.jsxs(_e,{variant:"outlined",className:"text-center py-12",children:[e.jsx(_,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 mb-2",children:d||"all"!==x||"all"!==h?"No users found matching your filters.":"No users yet."}),!d&&"all"===x&&"all"===h&&e.jsx(ke,{variant:"outline",onClick:()=>j(!0),className:"mt-4",children:"Create Your First User"})]}):e.jsx(_e,{variant:"outlined",className:"border-gray-200 overflow-hidden",children:e.jsx(ze,{data:S,columns:C,striped:!0,hover:!0,size:"md"})})})]})}},Symbol.toStringTag,{value:"Module"}));export{Ds as A,Os as C,ks as E,et as F,_s as L,Fs as M,nt as O,Ws as S,Ts as T,Js as U,Cs as a,Es as b,Bs as c,Ys as d,Zs as e,Xs as f,rt as g,lt as h,Rs as u};
