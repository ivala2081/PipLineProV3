import{bk as e,u as t,aH as a,r as s,j as r,aR as i,o as n,x as c}from"./vendor-react-X8uUzP0t.js";import{b as l,a as d}from"./contexts-9IXokeH-.js";import{u as x,d as m,m as o,U as h,f as p,b as g,a as y,l as j}from"./components-modern-DxUcFm15.js";import{x as u,s as b,t as N,u as f,v}from"./components-ui-BYXC3pAy.js";import"./vendor-i18n-DHLiip7K.js";import"./vendor-utils-CtF19A-_.js";import"./vendor-charts-recharts-ipxjOH9-.js";function w(){const{clientName:w}=e(),k=t(),_=a(),{t:C}=l(),{isAuthenticated:T,isLoading:R}=d(),{error:A}=x(),[Y,S]=s.useState(null),[D,P]=s.useState(!0),[L,U]=s.useState("overview"),I=async()=>{const e=(()=>{if(w)try{return decodeURIComponent(w.replace(/\+/g," "))}catch(a){return w}const e=new URLSearchParams(_.search),t=e.get("client_name")||e.get("client")||"";if(t)try{return decodeURIComponent(t.replace(/\+/g," "))}catch(a){return t}return""})();if(!e)return A("Client name is required"),void k("/clients");P(!0);try{const a=await y.get(`/transactions/client-details/${encodeURIComponent(e)}`);if(a.ok){const e=await y.parseResponse(a);if(e.client_name)try{e.client_name=decodeURIComponent(e.client_name)}catch(t){}S(e),j.info("Client details loaded:",e.client_name)}else A("Failed to load client details"),k("/clients")}catch(a){j.error("Error fetching client details:",a),A(a.message||"Failed to load client details"),k("/clients")}finally{P(!1)}};if(s.useEffect(()=>{T&&!R&&I()},[T,R,w,_.search]),D)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-12 h-12 border-4 border-gray-300 border-t-gray-900 rounded-full animate-spin mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Loading client details..."})]})});if(!Y)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-gray-600 mb-4",children:"Client not found"}),r.jsx(m,{onClick:()=>k("/clients"),icon:r.jsx(i,{className:"w-4 h-4"}),children:"Back to Clients"})]})});const{statistics:z,metadata:F,transactions:E}=Y;return r.jsx("div",{className:"min-h-screen bg-gray-50",children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx(u,{items:[{label:C("navigation.dashboard"),href:"/dashboard"},{label:C("navigation.clients"),href:"/clients"},{label:Y.client_name}]}),r.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(m,{variant:"ghost",size:"sm",onClick:()=>k("/clients"),icon:r.jsx(i,{className:"w-4 h-4"}),className:"text-gray-700 hover:text-gray-900",children:"Back"}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-semibold text-gray-900 flex items-center gap-2",children:Y.client_name}),Y.company_name&&r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:Y.company_name})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(m,{variant:"outline",size:"sm",onClick:I,icon:r.jsx(n,{className:"w-4 h-4"}),className:"text-gray-700 border-gray-300 hover:bg-gray-50",children:"Refresh"}),r.jsx(m,{variant:"outline",size:"sm",onClick:()=>k(`/clients?client_name=${encodeURIComponent(Y.client_name)}&tab=clients`),icon:r.jsx(c,{className:"w-4 h-4"}),className:"text-gray-700 border-gray-300 hover:bg-gray-50",children:"Edit"})]})]})]}),r.jsxs(o,{cols:4,gap:"md",className:"mb-6",children:[r.jsx(h,{variant:"flat",className:"border border-gray-200",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Total Volume"}),r.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:p(z.total_amount,"TRY")})]})}),r.jsx(h,{variant:"flat",className:"border border-gray-200",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Total Commission"}),r.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:p(z.total_commission,"TRY")})]})}),r.jsx(h,{variant:"flat",className:"border border-gray-200",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Net Amount"}),r.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:p(z.total_net,"TRY")})]})}),r.jsx(h,{variant:"flat",className:"border border-gray-200",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Transactions"}),r.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:z.transaction_count})]})})]}),r.jsxs(o,{cols:3,gap:"md",className:"mb-6",children:[r.jsx(h,{variant:"flat",className:"border border-gray-200",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Total Deposits"}),r.jsx("p",{className:"text-xl font-semibold text-gray-900",children:p(z.total_deposits,"TRY")})]})}),r.jsx(h,{variant:"flat",className:"border border-gray-200",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Total Withdrawals"}),r.jsx("p",{className:"text-xl font-semibold text-gray-900",children:p(z.total_withdrawals,"TRY")})]})}),r.jsx(h,{variant:"flat",className:"border border-gray-200",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Average Transaction"}),r.jsx("p",{className:"text-xl font-semibold text-gray-900",children:p(z.avg_transaction,"TRY")})]})})]}),r.jsxs(b,{value:L,onValueChange:e=>U(e),className:"w-full",children:[r.jsxs(N,{className:"grid w-full grid-cols-2 bg-white border-b border-gray-200 rounded-none h-auto p-0",children:[r.jsx(f,{value:"overview",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-gray-900 data-[state=active]:bg-transparent data-[state=active]:text-gray-900 py-3 px-4",children:"Overview"}),r.jsxs(f,{value:"transactions",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-gray-900 data-[state=active]:bg-transparent data-[state=active]:text-gray-900 py-3 px-4",children:["Transactions (",E.length,")"]})]}),r.jsx(v,{value:"overview",className:"mt-6",children:r.jsxs(o,{cols:2,gap:"md",children:[r.jsx(h,{variant:"flat",className:"border border-gray-200",header:{title:"Client Information",description:"Payment methods, currencies, and providers"},children:r.jsxs("div",{className:"space-y-5",children:[F.currencies.length>0&&r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Currencies"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:F.currencies.map(e=>r.jsx(g,{variant:"outline",className:"bg-white border-gray-300 text-gray-700",children:e},e))})]}),F.payment_methods.length>0&&r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Payment Methods"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:F.payment_methods.map(e=>r.jsx(g,{variant:"outline",className:"bg-white border-gray-300 text-gray-700",children:e},e))})]}),F.psps.length>0&&r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Payment Service Providers"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:F.psps.map(e=>r.jsx(g,{variant:"outline",className:"bg-white border-gray-300 text-gray-700",children:e},e))})]}),F.categories.length>0&&r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Categories"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:F.categories.map(e=>r.jsx(g,{variant:"outline",className:"bg-white border-gray-300 text-gray-700",children:e},e))})]})]})}),r.jsx(h,{variant:"flat",className:"border border-gray-200",header:{title:"Transaction Timeline",description:"First and last transaction dates"},children:r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"flex items-center gap-3 pb-4 border-b border-gray-100",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"First Transaction"}),r.jsx("p",{className:"text-base font-semibold text-gray-900",children:z.first_transaction?new Date(z.first_transaction).toLocaleDateString():"N/A"})]})}),r.jsx("div",{className:"flex items-center gap-3",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Last Transaction"}),r.jsx("p",{className:"text-base font-semibold text-gray-900",children:z.last_transaction?new Date(z.last_transaction).toLocaleDateString():"N/A"})]})})]})})]})}),r.jsx(v,{value:"transactions",className:"mt-6",children:r.jsx(h,{variant:"flat",className:"border border-gray-200",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-gray-200",children:[r.jsx("th",{className:"text-left py-3 px-4 text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Date"}),r.jsx("th",{className:"text-left py-3 px-4 text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Category"}),r.jsx("th",{className:"text-left py-3 px-4 text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Payment Method"}),r.jsx("th",{className:"text-left py-3 px-4 text-xs font-medium text-gray-500 uppercase tracking-wide",children:"PSP"}),r.jsx("th",{className:"text-right py-3 px-4 text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Amount"}),r.jsx("th",{className:"text-right py-3 px-4 text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Commission"}),r.jsx("th",{className:"text-right py-3 px-4 text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Net Amount"}),r.jsx("th",{className:"text-left py-3 px-4 text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Currency"})]})}),r.jsx("tbody",{children:E.map(e=>r.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50 transition-colors",children:[r.jsx("td",{className:"py-3 px-4 text-sm text-gray-900",children:e.date?new Date(e.date).toLocaleDateString():"N/A"}),r.jsx("td",{className:"py-3 px-4",children:r.jsx(g,{variant:"outline",size:"sm",className:"bg-white border-gray-300 text-gray-700",children:e.category||"N/A"})}),r.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:e.payment_method||"N/A"}),r.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:e.psp||"N/A"}),r.jsx("td",{className:"py-3 px-4 text-sm text-right font-medium text-gray-900",children:p(e.amount,e.currency||"TRY")}),r.jsx("td",{className:"py-3 px-4 text-sm text-right font-medium text-gray-900",children:p(e.commission,e.currency||"TRY")}),r.jsx("td",{className:"py-3 px-4 text-sm text-right font-semibold text-gray-900",children:p(e.net_amount,e.currency||"TRY")}),r.jsx("td",{className:"py-3 px-4",children:r.jsx(g,{variant:"outline",size:"sm",className:"bg-white border-gray-300 text-gray-700",children:e.currency||"TRY"})})]},e.id))})]})})})})]})]})})}export{w as default};
