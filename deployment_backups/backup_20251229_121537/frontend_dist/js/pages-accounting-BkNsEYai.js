import{r as e,u as t,j as s,aK as a,p as n,bf as r,v as i,I as l,i as c,_ as o,S as d,X as m,m as x,n as u,h as g,c as h,C as p,G as y,E as b,x as N,y as f,bg as j,s as v,a as _,bh as w,q as k,R as S,aU as C,a2 as D,b7 as F,Z as $,Y as T,o as U,aY as R,k as L,l as E,bi as Y,bj as M}from"./vendor-react-X8uUzP0t.js";import{u as I}from"./pages-C9OTfaPt.js";import{b as A,a as P}from"./contexts-9IXokeH-.js";import{u as O,a as z,l as K,U as B,f as q,b as J,d as V,k as W,m as H}from"./components-modern-DxUcFm15.js";import{e as G,s as Z,t as Q,u as X,v as ee,d as te,f as se,g as ae,a as ne,B as re,I as ie}from"./components-ui-BYXC3pAy.js";import"./vendor-charts-recharts-ipxjOH9-.js";import"./vendor-utils-CtF19A-_.js";import"./components-trust-CB39-DvV.js";import"./vendor-i18n-DHLiip7K.js";function le(){e.useEffect(()=>{fetch("/api/v1/monitoring/client-log",{method:"POST",keepalive:!0,headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Accounting.tsx:component",message:"Accounting component mounted",data:{timestamp:Date.now()},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"C"})}).catch(()=>{})},[]);const{t:le,currentLanguage:ce}=A(),{isAuthenticated:oe,isLoading:de}=P(),{success:me,error:xe,info:ue}=O();t();const[ge,he]=I("overview"),[pe,ye]=e.useState("all"),[be,Ne]=e.useState("calculator"),[fe,je]=e.useState(null),[ve,_e]=e.useState((new Date).getMonth()+1),[we,ke]=e.useState((new Date).getFullYear()),[Se,Ce]=e.useState("desc"),[De,Fe]=e.useState(null),[$e,Te]=e.useState([]),[Ue,Re]=e.useState(!0),[Le,Ee]=e.useState(null),[Ye,Me]=e.useState(""),[Ie,Ae]=e.useState(""),[Pe,Oe]=e.useState("all"),[ze,Ke]=e.useState("all");e.useState("all"),e.useState(""),e.useState(""),e.useState(""),e.useState(!1),e.useState(!1),e.useState(!1),e.useState(!1),e.useState(null),e.useState([]),e.useState(null),e.useState(!1),e.useState(!1),e.useState("currency_summary");const[Be,qe]=e.useState((new Date).toISOString().slice(0,7)),[Je,Ve]=e.useState([]),[We,He]=e.useState(!1),[Ge,Ze]=e.useState(!1),[Qe,Xe]=e.useState(!1),[et,tt]=e.useState({TRY:""}),[st,at]=e.useState({TRY:0,USD:0,USDT:0});e.useState(()=>{const e=localStorage.getItem("expense_carryover_values");if(e)try{const t=JSON.parse(e);if(t&&"number"==typeof t.TRY&&"number"==typeof t.USD&&"number"==typeof t.USDT)return t}catch(t){}return{TRY:75e4,USD:5e3,USDT:168e3}});const[nt,rt]=e.useState(1),it=50,[lt,ct]=e.useState(!1),[ot,dt]=e.useState(null),[mt,xt]=e.useState(null),[ut,gt]=e.useState(!1),[ht,pt]=e.useState(!1),[yt,bt]=e.useState({description:"",detail:"",category:"inflow",type:"payment",amount:"",mount_currency:"TRY",status:"pending",cost_period:"",payment_date:"",payment_period:"",source:""}),[Nt,ft]=e.useState({amount_try:0,amount_usd:0,amount_usdt:0}),[jt,vt]=e.useState(null),[_t,wt]=e.useState(!1),[kt,St]=e.useState(!0);function Ct({expenses:t,recordToLoad:a,onRecordLoaded:n}){const i=e=>`net_tab_values_${e}`,l=(e,t)=>{try{const s=i(e);localStorage.setItem(s,JSON.stringify(t)),K.info("[Net Tab] Saved values to localStorage for date:",e)}catch(s){K.error("[Net Tab] Failed to save values to localStorage:",s)}},o=e=>{try{const t=i(e),s=localStorage.getItem(t);if(s){const t=JSON.parse(s);return K.info("[Net Tab] Loaded values from localStorage for date:",e),t}}catch(t){K.error("[Net Tab] Failed to load values from localStorage:",t)}return null},[d,x]=e.useState(()=>{const e=localStorage.getItem("net_tab_date");if(e)return K.info("[Net Tab] Loaded date from localStorage:",e),e;const t=(new Date).toISOString().slice(0,10);return K.info("[Net Tab] Initial date set to:",t),t}),g=(()=>{const e=localStorage.getItem("net_tab_date")||(new Date).toISOString().slice(0,10);return o(e)})(),[y,b]=e.useState(()=>g?.expensesUsd||"0"),[N,w]=e.useState(()=>g?.rolloverUsd||"0"),[C,D]=e.useState(()=>g?.netCashUsd||"0"),[F,E]=e.useState(()=>g?.commissionUsd||"0"),[Y,M]=e.useState(()=>g?.oncekiKapanisUsd||"0"),[I,A]=e.useState(()=>g?.companyCashUsd||"0"),[P,O]=e.useState(()=>g?.cryptoBalanceUsd||"0"),[q,J]=e.useState(()=>g?.anlikKasaUsd||"0"),[G,Z]=e.useState(()=>g?.bekleyenTahsilatUsd||"0"),[Q,X]=e.useState(()=>g?.anlikKasaManual||!1),ee=e=>{K.info("[Net Tab] Date being changed to:",e),l(d,{expensesUsd:y,rolloverUsd:N,netCashUsd:C,commissionUsd:F,oncekiKapanisUsd:Y,companyCashUsd:I,cryptoBalanceUsd:P,anlikKasaUsd:q,bekleyenTahsilatUsd:G,anlikKasaManual:Q}),localStorage.setItem("net_tab_date",e),x(e);const t=o(e);t?(b(t.expensesUsd||"0"),w(t.rolloverUsd||"0"),D(t.netCashUsd||"0"),E(t.commissionUsd||"0"),M(t.oncekiKapanisUsd||"0"),A(t.companyCashUsd||"0"),O(t.cryptoBalanceUsd||"0"),J(t.anlikKasaUsd||"0"),Z(t.bekleyenTahsilatUsd||"0"),X(t.anlikKasaManual||!1)):(b("0"),w("0"),D("0"),E("0"),M("0"),A("0"),O("0"),J("0"),Z("0"),X(!1))},[te,se]=e.useState(!1),[ae,ne]=e.useState(""),[re,ce]=e.useState(!1),[oe,de]=e.useState(""),[ge,he]=e.useState(null),[pe,ye]=e.useState(!1),[be,Ne]=e.useState(null),[fe,je]=e.useState(!1),[ve,_e]=e.useState(!1),[we,ke]=e.useState(!1),[Se,Ce]=e.useState(!1),[De,Fe]=e.useState(!1),[$e,Te]=e.useState(!1),[Ue,Re]=e.useState(()=>d?new Date(d):new Date),Le=S.useRef(!0),Ee=async()=>{try{ye(!0),Ne(null);const e=new URLSearchParams({date:d,expenses_usd:y||"0",rollover_usd:N||"0",net_cash_usd:C||"0",commissions_usd:F||"0",onceki_kapanis_usd:Y||"0",company_cash_usd:I||"0",crypto_balance_usd:P||"0",anlik_kasa_usd:q||"0",anlik_kasa_manual:Q?"true":"false",bekleyen_tahsilat_usd:G||"0"}).toString(),t=await z.get(`/accounting/net?${e}`),s=await z.parseResponse(t);s&&s.success?(he(s.data),_e(s.is_saved||!1),!$e&&s.is_saved&&s.data?"0"===C&&"0"===F&&"0"===y&&"0"===N&&"0"===Y&&"0"===I&&"0"===P&&"0"===q&&"0"===G&&(K.info("[fetchNet] Loading saved values from database"),b(String(s.data.expenses_usd||"0")),w(String(s.data.rollover_usd||"0")),D(String(s.data.net_cash_usd||"0")),E(String(s.data.commissions_usd||"0")),M(String(s.data.onceki_kapanis_usd||"0")),A(String(s.data.company_cash_usd||"0")),O(String(s.data.crypto_balance_usd||"0")),J(String(s.data.anlik_kasa_usd||"0")),X(s.data.anlik_kasa_manual||!1),Z(String(s.data.bekleyen_tahsilat_usd||"0"))):$e&&K.info("[fetchNet] Skipping saved value load - just fetched data (protection active)")):Ne(le("accounting.net.calculation_failed"))}catch(e){Ne(e?.message||le("accounting.net.calculation_failed"))}finally{ye(!1)}},Ye=async(e={})=>{try{ye(!0),Ne(null);const t={date:d,expenses_usd:e.expenses_usd??(y||"0"),rollover_usd:e.rollover_usd??(N||"0"),net_cash_usd:e.net_cash_usd??(C||"0"),commissions_usd:e.commissions_usd??(F||"0"),onceki_kapanis_usd:e.onceki_kapanis_usd??(Y||"0"),company_cash_usd:e.company_cash_usd??(I||"0"),crypto_balance_usd:e.crypto_balance_usd??(P||"0"),anlik_kasa_usd:e.anlik_kasa_usd??(q||"0"),bekleyen_tahsilat_usd:e.bekleyen_tahsilat_usd??(G||"0")},s=new URLSearchParams(t).toString(),a=await z.get(`/accounting/net?${s}`),n=await z.parseResponse(a);n&&n.success?(he(n.data),_e(n.is_saved||!1)):Ne(le("accounting.net.calculation_failed"))}catch(t){Ne(t?.message||le("accounting.net.calculation_failed"))}finally{ye(!1)}},Me=async(e=!1)=>{try{Fe(!0),K.info(`[Crypto Balance] ${e?"Auto-fetching":"Fetching"} total balance from all active wallets`);const t=await z.get("/accounting/crypto-balance"),s=await z.parseResponse(t);if(s&&s.success){const t=(s.data.total_usd||0).toFixed(2);K.info(`[Crypto Balance] Total fetched: $${t}`),O(t),_e(!1);const a=(parseFloat(I||"0")+parseFloat(t)).toFixed(2);J(a),e||me(`Crypto Balance Fetched: $${t} (${s.data.wallet_count} wallets)`),Ye({crypto_balance_usd:t,anlik_kasa_usd:a})}else e||xe("Failed to fetch crypto balance")}catch(t){K.error("[Crypto Balance] Failed to fetch:",t),e||xe(t?.message||"Failed to fetch crypto balance")}finally{Fe(!1)}};S.useEffect(()=>{if(Q)return;const e=parseFloat(I||"0"),t=parseFloat(P||"0"),s=(e+t).toFixed(2);q!==s&&(K.info(`[Auto Calculate] Updating Anlik Kasa: ${e} + ${t} = ${s}`),J(s))},[I,P,Q]);const Ie=()=>{"4561"===ae?(X(!0),se(!1),ne(""),_e(!1)):(alert(le("accounting.net.invalid_confirmation_code")||"Invalid confirmation code. Please enter the correct 4-digit code."),ne(""))},Ae=()=>{ce(!0)},Pe=()=>{"4561"===oe?(b("0"),w("0"),D("0"),E("0"),M("0"),A("0"),O("0"),J("0"),Z("0"),X(!1),_e(!1),he(null),ce(!1),de(""),l(d,{expensesUsd:"0",rolloverUsd:"0",netCashUsd:"0",commissionUsd:"0",oncekiKapanisUsd:"0",companyCashUsd:"0",cryptoBalanceUsd:"0",anlikKasaUsd:"0",bekleyenTahsilatUsd:"0",anlikKasaManual:!1}),me(le("accounting.net.all_values_deleted")),setTimeout(()=>Ee(),100)):(alert(le("accounting.net.invalid_confirmation_code")||"Invalid confirmation code. Please enter the correct 4-digit code."),de(""))};e.useEffect(()=>{Le.current?(Le.current=!1,K.info("[Net Tab] Initial mount - fetching net data for date:",d),_e(!1),Ee(),Me(!0)):(K.info("[Net Tab] Date changed to:",d),_e(!1),Ee(),Me(!0))},[d]),e.useEffect(()=>{if(d){const e=new Date(d);Re(new Date(e.getFullYear(),e.getMonth(),1))}},[d]),e.useEffect(()=>{if(a){K.info("[Load Record] Loading record into calculator:",a);const e={expensesUsd:String(a.expenses_usd||"0"),rolloverUsd:String(a.rollover_usd||"0"),netCashUsd:String(a.net_cash_usd||"0"),commissionUsd:String(a.commissions_usd||"0"),oncekiKapanisUsd:String(a.onceki_kapanis_usd||"0"),companyCashUsd:String(a.company_cash_usd||"0"),cryptoBalanceUsd:String(a.crypto_balance_usd||"0"),anlikKasaUsd:String(a.anlik_kasa_usd||"0"),bekleyenTahsilatUsd:String(a.bekleyen_tahsilat_usd||"0"),anlikKasaManual:a.anlik_kasa_manual||!1};l(a.date,e),ee(a.date),_e(!1),n(),me(`Loaded record for ${a.date}`)}},[a]),e.useEffect(()=>{if(Le.current)return;const e=setTimeout(()=>{l(d,{expensesUsd:y,rolloverUsd:N,netCashUsd:C,commissionUsd:F,oncekiKapanisUsd:Y,companyCashUsd:I,cryptoBalanceUsd:P,anlikKasaUsd:q,bekleyenTahsilatUsd:G,anlikKasaManual:Q})},500);return()=>clearTimeout(e)},[d,y,N,C,F,Y,I,P,q,G,Q]),e.useEffect(()=>{if(!ge||ve)return;const e=setInterval(async()=>{if(ge&&!ve)try{K.info("[Auto-save] Saving draft to database..."),await saveNetCalculation(),ue("Draft auto-saved successfully")}catch(e){K.error("[Auto-save] Failed to save draft:",e)}},9e5);return()=>clearInterval(e)},[ge,ve]);const Oe=e=>{Re(t=>{const s=new Date(t);return"prev"===e?s.setMonth(t.getMonth()-1):s.setMonth(t.getMonth()+1),s})},ze=d?new Date(d):new Date,Ke=(Be=Ue,new Date(Be.getFullYear(),Be.getMonth()+1,0).getDate());var Be;const qe=(e=>new Date(e.getFullYear(),e.getMonth(),1).getDay())(Ue),Je=Ue.toLocaleDateString("en-US",{month:"long",year:"numeric"}),Ve=[];for(let e=0;e<qe;e++)Ve.push(null);for(let e=1;e<=Ke;e++)Ve.push(e);return e.useEffect(()=>{const e=e=>{const t=e.target;we&&!t.closest(".calendar-container")&&ke(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[we]),s.jsxs("div",{className:"space-y-5",children:[s.jsx(B,{variant:"flat",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center justify-between gap-6",children:[s.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[s.jsx("div",{className:"p-2.5 bg-gray-100 rounded-lg",children:s.jsx(c,{className:"h-5 w-5 text-gray-700"})}),s.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[s.jsxs("div",{className:"min-w-[140px]",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-0.5",children:le("accounting.net.calculation_date")}),s.jsx("p",{className:"text-xs text-gray-500",children:le("accounting.net.calculation_date_desc")})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"relative calendar-container",children:[s.jsxs("div",{className:"relative",children:[s.jsx(ie,{type:"date",value:d,onChange:e=>ee(e.target.value),className:"w-[200px] pl-3 pr-10 py-2.5 text-sm border border-gray-200 rounded-lg bg-white text-gray-900 placeholder:text-gray-400 focus:outline-none transition-all [&::-webkit-calendar-picker-indicator]:hidden [&::-webkit-calendar-picker-indicator]:appearance-none [&::-webkit-inner-spin-button]:hidden [&::-webkit-outer-spin-button]:hidden",style:{colorScheme:"light"}}),s.jsx("button",{type:"button",onClick:()=>ke(!we),className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 hover:bg-gray-100 rounded transition-colors",children:s.jsx(c,{className:"h-4 w-4 text-gray-400"})})]}),we&&s.jsxs("div",{className:"absolute z-50 mt-2 bg-white border border-gray-200 rounded-xl shadow-xl p-4 w-72",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("button",{type:"button",onClick:()=>Oe("prev"),className:"p-1.5 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(v,{className:"h-4 w-4 text-gray-600"})}),s.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:Je}),s.jsx("button",{type:"button",onClick:()=>Oe("next"),className:"p-1.5 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(_,{className:"h-4 w-4 text-gray-600"})})]}),s.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>s.jsx("div",{className:"text-xs font-medium text-gray-500 text-center py-1",children:e},e))}),s.jsx("div",{className:"grid grid-cols-7 gap-1",children:Ve.map((e,t)=>{if(null===e)return s.jsx("div",{className:"h-8"},t);const a=ze.getFullYear()===Ue.getFullYear()&&ze.getMonth()===Ue.getMonth()&&ze.getDate()===e,n=(new Date).getFullYear()===Ue.getFullYear()&&(new Date).getMonth()===Ue.getMonth()&&(new Date).getDate()===e;return s.jsx("button",{type:"button",onClick:()=>(e=>{const t=new Date(Ue.getFullYear(),Ue.getMonth(),e);ee((e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`)(t)),ke(!1)})(e),className:"h-8 text-sm rounded-lg transition-colors "+(a?"bg-gray-900 text-white font-semibold":n?"bg-gray-100 text-gray-900 font-medium border border-gray-300":"text-gray-700 hover:bg-gray-50"),children:e},t)})})]})]}),s.jsx(V,{variant:"outline",size:"sm",onClick:()=>{const e=(new Date).toISOString().slice(0,10);ee(e),K.info("[Today Button] Date set to today:",e)},disabled:Se,className:"whitespace-nowrap border-gray-300 text-gray-700 hover:bg-gray-50",icon:s.jsx(c,{className:"h-4 w-4"}),iconPosition:"left",children:le("accounting.net.today")}),s.jsx(V,{variant:"outline",size:"sm",onClick:Ae,className:"whitespace-nowrap text-red-600 hover:text-red-700 hover:border-red-300 border-red-300",icon:s.jsx(f,{className:"h-4 w-4"}),iconPosition:"left",children:"Delete"}),s.jsx(V,{variant:"primary",size:"sm",onClick:async()=>{if(!d)return void xe(le("accounting.net.error_no_date"));Ce(!0),K.info(`[Fetch All] Starting auto-fetch for date: ${d}`);const e={expenses:{success:!1,value:"0",message:""},netCash:{success:!1,value:"0",message:""},commission:{success:!1,value:"0",message:""}};try{const s=t.filter(e=>e.payment_date===d&&"paid"===e.status);if(0===s.length)e.expenses={success:!0,value:"0",message:le("accounting.net.info_no_expenses_found")},b("0");else{const t=s.reduce((e,t)=>e+(t.amount_usd||0),0).toFixed(2);e.expenses={success:!0,value:t,message:`${s.length} expense(s): $${t}`},b(t),K.info(`[Fetch All] Expenses state updated to: $${t}`)}}catch(a){e.expenses={success:!1,value:"0",message:"Failed to fetch expenses"},b("0"),K.error("[Fetch All] Expenses fetch failed:",a)}try{const t=localStorage.getItem("pipeline_transactions_data");if(t){const s=JSON.parse(t).filter(e=>e.date===d);if(0===s.length)e.netCash={success:!0,value:"0",message:le("accounting.net.info_no_transactions_for_date")},D("0");else{let t=41.7;try{const e=await z.get(`/api/v1/exchange-rates/historical?date=${d}&pair=USDTRY`),s=await z.parseResponse(e);s&&s.rate&&!isNaN(parseFloat(s.rate))&&(t=parseFloat(s.rate))}catch(a){}let n=0;s.forEach(e=>{const s=e.amount||0,a=e.currency||"TL";let r=0;"USD"===a?r=s:"TL"===a||"TRY"===a?r=s/t:"EUR"===a&&(r=1.1*s),n+=r});const r=n.toFixed(2);e.netCash={success:!0,value:r,message:`${s.length} transaction(s): $${r}`},D(r),K.info(`[Fetch All] Net Cash state updated to: $${r}`)}}else e.netCash={success:!0,value:"0",message:le("accounting.net.info_no_transactions_found")},D("0")}catch(a){e.netCash={success:!1,value:"0",message:"Failed to fetch net cash"},D("0"),K.error("[Fetch All] Net cash fetch failed:",a)}try{const t=localStorage.getItem("pipeline_transactions_data");if(t){const s=JSON.parse(t).filter(e=>e.date===d);if(0===s.length)e.commission={success:!0,value:"0",message:le("accounting.net.info_no_transactions_for_date")},E("0");else{let t=41.7;try{const e=await z.get(`/api/v1/exchange-rates/historical?date=${d}&pair=USDTRY`),s=await z.parseResponse(e);s&&s.rate&&!isNaN(parseFloat(s.rate))&&(t=parseFloat(s.rate))}catch(a){}let n=0,r=0;s.forEach(e=>{const s=e.commission||0,a=e.currency||"TL";if(0===s)return;r++;let i=0;"USD"===a?i=Math.abs(s):"TL"===a||"TRY"===a?i=Math.abs(s)/t:"EUR"===a&&(i=1.1*Math.abs(s)),n+=i});const i=n.toFixed(2);e.commission={success:!0,value:i,message:`${r} txn(s) with commission: $${i}`},E(i),K.info(`[Fetch All] Commission state updated to: $${i}`)}}else e.commission={success:!0,value:"0",message:le("accounting.net.info_no_transactions_found")},E("0")}catch(a){e.commission={success:!1,value:"0",message:"Failed to fetch commission"},E("0"),K.error("[Fetch All] Commission fetch failed:",a)}Ce(!1),_e(!1),Te(!0),K.info("[Fetch All] Protection flag SET - values will be protected from overwrite");const s=[e.expenses.success,e.netCash.success,e.commission.success].filter(Boolean).length;if(K.info("[Fetch All] Completed:",e),K.info("[Fetch All] Final state values that were SET:",{expensesUsd:e.expenses.value,netCashUsd:e.netCash.value,commissionUsd:e.commission.value}),Ye({expenses_usd:e.expenses.value,net_cash_usd:e.netCash.value,commissions_usd:e.commission.value}),setTimeout(()=>{Te(!1),K.info("[Fetch All] Protection flag cleared")},500),3===s){const t=[`✓ Expenses: ${e.expenses.message}`,`✓ Net Cash: ${e.netCash.message}`,`✓ Commission: ${e.commission.message}`];me(`${le("accounting.net.fetch_all_success")}\n${t.join("\n")}\n\n${le("accounting.net.click_calculate_to_proceed")}`)}else if(s>0){const t=[],s=[];e.expenses.success?t.push(`✓ Expenses: ${e.expenses.message}`):s.push(`✗ Expenses: ${e.expenses.message}`),e.netCash.success?t.push(`✓ Net Cash: ${e.netCash.message}`):s.push(`✗ Net Cash: ${e.netCash.message}`),e.commission.success?t.push(`✓ Commission: ${e.commission.message}`):s.push(`✗ Commission: ${e.commission.message}`),ue(`${le("accounting.net.fetch_all_partial")}\n${t.join("\n")}\n${s.join("\n")}\n\n${le("accounting.net.click_calculate_to_proceed")}`)}else xe(`${le("accounting.net.fetch_all_failed")}\n✗ Expenses: ${e.expenses.message}\n✗ Net Cash: ${e.netCash.message}\n✗ Commission: ${e.commission.message}`)},disabled:Se||!d,className:"whitespace-nowrap",icon:s.jsx(u,{className:"h-4 w-4 "+(Se?"animate-pulse":"")}),iconPosition:"left",children:le(Se?"accounting.net.fetching_all":"accounting.net.fetch_all")})]})]})]}),ve&&s.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-green-50 border border-green-200 rounded-lg",children:[s.jsx(h,{className:"h-4 w-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-700",children:le("accounting.net.saved")})]})]})})}),be&&s.jsx(B,{variant:"flat",children:s.jsx("div",{className:"p-4 bg-red-50 border-l-4 border-red-500",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx($,{className:"h-5 w-5 text-red-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-semibold text-red-900",children:le("accounting.net.calculation_error")}),s.jsx("p",{className:"text-sm text-red-700 mt-1",children:be})]})]})})}),s.jsx(B,{variant:"elevated",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:s.jsx(r,{className:"h-5 w-5 text-gray-700"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-base font-semibold text-gray-900",children:le("accounting.net.transaction_data")}),s.jsx("p",{className:"text-xs text-gray-500",children:le("accounting.net.transaction_data_desc")})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 uppercase tracking-wider",children:le("accounting.net.expenses")}),s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"$"}),s.jsx(ie,{type:"number",value:y,onChange:e=>{b(e.target.value),_e(!1),Te(!1)},onBlur:()=>{$e||Ee()},className:"pl-8 pr-12 h-11 border-gray-200 focus:outline-none",placeholder:"0.00"}),s.jsx("button",{type:"button",onClick:()=>{try{if(Ce(!0),K.info(`[Expenses Fetch] Starting for date: ${d}`),!d)return xe(le("accounting.net.error_no_date")),void K.error("[Expenses Fetch] No date selected");const e=t.filter(e=>e.payment_date===d&&"paid"===e.status);if(K.info(`[Expenses Fetch] Found ${e.length} paid expenses for ${d}`),0===e.length)return ue(le("accounting.net.info_no_expenses_found")),K.info("[Expenses Fetch] No paid expenses found for this date"),b("0"),_e(!1),Te(!0),void setTimeout(()=>Ee(),100);const s=e.reduce((e,t)=>{const s=t.amount_usd||0;return isNaN(s)||s<0?(K.warn(`[Expenses Fetch] Invalid amount for expense ID ${t.id}: ${s}`),e):e+s},0);if(isNaN(s))return xe(le("accounting.net.error_invalid_calculation")),void K.error("[Expenses Fetch] Calculated total is NaN");const a=s.toFixed(2);K.info(`[Expenses Fetch] Total calculated: $${a}`),b(String(a)),_e(!1),Te(!0),s>0?me(`${le("accounting.net.success_expenses_fetched")}: $${a}`):ue(`${le("accounting.net.info_expenses_zero")}: $${a}`),Ye({expenses_usd:a}),setTimeout(()=>{Te(!1),K.info("[Expenses Fetch] Protection flag cleared")},500)}catch(e){const s=e?.message||"Unknown error";K.error("[Expenses Fetch] Failed to calculate daily expenses:",{error:s,date:d,expensesCount:t.length}),xe(le("accounting.net.error_fetch_expenses"))}finally{Ce(!1)}},disabled:Se,className:"absolute right-3 top-1/2 -translate-y-1/2 p-1.5 hover:bg-gray-100 rounded transition-colors disabled:opacity-50",title:le("accounting.net.auto_fill_expenses"),children:s.jsx(u,{className:"h-4 w-4 text-gray-600 "+(Se?"animate-pulse":"")})})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1.5",children:le("accounting.net.expenses_desc")})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 uppercase tracking-wider",children:le("accounting.net.rollover_collection")}),s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"$"}),s.jsx(ie,{type:"number",value:N,onChange:e=>{w(e.target.value),_e(!1)},onBlur:Ee,className:"pl-8 h-11 border-gray-200 focus:outline-none",placeholder:"0.00"})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1.5",children:le("accounting.net.rollover_collection_desc")})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 uppercase tracking-wider",children:le("accounting.net.net_cash_override")}),s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"$"}),s.jsx(ie,{type:"number",value:C,onChange:e=>{D(e.target.value),_e(!1),Te(!1)},onBlur:()=>{$e||Ee()},className:"pl-8 pr-12 h-11 border-gray-200 focus:outline-none",placeholder:"0.00"}),s.jsx("button",{type:"button",onClick:async()=>{try{if(Ce(!0),K.info(`[Net Cash Fetch] Starting for date: ${d}`),!d)return xe(le("accounting.net.error_no_date")),void K.error("[Net Cash Fetch] No date selected");const s=localStorage.getItem("pipeline_transactions_data");if(!s)return ue(le("accounting.net.info_no_transactions_found")),K.info("[Net Cash Fetch] No transactions found in localStorage"),D("0"),_e(!1),Te(!0),void setTimeout(()=>Ee(),100);let a;try{if(a=JSON.parse(s),!Array.isArray(a))throw new Error("Invalid transactions data format")}catch(e){return xe(le("accounting.net.error_invalid_data")),void K.error("[Net Cash Fetch] Failed to parse transactions:",e)}const n=a.filter(e=>e.date===d);if(K.info(`[Net Cash Fetch] Found ${n.length} transactions for ${d}`),0===n.length)return ue(le("accounting.net.info_no_transactions_for_date")),K.info("[Net Cash Fetch] No transactions found for this date"),D("0"),_e(!1),Te(!0),void setTimeout(()=>Ee(),100);let r=41.7,i="default";try{const e=await z.get(`/api/v1/exchange-rates/historical?date=${d}&pair=USDTRY`),t=await z.parseResponse(e);t&&t.rate&&(r=parseFloat(t.rate),isNaN(r)||r<=0?(K.warn("[Net Cash Fetch] Invalid exchange rate from API, using default"),r=41.7):i="api")}catch(t){K.warn("[Net Cash Fetch] Failed to fetch exchange rate, using default:",r),ue(le("accounting.net.info_using_default_rate"))}K.info(`[Net Cash Fetch] Using exchange rate: ${r} (source: ${i})`);let l=0,c=0;if(n.forEach(e=>{const t=e.amount||0,s=e.currency||"TL";if(isNaN(t))return c++,void K.warn("[Net Cash Fetch] Invalid amount in transaction:",e);let a=0;if("USD"===s)a=t;else if("TL"===s||"TRY"===s)a=t/r;else{if("EUR"!==s)return K.warn(`[Net Cash Fetch] Unknown currency: ${s}, skipping transaction`),void c++;a=1.1*t}l+=a}),c>0&&K.warn(`[Net Cash Fetch] Skipped ${c} invalid transactions`),isNaN(l))return xe(le("accounting.net.error_invalid_calculation")),void K.error("[Net Cash Fetch] Calculated total is NaN");const o=l.toFixed(2);K.info(`[Net Cash Fetch] Calculated Total USD (gross): $${o}`),D(String(o)),_e(!1),Te(!0),0!==l?me(`${le("accounting.net.success_net_cash_fetched")}: $${o} (${n.length} transactions)`):ue(`${le("accounting.net.info_net_cash_zero")}: ${n.length} transactions found but total is $0.00`),Ye({net_cash_usd:o}),setTimeout(()=>{Te(!1),K.info("[Net Cash Fetch] Protection flag cleared")},500)}catch(t){const e=t?.message||"Unknown error";K.error("[Net Cash Fetch] Failed to calculate daily net cash:",{error:e,date:d}),xe(le("accounting.net.error_fetch_net_cash"))}finally{Ce(!1)}},disabled:Se,className:"absolute right-3 top-1/2 -translate-y-1/2 p-1.5 hover:bg-gray-100 rounded transition-colors disabled:opacity-50",title:le("accounting.net.auto_fill_net_cash"),children:s.jsx(u,{className:"h-4 w-4 text-gray-600 "+(Se?"animate-pulse":"")})})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1.5",children:le("accounting.net.net_cash_override_desc")})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 uppercase tracking-wider",children:le("accounting.net.commission_override")}),s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"$"}),s.jsx(ie,{type:"number",value:F,onChange:e=>{E(e.target.value),_e(!1),Te(!1)},onBlur:()=>{$e||Ee()},className:"pl-8 pr-12 h-11 border-gray-200 focus:outline-none",placeholder:"0.00"}),s.jsx("button",{type:"button",onClick:async()=>{try{if(Ce(!0),K.info(`[Commission Fetch] Starting for date: ${d}`),!d)return xe(le("accounting.net.error_no_date")),void K.error("[Commission Fetch] No date selected");const s=localStorage.getItem("pipeline_transactions_data");if(!s)return ue(le("accounting.net.info_no_transactions_found")),K.info("[Commission Fetch] No transactions found in localStorage"),E("0"),_e(!1),Te(!0),void setTimeout(()=>Ee(),100);let a;try{if(a=JSON.parse(s),!Array.isArray(a))throw new Error("Invalid transactions data format")}catch(e){return xe(le("accounting.net.error_invalid_data")),void K.error("[Commission Fetch] Failed to parse transactions:",e)}const n=a.filter(e=>e.date===d);if(K.info(`[Commission Fetch] Found ${n.length} transactions for ${d}`),0===n.length)return ue(le("accounting.net.info_no_transactions_for_date")),K.info("[Commission Fetch] No transactions found for this date"),E("0"),_e(!1),Te(!0),void setTimeout(()=>Ee(),100);let r=41.7,i="default";try{const e=await z.get(`/api/v1/exchange-rates/historical?date=${d}&pair=USDTRY`),t=await z.parseResponse(e);t&&t.rate&&(r=parseFloat(t.rate),isNaN(r)||r<=0?(K.warn("[Commission Fetch] Invalid exchange rate from API, using default"),r=41.7):i="api")}catch(t){K.warn("[Commission Fetch] Failed to fetch exchange rate, using default:",r),ue(le("accounting.net.info_using_default_rate"))}K.info(`[Commission Fetch] Using exchange rate: ${r} (source: ${i})`);let l=0,c=0,o=0;if(n.forEach(e=>{const t=e.commission||0,s=e.currency||"TL";if(isNaN(t))return c++,void K.warn("[Commission Fetch] Invalid commission in transaction:",e);if(0===t)return;o++;let a=0;if("USD"===s)a=Math.abs(t);else if("TL"===s||"TRY"===s)a=Math.abs(t)/r;else{if("EUR"!==s)return K.warn(`[Commission Fetch] Unknown currency: ${s}, skipping transaction`),void c++;a=1.1*Math.abs(t)}l+=a}),c>0&&K.warn(`[Commission Fetch] Skipped ${c} invalid transactions`),K.info(`[Commission Fetch] ${o} transactions had commissions out of ${n.length}`),isNaN(l))return xe(le("accounting.net.error_invalid_calculation")),void K.error("[Commission Fetch] Calculated total is NaN");const m=l.toFixed(2);K.info(`[Commission Fetch] Calculated Total Commission USD: $${m}`),E(String(m)),_e(!1),Te(!0),l>0?me(`${le("accounting.net.success_commission_fetched")}: $${m} (${o} txns with commission)`):ue(`${le("accounting.net.info_commission_zero")}: No commissions found in ${n.length} transactions`),Ye({commissions_usd:m}),setTimeout(()=>{Te(!1),K.info("[Commission Fetch] Protection flag cleared")},500)}catch(t){const e=t?.message||"Unknown error";K.error("[Commission Fetch] Failed to calculate daily commission:",{error:e,date:d}),xe(le("accounting.net.error_fetch_commission"))}finally{Ce(!1)}},disabled:Se,className:"absolute right-3 top-1/2 -translate-y-1/2 p-1.5 hover:bg-gray-100 rounded transition-colors disabled:opacity-50",title:le("accounting.net.auto_fill_commission"),children:s.jsx(u,{className:"h-4 w-4 text-gray-600 "+(Se?"animate-pulse":"")})})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1.5",children:le("accounting.net.commission_override_desc")})]})]})]})]})}),s.jsx(B,{variant:"elevated",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:s.jsx(T,{className:"h-5 w-5 text-gray-700"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-base font-semibold text-gray-900",children:le("accounting.net.cash_balance_data")}),s.jsx("p",{className:"text-xs text-gray-500",children:le("accounting.net.cash_balance_data_desc")})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 uppercase tracking-wider",children:le("accounting.net.previous_closing")}),s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"$"}),s.jsx(ie,{type:"number",value:Y,onChange:e=>{M(e.target.value),_e(!1)},onBlur:Ee,className:"pl-8 pr-12 h-11 border-gray-200 focus:outline-none",placeholder:"0.00"}),s.jsx("button",{type:"button",onClick:async()=>{try{K.info("[Previous Closing] Loading from previous day");const e=new Date(d);e.setDate(e.getDate()-1);const t=e.toISOString().slice(0,10);K.info(`[Previous Closing] Previous date: ${t}`);const s=await z.get(`/accounting/net?date=${t}`),a=await z.parseResponse(s);if(a&&a.success&&a.data){const e=(a.data.anlik_kasa_usd||0).toFixed(2);K.info(`[Previous Closing] Loaded: $${e}`),M(e),_e(!1),me(`Previous Closing Loaded: $${e}`),Ye({onceki_kapanis_usd:e})}else ue("No data found for previous day"),M("0")}catch(e){K.error("[Previous Closing] Failed to load:",e),xe(e?.message||"Failed to load previous closing")}},className:"absolute right-3 top-1/2 -translate-y-1/2 p-1.5 hover:bg-gray-100 rounded transition-colors",title:"Load from previous day",children:s.jsx(v,{className:"h-4 w-4 text-gray-600"})})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1.5",children:le("accounting.net.previous_closing_desc")})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 uppercase tracking-wider",children:"Company Cash (USD)"}),s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"$"}),s.jsx(ie,{type:"number",value:I,onChange:e=>{A(e.target.value),_e(!1)},onBlur:Ee,className:"pl-8 h-11 border-gray-200 focus:outline-none",placeholder:"0.00"})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1.5",children:"Physical cash and bank balance"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 uppercase tracking-wider",children:"Crypto Wallets Balance (USD)"}),s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"$"}),s.jsx(ie,{type:"number",value:P,readOnly:!0,className:"pl-8 pr-12 h-11 border-gray-200 bg-gray-50 focus:outline-none cursor-not-allowed",placeholder:"0.00"}),s.jsx("button",{type:"button",onClick:()=>Me(!1),disabled:De,className:"absolute right-3 top-1/2 -translate-y-1/2 p-1.5 hover:bg-gray-100 rounded transition-colors disabled:opacity-50",title:"Refresh crypto balance",children:s.jsx(U,{className:"h-4 w-4 text-gray-600 "+(De?"animate-spin":"")})})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1.5",children:"Auto-fetched from Trust wallets • Click refresh to update"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 uppercase tracking-wider",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{children:le("accounting.net.current_cash")}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs font-normal normal-case "+(Q?"text-orange-600":"text-gray-500"),children:Q?"Manual":"Auto"}),s.jsx("button",{type:"button",onClick:()=>{if(Q){X(!1),ne("");const e=(parseFloat(I)||0)+(parseFloat(P)||0);J(String(e)),_e(!1)}else se(!0)},className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 "+(Q?"bg-orange-600 focus:ring-orange-500":"bg-gray-200 focus:ring-gray-400"),title:Q?"Switch to Auto-calculated":"Switch to Manual",children:s.jsx("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform "+(Q?"translate-x-6":"translate-x-1")})})]})]})}),s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"$"}),s.jsx(ie,{type:"number",value:q,readOnly:!Q,onChange:e=>{Q&&(J(e.target.value),_e(!1))},onBlur:()=>{Q&&Ee()},className:"pl-8 h-11 border-gray-200 focus:outline-none font-medium "+(Q?"bg-white border-orange-300 focus:border-orange-500 cursor-text":"bg-gray-50 cursor-not-allowed"),placeholder:"0.00"})]}),s.jsx("p",{className:"text-xs mt-1.5 "+(Q?"text-orange-600":"text-gray-500"),children:Q?"Manual override active - Enter value directly":`Company Cash + Crypto Balance = $${q||"0.00"}`})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 uppercase tracking-wider",children:le("accounting.net.pending_collection")}),s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"$"}),s.jsx(ie,{type:"number",value:G,onChange:e=>{Z(e.target.value),_e(!1)},onBlur:Ee,className:"pl-8 h-11 border-gray-200 focus:outline-none",placeholder:"0.00"})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1.5",children:le("accounting.net.pending_collection_desc")})]})]})]})]})}),s.jsxs("div",{className:"flex items-center justify-end gap-3",children:[s.jsxs(V,{variant:"outline",onClick:Ae,className:"min-w-[140px] text-red-600 hover:text-red-700 hover:border-red-300 border-red-300",children:[s.jsx(f,{className:"h-4 w-4 mr-2"}),"Delete"]}),s.jsxs(V,{variant:"outline",onClick:()=>{Te(!1),Ee()},disabled:pe,className:"min-w-[140px]",children:[s.jsx(U,{className:"h-4 w-4 mr-2 "+(pe?"animate-spin":"")}),le(pe?"accounting.net.calculating":"accounting.net.calculate")]}),ge&&s.jsxs(V,{variant:"primary",onClick:async()=>{if(ge)try{je(!0),Ne(null);const e=await z.post("/accounting/net",{date:ge.date,net_cash_usd:ge.net_cash_usd,expenses_usd:ge.expenses_usd,commissions_usd:ge.commissions_usd,rollover_usd:ge.rollover_usd,net_saglama_usd:ge.net_saglama_usd,onceki_kapanis_usd:ge.onceki_kapanis_usd,company_cash_usd:ge.company_cash_usd,crypto_balance_usd:ge.crypto_balance_usd,anlik_kasa_usd:q||ge.anlik_kasa_usd,anlik_kasa_manual:Q,confirmation_code:Q?"4561":"",bekleyen_tahsilat_usd:ge.bekleyen_tahsilat_usd,fark_usd:ge.fark_usd,fark_bottom_usd:ge.fark_bottom_usd}),t=await z.parseResponse(e);t&&t.success?(_e(!0),me(le("accounting.net.saved_successfully"))):Ne(le("accounting.net.calculation_failed"))}catch(e){Ne(e?.message||le("accounting.net.calculation_failed"))}finally{je(!1)}else Ne(le("accounting.net.please_calculate_first"))},disabled:fe||pe,className:"min-w-[140px]",children:[s.jsx(h,{className:"h-4 w-4 mr-2"}),le(fe?"accounting.net.saving":ve?"accounting.net.update":"accounting.net.save")]})]}),te&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:le("accounting.net.enable_manual_mode")}),s.jsx("button",{onClick:()=>{se(!1),ne("")},className:"text-gray-400 hover:text-gray-600",children:s.jsx(m,{className:"h-5 w-5"})})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:le("accounting.net.enter_confirmation_code")}),s.jsx("div",{className:"mb-4",children:s.jsx(ie,{type:"text",value:ae,onChange:e=>{const t=e.target.value.replace(/\D/g,"").slice(0,4);ne(t)},placeholder:"----",className:"text-center text-lg font-mono tracking-widest",maxLength:4,autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&Ie()}})}),s.jsxs("div",{className:"flex gap-3 justify-end",children:[s.jsx(V,{variant:"outline",onClick:()=>{se(!1),ne("")},children:le("common.cancel")||"Cancel"}),s.jsx(V,{variant:"primary",onClick:Ie,disabled:4!==ae.length,children:le("common.confirm")||"Confirm"})]})]})}),re&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete All Values"}),s.jsx("button",{onClick:()=>{ce(!1),de("")},className:"text-gray-400 hover:text-gray-600",children:s.jsx(m,{className:"h-5 w-5"})})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Please enter the security code to delete all values on this page."}),s.jsx("div",{className:"mb-4",children:s.jsx(ie,{type:"text",value:oe,onChange:e=>{const t=e.target.value.replace(/\D/g,"").slice(0,4);de(t)},placeholder:"----",className:"text-center text-lg font-mono tracking-widest",maxLength:4,autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&Pe()}})}),s.jsxs("div",{className:"flex gap-3 justify-end",children:[s.jsx(V,{variant:"outline",onClick:()=>{ce(!1),de("")},children:le("common.cancel")||"Cancel"}),s.jsx(V,{variant:"primary",onClick:Pe,disabled:4!==oe.length,className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})}),ge&&s.jsxs("div",{className:"space-y-5",children:[s.jsx(W,{title:le("accounting.net.calculation_components"),description:le("accounting.net.calculation_components_desc"),children:s.jsxs(H,{cols:4,gap:"md",children:[s.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider mb-2",children:le("accounting.net.net_cash")}),s.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["$",Number(ge.net_cash_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsx("div",{className:"p-1.5 bg-gray-100 rounded",children:s.jsx(k,{className:"h-4 w-4 text-gray-700"})})]})}),s.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider mb-2",children:le("accounting.net.expenses")}),s.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["$",Number(ge.expenses_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsx("div",{className:"p-1.5 bg-gray-100 rounded",children:s.jsx(j,{className:"h-4 w-4 text-gray-700"})})]})}),s.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider mb-2",children:le("accounting.net.commission")}),s.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["$",Number(ge.commissions_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsx("div",{className:"p-1.5 bg-gray-100 rounded",children:s.jsx(R,{className:"h-4 w-4 text-gray-700"})})]})}),s.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider mb-2",children:le("accounting.net.rollover")}),s.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["$",Number(ge.rollover_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsx("div",{className:"p-1.5 bg-gray-100 rounded",children:s.jsx(U,{className:"h-4 w-4 text-gray-700"})})]})})]})}),s.jsx(B,{variant:"elevated",className:"overflow-hidden",children:s.jsx("div",{className:"bg-gray-50 p-6 border-l-4 border-gray-600",children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"p-3 bg-gray-100 rounded-xl",children:s.jsx(L,{className:"h-6 w-6 text-gray-700"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-green-700 uppercase tracking-wider mb-1",children:le("accounting.net.net_result")}),s.jsxs("h3",{className:"text-3xl font-bold text-green-900",children:["$",Number(ge.net_saglama_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsx("p",{className:"text-xs text-green-600 mt-1",children:le("accounting.net.net_saglama")})]})]})})})}),s.jsx(W,{title:le("accounting.net.cash_balance_analysis"),description:le("accounting.net.cash_balance_analysis_desc"),children:s.jsxs(H,{cols:4,gap:"md",children:[s.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider mb-2",children:le("accounting.net.previous_close")}),s.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["$",Number(ge.onceki_kapanis_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsx("div",{className:"p-1.5 bg-gray-100 rounded",children:s.jsx(k,{className:"h-4 w-4 text-gray-700"})})]})}),s.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider mb-2",children:le("accounting.net.current_cash_balance")}),s.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["$",Number(ge.anlik_kasa_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsx("div",{className:"p-1.5 bg-gray-100 rounded",children:s.jsx(T,{className:"h-4 w-4 text-gray-700"})})]})}),s.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider mb-2",children:le("accounting.net.pending")}),s.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["$",Number(ge.bekleyen_tahsilat_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsx("div",{className:"p-1.5 bg-gray-100 rounded",children:s.jsx(p,{className:"h-4 w-4 text-gray-700"})})]})}),s.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider mb-2",children:le("accounting.net.difference")}),s.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["$",Number(ge.fark_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsx("div",{className:"p-1.5 bg-gray-100 rounded",children:s.jsx(L,{className:"h-4 w-4 text-gray-700"})})]})})]})}),s.jsx(B,{variant:"elevated",className:"overflow-hidden",children:s.jsx("div",{className:"p-6 border-l-4 "+(Number(ge.fark_bottom_usd),"bg-gray-50 border-gray-600"),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"p-3 rounded-xl "+(Number(ge.fark_bottom_usd),"bg-gray-100"),children:s.jsx($,{className:"h-6 w-6 "+(Number(ge.fark_bottom_usd),"text-gray-700")})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium uppercase tracking-wider mb-1 "+(0===Number(ge.fark_bottom_usd)?"text-green-700":"text-red-700"),children:0===Number(ge.fark_bottom_usd)?le("accounting.net.balanced_no_discrepancy"):le("accounting.net.reconciliation_required")}),s.jsxs("h3",{className:"text-3xl font-bold "+(0===Number(ge.fark_bottom_usd)?"text-green-900":"text-red-900"),children:["$",Number(ge.fark_bottom_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsx("p",{className:"text-xs mt-1 "+(0===Number(ge.fark_bottom_usd)?"text-green-600":"text-red-600"),children:le("accounting.net.reconciliation_difference_desc")})]})]}),0===Number(ge.fark_bottom_usd)&&s.jsx("div",{className:"px-4 py-2 bg-green-100 border border-green-300 rounded-lg",children:s.jsx("span",{className:"text-sm font-semibold text-green-800",children:le("accounting.net.perfect_match")})})]})})})]})]})}function Dt({onLoadRecord:t}){const[r,l]=e.useState([]),[c,o]=e.useState(!1),[p,y]=e.useState(!1),[b,N]=e.useState(null),[j,w]=e.useState(""),[k,C]=e.useState(""),[D,F]=e.useState(""),[$,T]=e.useState(""),[R,I]=e.useState("all"),[A,P]=e.useState("date"),[O,K]=e.useState("desc"),[q,J]=e.useState(1),[W,H]=e.useState(!1),[G,Z]=e.useState(null),[Q,X]=e.useState(null),ee=async()=>{try{o(!0);const e=await z.get("/accounting/net/history"),t=await z.parseResponse(e);t&&t.success&&l(t.data||[])}catch(e){xe(e?.message||"Failed to load historical records")}finally{o(!1)}},te=e.useMemo(()=>{let e=[...r];if(D&&(e=e.filter(e=>e.date>=D)),$&&(e=e.filter(e=>e.date<=$)),"balanced"===R?e=e.filter(e=>0===Number(e.fark_bottom_usd)):"unbalanced"===R&&(e=e.filter(e=>0!==Number(e.fark_bottom_usd))),k){const t=k.toLowerCase();e=e.filter(e=>e.date.includes(t)||String(e.net_cash_usd).includes(t)||String(e.net_saglama_usd).includes(t)||String(e.fark_bottom_usd).includes(t))}return e},[r,D,$,R,k]),se=e.useMemo(()=>{const e=[...te];return e.sort((e,t)=>{let s,a;switch(A){case"date":default:s=e.date,a=t.date;break;case"net_cash":s=Number(e.net_cash_usd),a=Number(t.net_cash_usd);break;case"expenses":s=Number(e.expenses_usd),a=Number(t.expenses_usd);break;case"commission":s=Number(e.commissions_usd),a=Number(t.commissions_usd);break;case"net_saglama":s=Number(e.net_saglama_usd),a=Number(t.net_saglama_usd);break;case"fark":s=Number(e.fark_bottom_usd),a=Number(t.fark_bottom_usd)}return"asc"===O?s>a?1:-1:s<a?1:-1}),e},[te,A,O]),ae=e.useMemo(()=>{const e=50*(q-1),t=e+50;return se.slice(e,t)},[se,q]),ne=Math.ceil(se.length/50),re=e=>{A===e?K("asc"===O?"desc":"asc"):(P(e),K("desc")),J(1)},ce=e.useMemo(()=>{if(0===se.length)return null;const e=se.reduce((e,t)=>e+Number(t.net_saglama_usd),0),t=se.reduce((e,t)=>e+Number(t.expenses_usd),0),s=se.reduce((e,t)=>e+Number(t.net_cash_usd),0),a=se.filter(e=>0===Number(e.fark_bottom_usd)).length;return{totalNetSaglama:e,totalExpenses:t,totalNetCash:s,avgNetSaglama:e/se.length,balancedCount:a,totalRecords:se.length,balancedPercentage:a/se.length*100}},[se]),oe=e.useMemo(()=>{if(se.length<2)return null;const e=[...se].sort((e,t)=>e.date.localeCompare(t.date)),t=[];for(let s=1;s<e.length;s++){const a=e[s-1],n=e[s],r=Number(n.net_saglama_usd)-Number(a.net_saglama_usd),i=r/Number(a.net_saglama_usd)*100;t.push({date:n.date,netSaglamaChange:r,netSaglamaChangePercent:isFinite(i)?i:0})}return t},[se]),de=async()=>{if("4561"!==j)return alert(le("accounting.net.invalid_confirmation_code")||"Invalid confirmation code. Please enter the correct 4-digit code."),void w("");try{const e=await z.delete(`/accounting/net/${b.date}`,{confirmation_code:j}),t=await z.parseResponse(e);t&&t.success&&(me("Record deleted successfully"),ee(),y(!1),N(null),w(""))}catch(e){xe(e?.message||"Failed to delete record")}},ge=()=>{Z(null),X(null),H(!1)};return S.useEffect(()=>{ee()},[]),s.jsxs("div",{className:"space-y-6",children:[s.jsx(B,{variant:"elevated",children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1.5 block",children:"Search"}),s.jsxs("div",{className:"relative",children:[s.jsx(d,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx(ie,{type:"text",placeholder:"Search records...",value:k,onChange:e=>{C(e.target.value),J(1)},className:"pl-10"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1.5 block",children:"From Date"}),s.jsx(ie,{type:"date",value:D,onChange:e=>{F(e.target.value),J(1)}})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1.5 block",children:"To Date"}),s.jsx(ie,{type:"date",value:$,onChange:e=>{T(e.target.value),J(1)}})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1.5 block",children:le("accounting.status")}),s.jsxs("select",{value:R,onChange:e=>{I(e.target.value),J(1)},className:"w-full h-10 px-3 border border-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:[s.jsx("option",{value:"all",children:le("accounting.all_status")}),s.jsx("option",{value:"balanced",children:le("accounting.net.balanced")}),s.jsx("option",{value:"unbalanced",children:le("accounting.net.unbalanced")})]})]})]}),s.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-gray-200",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",ae.length," of ",se.length," records",se.length!==r.length&&` (filtered from ${r.length})`]}),s.jsxs("div",{className:"flex gap-2",children:[G&&s.jsxs(V,{variant:"outline",size:"sm",onClick:ge,children:[s.jsx(m,{className:"h-4 w-4 mr-1"}),"Reset Comparison"]}),s.jsxs(V,{variant:"outline",size:"sm",onClick:()=>{C(""),F(""),T(""),I("all"),J(1)},children:[s.jsx(x,{className:"h-4 w-4 mr-1"}),"Reset Filters"]}),s.jsxs(V,{variant:"outline",size:"sm",onClick:()=>{if(0===se.length)return;const e=[["Date","Net Cash","Expenses","Commission","Rollover","Net Sağlama","Current Cash","FARK"],...se.map(e=>[new Date(e.date).toLocaleDateString(),Number(e.net_cash_usd).toFixed(2),Number(e.expenses_usd).toFixed(2),Number(e.commissions_usd).toFixed(2),Number(e.rollover_usd).toFixed(2),Number(e.net_saglama_usd).toFixed(2),Number(e.anlik_kasa_usd).toFixed(2),Number(e.fark_bottom_usd).toFixed(2)])].map(e=>e.join(",")).join("\n"),t=new Blob([e],{type:"text/csv"}),s=window.URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download=`net_calculations_${(new Date).toISOString().slice(0,10)}.csv`,a.click(),window.URL.revokeObjectURL(s),me(`Exported ${se.length} records`)},disabled:0===se.length,children:[s.jsx(u,{className:"h-4 w-4 mr-1"}),"Export"]}),s.jsxs(V,{variant:"outline",size:"sm",onClick:ee,disabled:c,children:[s.jsx(U,{className:"h-4 w-4 mr-1 "+(c?"animate-spin":"")}),"Refresh"]})]})]})]})}),ce&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsx(B,{variant:"elevated",className:"p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Total Net Sağlama"}),s.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:["$",ce.totalNetSaglama.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Across ",ce.totalRecords," records"]})]}),s.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:s.jsx(L,{className:"h-5 w-5 text-green-600"})})]})}),s.jsx(B,{variant:"elevated",className:"p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Avg Net Sağlama"}),s.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:["$",ce.avgNetSaglama.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Per day average"})]}),s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(g,{className:"h-5 w-5 text-blue-600"})})]})}),s.jsx(B,{variant:"elevated",className:"p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Total Expenses"}),s.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:["$",ce.totalExpenses.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Total spent"})]}),s.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:s.jsx(E,{className:"h-5 w-5 text-red-600"})})]})}),s.jsx(B,{variant:"elevated",className:"p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Balanced Days"}),s.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:[ce.balancedPercentage.toFixed(1),"%"]}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[ce.balancedCount," of ",ce.totalRecords," days"]})]}),s.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:s.jsx(h,{className:"h-5 w-5 text-purple-600"})})]})})]}),se.length>=2&&s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx(B,{variant:"elevated",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-base font-semibold text-gray-900",children:"Net Sağlama Trends"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Historical Net Sağlama over time"})]}),s.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:s.jsx(i,{className:"h-5 w-5 text-green-600"})})]}),s.jsx("div",{className:"h-64",children:s.jsx("p",{className:"text-sm text-gray-500 text-center py-20",children:"Chart visualization coming soon with Recharts"})})]})}),s.jsx(B,{variant:"elevated",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-base font-semibold text-gray-900",children:"Expenses vs Net Cash"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Comparison of expenses and revenue"})]}),s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(n,{className:"h-5 w-5 text-blue-600"})})]}),s.jsx("div",{className:"h-64",children:s.jsx("p",{className:"text-sm text-gray-500 text-center py-20",children:"Chart visualization coming soon with Recharts"})})]})}),oe&&oe.length>0&&s.jsx(B,{variant:"elevated",className:"lg:col-span-2",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-base font-semibold text-gray-900",children:"Variance Analysis"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Day-over-day Net Sağlama changes"})]}),s.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:s.jsx(g,{className:"h-5 w-5 text-purple-600"})})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-600 uppercase",children:le("common.date")}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-600 uppercase",children:"Change (USD)"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-600 uppercase",children:"Change (%)"}),s.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-600 uppercase",children:"Trend"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:oe.slice(0,10).map((e,t)=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-gray-900 font-medium",children:new Date(e.date).toLocaleDateString()}),s.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-right font-semibold "+(e.netSaglamaChange>0?"text-green-600":e.netSaglamaChange<0?"text-red-600":"text-gray-600"),children:[e.netSaglamaChange>0?"+":"","$",e.netSaglamaChange.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-right font-semibold "+(e.netSaglamaChangePercent>0?"text-green-600":e.netSaglamaChangePercent<0?"text-red-600":"text-gray-600"),children:[e.netSaglamaChangePercent>0?"+":"",e.netSaglamaChangePercent.toFixed(2),"%"]}),s.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-center",children:e.netSaglamaChange>0?s.jsx(L,{className:"h-4 w-4 text-green-600 mx-auto"}):e.netSaglamaChange<0?s.jsx(E,{className:"h-4 w-4 text-red-600 mx-auto"}):s.jsx(g,{className:"h-4 w-4 text-gray-400 mx-auto"})})]},t))})]})}),oe.length>10&&s.jsxs("p",{className:"text-xs text-gray-500 text-center mt-3",children:["Showing latest 10 changes out of ",oe.length]})]})})]}),s.jsx(B,{variant:"elevated",children:s.jsxs("div",{className:"p-6",children:[s.jsx("div",{className:"flex items-center justify-between mb-6",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Saved Net Calculations"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"View and manage historical net calculation records"})]})}),c?s.jsxs("div",{className:"flex items-center justify-center py-12",children:[s.jsx(U,{className:"h-6 w-6 text-gray-400 animate-spin"}),s.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"Loading records..."})]}):0===se.length?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(a,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-sm text-gray-500",children:0===r.length?"No saved records found":"No records match your filters"}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:0===r.length?"Calculate and save to see records here":"Try adjusting your filter criteria"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:s.jsxs("button",{onClick:()=>re("date"),className:"flex items-center gap-1 hover:text-gray-900 transition-colors",children:["Date","date"===A&&("asc"===O?s.jsx(_,{className:"h-3 w-3 rotate-[-90deg]"}):s.jsx(_,{className:"h-3 w-3 rotate-90"}))]})}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-600 uppercase tracking-wider",children:s.jsxs("button",{onClick:()=>re("net_cash"),className:"flex items-center justify-end gap-1 hover:text-gray-900 transition-colors ml-auto",children:["Net Cash","net_cash"===A&&("asc"===O?s.jsx(_,{className:"h-3 w-3 rotate-[-90deg]"}):s.jsx(_,{className:"h-3 w-3 rotate-90"}))]})}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-600 uppercase tracking-wider",children:s.jsxs("button",{onClick:()=>re("expenses"),className:"flex items-center justify-end gap-1 hover:text-gray-900 transition-colors ml-auto",children:["Expenses","expenses"===A&&("asc"===O?s.jsx(_,{className:"h-3 w-3 rotate-[-90deg]"}):s.jsx(_,{className:"h-3 w-3 rotate-90"}))]})}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-600 uppercase tracking-wider",children:s.jsxs("button",{onClick:()=>re("commission"),className:"flex items-center justify-end gap-1 hover:text-gray-900 transition-colors ml-auto",children:["Commission","commission"===A&&("asc"===O?s.jsx(_,{className:"h-3 w-3 rotate-[-90deg]"}):s.jsx(_,{className:"h-3 w-3 rotate-90"}))]})}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Rollover"}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-600 uppercase tracking-wider font-semibold",children:s.jsxs("button",{onClick:()=>re("net_saglama"),className:"flex items-center justify-end gap-1 hover:text-gray-900 transition-colors ml-auto font-semibold",children:["Net Sağlama","net_saglama"===A&&("asc"===O?s.jsx(_,{className:"h-3 w-3 rotate-[-90deg]"}):s.jsx(_,{className:"h-3 w-3 rotate-90"}))]})}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Current Cash"}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-600 uppercase tracking-wider",children:s.jsxs("button",{onClick:()=>re("fark"),className:"flex items-center justify-end gap-1 hover:text-gray-900 transition-colors ml-auto",children:["FARK","fark"===A&&("asc"===O?s.jsx(_,{className:"h-3 w-3 rotate-[-90deg]"}):s.jsx(_,{className:"h-3 w-3 rotate-90"}))]})}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-600 uppercase tracking-wider",children:le("common.actions")})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:ae.map(e=>s.jsxs("tr",{className:"hover:bg-gray-50 transition-colors "+(G?.date===e.date||Q?.date===e.date?"bg-blue-50 border-l-4 border-blue-500":""),children:[s.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-900 font-medium",children:new Date(e.date).toLocaleDateString()}),s.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-right text-gray-900",children:["$",Number(e.net_cash_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-right text-gray-900",children:["$",Number(e.expenses_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-right text-gray-900",children:["$",Number(e.commissions_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-right text-gray-900",children:["$",Number(e.rollover_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-right font-semibold text-green-700",children:["$",Number(e.net_saglama_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-right text-gray-900",children:["$",Number(e.anlik_kasa_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),e.anlik_kasa_manual&&s.jsx("span",{className:"ml-1 text-xs text-orange-600",children:"(M)"})]}),s.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-right font-medium "+(0===Number(e.fark_bottom_usd)?"text-green-700":"text-red-700"),children:["$",Number(e.fark_bottom_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:s.jsxs("div",{className:"flex items-center justify-center gap-1",children:[s.jsx("button",{onClick:()=>(e=>{G?Q||e.date===G.date?e.date===G.date?ue("Please select a different date"):(Z(e),X(null),ue("Select second date to compare")):(X(e),H(!0)):(Z(e),ue("Select second date to compare"))})(e),className:"p-1.5 hover:bg-gray-100 rounded transition-colors "+(G?.date===e.date||Q?.date===e.date?"bg-blue-100":""),title:"Compare",children:s.jsx(Y,{className:"h-4 w-4 text-purple-600"})}),s.jsx("button",{onClick:()=>(e=>{t(e)})(e),className:"p-1.5 hover:bg-gray-100 rounded transition-colors",title:"Load to calculator",children:s.jsx(M,{className:"h-4 w-4 text-blue-600"})}),s.jsx("button",{onClick:()=>(e=>{N(e),y(!0)})(e),className:"p-1.5 hover:bg-gray-100 rounded transition-colors",title:"Delete this record",children:s.jsx(f,{className:"h-4 w-4 text-red-600"})})]})})]},e.id))})]})}),ne>1&&s.jsxs("div",{className:"flex items-center justify-between mt-6 pt-6 border-t border-gray-200",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",q," of ",ne]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(V,{variant:"outline",size:"sm",onClick:()=>J(1),disabled:1===q,children:[s.jsx(v,{className:"h-4 w-4 mr-1"}),"First"]}),s.jsx(V,{variant:"outline",size:"sm",onClick:()=>J(q-1),disabled:1===q,children:s.jsx(v,{className:"h-4 w-4"})}),s.jsx("div",{className:"flex items-center gap-1",children:[...Array(Math.min(5,ne))].map((e,t)=>{let a;return a=ne<=5||q<=3?t+1:q>=ne-2?ne-4+t:q-2+t,s.jsx("button",{onClick:()=>J(a),className:"px-3 py-1.5 text-sm font-medium rounded transition-colors "+(q===a?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-100 border border-gray-300"),children:a},a)})}),s.jsx(V,{variant:"outline",size:"sm",onClick:()=>J(q+1),disabled:q===ne,children:s.jsx(_,{className:"h-4 w-4"})}),s.jsxs(V,{variant:"outline",size:"sm",onClick:()=>J(ne),disabled:q===ne,children:["Last",s.jsx(_,{className:"h-4 w-4 ml-1"})]})]})]})]})]})}),p&&b&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Record"}),s.jsx("button",{onClick:()=>{y(!1),N(null),w("")},className:"text-gray-400 hover:text-gray-600",children:s.jsx(m,{className:"h-5 w-5"})})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Are you sure you want to delete the record for:"}),s.jsxs("p",{className:"text-sm font-semibold text-gray-900 mb-4",children:[new Date(b.date).toLocaleDateString()," - Net Sağlama: $",Number(b.net_saglama_usd).toFixed(2)]}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Enter security code to confirm deletion:"}),s.jsx("div",{className:"mb-4",children:s.jsx(ie,{type:"text",value:j,onChange:e=>{const t=e.target.value.replace(/\D/g,"").slice(0,4);w(t)},placeholder:"----",className:"text-center text-lg font-mono tracking-widest",maxLength:4,autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&4===j.length&&de()}})}),s.jsxs("div",{className:"flex gap-3 justify-end",children:[s.jsx(V,{variant:"outline",onClick:()=>{y(!1),N(null),w("")},children:"Cancel"}),s.jsx(V,{variant:"primary",onClick:de,disabled:4!==j.length,className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})}),W&&G&&Q&&s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-hidden",children:[s.jsx("div",{className:"bg-gray-50 px-6 py-5 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(Y,{className:"h-6 w-6 text-purple-600"}),"Date Comparison"]}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Comparing ",new Date(G.date).toLocaleDateString()," vs ",new Date(Q.date).toLocaleDateString()]})]}),s.jsx("button",{onClick:()=>H(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(m,{className:"h-5 w-5 text-gray-500"})})]})}),s.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:s.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[s.jsx("h4",{className:"text-lg font-semibold text-purple-900 mb-1",children:new Date(G.date).toLocaleDateString()}),s.jsx("p",{className:"text-xs text-purple-600",children:"Date 1"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Net Cash"}),s.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-1",children:["$",Number(G.net_cash_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Expenses"}),s.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-1",children:["$",Number(G.expenses_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Commission"}),s.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-1",children:["$",Number(G.commissions_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Rollover"}),s.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-1",children:["$",Number(G.rollover_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[s.jsx("p",{className:"text-xs font-medium text-green-700 uppercase",children:"Net Sağlama"}),s.jsxs("p",{className:"text-2xl font-bold text-green-900 mt-1",children:["$",Number(G.net_saglama_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Current Cash"}),s.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-1",children:["$",Number(G.anlik_kasa_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsxs("div",{className:"rounded-lg p-3 "+(0===Number(G.fark_bottom_usd)?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:[s.jsx("p",{className:"text-xs font-medium uppercase "+(0===Number(G.fark_bottom_usd)?"text-green-700":"text-red-700"),children:"FARK"}),s.jsxs("p",{className:"text-lg font-bold mt-1 "+(0===Number(G.fark_bottom_usd)?"text-green-900":"text-red-900"),children:["$",Number(G.fark_bottom_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("h4",{className:"text-lg font-semibold text-blue-900 mb-1",children:new Date(Q.date).toLocaleDateString()}),s.jsx("p",{className:"text-xs text-blue-600",children:"Date 2"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Net Cash"}),s.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-1",children:["$",Number(Q.net_cash_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsxs("p",{className:"text-xs mt-1 font-medium "+(Number(Q.net_cash_usd)>Number(G.net_cash_usd)?"text-green-600":Number(Q.net_cash_usd)<Number(G.net_cash_usd)?"text-red-600":"text-gray-600"),children:[Number(Q.net_cash_usd)>Number(G.net_cash_usd)&&"↑ ",Number(Q.net_cash_usd)<Number(G.net_cash_usd)&&"↓ ","$",Math.abs(Number(Q.net_cash_usd)-Number(G.net_cash_usd)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Expenses"}),s.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-1",children:["$",Number(Q.expenses_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsxs("p",{className:"text-xs mt-1 font-medium "+(Number(Q.expenses_usd)>Number(G.expenses_usd)?"text-red-600":Number(Q.expenses_usd)<Number(G.expenses_usd)?"text-green-600":"text-gray-600"),children:[Number(Q.expenses_usd)>Number(G.expenses_usd)&&"↑ ",Number(Q.expenses_usd)<Number(G.expenses_usd)&&"↓ ","$",Math.abs(Number(Q.expenses_usd)-Number(G.expenses_usd)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Commission"}),s.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-1",children:["$",Number(Q.commissions_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsxs("p",{className:"text-xs mt-1 font-medium "+(Number(Q.commissions_usd)>Number(G.commissions_usd)?"text-red-600":Number(Q.commissions_usd)<Number(G.commissions_usd)?"text-green-600":"text-gray-600"),children:[Number(Q.commissions_usd)>Number(G.commissions_usd)&&"↑ ",Number(Q.commissions_usd)<Number(G.commissions_usd)&&"↓ ","$",Math.abs(Number(Q.commissions_usd)-Number(G.commissions_usd)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Rollover"}),s.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-1",children:["$",Number(Q.rollover_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsxs("p",{className:"text-xs mt-1 font-medium "+(Number(Q.rollover_usd)>Number(G.rollover_usd)?"text-green-600":Number(Q.rollover_usd)<Number(G.rollover_usd)?"text-red-600":"text-gray-600"),children:[Number(Q.rollover_usd)>Number(G.rollover_usd)&&"↑ ",Number(Q.rollover_usd)<Number(G.rollover_usd)&&"↓ ","$",Math.abs(Number(Q.rollover_usd)-Number(G.rollover_usd)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[s.jsx("p",{className:"text-xs font-medium text-green-700 uppercase",children:"Net Sağlama"}),s.jsxs("p",{className:"text-2xl font-bold text-green-900 mt-1",children:["$",Number(Q.net_saglama_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsxs("p",{className:"text-sm mt-1 font-medium "+(Number(Q.net_saglama_usd)>Number(G.net_saglama_usd)?"text-green-600":Number(Q.net_saglama_usd)<Number(G.net_saglama_usd)?"text-red-600":"text-gray-600"),children:[Number(Q.net_saglama_usd)>Number(G.net_saglama_usd)&&"↑ ",Number(Q.net_saglama_usd)<Number(G.net_saglama_usd)&&"↓ ","$",Math.abs(Number(Q.net_saglama_usd)-Number(G.net_saglama_usd)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})," ","(",(Math.abs(Number(Q.net_saglama_usd)-Number(G.net_saglama_usd))/Number(G.net_saglama_usd)*100).toFixed(1),"%)"]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Current Cash"}),s.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-1",children:["$",Number(Q.anlik_kasa_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsxs("p",{className:"text-xs mt-1 font-medium "+(Number(Q.anlik_kasa_usd)>Number(G.anlik_kasa_usd)?"text-green-600":Number(Q.anlik_kasa_usd)<Number(G.anlik_kasa_usd)?"text-red-600":"text-gray-600"),children:[Number(Q.anlik_kasa_usd)>Number(G.anlik_kasa_usd)&&"↑ ",Number(Q.anlik_kasa_usd)<Number(G.anlik_kasa_usd)&&"↓ ","$",Math.abs(Number(Q.anlik_kasa_usd)-Number(G.anlik_kasa_usd)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsxs("div",{className:"rounded-lg p-3 "+(0===Number(Q.fark_bottom_usd)?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:[s.jsx("p",{className:"text-xs font-medium uppercase "+(0===Number(Q.fark_bottom_usd)?"text-green-700":"text-red-700"),children:"FARK"}),s.jsxs("p",{className:"text-lg font-bold mt-1 "+(0===Number(Q.fark_bottom_usd)?"text-green-900":"text-red-900"),children:["$",Number(Q.fark_bottom_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsxs("p",{className:"text-xs mt-1 font-medium "+(Math.abs(Number(Q.fark_bottom_usd))<Math.abs(Number(G.fark_bottom_usd))?"text-green-600":Math.abs(Number(Q.fark_bottom_usd))>Math.abs(Number(G.fark_bottom_usd))?"text-red-600":"text-gray-600"),children:[Math.abs(Number(Q.fark_bottom_usd))<Math.abs(Number(G.fark_bottom_usd))&&"✓ Better ",Math.abs(Number(Q.fark_bottom_usd))>Math.abs(Number(G.fark_bottom_usd))&&"⚠ Worse ",Math.abs(Number(Q.fark_bottom_usd))===Math.abs(Number(G.fark_bottom_usd))&&"= Same "]})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("h4",{className:"text-lg font-semibold text-blue-900 mb-1",children:new Date(Q.date).toLocaleDateString()}),s.jsx("p",{className:"text-xs text-blue-600",children:"Date 2"})]}),s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[s.jsx("h5",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Overall Comparison"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{className:"text-gray-600",children:"Net Sağlama Change:"}),s.jsxs("span",{className:"font-bold "+(Number(Q.net_saglama_usd)>Number(G.net_saglama_usd)?"text-green-600":"text-red-600"),children:[Number(Q.net_saglama_usd)>Number(G.net_saglama_usd)?"+":"","$",(Number(Q.net_saglama_usd)-Number(G.net_saglama_usd)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{className:"text-gray-600",children:"Percentage Change:"}),s.jsxs("span",{className:"font-bold "+(Number(Q.net_saglama_usd)>Number(G.net_saglama_usd)?"text-green-600":"text-red-600"),children:[Number(Q.net_saglama_usd)>Number(G.net_saglama_usd)?"+":"",((Number(Q.net_saglama_usd)-Number(G.net_saglama_usd))/Number(G.net_saglama_usd)*100).toFixed(2),"%"]})]}),s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{className:"text-gray-600",children:"Expense Change:"}),s.jsxs("span",{className:"font-bold "+(Number(Q.expenses_usd)<Number(G.expenses_usd)?"text-green-600":"text-red-600"),children:[Number(Q.expenses_usd)>Number(G.expenses_usd)?"+":"","$",(Number(Q.expenses_usd)-Number(G.expenses_usd)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsxs("span",{className:"text-gray-600",children:[le("accounting.status_comparison"),":"]}),s.jsxs("span",{className:"font-bold",children:[0===Number(G.fark_bottom_usd)?"✓":"✗"," → ",0===Number(Q.fark_bottom_usd)?"✓":"✗"]})]})]})]})]})]})}),s.jsx("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200 flex justify-end gap-3",children:s.jsx(V,{variant:"outline",onClick:ge,children:"Close Comparison"})})]})})]})}e.useEffect(()=>{const e=parseFloat(yt.amount)||0;let t={amount_try:0,amount_usd:0,amount_usdt:0};if(!kt)return"TRY"===yt.mount_currency?t.amount_try=e:"USD"===yt.mount_currency?t.amount_usd=e:"USDT"===yt.mount_currency&&(t.amount_usdt=e),void ft(t);const s=jt||42.57;"TRY"===yt.mount_currency?(t.amount_try=e,t.amount_usd=s>0?e/s:0,t.amount_usdt=t.amount_usd):"USD"===yt.mount_currency?(t.amount_usd=e,t.amount_try=e*s,t.amount_usdt=e):"USDT"===yt.mount_currency&&(t.amount_usdt=e,t.amount_usd=e,t.amount_try=e*s),ft(t)},[yt.amount,yt.mount_currency,jt,kt]);const[Ft,$t]=e.useState("");e.useEffect(()=>{(async()=>{if(oe&&!de)try{Re(!0),Ee(null),K.debug("Loading expenses from API...");const e=await z.get("/accounting/expenses");if(e.ok){const t=await z.parseResponse(e);K.debug("Expenses loaded:",t),t.success&&Array.isArray(t.expenses)?Te(t.expenses):(K.warn("Invalid expenses response structure:",t),Ee(t.error||"Invalid response format"),Te([]))}else K.error("HTTP error loading expenses:",e.status),Ee("Failed to load expenses"),Te([])}catch(e){K.error("Error loading expenses:",e),Ee("Error loading expenses: "+(e instanceof Error?e.message:String(e))),Te([])}finally{Re(!1)}})()},[oe,de,ge]),e.useEffect(()=>{const e=setTimeout(()=>{Ae(Ye)},300);return()=>clearTimeout(e)},[Ye]);const Tt=e.useCallback(async()=>{try{const e=await z.get("/accounting/currency-summary/months");if(e.ok){const t=await z.parseResponse(e);t.success&&Ve(t.months||[])}}catch(e){}},[]),Ut=e.useCallback(async e=>{try{Xe(!0),qe(e);const s=await z.get(`/accounting/currency-summary/${e}`);if(s.ok){const a=await z.parseResponse(s);if(a.success&&a.is_saved&&a.currencies.length>0){He(a.is_locked);const t={TRY:0,USD:0,USDT:0},s={TRY:""};a.currencies.forEach(e=>{t[e.currency]=e.devir||0,"TRY"===e.currency&&e.exchange_rate&&(s.TRY=e.exchange_rate.toString())}),at(t),tt(s),ue(`Loaded data for ${e}`)}else if(He(!1),jt&&jt>0&&tt({TRY:jt.toFixed(2)}),e===(new Date).toISOString().slice(0,7)){const e=localStorage.getItem("expense_carryover_values");if(e)try{const t=JSON.parse(e);at(t)}catch(t){at({TRY:75e4,USD:5e3,USDT:168e3})}else at({TRY:75e4,USD:5e3,USDT:168e3})}else at({TRY:0,USD:0,USDT:0})}}catch(s){xe("Failed to load month data")}finally{Xe(!1)}},[jt,ue,xe]),Rt=e.useMemo(()=>{const e={TRY:{currency:"TRY",carryover:st.TRY,inflow:0,outflow:0,net:0,usdEquivalent:0},USD:{currency:"USD",carryover:st.USD,inflow:0,outflow:0,net:0,usdEquivalent:0},USDT:{currency:"USDT",carryover:st.USDT,inflow:0,outflow:0,net:0,usdEquivalent:0}};if(!$e||0===$e.length){const t=et.TRY&&parseFloat(et.TRY)>0?parseFloat(et.TRY):jt&&jt>0?jt:42.57;return Object.keys(e).forEach(s=>{const a=e[s];a.net=a.carryover+a.inflow-a.outflow,"USD"===s||"USDT"===s?a.usdEquivalent=a.net:"TRY"===s&&(a.usdEquivalent=t>0?a.net/t:0)}),[e.USD,e.TRY,e.USDT]}$e.forEach(t=>{if(!t)return;const s=t.mount_currency||"TRY",a="TRY"===s?"TRY":"USD"===s?"USD":"USDT";e[a]||(e[a]={currency:a,carryover:0,inflow:0,outflow:0,net:0,usdEquivalent:0});let n=0;"TRY"===s?n=t.amount_try||0:"USD"===s?n=t.amount_usd||0:"USDT"===s&&(n=t.amount_usdt||0),"inflow"===t.category?e[a].inflow+=n:"outflow"===t.category&&(e[a].outflow+=n)});const t=et.TRY&&parseFloat(et.TRY)>0?parseFloat(et.TRY):jt&&jt>0?jt:42.57;return Object.keys(e).forEach(s=>{const a=e[s];a.net=a.carryover+a.inflow-a.outflow,"USD"===s||"USDT"===s?a.usdEquivalent=a.net:"TRY"===s&&(a.usdEquivalent=t>0?a.net/t:0)}),[e.USD,e.TRY,e.USDT]},[$e,jt,st,et]),Lt=e.useCallback(async()=>{try{Ze(!0);const e=Rt.map(e=>({currency:e.currency,devir:st[e.currency]||0,exchange_rate:"TRY"===e.currency&&et.TRY?parseFloat(et.TRY):null,inflow:e.inflow,outflow:e.outflow,net:e.net,usd_equivalent:e.usdEquivalent})),t=await z.post("/accounting/currency-summary",{month_period:Be,currencies:e});if(t.ok){const e=await z.parseResponse(t);if(e.success){me("Month data saved successfully!"),Tt();const e=(new Date).toISOString().slice(0,7);Be===e&&localStorage.setItem("expense_carryover_values",JSON.stringify(st))}else xe(e.error||"Failed to save month data")}else xe("Failed to save month data")}catch(e){xe("Failed to save month data")}finally{Ze(!1)}},[Be,Rt,st,et,me,xe,Tt]),Et=e.useCallback(async()=>{if(confirm(`Lock ${Be}? You won't be able to edit it without unlocking.`))try{const e=await z.post(`/accounting/currency-summary/${Be}/lock`);if(e.ok){const t=await z.parseResponse(e);t.success?(He(!0),me("Month locked successfully"),Tt()):xe(t.error||"Failed to lock month")}}catch(e){xe("Failed to lock month")}},[Be,me,xe,Tt]),Yt=e.useCallback(async()=>{try{const e=await z.post(`/accounting/currency-summary/${Be}/unlock`);if(e.ok){const t=await z.parseResponse(e);t.success?(He(!1),me("Month unlocked successfully"),Tt()):xe(t.error||"Failed to unlock month")}}catch(e){xe("Failed to unlock month")}},[Be,me,xe,Tt]);e.useEffect(()=>{Tt()},[Tt]),e.useEffect(()=>{const e=(new Date).toISOString().slice(0,7);Ut(e)},[Ut]);const Mt=e.useCallback(()=>{xt(null),dt(null),gt(!1),pt(!1),St(!0),bt({description:"",detail:"",category:"inflow",type:"payment",amount:"",mount_currency:"TRY",status:"pending",cost_period:"",payment_date:"",payment_period:"",source:""}),ft({amount_try:0,amount_usd:0,amount_usdt:0}),ct(!0)},[]),It=e.useCallback(e=>{dt(e),xt(null),gt(!0);const t=e.mount_currency||"TRY";let s="0";"TRY"===t?s=e.amount_try?.toString()||"0":"USD"===t?s=e.amount_usd?.toString()||"0":"USDT"===t&&(s=e.amount_usdt?.toString()||"0"),bt({description:e.description,detail:e.detail,category:e.category||"inflow",type:e.type||"payment",amount:s,mount_currency:t,status:e.status,cost_period:e.cost_period,payment_date:e.payment_date,payment_period:e.payment_period,source:e.source}),ft({amount_try:e.amount_try||0,amount_usd:e.amount_usd||0,amount_usdt:e.amount_usdt||0}),ct(!0)},[]),At=e.useCallback(e=>{if("4561"!==prompt(le("accounting.enter_security_pin")))return void xe(le("accounting.invalid_security_pin"));xt(e),dt(null),gt(!1);const t=e.mount_currency||"TRY";let s="0";"TRY"===t?s=e.amount_try?.toString()||"0":"USD"===t?s=e.amount_usd?.toString()||"0":"USDT"===t&&(s=e.amount_usdt?.toString()||"0"),bt({description:e.description,detail:e.detail,category:e.category||"inflow",type:e.type||"payment",amount:s,mount_currency:t,status:e.status,cost_period:e.cost_period,payment_date:e.payment_date,payment_period:e.payment_period,source:e.source}),ft({amount_try:e.amount_try||0,amount_usd:e.amount_usd||0,amount_usdt:e.amount_usdt||0}),$t("4561"),ct(!0)},[le]),Pt=e.useCallback(()=>{ct(!1),xt(null),dt(null),gt(!1),pt(!1),vt(null),$t(""),St(!0),bt({description:"",detail:"",category:"inflow",type:"payment",amount:"",mount_currency:"TRY",status:"pending",cost_period:"",payment_date:"",payment_period:"",source:""}),ft({amount_try:0,amount_usd:0,amount_usdt:0})},[]),Ot=e.useCallback(async()=>{wt(!0);try{K.debug("Fetching current exchange rate...");const e=await z.get("/exchange-rates/current");if(e.ok){const t=await z.parseResponse(e);if(K.debug("Exchange rate response:",t),t.success&&t.rate&&t.rate.rate){const e=parseFloat(t.rate.rate);return K.debug("Exchange rate fetched:",e),vt(e),me(le("accounting.rate_fetched").replace("{rate}",e.toFixed(4))),e}return K.error("Invalid exchange rate response structure:",t),xe(le("accounting.rate_fetch_failed")),null}return K.error("HTTP error fetching exchange rate:",e.status),xe(le("accounting.rate_fetch_failed")),null}catch(e){return K.error("Error fetching exchange rate:",e),xe(le("accounting.rate_fetch_error")),null}finally{wt(!1)}},[le,me,xe]);e.useEffect(()=>{!oe||de||"expenses"!==ge||jt||Ot().catch(()=>{})},[oe,de,ge,jt,Ot]);const zt=e.useCallback(async()=>{try{fetch("http://127.0.0.1:7242/ingest/49fd889e-f043-489a-b352-a05d8b26fc7c",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Accounting.tsx:3425",message:"handleSaveExpense called",data:{isEdit:!!mt,expensesCount:$e.length},timestamp:Date.now(),sessionId:"debug-session",runId:"run2",hypothesisId:"A"})}).catch(()=>{})}catch{}try{if(Re(!0),mt){try{fetch("http://127.0.0.1:7242/ingest/49fd889e-f043-489a-b352-a05d8b26fc7c",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Accounting.tsx:3428",message:"Updating expense via API",data:{expenseId:mt.id},timestamp:Date.now(),sessionId:"debug-session",runId:"run2",hypothesisId:"A"})}).catch(()=>{})}catch{}const e=await z.put(`/accounting/expenses/${mt.id}`,{description:yt.description,detail:yt.detail,category:yt.category,type:yt.type,amount_try:Nt.amount_try,amount_usd:Nt.amount_usd,amount_usdt:Nt.amount_usdt,mount_currency:yt.mount_currency,status:yt.status,cost_period:yt.cost_period,payment_date:yt.payment_date||null,payment_period:yt.payment_period,source:yt.source});if(e.ok){const t=await z.parseResponse(e);t.success&&t.expense?(Te($e.map(e=>e.id===mt.id?t.expense:e)),me(le("accounting.expense_updated_success")),Pt()):xe(t.error||le("accounting.failed_to_update_expense"))}else xe(le("accounting.failed_to_update_expense"))}else{try{fetch("http://127.0.0.1:7242/ingest/49fd889e-f043-489a-b352-a05d8b26fc7c",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Accounting.tsx:3448",message:"Adding new expense via API",data:{expensesCount:$e.length},timestamp:Date.now(),sessionId:"debug-session",runId:"run2",hypothesisId:"A"})}).catch(()=>{})}catch{}const e=await z.post("/accounting/expenses",{description:yt.description,detail:yt.detail,category:yt.category,type:yt.type,amount_try:Nt.amount_try,amount_usd:Nt.amount_usd,amount_usdt:Nt.amount_usdt,mount_currency:yt.mount_currency,status:yt.status,cost_period:yt.cost_period,payment_date:yt.payment_date||null,payment_period:yt.payment_period,source:yt.source});if(e.ok){const t=await z.parseResponse(e);t.success&&t.expense?(Te([...$e,t.expense]),me(le("accounting.expense_added_success")),Pt()):xe(t.error||"Failed to create expense")}else xe("Failed to create expense")}}catch(e){K.error("Error saving expense:",e),xe("Error saving expense. Please try again.")}finally{Re(!1)}},[mt,$e,yt,Pt,me,xe,le]),Kt=e.useCallback(async e=>{try{fetch("http://127.0.0.1:7242/ingest/49fd889e-f043-489a-b352-a05d8b26fc7c",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Accounting.tsx:3469",message:"handleDeleteExpense called",data:{expenseId:e},timestamp:Date.now(),sessionId:"debug-session",runId:"run2",hypothesisId:"A"})}).catch(()=>{})}catch{}if(confirm(le("accounting.confirm_delete_expense")))try{Re(!0);const t=await z.delete(`/accounting/expenses/${e}`);if(t.ok){const s=await z.parseResponse(t);s.success?(Te($e.filter(t=>t.id!==e)),me(le("accounting.expense_deleted_success"))):xe(s.error||"Failed to delete expense")}else xe("Failed to delete expense")}catch(t){K.error("Error deleting expense:",t),xe("Error deleting expense. Please try again.")}finally{Re(!1)}},[$e,me,xe,le]),Bt=e.useMemo(()=>$e.filter(e=>{const t=e.description.toLowerCase().includes(Ie.toLowerCase())||e.detail.toLowerCase().includes(Ie.toLowerCase())||e.source.toLowerCase().includes(Ie.toLowerCase()),s="all"===Pe||e.status===Pe,a="all"===ze||e.category===ze;return t&&s&&a}),[$e,Ie,Pe,ze]),qt=e.useMemo(()=>{const e=(nt-1)*it,t=e+it;return Bt.slice(e,t)},[Bt,nt,it]),Jt=Math.ceil(Bt.length/it);e.useEffect(()=>{rt(1)},[Ie,Pe,ze]);const Vt=e.useMemo(()=>({totalTRY:$e.reduce((e,t)=>e+t.amount_try,0),totalUSD:$e.reduce((e,t)=>e+t.amount_usd,0),count:$e.length}),[$e]),Wt=e.useMemo(()=>{const e=$e.filter(e=>{if(!e.payment_date||""===e.payment_date.trim()||"paid"!==e.status)return!1;const t=new Date(e.payment_date),s=t.getMonth()+1,a=t.getFullYear();return s===ve&&a===we}).reduce((e,t)=>{const s=t.payment_date;return e[s]||(e[s]={date:s,totalTRY:0,totalUSD:0,count:0,expenses:[]}),e[s].totalTRY+=t.amount_try,e[s].totalUSD+=t.amount_usd,e[s].count+=1,e[s].expenses.push(t),e},{});return Object.values(e).sort((e,t)=>{const s=new Date(e.date).getTime(),a=new Date(t.date).getTime();return"desc"===Se?a-s:s-a})},[$e,ve,we,Se]),Ht=e.useCallback(()=>{const e=Bt.map(e=>`"${e.description}","${e.detail}",${e.amount_try},${e.amount_usd},"${e.status}","${e.cost_period}","${e.payment_date}","${e.payment_period}","${e.source}"`).join("\n"),t=new Blob(["Description,Detail,TRY Amount,USD Amount,Status,Cost Period,Payment Date,Payment Period,Source\n"+e],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),a=URL.createObjectURL(t);s.setAttribute("href",a),s.setAttribute("download",`expenses_${(new Date).toISOString().split("T")[0]}.csv`),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s),me(le("accounting.exported_expenses").replace("{count}",String(Bt.length)))},[Bt,me,le]);return e.useEffect(()=>{window.scrollTo({top:0,behavior:"instant"})},[]),e.useEffect(()=>{$e.length>0&&localStorage.setItem("accounting_expenses",JSON.stringify($e))},[$e]),e.useEffect(()=>{const e=e=>{if((e.ctrlKey||e.metaKey)&&"k"===e.key){e.preventDefault();const t=document.querySelector('input[placeholder*="Search expenses"]');t?.focus(),ue("Search activated (Ctrl+K)")}!e.ctrlKey&&!e.metaKey||"n"!==e.key||lt||(e.preventDefault(),Mt(),ue("New expense form opened (Ctrl+N)"))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[lt,Mt]),de?s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("div",{className:"h-10 w-64 bg-gray-200 rounded animate-pulse"}),s.jsx("div",{className:"h-4 w-96 bg-gray-100 rounded animate-pulse mt-2"})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"h-12 bg-gray-100 rounded animate-pulse"}),s.jsx("div",{className:"h-96 bg-gray-50 rounded animate-pulse"})]})]}):s.jsxs("div",{className:"p-6 animate-in fade-in duration-300",children:[s.jsx("div",{className:"mb-6",children:s.jsx(G,{title:"Accounting",description:"Financial records and accounting management",icon:a,actions:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded border border-gray-200 font-mono",children:"Ctrl+K"}),s.jsx("span",{className:"text-xs text-gray-500",children:"Search"}),s.jsx("span",{className:"text-gray-300",children:"•"}),s.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded border border-gray-200 font-mono",children:"Ctrl+N"}),s.jsx("span",{className:"text-xs text-gray-500",children:"New Expense"})]})})}),s.jsxs(Z,{value:ge,onValueChange:he,className:"w-full",children:[s.jsxs(Q,{className:"grid w-full grid-cols-4 bg-gray-50/80 border border-gray-200/60 rounded-lg shadow-sm",children:[s.jsxs(X,{value:"overview",className:"flex items-center gap-2",children:[s.jsx(n,{className:"h-4 w-4"}),le("tabs.overview")]}),s.jsxs(X,{value:"expenses",className:"flex items-center gap-2",children:[s.jsx(r,{className:"h-4 w-4"}),le("tabs.expenses")]}),s.jsxs(X,{value:"net",className:"flex items-center gap-2",children:[s.jsx(a,{className:"h-4 w-4"}),le("tabs.net")]}),s.jsxs(X,{value:"analytics",className:"flex items-center gap-2",children:[s.jsx(i,{className:"h-4 w-4"}),le("tabs.analytics")]})]}),s.jsx(ee,{value:"overview",className:"mt-6",children:s.jsx("div",{className:"p-6",children:s.jsxs(B,{variant:"elevated",children:[s.jsxs(te,{children:[s.jsxs(se,{className:"flex items-center gap-2",children:[s.jsx(l,{className:"h-5 w-5 text-blue-600"}),"Accounting Overview"]}),s.jsx(ae,{children:"Your accounting dashboard overview"})]}),s.jsx(ne,{children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx(a,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Welcome to the Accounting section"}),s.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Select a tab above to get started"})]})})]})})}),s.jsx(ee,{value:"expenses",className:"mt-6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"relative w-full",children:s.jsxs("div",{className:"relative bg-gray-50 border border-gray-200 rounded-lg p-1.5",children:[s.jsx("div",{className:"absolute top-1.5 bottom-1.5 w-[calc(33.333%-0.5rem)] bg-white border border-gray-300 rounded-md transition-all duration-300 ease-out "+("all"===pe?"left-1.5":"daily"===pe?"left-[calc(33.333%+0.25rem)]":"left-[calc(66.666%+1rem)]")}),s.jsxs("div",{className:"relative grid grid-cols-3 gap-1.5",children:[s.jsxs("button",{onClick:()=>ye("all"),className:"group relative flex items-center justify-center gap-2.5 px-5 py-3.5 rounded-md font-semibold text-sm transition-all duration-300 ease-out outline-none focus:outline-none focus:ring-0 "+("all"===pe?"text-gray-900":"text-gray-600 hover:text-gray-900"),children:[s.jsx(r,{className:"h-4 w-4 transition-all duration-300 "+("all"===pe?"text-gray-900":"text-gray-500 group-hover:text-gray-700")}),s.jsx("span",{className:"relative z-10 transition-all duration-300",children:le("accounting.all_expenses")})]}),s.jsxs("button",{onClick:()=>ye("daily"),className:"group relative flex items-center justify-center gap-2.5 px-5 py-3.5 rounded-md font-semibold text-sm transition-all duration-300 ease-out outline-none focus:outline-none focus:ring-0 "+("daily"===pe?"text-gray-900":"text-gray-600 hover:text-gray-900"),children:[s.jsx(c,{className:"h-4 w-4 transition-all duration-300 "+("daily"===pe?"text-gray-900":"text-gray-500 group-hover:text-gray-700")}),s.jsx("span",{className:"relative z-10 transition-all duration-300",children:le("accounting.daily_summary")})]}),s.jsxs("button",{onClick:()=>ye("internal_revenue"),className:"group relative flex items-center justify-center gap-2.5 px-5 py-3.5 rounded-md font-semibold text-sm transition-all duration-300 ease-out outline-none focus:outline-none focus:ring-0 "+("internal_revenue"===pe?"text-gray-900":"text-gray-600 hover:text-gray-900"),children:[s.jsx(a,{className:"h-4 w-4 transition-all duration-300 "+("internal_revenue"===pe?"text-gray-900":"text-gray-500 group-hover:text-gray-700")}),s.jsx("span",{className:"relative z-10 transition-all duration-300",children:"Internal Revenue"})]})]})]})}),"all"===pe&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"bg-gray-50 px-6 py-5 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center border border-gray-200",children:s.jsx(r,{className:"h-5 w-5 text-gray-700"})}),le("accounting.company_expenses")]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:le("accounting.track_manage_expenses")})]}),s.jsxs(re,{onClick:Mt,className:"bg-gray-900 hover:bg-gray-800 text-white px-4 py-2 rounded-lg flex items-center gap-2 border border-gray-900 transition-all",children:[s.jsx(o,{className:"h-4 w-4"}),le("accounting.add_expense")]})]})}),s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[s.jsx(d,{className:"h-4 w-4 text-gray-500"}),"Search"]}),s.jsxs("div",{className:"relative",children:[s.jsx(d,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx(ie,{type:"text",placeholder:le("accounting.search_placeholder"),className:"pl-10 w-full border-gray-200 focus:border-gray-500 focus:ring-gray-500",value:Ye,onChange:e=>Me(e.target.value)}),Ye&&s.jsx("button",{onClick:()=>Me(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",title:le("accounting.clear_search"),children:s.jsx(m,{className:"h-4 w-4"})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[s.jsx(x,{className:"h-4 w-4 text-gray-500"}),le("accounting.status")]}),s.jsx("div",{className:"relative",children:s.jsxs("select",{value:Pe,onChange:e=>Oe(e.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-gray-500 bg-white appearance-none text-sm",children:[s.jsx("option",{value:"all",children:le("accounting.all_status")}),s.jsx("option",{value:"paid",children:le("accounting.status_paid")}),s.jsx("option",{value:"pending",children:le("accounting.status_pending")}),s.jsx("option",{value:"cancelled",children:le("accounting.status_cancelled")})]})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[s.jsx(x,{className:"h-4 w-4 text-gray-500"}),le("accounting.category")]}),s.jsx("div",{className:"relative",children:s.jsxs("select",{value:ze,onChange:e=>Ke(e.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-gray-500 bg-white appearance-none text-sm",children:[s.jsx("option",{value:"all",children:le("accounting.all_categories")}),s.jsx("option",{value:"inflow",children:le("accounting.category_inflow")}),s.jsx("option",{value:"outflow",children:le("accounting.category_outflow")})]})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Active Filters"}),s.jsxs("div",{className:"flex items-center gap-2 min-h-[40px]",children:[(Ye||"all"!==Pe||"all"!==ze)&&s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[Ye&&s.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded-md border border-gray-200",children:['Search: "',Ye.substring(0,20),Ye.length>20?"...":"",'"',s.jsx("button",{onClick:()=>Me(""),className:"hover:text-gray-900",children:s.jsx(m,{className:"h-3 w-3"})})]}),"all"!==Pe&&s.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded-md border border-gray-200",children:[le("accounting.status"),": ",le("paid"===Pe?"accounting.status_paid":"pending"===Pe?"accounting.status_pending":"accounting.status_cancelled"),s.jsx("button",{onClick:()=>Oe("all"),className:"hover:text-gray-900",children:s.jsx(m,{className:"h-3 w-3"})})]}),"all"!==ze&&s.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded-md border border-gray-200",children:[le("accounting.category"),": ",le("inflow"===ze?"accounting.category_inflow":"accounting.category_outflow"),s.jsx("button",{onClick:()=>Ke("all"),className:"hover:text-gray-900",children:s.jsx(m,{className:"h-3 w-3"})})]})]}),!Ye&&"all"===Pe&&"all"===ze&&s.jsx("span",{className:"text-xs text-gray-400",children:"No active filters"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Actions"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(re,{onClick:Ht,variant:"outline",className:"flex-1 border-gray-200 hover:border-gray-300 hover:bg-gray-50 flex items-center justify-center gap-2",disabled:0===Bt.length,size:"sm",children:[s.jsx(u,{className:"h-4 w-4"}),"Export"]}),(Ye||"all"!==Pe||"all"!==ze)&&s.jsx(re,{onClick:()=>{Me(""),Oe("all"),Ke("all")},variant:"outline",className:"border-gray-200 hover:border-gray-300 hover:bg-gray-50",size:"sm",title:"Clear all filters",children:s.jsx(m,{className:"h-4 w-4"})})]})]})]})})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(g,{className:"h-5 w-5 text-gray-700"}),"Expense Records"]}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Showing ",(nt-1)*it+1," to ",Math.min(nt*it,Bt.length)," of ",Bt.length," ",1===Bt.length?"expense":"expenses"]})]})})}),s.jsxs("div",{className:"overflow-x-auto",children:[s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"#"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:le("accounting.description")}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:le("accounting.detail")}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:le("accounting.category")}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:le("accounting.type")}),s.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:le("accounting.mount")}),s.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:le("accounting.status")}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:le("accounting.cost_period")}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:le("accounting.payment_date")}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:le("accounting.payment_period")}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:le("accounting.source")}),s.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:le("common.actions")})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:qt.map((e,t)=>s.jsxs("tr",{className:"hover:bg-gray-50 transition-colors group",children:[s.jsx("td",{className:"py-5 px-6 text-center",children:s.jsx("span",{className:"text-sm font-medium text-gray-600",children:(nt-1)*it+t+1})}),s.jsx("td",{className:"py-5 px-6",children:s.jsx("p",{className:"font-semibold text-gray-900 group-hover:text-gray-700 transition-colors",children:e.description})}),s.jsx("td",{className:"py-5 px-6",children:s.jsx("p",{className:"text-sm text-gray-600 max-w-xs truncate",title:e.detail,children:e.detail})}),s.jsx("td",{className:"py-5 px-6",children:s.jsx("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-semibold transition-all "+("inflow"===e.category?"bg-gray-100 text-gray-700 border border-gray-300":"bg-gray-200 text-gray-800 border border-gray-300"),children:"inflow"===e.category?le("accounting.category_inflow"):le("accounting.category_outflow")})}),s.jsx("td",{className:"py-5 px-6",children:s.jsx("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-semibold bg-gray-50 text-gray-700 border border-gray-200",children:"payment"===e.type?le("accounting.type_payment"):le("accounting.type_transfer")})}),s.jsxs("td",{className:"py-5 px-6 text-right",children:[s.jsx("p",{className:"font-bold text-gray-900 font-mono",children:"USD"===e.mount_currency?`$${e.amount_usd.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`:"USDT"===e.mount_currency?`₮${e.amount_usdt.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`:q(e.amount_try,"₺")}),s.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:e.mount_currency||"TRY"})]}),s.jsx("td",{className:"py-5 px-6 text-center",children:s.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-semibold transition-all "+("paid"===e.status?"bg-gray-100 text-gray-700 border border-gray-300":"pending"===e.status?"bg-gray-50 text-gray-600 border border-gray-200":"bg-gray-200 text-gray-800 border border-gray-300"),children:["paid"===e.status&&s.jsx(h,{className:"h-3.5 w-3.5"}),"pending"===e.status&&s.jsx(p,{className:"h-3.5 w-3.5"}),"cancelled"===e.status&&s.jsx(y,{className:"h-3.5 w-3.5"}),"paid"===e.status?"Ödendi":"pending"===e.status?"Beklemede":"İptal"]})}),s.jsx("td",{className:"py-5 px-6",children:s.jsx("p",{className:"text-sm text-gray-700",children:e.cost_period})}),s.jsx("td",{className:"py-5 px-6",children:s.jsx("p",{className:"text-sm text-gray-700",children:e.payment_date?new Date(e.payment_date).toLocaleDateString("tr-TR"):"-"})}),s.jsx("td",{className:"py-5 px-6",children:s.jsx("p",{className:"text-sm text-gray-700",children:e.payment_period})}),s.jsx("td",{className:"py-5 px-6",children:s.jsx("p",{className:"text-sm text-gray-700",children:e.source})}),s.jsx("td",{className:"py-5 px-6",children:s.jsxs("div",{className:"flex items-center justify-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[s.jsx(re,{variant:"ghost",size:"sm",onClick:()=>It(e),className:"h-9 w-9 p-0 hover:bg-gray-100 hover:text-gray-700 rounded-lg transition-all",title:"View expense details (read-only)","aria-label":"View expense",children:s.jsx(b,{className:"h-4 w-4"})}),s.jsx(re,{variant:"ghost",size:"sm",onClick:()=>At(e),className:"h-9 w-9 p-0 hover:bg-gray-100 hover:text-gray-700 rounded-lg transition-all",title:"Edit this expense","aria-label":"Edit expense",children:s.jsx(N,{className:"h-4 w-4"})}),s.jsx(re,{variant:"ghost",size:"sm",onClick:()=>Kt(e.id),className:"h-9 w-9 p-0 hover:bg-gray-200 hover:text-gray-900 rounded-lg transition-all",title:"Delete this expense (cannot be undone)","aria-label":"Delete expense",children:s.jsx(f,{className:"h-4 w-4"})})]})})]},e.id))})]}),0===Bt.length&&s.jsxs("div",{className:"text-center py-16",children:[s.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:s.jsx(j,{className:"h-10 w-10 text-gray-600"})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No expenses found"}),s.jsx("p",{className:"text-sm text-gray-600 max-w-md mx-auto mb-6",children:Ye||"all"!==Pe||"all"!==ze?"No expenses match your current search or filter criteria. Try adjusting your filters to see more results.":"You haven't added any expenses yet. Start tracking your company expenses by adding your first entry."}),!Ye&&"all"===Pe&&"all"===ze&&s.jsxs(re,{onClick:Mt,className:"bg-gray-900 hover:bg-gray-800 text-white px-4 py-2 rounded-lg flex items-center gap-2 mx-auto border border-gray-900 transition-all",children:[s.jsx(o,{className:"h-4 w-4"}),"Add Your First Expense"]}),(Ye||"all"!==Pe||"all"!==ze)&&s.jsxs(re,{variant:"outline",onClick:()=>{Me(""),Oe("all"),Ke("all")},className:"border-gray-200 hover:border-gray-300 hover:bg-gray-50 px-4 py-2 rounded-lg flex items-center gap-2 mx-auto",children:[s.jsx(m,{className:"h-4 w-4"}),"Clear Filters"]})]}),Bt.length>it&&s.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",nt," of ",Jt]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(re,{variant:"outline",size:"sm",onClick:()=>rt(e=>Math.max(e-1,1)),disabled:1===nt,className:"flex items-center gap-2",children:[s.jsx(v,{className:"h-4 w-4"}),"Previous"]}),s.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,Jt)},(e,t)=>{let a;return a=Jt<=5||nt<=3?t+1:nt>=Jt-2?Jt-4+t:nt-2+t,s.jsx(re,{variant:nt===a?"default":"outline",size:"sm",onClick:()=>rt(a),className:"min-w-[40px] h-9",children:a},a)})}),s.jsxs(re,{variant:"outline",size:"sm",onClick:()=>rt(e=>Math.min(e+1,Jt)),disabled:nt===Jt,className:"flex items-center gap-2",children:["Next",s.jsx(_,{className:"h-4 w-4"})]})]})]})})]})]}),$e.length>0&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 hover:border-gray-300 transition-all duration-200 group",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("div",{className:"w-14 h-14 bg-gray-50 border border-gray-200 rounded-lg flex items-center justify-center group-hover:bg-gray-100 transition-all duration-200",children:s.jsx(w,{className:"h-7 w-7 text-gray-700 group-hover:text-gray-900 transition-colors"})}),s.jsx("div",{className:"text-right",children:s.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Total TRY"})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("p",{className:"text-3xl font-bold text-slate-900 font-mono tracking-tight",children:q(Vt.totalTRY,"₺")}),s.jsx("p",{className:"text-sm text-slate-600 font-medium",children:"Turkish Lira"})]})]})}),s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 hover:border-gray-300 transition-all duration-200 group",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("div",{className:"w-14 h-14 bg-gray-50 border border-gray-200 rounded-lg flex items-center justify-center group-hover:bg-gray-100 transition-all duration-200",children:s.jsx(k,{className:"h-7 w-7 text-gray-700 group-hover:text-gray-900 transition-colors"})}),s.jsx("div",{className:"text-right",children:s.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Total USD"})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("p",{className:"text-3xl font-bold text-slate-900 font-mono tracking-tight",children:["$",Vt.totalUSD.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsx("p",{className:"text-sm text-slate-600 font-medium",children:"US Dollar"})]})]})}),s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 hover:border-gray-300 transition-all duration-200 group",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("div",{className:"w-14 h-14 bg-gray-50 border border-gray-200 rounded-lg flex items-center justify-center group-hover:bg-gray-100 transition-all duration-200",children:s.jsx(r,{className:"h-7 w-7 text-gray-700 group-hover:text-gray-900 transition-colors"})}),s.jsx("div",{className:"text-right",children:s.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Total Entries"})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("p",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:Vt.count}),s.jsx("p",{className:"text-sm text-slate-600 font-medium",children:"Expense Records"})]})]})})]})]}),"daily"===pe&&s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"bg-gray-50 px-6 py-5 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center border border-gray-200",children:s.jsx(c,{className:"h-5 w-5 text-gray-700"})}),le("accounting.daily_expenses")]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:le("accounting.daily_breakdown")})]}),s.jsx(J,{variant:"info",size:"md",children:le("accounting.payment_date_grouped")})]})}),s.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(c,{className:"h-5 w-5 text-gray-600"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:le("accounting.select_period")}),s.jsx("p",{className:"text-xs text-gray-600",children:"Choose month and year for analysis"})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Month"}),s.jsxs("select",{value:ve,onChange:e=>_e(parseInt(e.target.value)),className:"px-3 py-2 text-sm border border-gray-300 rounded-md bg-white focus:ring-2 focus:ring-gray-500 focus:border-gray-500 font-medium min-w-[120px]",children:[s.jsx("option",{value:1,children:le("accounting.january")}),s.jsx("option",{value:2,children:le("accounting.february")}),s.jsx("option",{value:3,children:le("accounting.march")}),s.jsx("option",{value:4,children:le("accounting.april")}),s.jsx("option",{value:5,children:le("accounting.may")}),s.jsx("option",{value:6,children:le("accounting.june")}),s.jsx("option",{value:7,children:le("accounting.july")}),s.jsx("option",{value:8,children:le("accounting.august")}),s.jsx("option",{value:9,children:le("accounting.september")}),s.jsx("option",{value:10,children:le("accounting.october")}),s.jsx("option",{value:11,children:le("accounting.november")}),s.jsx("option",{value:12,children:le("accounting.december")})]})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Year"}),s.jsx("select",{value:we,onChange:e=>ke(parseInt(e.target.value)),className:"px-3 py-2 text-sm border border-gray-300 rounded-md bg-white focus:ring-2 focus:ring-gray-500 focus:border-gray-500 font-medium min-w-[100px]",children:Array.from({length:5},(e,t)=>{const a=(new Date).getFullYear()-2+t;return s.jsx("option",{value:a,children:a},a)})})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide opacity-0",children:"Action"}),s.jsx("button",{onClick:()=>{_e((new Date).getMonth()+1),ke((new Date).getFullYear())},className:"px-4 py-2 text-sm bg-gray-800 text-white rounded-md hover:bg-gray-900 transition-colors font-medium",children:le("accounting.current_month")})]})]})]})}),s.jsx("div",{className:"overflow-x-auto",children:Wt.length>0?s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(c,{className:"h-4 w-4 text-gray-500"}),le("accounting.payment_date"),s.jsx("button",{onClick:()=>Ce("desc"===Se?"asc":"desc"),className:"p-1 hover:bg-gray-200 rounded transition-colors",title:le("desc"===Se?"accounting.sort_ascending":"accounting.sort_descending"),children:"desc"===Se?s.jsx("svg",{className:"h-3 w-3 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):s.jsx("svg",{className:"h-3 w-3 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})})]})}),s.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider",children:s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx(w,{className:"h-4 w-4 text-gray-500"}),"TRY"]})}),s.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider",children:s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx(w,{className:"h-4 w-4 text-gray-500"}),"USD"]})})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Wt.map((e,t)=>s.jsxs(S.Fragment,{children:[s.jsxs("tr",{onClick:()=>Fe(De===e.date?null:e.date),className:"hover:bg-gray-50 transition-colors group cursor-pointer",children:[s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(c,{className:"h-5 w-5 text-gray-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-gray-900 text-base",children:new Date(e.date).toLocaleDateString("tr"===ce?"tr-TR":"en-US",{day:"2-digit",month:"long",year:"numeric"})}),s.jsxs("p",{className:"text-sm text-gray-600 mt-0.5",children:[e.count," ",1===e.count?"transaction":"transactions"]})]})]})}),s.jsx("td",{className:"px-6 py-4 text-right",children:s.jsx("p",{className:"text-lg font-semibold text-gray-900 font-mono",children:q(e.totalTRY,"₺")})}),s.jsx("td",{className:"px-6 py-4 text-right",children:s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsxs("p",{className:"text-lg font-semibold text-gray-900 font-mono",children:["$",e.totalUSD.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsx("div",{className:"transition-transform duration-200 "+(De===e.date?"rotate-180":""),children:s.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})})]},e.date),De===e.date&&s.jsx("tr",{className:"bg-slate-50",children:s.jsx("td",{colSpan:3,className:"px-6 py-6",children:s.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm overflow-hidden",children:[s.jsx("div",{className:"px-6 py-4 bg-slate-50 border-b border-slate-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-9 h-9 bg-slate-100 rounded-lg flex items-center justify-center",children:s.jsx(r,{className:"h-5 w-5 text-slate-700"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-slate-900 text-sm",children:le("accounting.expenses_for_date").replace("{count}",e.count.toString())}),s.jsx("p",{className:"text-xs text-slate-600 mt-0.5",children:"Detailed transaction breakdown"})]})]}),s.jsxs("div",{className:"flex items-center gap-6 text-xs",children:[s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-slate-500 font-medium uppercase tracking-wide",children:"Total TRY"}),s.jsx("p",{className:"text-slate-900 font-semibold text-sm mt-0.5 font-mono",children:q(e.totalTRY,"₺")})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-slate-500 font-medium uppercase tracking-wide",children:"Total USD"}),s.jsxs("p",{className:"text-slate-900 font-semibold text-sm mt-0.5 font-mono",children:["$",e.totalUSD.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]})}),s.jsx("div",{className:"overflow-hidden",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider w-[40%]",children:"Description"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider w-[30%]",children:"Details"}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-700 uppercase tracking-wider w-[12%]",children:"TRY"}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-700 uppercase tracking-wider w-[12%]",children:"USD"}),s.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider w-[6%]",children:le("accounting.status")})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-slate-100",children:e.expenses.map((e,t)=>s.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"mt-0.5",children:s.jsx(r,{className:"h-4 w-4 text-slate-400"})}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("p",{className:"font-semibold text-slate-900 text-sm leading-tight",children:e.description}),s.jsxs("p",{className:"text-xs text-slate-500 mt-1 font-medium",children:["ID: ",e.id]})]})]})}),s.jsx("td",{className:"px-4 py-4",children:s.jsx("p",{className:"text-xs text-slate-600 leading-relaxed line-clamp-2",children:e.detail})}),s.jsx("td",{className:"px-4 py-4 text-right",children:s.jsx("p",{className:"text-sm font-semibold text-slate-900 font-mono tabular-nums",children:q(e.amount_try,"₺")})}),s.jsx("td",{className:"px-4 py-4 text-right",children:s.jsxs("p",{className:"text-sm font-semibold text-slate-900 font-mono tabular-nums",children:["$",e.amount_usd.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("div",{className:"flex justify-center",children:s.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-md text-xs font-semibold uppercase tracking-wide "+("paid"===e.status?"bg-emerald-50 text-emerald-700 border border-emerald-200":"pending"===e.status?"bg-amber-50 text-amber-700 border border-amber-200":"bg-rose-50 text-rose-700 border border-rose-200"),children:"paid"===e.status?le("accounting.paid"):"pending"===e.status?le("accounting.pending"):le("accounting.cancelled")})})})]},e.id))})]})})]})})})]},e.date))}),s.jsx("tfoot",{className:"bg-gray-100 border-t border-gray-300",children:s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"h-5 w-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-gray-900 text-lg",children:"Grand Total"}),s.jsxs("p",{className:"text-sm text-gray-600 mt-0.5",children:[Wt.length," ",1===Wt.length?"day":"days"," • ",Wt.reduce((e,t)=>e+t.count,0)," total transactions"]})]})]})}),s.jsx("td",{className:"px-6 py-4 text-right",children:s.jsx("p",{className:"text-xl font-semibold text-gray-900 font-mono",children:q(Wt.reduce((e,t)=>e+t.totalTRY,0),"₺")})}),s.jsx("td",{className:"px-6 py-4 text-right",children:s.jsxs("p",{className:"text-xl font-semibold text-gray-900 font-mono",children:["$",Wt.reduce((e,t)=>e+t.totalUSD,0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]})})]}):s.jsxs("div",{className:"text-center py-16",children:[s.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:s.jsx(c,{className:"h-10 w-10 text-gray-600"})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:le("accounting.no_daily_data")}),s.jsx("p",{className:"text-sm text-gray-600 max-w-md mx-auto mb-6",children:le("accounting.no_daily_data_desc")}),s.jsxs(re,{onClick:()=>ye("all"),className:"bg-gray-900 hover:bg-gray-800 text-white px-4 py-2 rounded-lg flex items-center gap-2 mx-auto border border-gray-900 transition-all",children:[s.jsx(r,{className:"h-4 w-4"}),le("accounting.all_expenses")]})]})})]})}),"internal_revenue"===pe&&s.jsx("div",{className:"space-y-6",children:Rt.length>0&&s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[s.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Month:"}),s.jsxs("select",{value:Be,onChange:e=>Ut(e.target.value),disabled:Qe,className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 bg-white text-sm",children:[s.jsxs("option",{value:(new Date).toISOString().slice(0,7),children:["Current Month (",(new Date).toISOString().slice(0,7),")"]}),Je.map(e=>s.jsxs("option",{value:e.month_period,children:[e.month_period," ",e.is_locked?"🔒":""]},e.month_period))]}),We&&s.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-md text-xs font-semibold bg-orange-100 text-orange-700 border border-orange-200",children:[s.jsx(C,{className:"h-3 w-3 mr-1"}),"Locked"]}),Qe&&s.jsx("span",{className:"text-sm text-gray-500",children:"Loading..."})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(re,{onClick:Lt,disabled:We||Ge||Qe,className:"bg-gray-900 hover:bg-gray-800 text-white disabled:opacity-50",size:"sm",children:[s.jsx(D,{className:"h-4 w-4 mr-2"}),Ge?"Saving...":"Save Month Data"]}),!We&&Be!==(new Date).toISOString().slice(0,7)&&s.jsxs(re,{onClick:Et,variant:"outline",size:"sm",className:"border-orange-500 text-orange-600 hover:bg-orange-50",children:[s.jsx(C,{className:"h-4 w-4 mr-2"}),"Lock Month"]}),We&&s.jsxs(re,{onClick:Yt,variant:"outline",size:"sm",className:"border-green-500 text-green-600 hover:bg-green-50",children:[s.jsx(F,{className:"h-4 w-4 mr-2"}),"Unlock"]})]})]}),s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(a,{className:"h-5 w-5 text-gray-700"}),"Currency Summary"]}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Summary grouped by currency with inflow/outflow calculations.",We?" (Read-only - month is locked)":" Edit DEVİR and KUR, then click Save."]})]})})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Currency"}),s.jsxs("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider",children:["DEVİR",s.jsx("br",{}),"(Carryover)"]}),s.jsxs("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider",children:["GİREN",s.jsx("br",{}),"(Inflow)"]}),s.jsxs("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider",children:["ÇIKAN",s.jsx("br",{}),"(Outflow)"]}),s.jsx("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"NET"}),s.jsxs("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider",children:["USD ÇEVRİM",s.jsx("br",{}),"(USD Conversion)"]}),s.jsxs("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider",children:["KUR",s.jsx("br",{}),"(Rate)"]})]})}),s.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[Rt.map((e,t)=>s.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:"font-semibold text-gray-900",children:e.currency})}),s.jsx("td",{className:"px-6 py-4 text-right",children:s.jsxs("div",{className:"flex items-center justify-end gap-2",children:["TRY"===e.currency?s.jsx("span",{className:"text-gray-500 text-sm",children:"₺"}):s.jsx("span",{className:"text-gray-500 text-sm",children:"$"}),s.jsx(ie,{type:"number",step:"0.01",value:st[e.currency]||0,onChange:t=>{const s=parseFloat(t.target.value)||0;at({...st,[e.currency]:s})},disabled:We,className:"w-32 h-9 text-sm font-mono text-right border-gray-300 focus:border-gray-500 focus:ring-gray-500 "+(We?"bg-gray-100 cursor-not-allowed":""),placeholder:"0.00"})]})}),s.jsx("td",{className:"px-6 py-4 text-right",children:s.jsx("span",{className:"text-sm font-mono text-gray-700",children:"TRY"===e.currency?q(e.inflow,"₺"):(e.currency,`$${e.inflow.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`)})}),s.jsx("td",{className:"px-6 py-4 text-right",children:s.jsx("span",{className:"text-sm font-mono text-gray-700",children:"TRY"===e.currency?q(e.outflow,"₺"):(e.currency,`$${e.outflow.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`)})}),s.jsx("td",{className:"px-6 py-4 text-right",children:s.jsx("span",{className:"text-sm font-bold font-mono "+(e.net>=0?"text-gray-900":"text-red-600"),children:"TRY"===e.currency?q(e.net,"₺"):(e.currency,`$${e.net.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`)})}),s.jsx("td",{className:"px-6 py-4 text-right",children:s.jsxs("span",{className:"text-sm font-bold font-mono text-gray-900",children:["$",e.usdEquivalent.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})}),s.jsx("td",{className:"px-6 py-4 text-right",children:"TRY"===e.currency?s.jsx("div",{className:"flex items-center justify-end gap-2",children:s.jsx(ie,{type:"number",step:"0.01",value:et.TRY||"",onChange:e=>{tt({...et,TRY:e.target.value})},disabled:We,className:"w-24 h-9 text-sm font-mono text-right border-gray-300 focus:border-gray-500 focus:ring-gray-500 "+(We?"bg-gray-100 cursor-not-allowed":""),placeholder:"0.00"})}):s.jsx("span",{className:"text-sm font-mono text-gray-700",children:"-"})})]},e.currency)),s.jsxs("tr",{className:"bg-gray-50 font-semibold",children:[s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:"font-bold text-gray-900",children:"KASA TOPLAM"})}),s.jsx("td",{className:"px-6 py-4 text-right",children:s.jsx("span",{className:"text-sm font-mono text-gray-700",children:"-"})}),s.jsx("td",{className:"px-6 py-4 text-right",children:s.jsx("span",{className:"text-sm font-mono text-gray-700",children:"-"})}),s.jsx("td",{className:"px-6 py-4 text-right",children:s.jsx("span",{className:"text-sm font-mono text-gray-700",children:"-"})}),s.jsx("td",{className:"px-6 py-4 text-right",children:s.jsx("span",{className:"text-sm font-mono text-gray-700",children:"-"})}),s.jsx("td",{className:"px-6 py-4 text-right",children:s.jsxs("span",{className:"text-sm font-bold font-mono text-gray-900",children:["$",Rt.reduce((e,t)=>e+t.usdEquivalent,0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})}),s.jsx("td",{className:"px-6 py-4 text-right",children:s.jsx("span",{className:"text-sm font-mono text-gray-700",children:"-"})})]})]})]})})]})})]})}),s.jsx(ee,{value:"analytics",className:"mt-6",children:"analytics"===ge&&s.jsx("div",{className:"p-6 animate-in fade-in duration-300",children:s.jsxs(B,{variant:"elevated",children:[s.jsxs(te,{children:[s.jsx(se,{children:"Accounting Analytics"}),s.jsx(ae,{children:"Financial analytics and reporting"})]}),s.jsx(ne,{children:s.jsx("p",{className:"text-gray-600",children:"Accounting analytics will be displayed here."})})]})})}),s.jsx(ee,{value:"net",className:"mt-6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"relative w-full",children:s.jsxs("div",{className:"relative bg-gradient-to-r from-slate-50/90 via-white/80 to-slate-50/90 backdrop-blur-sm border border-slate-200/60 rounded-xl shadow-lg shadow-slate-200/20 p-1.5",children:[s.jsx("div",{className:"absolute top-1.5 bottom-1.5 w-[calc(50%-0.375rem)] bg-gray-100/50 backdrop-blur-sm border border-gray-200/40 rounded-lg shadow-sm transition-all duration-300 ease-out "+("calculator"===be?"left-1.5":"right-1.5")}),s.jsxs("div",{className:"relative grid grid-cols-2 gap-1.5",children:[s.jsxs("button",{onClick:()=>Ne("calculator"),className:"group relative flex items-center justify-center gap-2.5 px-5 py-3.5 rounded-lg font-semibold text-sm transition-all duration-300 ease-out outline-none focus:outline-none focus:ring-0 "+("calculator"===be?"text-green-700 shadow-sm":"text-slate-600 hover:text-slate-800 hover:bg-slate-50/50"),children:[s.jsx(a,{className:"h-4 w-4 transition-all duration-300 "+("calculator"===be?"text-green-600 scale-110":"text-slate-500 group-hover:text-slate-700 group-hover:scale-105")}),s.jsx("span",{className:"relative z-10 transition-all duration-300",children:"Net Calculator"}),"calculator"===be&&s.jsx("div",{className:"absolute inset-0 rounded-lg bg-gray-100/20 animate-pulse"})]}),s.jsxs("button",{onClick:()=>Ne("daily"),className:"group relative flex items-center justify-center gap-2.5 px-5 py-3.5 rounded-lg font-semibold text-sm transition-all duration-300 ease-out outline-none focus:outline-none focus:ring-0 "+("daily"===be?"text-green-700 shadow-sm":"text-slate-600 hover:text-slate-800 hover:bg-slate-50/50"),children:[s.jsx(c,{className:"h-4 w-4 transition-all duration-300 "+("daily"===be?"text-green-600 scale-110":"text-slate-500 group-hover:text-slate-700 group-hover:scale-105")}),s.jsx("span",{className:"relative z-10 transition-all duration-300",children:"Daily Net"}),"daily"===be&&s.jsx("div",{className:"absolute inset-0 rounded-lg bg-gray-100/20 animate-pulse"})]})]})]})}),"calculator"===be&&s.jsx("div",{className:"animate-in fade-in duration-300",children:s.jsxs(B,{variant:"elevated",children:[s.jsxs(te,{children:[s.jsxs(se,{className:"flex items-center gap-2",children:[s.jsx(a,{className:"h-5 w-5 text-green-700"}),le("accounting.net.title")]}),s.jsx(ae,{children:le("accounting.net.subtitle")})]}),s.jsx(ne,{children:s.jsx(Ct,{expenses:$e,recordToLoad:fe,onRecordLoaded:()=>je(null)})})]})}),"daily"===be&&s.jsx("div",{className:"animate-in fade-in duration-300",children:s.jsx(Dt,{onLoadRecord:e=>{je(e),Ne("calculator")}})})]})})]}),lt&&s.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:e=>{e.target===e.currentTarget&&Pt()},onKeyDown:e=>{"Escape"===e.key&&Pt()},tabIndex:-1,children:s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 max-w-2xl w-full max-h-[90vh] overflow-hidden",children:[s.jsx("div",{className:"bg-gray-50 px-6 py-5 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center border border-gray-200",children:s.jsx(r,{className:"h-5 w-5 text-gray-700"})}),le(ut?"accounting.view_expense":mt?"accounting.edit_expense":"accounting.add_new_expense")]}),s.jsx("button",{onClick:Pt,className:"w-8 h-8 rounded-lg hover:bg-gray-100 flex items-center justify-center transition-colors",children:s.jsx(m,{className:"h-5 w-5 text-gray-500"})})]})}),s.jsx("div",{className:"overflow-y-auto max-h-[calc(90vh-140px)]",children:s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-sm font-bold text-gray-900 uppercase tracking-wide flex items-center gap-2",children:[s.jsx("div",{className:"w-1 h-4 bg-gray-700 rounded-full"}),le("accounting.basic_information")]}),s.jsxs("div",{className:"pl-4 space-y-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[le("accounting.description")," ",!ut&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(ie,{type:"text",placeholder:le("accounting.description_placeholder"),value:yt.description,onChange:e=>bt({...yt,description:e.target.value}),className:"w-full h-11 text-base",disabled:ut})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:le("accounting.detail")}),s.jsx(ie,{type:"text",placeholder:le("accounting.detail_placeholder"),value:yt.detail,onChange:e=>bt({...yt,detail:e.target.value}),className:"w-full h-11 text-base",disabled:ut})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[le("accounting.category")," ",!ut&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("select",{value:yt.category,onChange:e=>bt({...yt,category:e.target.value}),className:"w-full h-11 px-3 py-2 border border-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-gray-500 disabled:bg-gray-100 disabled:cursor-not-allowed text-base",disabled:ut,children:[s.jsx("option",{value:"inflow",children:le("accounting.category_inflow")}),s.jsx("option",{value:"outflow",children:le("accounting.category_outflow")})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[le("accounting.type")," ",!ut&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("select",{value:yt.type,onChange:e=>bt({...yt,type:e.target.value}),className:"w-full h-11 px-3 py-2 border border-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-gray-500 disabled:bg-gray-100 disabled:cursor-not-allowed text-base",disabled:ut,children:[s.jsx("option",{value:"payment",children:le("accounting.type_payment")}),s.jsx("option",{value:"transfer",children:le("accounting.type_transfer")})]})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-sm font-bold text-gray-900 uppercase tracking-wide flex items-center gap-2",children:[s.jsx("div",{className:"w-1 h-4 bg-gray-700 rounded-full"}),le("accounting.financial_details")]}),s.jsxs("div",{className:"pl-4 space-y-4",children:[s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[le("accounting.mount")," ",!ut&&s.jsx("span",{className:"text-red-500",children:"*"})]}),!ut&&s.jsxs("div",{className:"flex items-center gap-3 mb-3 p-3 bg-gray-50 border border-gray-200 rounded-md",children:[s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:kt,onChange:e=>St(e.target.checked),className:"w-4 h-4 rounded border-gray-300 text-gray-700 focus:ring-gray-500 focus:ring-2"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Converter"})]}),s.jsx("span",{className:"text-xs px-2 py-1 rounded "+(kt?"bg-gray-200 text-gray-700":"bg-gray-100 text-gray-500"),children:kt?"ON":"OFF"})]}),!ut&&s.jsxs("div",{className:"flex items-center gap-4 mb-3 p-3 bg-gray-50 border border-gray-200 rounded-md",children:[s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"radio",value:"TRY",checked:"TRY"===yt.mount_currency,onChange:e=>bt({...yt,mount_currency:e.target.value}),className:"w-4 h-4 text-gray-700"}),s.jsx("span",{className:"font-medium text-sm",children:"₺ TRY"})]}),s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"radio",value:"USD",checked:"USD"===yt.mount_currency,onChange:e=>bt({...yt,mount_currency:e.target.value}),className:"w-4 h-4 text-gray-700"}),s.jsx("span",{className:"font-medium text-sm",children:"$ USD"})]}),s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"radio",value:"USDT",checked:"USDT"===yt.mount_currency,onChange:e=>bt({...yt,mount_currency:e.target.value}),className:"w-4 h-4 text-gray-700"}),s.jsx("span",{className:"font-medium text-sm",children:"₮ USDT"})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-semibold",children:"TRY"===yt.mount_currency?"₺":"USD"===yt.mount_currency?"$":"₮"}),s.jsx(ie,{type:"number",step:"0.01",placeholder:"0.00",value:yt.amount,onChange:e=>bt({...yt,amount:e.target.value}),className:"w-full h-11 pl-8 text-base font-mono",disabled:ut})]}),!ut&&yt.amount&&parseFloat(yt.amount)>0&&s.jsx("div",{className:"mt-3 p-3 bg-gray-50 border border-gray-200 rounded-md space-y-2",children:kt?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"text-xs font-semibold text-gray-600 mb-2",children:[le("accounting.calculated_amounts"),":"]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("span",{className:"text-gray-500",children:"₺"}),s.jsxs("span",{className:"font-mono text-gray-700",children:[Nt.amount_try.toFixed(2)," TRY"]})]}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("span",{className:"text-gray-500",children:"$"}),s.jsxs("span",{className:"font-mono text-gray-700",children:[Nt.amount_usd.toFixed(2)," USD"]})]}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("span",{className:"text-gray-500",children:"₮"}),s.jsxs("span",{className:"font-mono text-gray-700",children:[Nt.amount_usdt.toFixed(2)," USDT"]})]})]}),jt&&"USDT"!==yt.mount_currency&&s.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[le("accounting.rate"),": 1 USD = ",jt.toFixed(4)," TRY"]})]}):s.jsxs("div",{className:"text-xs text-gray-500",children:["Converter is OFF - Only ","TRY"===yt.mount_currency?"₺ TRY":"USD"===yt.mount_currency?"$ USD":"₮ USDT"," amount will be saved"]})}),ut&&s.jsx("div",{className:"mt-3 p-3 bg-gray-50 border border-gray-200 rounded-md space-y-2",children:s.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("span",{className:"text-gray-500",children:"₺"}),s.jsxs("span",{className:"font-mono text-gray-700",children:[Nt.amount_try.toFixed(2)," TRY"]})]}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("span",{className:"text-gray-500",children:"$"}),s.jsxs("span",{className:"font-mono text-gray-700",children:[Nt.amount_usd.toFixed(2)," USD"]})]}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("span",{className:"text-gray-500",children:"₮"}),s.jsxs("span",{className:"font-mono text-gray-700",children:[Nt.amount_usdt.toFixed(2)," USDT"]})]})]})})]})}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:le("accounting.status")}),s.jsxs("select",{value:yt.status,onChange:e=>bt({...yt,status:e.target.value}),className:"w-full h-11 px-3 py-2 border border-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-gray-500 disabled:bg-gray-100 disabled:cursor-not-allowed text-base",disabled:ut,children:[s.jsx("option",{value:"pending",children:le("accounting.status_pending")}),s.jsx("option",{value:"paid",children:le("accounting.status_paid")}),s.jsx("option",{value:"cancelled",children:le("accounting.status_cancelled")})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:le("accounting.source")}),s.jsx(ie,{type:"text",placeholder:le("accounting.source_placeholder"),value:yt.source,onChange:e=>bt({...yt,source:e.target.value}),className:"w-full h-11 text-base",disabled:ut})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-sm font-bold text-gray-900 uppercase tracking-wide flex items-center gap-2",children:[s.jsx("div",{className:"w-1 h-4 bg-gray-700 rounded-full"}),le("accounting.period_information")]}),s.jsxs("div",{className:"pl-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:le("accounting.cost_period")}),s.jsx(ie,{type:"text",placeholder:le("accounting.period_placeholder"),value:yt.cost_period,onChange:e=>bt({...yt,cost_period:e.target.value}),className:"w-full h-11 text-base",disabled:ut})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:le("accounting.payment_date")}),s.jsx(ie,{type:"date",value:yt.payment_date,onChange:e=>bt({...yt,payment_date:e.target.value}),className:"w-full h-11 text-base",disabled:ut})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:le("accounting.payment_period")}),s.jsx(ie,{type:"text",placeholder:le("accounting.period_placeholder"),value:yt.payment_period,onChange:e=>bt({...yt,payment_period:e.target.value}),className:"w-full h-11 text-base",disabled:ut})]})]})]})]})]})}),s.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[ht?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-sm text-gray-700 font-medium",children:le("accounting.expense_added_success")})}),s.jsxs(re,{variant:"outline",onClick:Mt,className:"px-4 py-2 border-gray-200 hover:border-gray-300 hover:bg-gray-50",children:[s.jsx(o,{className:"h-4 w-4 mr-2"}),le("accounting.add_another")]}),s.jsx(re,{onClick:Pt,className:"px-4 py-2 bg-gray-900 hover:bg-gray-800 text-white border border-gray-900",children:le("accounting.close")})]}):ut?null:s.jsxs(s.Fragment,{children:[s.jsxs(re,{variant:"outline",onClick:Pt,className:"px-4 py-2 border-gray-200 hover:border-gray-300 hover:bg-gray-50",children:[s.jsx(m,{className:"h-4 w-4 mr-2"}),le("common.cancel")]}),s.jsxs(re,{onClick:zt,disabled:!yt.description||!yt.category||!yt.type||!yt.amount||parseFloat(yt.amount)<=0,className:"px-4 py-2 bg-gray-900 hover:bg-gray-800 text-white disabled:opacity-50 disabled:cursor-not-allowed border border-gray-900",children:[s.jsx(h,{className:"h-4 w-4 mr-2"}),le(mt?"accounting.update_expense":"accounting.add_expense")]})]}),ut&&s.jsxs(re,{variant:"outline",onClick:Pt,className:"px-4 py-2 border-gray-200 hover:border-gray-300 hover:bg-gray-50",children:[s.jsx(m,{className:"h-4 w-4 mr-2"}),le("accounting.close")]})]})]})})]})}export{le as default};
