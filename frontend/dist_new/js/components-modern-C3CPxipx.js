import{u as e,r as t,j as s,S as a,X as r,F as n,D as i,C as l,A as o,U as c,B as d,L as m,H as h,a as u,R as x,M as g,b as p,I as y,T as f,c as b,d as j,e as v,f as N,g as w,h as _,O as k,i as C,k as S,l as D,m as T,n as E,o as A,p as L,q as R,s as P,t as M,w as O,v as $,E as z,x as F,y as U,z as I,G as B,J as W,K as G,N as Y,P as q,Q as H,V,W as Z,Y as J}from"./vendor-react-OTlZW24_.js";import{u as K,a as X,b as Q}from"./contexts-ClDLaFbv.js";import{I as ee,B as te,C as se,a as ae,b as re,M as ne,c as ie,T as le,d as oe,S as ce,D as de,e as me,f as he,g as ue}from"./components-ui-CpjZxCxu.js";import{t as xe,c as ge}from"./vendor-utils-CtF19A-_.js";import{R as pe,P as ye,a as fe,C as be,T as je,L as ve,b as Ne,X as we,Y as _e,c as ke,B as Ce,d as Se,A as De,e as Te}from"./vendor-charts-recharts-DLiVWtHJ.js";const Ee={},Ae=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),r=s?.nonce||s?.getAttribute("nonce");a=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in Ee)return;Ee[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${s}`))return;const a=document.createElement("link");return a.rel=t?"stylesheet":"modulepreload",t||(a.as="script"),a.crossOrigin="",a.href=e,r&&a.setAttribute("nonce",r),document.head.appendChild(a),t?new Promise((t,s)=>{a.addEventListener("load",t),a.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return a.then(t=>{for(const e of t||[])"rejected"===e.status&&r(e.reason);return e().catch(r)})},Le=new class{isDevelopment=!1;isProduction=!0;shouldLog(e){return!this.isProduction||"error"===e||"warn"===e}debug(...e){this.shouldLog("debug")}info(...e){this.shouldLog("info")}warn(...e){this.shouldLog("warn")}error(...e){this.shouldLog("error")}dashboard(e,t){}api(e,t,s){}performance(e,t,s="ms"){}clients(e,t){}transaction(e,t){}health(e,t){}},Re=new class{baseUrl;defaultOptions;cache=new Map;onUnauthorizedCallback=null;unauthorizedAttempts=new Map;MAX_UNAUTHORIZED_ATTEMPTS=2;constructor(e="/api/v1",t={}){this.baseUrl=e,this.defaultOptions={timeout:15e3,retries:3,retryDelay:1e3,retryOn:[408,429,500,502,503,504],...t}}setOnUnauthorized(e){this.onUnauthorizedCallback=e}async retry(e,t,s=0){try{return await e()}catch(a){if(s<t.retries&&(t.retryOn.includes(a.status)||"AbortError"===a.name||"NetworkError"===a.name)){const r=t.retryDelay*Math.pow(2,s);return Le.warn(`Retry attempt ${s+1}/${t.retries} after ${r}ms`,a),await new Promise(e=>setTimeout(e,r)),this.retry(e,t,s+1)}throw a}}createTimeoutController(e){const t=new AbortController;return setTimeout(()=>t.abort(),e),t}handleUnauthorized(e,t){const s=this.unauthorizedAttempts.get(e)||0;s<this.MAX_UNAUTHORIZED_ATTEMPTS?(this.unauthorizedAttempts.set(e,s+1),Le.warn(`Unauthorized response (${t}) from ${e} - attempt ${s+1}/${this.MAX_UNAUTHORIZED_ATTEMPTS}. May be temporary.`),setTimeout(()=>{this.unauthorizedAttempts.delete(e)},1e4)):(Le.error(`Multiple unauthorized responses (${t}) from ${e}, redirecting to login`),this.unauthorizedAttempts.delete(e),this.onUnauthorizedCallback?this.onUnauthorizedCallback():"undefined"!=typeof window&&"/login"!==window.location.pathname&&(window.location.href="/login"))}handleError(e,t){if("AbortError"===e.name)return new Error("Request timeout. Please try again.");if(e.message?.includes("Failed to fetch")||e.message?.includes("NetworkError"))return new Error("Connection error. Please check your internet connection and try again.");if(401===e.status||403===e.status)return this.handleUnauthorized(t,e.status),new Error("Your session has expired. Please log in again.");if(e.status>=500)return 502===e.status?new Error("Server is temporarily unavailable. Please try again in a few moments."):503===e.status?new Error("Service is temporarily unavailable. Please try again later."):504===e.status?new Error("Request took too long. Please try again."):new Error("Server error. Please try again later or contact support if the problem persists.");if(404===e.status)return new Error("The requested resource was not found.");if(400===e.status){const t=e.data||e.response?.data||{},s=t.message||t.error||t.detail;return s?new Error(s):new Error("Invalid request. Please check your input and try again.")}if(422===e.status){const t=e.data||e.response?.data||{},s=t.message||t.error||t.detail;return s?new Error(s):new Error("Validation error. Please check your input and try again.")}return e instanceof Error?e:new Error(e.message||"An unexpected error occurred. Please try again.")}async get(e,t={}){const s={...this.defaultOptions,...t},a=`${this.baseUrl}${e}`;return this.retry(async()=>{const e=this.createTimeoutController(s.timeout);try{const s=await fetch(a,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"},signal:e.signal});if(!s.ok){401!==s.status&&403!==s.status||this.handleUnauthorized(a,s.status);const e=new Error(`HTTP error! status: ${s.status}`);throw e.status=s.status,e}this.unauthorizedAttempts.delete(a);const r=await s.text();if(!r||""===r.trim())throw Le.warn(`Empty response from ${a}`),new Error("Empty response from server");let n;try{n=JSON.parse(r)}catch(t){throw Le.error(`Failed to parse JSON from ${a}:`,t),new Error("Invalid JSON response from server")}return{data:n,status:s.status,headers:s.headers,ok:s.ok}}catch(r){throw this.handleError(r,a)}},s)}async post(e,t,s={}){const a={...this.defaultOptions,...s},r=`${this.baseUrl}${e}`;return this.retry(async()=>{const e=this.createTimeoutController(a.timeout);try{const a=localStorage.getItem("csrf_token"),n=await fetch(r,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...a?{"X-CSRFToken":a}:{}},body:JSON.stringify(t),signal:e.signal}),i=await n.text();let l;if(i&&""!==i.trim())try{l=JSON.parse(i)}catch(s){Le.error(`Failed to parse JSON from ${r}:`,s),l={error:i}}else l={};return n.ok?(this.unauthorizedAttempts.delete(r),{data:l,status:n.status,headers:n.headers,ok:!0}):(401!==n.status&&403!==n.status||this.handleUnauthorized(r,n.status),{data:l,status:n.status,headers:n.headers,ok:!1})}catch(n){throw this.handleError(n,r)}},a)}async put(e,t,s={}){const a={...this.defaultOptions,...s},r=`${this.baseUrl}${e}`;return this.retry(async()=>{const e=this.createTimeoutController(a.timeout);try{const a=localStorage.getItem("csrf_token"),n=await fetch(r,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json",...a?{"X-CSRFToken":a}:{}},body:JSON.stringify(t),signal:e.signal});if(!n.ok){401!==n.status&&403!==n.status||this.handleUnauthorized(r,n.status);const e=new Error(`HTTP error! status: ${n.status}`);throw e.status=n.status,e}this.unauthorizedAttempts.delete(r);const i=await n.text();if(!i||""===i.trim())throw Le.warn(`Empty response from ${r}`),new Error("Empty response from server");let l;try{l=JSON.parse(i)}catch(s){throw Le.error(`Failed to parse JSON from ${r}:`,s),new Error("Invalid JSON response from server")}return{data:l,status:n.status,headers:n.headers,ok:n.ok}}catch(n){throw this.handleError(n,r)}},a)}async delete(e,t,s={}){const a={...this.defaultOptions,...s},r=`${this.baseUrl}${e}`;return this.retry(async()=>{const e=this.createTimeoutController(a.timeout);try{const s=localStorage.getItem("csrf_token"),a=await fetch(r,{method:"DELETE",credentials:"include",headers:{"Content-Type":"application/json",...s?{"X-CSRFToken":s}:{}},...t?{body:JSON.stringify(t)}:{},signal:e.signal});if(!a.ok){401!==a.status&&403!==a.status||this.handleUnauthorized(r,a.status);const e=new Error(`HTTP error! status: ${a.status}`);throw e.status=a.status,e}this.unauthorizedAttempts.delete(r);const n=await a.text();return n&&""!==n.trim()?{data:JSON.parse(n),status:a.status,headers:a.headers,ok:a.ok}:{data:{},status:a.status,headers:a.headers,ok:a.ok}}catch(s){throw this.handleError(s,r)}},a)}parseResponse(e){const t=e.data;if(t&&"object"==typeof t&&("data"in t||"error"in t||"meta"in t)){if(t.error){const e=new Error(t.error.message||"API error");throw e.code=t.error.code,e.details=t.error.details,e}return void 0!==t.data?t.data:t}return e.data}clearToken(){try{localStorage.removeItem("auth_token"),localStorage.removeItem("csrf_token"),localStorage.removeItem("session_token"),Le.info("Authentication tokens cleared")}catch(e){Le.error("Error clearing tokens:",e)}}clearCache(){try{this.cache.clear(),Object.keys(localStorage).forEach(e=>{e.startsWith("api_cache_")&&localStorage.removeItem(e)}),Le.info("Cache cleared")}catch(e){Le.error("Error clearing cache:",e)}}clearCacheForUrl(e){try{const t=[];this.cache.forEach((s,a)=>{a.includes(e)&&t.push(a)}),t.forEach(e=>this.cache.delete(e)),Object.keys(localStorage).forEach(t=>{t.startsWith("api_cache_")&&t.includes(e)&&localStorage.removeItem(t)}),Le.info(`Cache cleared for URL pattern: ${e}`)}catch(t){Le.error("Error clearing cache for URL:",t)}}async refreshSession(){try{Le.info("Refreshing session...");const e=await this.get("/auth/csrf-token"),t=this.parseResponse(e);return t.csrf_token?(localStorage.setItem("csrf_token",t.csrf_token),Le.info("Session refreshed successfully"),!0):(Le.warn("Session refresh returned no CSRF token"),!1)}catch(e){return Le.error("Error refreshing session:",e),!1}}},Pe=Re;function Me(...e){return xe(ge(e))}const Oe=(e,t="₺",s="en-US")=>{if(isNaN(e)||null==e)return`${t}0`;const a={"₺":"TRY",$:"USD","€":"EUR","£":"GBP",TL:"TRY",TRY:"TRY",USD:"USD",EUR:"EUR",GBP:"GBP"}[t]||t;try{return new Intl.NumberFormat(s,{style:"currency",currency:a,minimumFractionDigits:0,maximumFractionDigits:2}).format(e)}catch(r){return`${t}${e.toLocaleString()}`}},$e=(e,t="₺",s="en-US")=>{const a=Math.abs(e);return Oe(a,t,s)},ze=(e,t="en-US")=>Oe(e,"$",t),Fe=({onResultClick:m})=>{const h=e(),[u,x]=t.useState(!1),[g,p]=t.useState(""),[y,f]=t.useState([]),[b,j]=t.useState(!1),v=t.useCallback(async e=>{if(e.length<2)f([]);else{j(!0);try{const t=await Pe.get(`/transactions/search-clients?q=${encodeURIComponent(e)}`);if(t.ok){const e=await Pe.parseResponse(t),s=[];e.clients&&Array.isArray(e.clients)&&e.clients.forEach(e=>{s.push({id:`client-${e.client_name}`,type:"client",title:e.client_name,description:`${e.transaction_count} transaction${1!==e.transaction_count?"s":""} • Total: ${Oe(e.total_amount,"TRY")}`,value:Oe(e.total_amount,"TRY"),date:e.last_transaction||e.first_transaction,clientData:e})}),e.transactions&&Array.isArray(e.transactions)&&e.transactions.slice(0,5).forEach(e=>{s.push({id:`tx-${e.id}`,type:"transaction",title:`${e.client_name} - ${e.category||"Transaction"}`,description:`${e.payment_method||""} • ${e.psp||""}`,value:Oe(e.amount,e.currency||"TRY"),date:e.date,status:"completed"})}),f(s)}else f([])}catch(t){f([])}finally{j(!1)}}},[]);t.useEffect(()=>{const e=setTimeout(()=>{v(g)},300);return()=>clearTimeout(e)},[g,v]),t.useEffect(()=>{const e=e=>{u&&!e.target.closest(".search-container")&&x(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[u]);const N=e=>{switch(e){case"transaction":return s.jsx(i,{className:"w-4 h-4"});case"client":return s.jsx(d,{className:"w-4 h-4"});case"user":return s.jsx(c,{className:"w-4 h-4"});default:return s.jsx(n,{className:"w-4 h-4"})}},w=e=>{if(!e)return null;const t={completed:{variant:"default",color:"bg-green-100 text-green-800"},pending:{variant:"secondary",color:"bg-yellow-100 text-yellow-800"},processing:{variant:"outline",color:"bg-gray-100 text-gray-800"}},a=t[e]||t.pending;return s.jsx(re,{variant:a.variant,className:a.color,children:e})};return s.jsxs("div",{className:"relative search-container",children:[s.jsxs("div",{className:"relative",children:[s.jsx(a,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),s.jsx(ee,{type:"text",placeholder:"Search transactions, clients, reports...",value:g,onChange:e=>p(e.target.value),onFocus:()=>x(!0),className:"pl-10 pr-10 w-80"}),g&&s.jsx(te,{variant:"ghost",size:"sm",onClick:()=>{p(""),x(!1)},className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0",children:s.jsx(r,{className:"w-4 h-4"})})]}),u&&(g.length>2||y.length>0)&&s.jsx(se,{className:"absolute top-full left-0 right-0 mt-2 z-50 max-h-96 overflow-y-auto",children:s.jsx(ae,{className:"p-0",children:b?s.jsxs("div",{className:"p-4 text-center text-muted-foreground",children:[s.jsx("div",{className:"w-4 h-4 border-2 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-2"}),"Searching..."]}):y.length>0?s.jsx("div",{className:"py-2",children:y.map(e=>s.jsxs("div",{onClick:()=>(e=>{if("client"===e.type&&e.clientData)h(`/clients/${encodeURIComponent(e.clientData.client_name)}`);else if("transaction"===e.type){const t=e.title.split(" - ")[0];h(`/clients/${encodeURIComponent(t)}`)}m?.(e),x(!1),p("")})(e),className:"flex items-center gap-3 p-3 hover:bg-muted/50 cursor-pointer border-b border-border last:border-b-0",children:[s.jsx("div",{className:"flex-shrink-0",children:N(e.type)}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:e.title}),e.value&&s.jsx("span",{className:"text-sm font-medium text-foreground",children:e.value})]}),s.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:e.description}),"client"===e.type&&e.clientData&&s.jsxs("div",{className:"flex items-center gap-3 mt-2 text-xs text-muted-foreground",children:[e.clientData.transaction_count>0&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(n,{className:"w-3 h-3"}),e.clientData.transaction_count," transactions"]}),e.clientData.total_commission>0&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(i,{className:"w-3 h-3"}),"Commission: ",Oe(e.clientData.total_commission,"TRY")]})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.date&&s.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[s.jsx(l,{className:"w-3 h-3"}),new Date(e.date).toLocaleDateString()]}),w(e.status)]})]}),s.jsx(o,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"})]},e.id))}):g.length>2?s.jsxs("div",{className:"p-4 text-center text-muted-foreground",children:[s.jsx(a,{className:"w-8 h-8 mx-auto mb-2 text-muted-foreground/50"}),s.jsxs("p",{children:['No results found for "',g,'"']}),s.jsx("p",{className:"text-xs mt-1",children:"Try different keywords"})]}):null})})]})},Ue=Object.freeze(Object.defineProperty({__proto__:null,GlobalSearch:Fe,default:Fe},Symbol.toStringTag,{value:"Module"})),Ie=()=>{const[e,s]=t.useState([]),[a,r]=t.useState(!0),[n,i]=t.useState(null),l=t.useCallback(async()=>{r(!0),i(null);try{const e=await Re.get("/notifications",{timeout:5e3,retries:1});s(e.data.notifications||[])}catch(e){if(e.message?.includes("404")||e.message?.includes("bulunamadı"))return s([]),void i(null);Le.warn("Failed to load notifications from API, using fallback",e),s([]),i(null)}finally{r(!1)}},[]),o=t.useCallback(async e=>{try{await Re.post(`/notifications/${e}/read`,{}),s(t=>t.map(t=>t.id===e?{...t,read:!0}:t))}catch(t){Le.error("Failed to mark notification as read",t),s(t=>t.map(t=>t.id===e?{...t,read:!0}:t))}},[]),c=t.useCallback(async()=>{try{await Re.post("/notifications/read-all",{}),s(e=>e.map(e=>({...e,read:!0})))}catch(e){Le.error("Failed to mark all notifications as read",e),s(e=>e.map(e=>({...e,read:!0})))}},[]);t.useEffect(()=>{l();const e=setInterval(()=>{l()},3e4);return()=>clearInterval(e)},[l]);const d=e.filter(e=>!e.read).length;return{notifications:e,unreadCount:d,markAsRead:o,markAllAsRead:c,refresh:l,loading:a,error:n}},Be=({className:e="",showHome:t=!0})=>{const{state:a}=K(),{breadcrumbs:r}=a;return r.length<=1?null:s.jsxs("nav",{className:ge("flex items-center space-x-1 text-sm text-gray-500",e),"aria-label":"Breadcrumb",children:[t&&s.jsxs(s.Fragment,{children:[s.jsx(m,{to:"/dashboard",className:"flex items-center hover:text-gray-700 transition-colors","aria-label":"Go to dashboard",children:s.jsx(h,{className:"w-4 h-4"})}),s.jsx(u,{className:"w-4 h-4 mx-1"})]}),r.map((e,t)=>s.jsxs(x.Fragment,{children:[e.current?s.jsx("span",{className:"font-medium text-gray-900","aria-current":"page",children:e.label}):s.jsx(m,{to:e.href,className:"hover:text-gray-700 transition-colors",children:e.label}),t<r.length-1&&s.jsx(u,{className:"w-4 h-4 mx-1"})]},e.href))]})},We=({onMenuClick:a,onLogout:n})=>{const i=e(),{user:l}=X(),[o,c]=t.useState(!1),[d,m]=t.useState(!1),{notifications:h,unreadCount:u}=Ie();x.useEffect(()=>{},[]);const _=()=>u;return s.jsxs("header",{className:"sticky top-0 z-50 p-6 border-b border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900 flex items-center justify-between w-full min-h-[88px] transition-colors duration-200",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(te,{variant:"ghost",size:"sm",onClick:a,className:"lg:hidden text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-800",children:s.jsx(g,{className:"w-5 h-5"})}),s.jsx(Be,{}),s.jsx("div",{className:"hidden lg:flex items-center",children:s.jsx(Fe,{onResultClick:e=>{"transaction"===e.type?i(`/transactions?highlight=${e.id}`):"client"===e.type&&i(`/clients?highlight=${e.id}`)}})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[!1,s.jsxs("div",{className:"relative",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>c(!o),className:"relative text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-800",children:[s.jsx(p,{className:"w-5 h-5"}),_()>0&&s.jsx(re,{variant:"destructive",className:"absolute -top-1 -right-1 w-5 h-5 p-0 flex items-center justify-center text-xs bg-red-600",children:_()})]}),o&&s.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-md z-50",children:[s.jsx("div",{className:"p-4 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Notifications"}),s.jsx(te,{variant:"ghost",size:"sm",onClick:()=>c(!1),className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200",children:s.jsx(r,{className:"w-4 h-4"})})]})}),s.jsx("div",{className:"max-h-96 overflow-y-auto",children:0===h.length?s.jsxs("div",{className:"p-6 text-center text-gray-500 dark:text-gray-400",children:[s.jsx(p,{className:"w-8 h-8 mx-auto mb-2 text-gray-300 dark:text-gray-600"}),s.jsx("p",{className:"text-sm",children:"No notifications"})]}):h.map(e=>s.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 last:border-b-0 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition-colors "+(e.read?"":"bg-gray-50 dark:bg-gray-800"),children:s.jsxs("div",{className:"flex items-start gap-3",children:["info"===e.type&&s.jsx(y,{className:"w-4 h-4 text-gray-500 mt-0.5"}),"warning"===e.type&&s.jsx(f,{className:"w-4 h-4 text-amber-500 mt-0.5"}),"success"===e.type&&s.jsx(b,{className:"w-4 h-4 text-green-500 mt-0.5"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:e.title}),s.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.time})]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:e.message}),!e.read&&s.jsx(re,{variant:"outline",className:"mt-2 text-xs border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-300",children:"New"})]})]})},e.id))})]})]}),s.jsxs("div",{className:"relative",children:[s.jsxs(te,{variant:"ghost",onClick:()=>m(!d),className:"flex items-center gap-2 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-800",children:[s.jsx("div",{className:"w-8 h-8 bg-gray-700 dark:bg-gray-600 rounded-lg flex items-center justify-center",children:s.jsx(j,{className:"w-4 h-4 text-white"})}),s.jsx("span",{className:"hidden md:block text-sm font-medium",children:l?.username||"User"}),s.jsx(v,{className:"w-4 h-4"})]}),d&&s.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-md z-50",children:s.jsxs("div",{className:"p-2",children:[s.jsxs(te,{variant:"ghost",className:"w-full justify-start text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-700",onClick:()=>{m(!1),i("/settings?tab=profile")},children:[s.jsx(j,{className:"w-4 h-4 mr-2"}),"Profile"]}),s.jsxs(te,{variant:"ghost",className:"w-full justify-start text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-700",onClick:()=>{m(!1),i("/settings")},children:[s.jsx(N,{className:"w-4 h-4 mr-2"}),"Settings"]}),s.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 my-1"}),s.jsxs(te,{variant:"ghost",className:"w-full justify-start text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/20",onClick:()=>{m(!1),n()},children:[s.jsx(w,{className:"w-4 h-4 mr-2"}),"Sign out"]})]})})]})]})]})},Ge=Object.freeze(Object.defineProperty({__proto__:null,ModernHeader:We},Symbol.toStringTag,{value:"Module"})),Ye=({className:e="",variant:t="button"})=>{const{currentLanguage:a,setLanguage:r,supportedLanguages:n}=Q(),i=Object.entries(n).map(([e,t])=>({code:e,name:t.name})),l=async e=>{try{await r(e)}catch(t){}};return"button"===t?s.jsx("div",{className:`flex items-center gap-2 ${e}`,children:i.map(e=>s.jsx("button",{onClick:()=>l(e.code),className:`\n              px-3 py-1.5 rounded-md text-sm font-medium transition-all\n              ${a===e.code?"bg-blue-600 text-white shadow-sm":"bg-gray-100 text-gray-700 hover:bg-gray-200"}\n            `,title:e.name,children:e.code.toUpperCase()},e.code))}):s.jsxs("div",{className:`relative inline-block ${e}`,children:[s.jsx("select",{value:a,onChange:e=>l(e.target.value),className:"\n          appearance-none bg-white border border-gray-300 rounded-md \n          px-4 py-2 pr-8 text-sm font-medium text-gray-700\n          hover:border-gray-400 focus:outline-none focus:ring-2 \n          focus:ring-blue-500 focus:border-transparent\n          cursor-pointer transition-all\n        ",children:i.map(e=>s.jsx("option",{value:e.code,children:e.name},e.code))}),s.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:s.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]})},qe=({variant:e,className:a=""})=>{const{state:n,navigationItems:i,isActive:o,navigateTo:c,getMobileNavigation:d}=K(),{user:m,logout:h}=X(),{t:u}=Q(),[g,p]=t.useState(new Date),[y,f]=t.useState(!1),[b,N]=t.useState(new Set);t.useEffect(()=>{const e=setInterval(()=>{p(new Date)},1e3);return()=>clearInterval(e)},[]),t.useEffect(()=>{const e=e=>{y&&(e.target.closest("[data-user-menu]")||f(!1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[y]);const k=e=>{if(e.children){e.id,e.name,e.href,o(e.href);const t=new Set(b);t.has(e.id)?t.delete(e.id):t.add(e.id),N(t)}else e.id,e.name,e.href,o(e.href),c(e.href)},C=async()=>{try{await h()}catch(e){}};if("sidebar"===e)return x.useEffect(()=>{},[]),s.jsxs("div",{className:ge("flex flex-col h-full bg-white border-r border-gray-200",a),children:[s.jsx("div",{className:"p-6 border-b border-gray-200 min-h-[88px] flex items-center",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("img",{src:"/plogo.png",alt:"PipLinePro",className:"w-8 h-8 rounded-lg"}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:u("common.app_name")}),s.jsx("p",{className:"text-xs text-gray-500",children:u("common.financial_management")})]})]})}),s.jsx("nav",{className:"flex-1 px-4 py-6 space-y-2",children:i.map(e=>{const t=e.icon,a=o(e.href),r=e.children&&e.children.length>0,n=b.has(e.id);return s.jsxs("div",{children:[s.jsxs("button",{onClick:()=>k(e),className:ge("group w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200",e.special?a?"bg-gray-700 text-white shadow-lg":"text-gray-600 hover:bg-gray-50 hover:text-gray-700":a?"bg-gray-100 text-gray-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(t,{className:ge("w-5 h-5",e.special&&a&&"animate-pulse")}),s.jsx("span",{children:e.name}),e.badge&&s.jsx(re,{variant:e.special?"default":"secondary",className:ge("text-xs opacity-0 transition-opacity duration-150 group-hover:opacity-100",e.special&&"bg-white/20 text-white"),children:e.badge})]}),r&&s.jsx(v,{className:ge("w-4 h-4 transition-transform",n&&"rotate-180")})]}),r&&n&&s.jsx("div",{className:"ml-8 mt-2 space-y-1",children:e.children.map(t=>{const a=o(t.href);return s.jsx("button",{onClick:()=>{e.id,e.name,t.id,t.name,t.href,c(t.href)},className:ge("w-full flex items-center px-3 py-2 rounded-lg text-sm transition-colors",a?"bg-gray-100 text-gray-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:s.jsx("span",{children:t.name})},t.id)})})]},e.id)})}),s.jsxs("div",{className:"p-4 border-t border-gray-200",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center",children:s.jsx(j,{className:"w-4 h-4 text-gray-600"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:m?.username||"User"}),s.jsx("p",{className:"text-xs text-gray-500",children:m?.role||"User"})]}),s.jsxs("div",{className:"relative","data-user-menu":!0,children:[s.jsx(te,{variant:"ghost",size:"sm",onClick:()=>f(!y),className:"w-8 h-8 p-0",children:s.jsx(v,{className:"w-4 h-4"})}),y&&s.jsx("div",{className:"absolute right-0 bottom-full mb-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:s.jsxs("button",{onClick:C,className:"w-full flex items-center gap-2 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[s.jsx(w,{className:"w-4 h-4"}),u("common.sign_out")]})})]})]}),s.jsx("div",{className:"mb-3",children:s.jsx(Ye,{variant:"button",className:"w-full justify-center"})}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),s.jsx("span",{children:u("common.system_online")}),s.jsx(l,{className:"w-3 h-3 ml-auto"}),s.jsx("span",{children:g.toLocaleTimeString()})]})]})]});if("mobile-bottom"===e){const e=d();return s.jsx("div",{className:ge("lg:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg z-50",a),children:s.jsxs("div",{className:"flex items-center justify-around px-2 py-2",children:[e.map(e=>{const t=e.icon,a=o(e.href);return s.jsxs("button",{onClick:()=>c(e.href),className:ge("flex flex-col items-center justify-center p-2 rounded-lg transition-all duration-200 min-w-[60px] min-h-[60px] relative",e.special?a?"bg-gray-700 text-white":"text-gray-600":a?"text-gray-900 bg-gray-100":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),children:[e.special&&a&&s.jsxs("div",{className:"absolute inset-0 rounded-lg overflow-hidden",children:[s.jsx("div",{className:"absolute top-1 right-1 w-1 h-1 bg-white rounded-full animate-ping"}),s.jsx("div",{className:"absolute bottom-1 left-1 w-0.5 h-0.5 bg-white rounded-full animate-ping",style:{animationDelay:"1s"}})]}),s.jsxs("div",{className:"relative z-10",children:[s.jsx(t,{className:ge("transition-all duration-200",e.special?ge("h-6 w-6",a&&"animate-pulse drop-shadow-sm"):ge("h-5 w-5",a&&"scale-105"))}),e.badge&&s.jsx(re,{className:ge("absolute -top-2 -right-2 h-4 w-4 text-xs p-0 flex items-center justify-center",e.special?"bg-white/20 text-white":"bg-red-500 text-white"),children:e.badge})]}),s.jsx("span",{className:ge("text-xs font-medium mt-1 text-center z-10",e.special&&a&&"text-white drop-shadow-sm"),children:e.name})]},e.id)}),s.jsxs("button",{className:"flex flex-col items-center justify-center p-2 rounded-lg transition-all duration-200 min-w-[60px] min-h-[60px] text-gray-600 hover:text-gray-900 hover:bg-gray-50","aria-label":"More actions",children:[s.jsx("div",{className:"relative",children:s.jsx(_,{className:"h-5 w-5 transition-transform duration-200 hover:scale-105","aria-hidden":"true"})}),s.jsx("span",{className:"text-xs font-medium mt-1 text-center",children:"More"})]})]})})}return"mobile-drawer"===e?s.jsxs("div",{className:ge("lg:hidden fixed inset-0 bg-white z-50 transform transition-transform duration-300 ease-in-out",n.mobileMenuOpen?"translate-x-0":"-translate-x-full",a),children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("img",{src:"/plogo.png",alt:"PipLinePro",className:"w-8 h-8 rounded-lg"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Menu"})]}),s.jsx(te,{variant:"ghost",size:"sm",onClick:()=>c("/"),className:"w-8 h-8 p-0",children:s.jsx(r,{className:"w-5 h-5"})})]}),s.jsx("nav",{className:"flex-1 px-4 py-6 space-y-2",children:i.map(e=>{const t=e.icon,a=o(e.href),r=e.children&&e.children.length>0,n=b.has(e.id);return s.jsxs("div",{children:[s.jsxs("button",{onClick:()=>k(e),className:ge("group w-full flex items-center justify-between px-3 py-3 rounded-lg text-sm font-medium transition-all duration-200",e.special?a?"bg-gray-700 text-white":"text-gray-600 hover:bg-gray-50":a?"bg-gray-100 text-gray-900":"text-gray-600 hover:bg-gray-50"),children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(t,{className:"w-5 h-5"}),s.jsx("span",{children:e.name}),e.badge&&s.jsx(re,{variant:"secondary",className:"text-xs opacity-0 transition-opacity duration-150 group-hover:opacity-100",children:e.badge})]}),r&&s.jsx(v,{className:ge("w-4 h-4 transition-transform",n&&"rotate-180")})]}),r&&n&&s.jsx("div",{className:"ml-8 mt-2 space-y-1",children:e.children.map(t=>{const a=o(t.href);return s.jsx("button",{onClick:()=>{e.id,e.name,t.id,t.name,t.href,c(t.href)},className:ge("w-full flex items-center px-3 py-2 rounded-lg text-sm transition-colors",a?"bg-gray-100 text-gray-900":"text-gray-600 hover:bg-gray-50"),children:s.jsx("span",{children:t.name})},t.id)})})]},e.id)})}),s.jsxs("div",{className:"p-4 border-t border-gray-200",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center",children:s.jsx(j,{className:"w-5 h-5 text-gray-600"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:m?.username||"User"}),s.jsx("p",{className:"text-xs text-gray-500",children:m?.role||"User"})]})]}),s.jsxs(te,{onClick:C,variant:"outline",className:"w-full",children:[s.jsx(w,{className:"w-4 h-4 mr-2"}),"Sign out"]})]})]}):null},He=({children:t})=>{const a=e(),{logout:r}=X(),{state:n,setMobileMenuOpen:i}=K();return x.useEffect(()=>{},[]),s.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-200",children:[n.mobileMenuOpen&&s.jsx("div",{className:"fixed inset-0 z-40 lg:hidden",onClick:()=>i(!1),children:s.jsx("div",{className:"fixed inset-0 bg-black/50"})}),s.jsx(qe,{variant:"mobile-drawer"}),s.jsx("div",{className:"hidden lg:fixed lg:inset-y-0 lg:flex lg:w-64 lg:flex-col",children:s.jsx(qe,{variant:"sidebar"})}),s.jsxs("div",{className:"lg:pl-64",children:[s.jsx(We,{onMenuClick:()=>i(!0),onLogout:async()=>{try{await r()}catch(e){a("/login")}}}),s.jsx("main",{className:"min-h-[calc(100vh-7rem)] bg-gray-50 dark:bg-gray-900 transition-colors duration-200",children:t||s.jsx(k,{})})]}),s.jsx(qe,{variant:"mobile-bottom"})]})},Ve=Object.freeze(Object.defineProperty({__proto__:null,default:He},Symbol.toStringTag,{value:"Module"})),Ze=()=>s.jsx("div",{className:"dashboard-grid",children:[...Array(4)].map((e,t)=>s.jsxs("div",{className:"dashboard-card metric-card border-0 shadow-lg p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"w-12 h-12 bg-slate-200 rounded-xl animate-pulse"}),s.jsx("div",{className:"w-16 h-4 bg-slate-200 rounded animate-pulse"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"h-8 bg-slate-200 rounded animate-pulse w-3/4"}),s.jsx("div",{className:"h-4 bg-slate-200 rounded animate-pulse w-1/2"})]})]},t))}),Je=()=>s.jsxs("div",{className:"dashboard-card dashboard-glass border-0 shadow-lg",children:[s.jsx("div",{className:"p-6 pb-4",children:s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"space-y-2 flex-1",children:[s.jsx("div",{className:"h-6 bg-slate-200 rounded animate-pulse w-1/3"}),s.jsx("div",{className:"h-4 bg-slate-200 rounded animate-pulse w-1/2"})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-32 h-8 bg-slate-200 rounded animate-pulse"}),s.jsx("div",{className:"w-32 h-8 bg-slate-200 rounded animate-pulse"}),s.jsx("div",{className:"w-20 h-6 bg-slate-200 rounded-full animate-pulse"})]})]})}),s.jsx("div",{className:"px-6 pb-6",children:s.jsxs("div",{className:"h-96 bg-slate-100 rounded-lg animate-pulse relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 -translate-x-full animate-shimmer bg-gradient-to-r from-transparent via-white/20 to-transparent"}),s.jsx("div",{className:"flex items-end justify-around h-full p-8 gap-2",children:[...Array(12)].map((e,t)=>s.jsx("div",{className:"bg-slate-200 rounded-t w-full",style:{height:60*Math.random()+40+"%"}},t))})]})})]}),Ke=({title:e="Performance"})=>s.jsxs("div",{className:"dashboard-card dashboard-glass border-0 shadow-lg",children:[s.jsx("div",{className:"p-6 pb-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-slate-200 rounded-xl animate-pulse"}),s.jsx("div",{className:"h-5 bg-slate-200 rounded animate-pulse w-32"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 bg-slate-200 rounded-full animate-pulse"}),s.jsx("div",{className:"w-12 h-3 bg-slate-200 rounded animate-pulse"})]})]})}),s.jsxs("div",{className:"px-6 pb-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"space-y-2",children:[...Array(4)].map((e,t)=>s.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-slate-50 rounded border",children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[s.jsx("div",{className:"w-4 h-4 bg-slate-200 rounded animate-pulse"}),s.jsx("div",{className:"h-3 bg-slate-200 rounded animate-pulse w-24"})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"h-4 bg-slate-200 rounded animate-pulse w-20 ml-auto"}),s.jsx("div",{className:"h-3 bg-slate-200 rounded animate-pulse w-16 ml-auto"})]})]},t))}),s.jsx("div",{className:"space-y-2 pt-2 border-t-2 border-slate-300",children:[...Array(3)].map((e,t)=>s.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-slate-50 rounded border",children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[s.jsx("div",{className:"w-4 h-4 bg-slate-200 rounded animate-pulse"}),s.jsx("div",{className:"h-3 bg-slate-200 rounded animate-pulse w-20"})]}),s.jsx("div",{className:"h-4 bg-slate-200 rounded animate-pulse w-24 ml-auto"})]},t))})]}),s.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200",children:s.jsxs("div",{className:"flex items-center justify-center gap-3",children:[s.jsx("div",{className:"h-8 w-8 bg-slate-200 rounded animate-pulse"}),s.jsx("div",{className:"h-4 bg-slate-200 rounded animate-pulse flex-1 max-w-md"}),s.jsx("div",{className:"h-8 w-8 bg-slate-200 rounded animate-pulse"})]})})]})]}),Xe=()=>s.jsx("main",{className:"flex-1 bg-gradient-to-br from-slate-50 via-white to-slate-100 min-h-screen",children:s.jsx("div",{className:"px-8 py-8",children:s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"h-10 bg-slate-200 rounded animate-pulse w-64"}),s.jsx("div",{className:"h-5 bg-slate-200 rounded animate-pulse w-96"})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-32 h-10 bg-slate-200 rounded-lg animate-pulse"}),s.jsx("div",{className:"w-24 h-10 bg-slate-200 rounded-lg animate-pulse"}),s.jsx("div",{className:"w-24 h-10 bg-slate-200 rounded-lg animate-pulse"}),s.jsx("div",{className:"w-24 h-10 bg-slate-200 rounded-lg animate-pulse"})]})]}),s.jsx(Ze,{}),s.jsxs("div",{className:"space-y-8",children:[s.jsx(Je,{}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsx(Ke,{title:"Daily"}),s.jsx(Ke,{title:"Monthly"}),s.jsx(Ke,{title:"Total"})]})]})]})})}),Qe=[{name:"Stripe",value:45,color:"#3b82f6"},{name:"PayPal",value:30,color:"#059669"},{name:"Square",value:15,color:"#d97706"},{name:"Other",value:10,color:"#64748b"}],et=({data:e=[],type:t="area",height:a=300,showWithCommission:r=!1})=>{const n=e&&e.length>0?e.map(t=>{let s=null,a="Unknown";t.date?s=new Date(t.date):t.created_at?s=new Date(t.created_at):t.transaction_date&&(s=new Date(t.transaction_date)),s&&!isNaN(s.getTime())?(e.length>30||e.length,a=s.toLocaleDateString("en-US",{month:"short",day:"numeric"})):t.month&&(a=t.month);const n=r?t.net_cash_after_commission_usd??t.net_cash_usd??t.net_cash??t.amount??0:t.net_cash_usd??t.net_cash??t.amount??t.revenue??t.total_amount??0;return{month:a,revenue:n,amount:n,net_cash_usd:r?t.net_cash_after_commission_usd??t.net_cash_usd??0:t.net_cash_usd??t.net_cash??t.amount??0,net_cash_after_commission_usd:t.net_cash_after_commission_usd??0,deposits:t.deposits_usd||t.deposits||0,withdrawals:t.withdrawals_usd||t.withdrawals||0,commissions:t.commissions_usd||t.commissions||0,transactions:t.transactions||t.transaction_count||0,transaction_count:t.transaction_count||t.transactions||0,clients:t.clients||0,date:s}}).sort((e,t)=>e.date&&t.date?e.date.getTime()-t.date.getTime():0):[];Le.debug("RevenueChart data",{rawLength:e?.length||0,chartLength:n.length,dateRange:n.length>0?{first:n[0]?.month,last:n[n.length-1]?.month}:null});const i=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),l=({active:e,payload:t,label:a})=>{if(e&&t&&t.length){const e=t[0].payload,n=e.amount||e.revenue||0,l=0===n;return s.jsx("div",{className:"bg-white border border-gray-200 rounded-lg shadow-lg p-4 min-w-[200px]",children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full "+(l?"bg-gray-400":"bg-blue-500")}),s.jsx("span",{className:"font-semibold text-gray-900",children:a}),l&&s.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:"No Activity"})]}),s.jsxs("div",{className:"border-t border-gray-100 pt-2 space-y-1",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-sm text-gray-600",children:r?"Net Cash (USD) After Commission:":"Net Cash (USD):"}),s.jsx("span",{className:"font-semibold "+(l?"text-gray-500":n>=0?"text-green-600":"text-red-600"),children:l?"$0":i(n)})]}),void 0!==e.commissions&&e.commissions>0&&s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Commissions:"}),s.jsxs("span",{className:"text-sm font-medium "+(l?"text-gray-500":"text-red-600"),children:["-",i(e.commissions)]})]}),void 0!==e.deposits&&s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Deposits:"}),s.jsxs("span",{className:"text-sm font-medium "+(l?"text-gray-500":"text-green-600"),children:["+",i(e.deposits)]})]}),void 0!==e.withdrawals&&s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Withdrawals:"}),s.jsxs("span",{className:"text-sm font-medium "+(l?"text-gray-500":"text-red-600"),children:["-",i(e.withdrawals)]})]}),void 0!==e.transaction_count&&s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Transactions:"}),s.jsx("span",{className:"text-sm font-medium "+(l?"text-gray-500":"text-gray-700"),children:e.transaction_count})]}),void 0!==e.clients&&s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Clients:"}),s.jsx("span",{className:"text-sm font-medium "+(l?"text-gray-500":"text-gray-700"),children:e.clients})]})]})]})})}return null};return"pie"===t?s.jsx(pe,{width:"100%",height:a,children:s.jsxs(ye,{children:[s.jsx(fe,{data:Qe,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:5,dataKey:"value",children:Qe.map((e,t)=>s.jsx(be,{fill:e.color},`cell-${t}`))}),s.jsx(je,{formatter:e=>`${e}%`})]})}):n&&0!==n.length?s.jsx(pe,{width:"100%",height:a,children:"line"===t?s.jsxs(ve,{data:n,margin:{top:5,right:30,left:20,bottom:5},children:[s.jsx(Ne,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),s.jsx(we,{dataKey:"month",stroke:"#64748b",fontSize:12}),s.jsx(_e,{stroke:"#64748b",fontSize:12,tickFormatter:i}),s.jsx(je,{content:s.jsx(l,{})}),s.jsx(ke,{type:"natural",dataKey:"amount",stroke:"#3b82f6",strokeWidth:3,dot:{fill:"#3b82f6",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#3b82f6",strokeWidth:2},animationDuration:800,animationEasing:"ease-in-out"})]}):"bar"===t?s.jsxs(Ce,{data:n,margin:{top:20,right:30,left:20,bottom:20},children:[s.jsxs("defs",{children:[s.jsxs("linearGradient",{id:"revenueBarGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"0%",stopColor:"#3B82F6",stopOpacity:1}),s.jsx("stop",{offset:"25%",stopColor:"#60A5FA",stopOpacity:.95}),s.jsx("stop",{offset:"50%",stopColor:"#93C5FD",stopOpacity:.9}),s.jsx("stop",{offset:"75%",stopColor:"#BFDBFE",stopOpacity:.85}),s.jsx("stop",{offset:"100%",stopColor:"#E0F2FE",stopOpacity:.8})]}),s.jsxs("linearGradient",{id:"depositsBarGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"0%",stopColor:"#10B981",stopOpacity:1}),s.jsx("stop",{offset:"25%",stopColor:"#34D399",stopOpacity:.95}),s.jsx("stop",{offset:"50%",stopColor:"#6EE7B7",stopOpacity:.9}),s.jsx("stop",{offset:"75%",stopColor:"#A7F3D0",stopOpacity:.85}),s.jsx("stop",{offset:"100%",stopColor:"#D1FAE5",stopOpacity:.8})]}),s.jsxs("linearGradient",{id:"withdrawalsBarGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"0%",stopColor:"#EF4444",stopOpacity:1}),s.jsx("stop",{offset:"25%",stopColor:"#F87171",stopOpacity:.95}),s.jsx("stop",{offset:"50%",stopColor:"#FCA5A5",stopOpacity:.9}),s.jsx("stop",{offset:"75%",stopColor:"#FECACA",stopOpacity:.85}),s.jsx("stop",{offset:"100%",stopColor:"#FEE2E2",stopOpacity:.8})]}),s.jsx("filter",{id:"barShadow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:s.jsx("feDropShadow",{dx:"0",dy:"4",stdDeviation:"6",floodColor:"#3B82F6",floodOpacity:"0.15"})}),s.jsxs("filter",{id:"barGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[s.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),s.jsxs("feMerge",{children:[s.jsx("feMergeNode",{in:"coloredBlur"}),s.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),s.jsx(Ne,{strokeDasharray:"1 3",stroke:"#f1f5f9",strokeWidth:1,vertical:!1,opacity:.8}),s.jsx(we,{dataKey:"date",stroke:"#475569",fontSize:12,fontWeight:600,tickLine:!1,axisLine:{stroke:"#e2e8f0",strokeWidth:1},tick:{fill:"#475569"},interval:"preserveStartEnd",tickFormatter:e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),s.jsx(_e,{stroke:"#475569",fontSize:12,fontWeight:600,tickFormatter:i,tickLine:!1,axisLine:{stroke:"#e2e8f0",strokeWidth:1},tick:{fill:"#475569"},width:80}),s.jsx(je,{content:({active:e,payload:t,label:a})=>{if(e&&t&&t.length){const e=t[0].payload,a=e.date,n=new Date(a+"T00:00:00");return s.jsx("div",{className:"bg-white border border-gray-200 rounded-xl shadow-lg p-4 min-w-[200px] backdrop-blur-sm",children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(C,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"font-semibold text-gray-900",children:n.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),s.jsxs("div",{className:"border-t border-gray-100 pt-2 space-y-1",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-sm text-gray-600",children:r?"Net Cash (USD) After Commission:":"Net Cash (USD):"}),s.jsx("span",{className:"font-semibold text-blue-600",children:i(e.net_cash_usd||e.amount||0)})]}),void 0!==e.commissions&&e.commissions>0&&s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Commissions:"}),s.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["-",i(e.commissions)]})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Transactions:"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:e.transaction_count||0})]})]})]})})}return null},cursor:{fill:"rgba(59, 130, 246, 0.05)"}}),s.jsx(Se,{dataKey:"amount",fill:"url(#revenueBarGradient)",radius:[6,6,0,0],stroke:"none",filter:"url(#barShadow)",style:{filter:"drop-shadow(0 4px 8px rgba(59, 130, 246, 0.15))"}})]}):s.jsxs(De,{data:n,margin:{top:5,right:30,left:20,bottom:5},children:[s.jsxs("defs",{children:[s.jsxs("linearGradient",{id:"colorRevenue",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),s.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]}),s.jsxs("linearGradient",{id:"colorRevenueZero",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"5%",stopColor:"#94a3b8",stopOpacity:.2}),s.jsx("stop",{offset:"95%",stopColor:"#94a3b8",stopOpacity:0})]})]}),s.jsx(Ne,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),s.jsx(we,{dataKey:"month",stroke:"#64748b",fontSize:12,interval:"preserveStartEnd",tick:{fontSize:11}}),s.jsx(_e,{stroke:"#64748b",fontSize:12,tickFormatter:i,domain:["dataMin - 100000","dataMax + 100000"]}),s.jsx(je,{content:s.jsx(l,{})}),s.jsx(Te,{type:"natural",dataKey:"amount",stroke:"#3b82f6",strokeWidth:3,fill:"url(#colorRevenue)",dot:!1,animationDuration:800,animationEasing:"ease-in-out"})]})}):s.jsx("div",{className:"flex items-center justify-center",style:{height:`${a}px`},children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"No revenue data available"}),s.jsx("p",{className:"text-xs mt-1",children:"Data will appear when transactions are available"})]})})},tt=Object.freeze(Object.defineProperty({__proto__:null,RevenueChart:et,default:et},Symbol.toStringTag,{value:"Module"})),st=({label:e,value:t,icon:a,change:r,trend:n="up",loading:i=!1,sparklineData:l,showGlass:o=!1})=>{if(i)return s.jsx(ne,{});const c=(e=>{if("number"==typeof e)return{prefix:"",suffix:"",numeric:e};const t=e.toString(),s=t.includes("%");let a="",r="";if(/[₺$₽€£]/.test(t)){const e=t.match(/[₺$₽€£]/);e&&(a=e[0])}s&&(r="%");const n=(e=>{if("number"==typeof e)return e;const t=e.toString().replace(/[₺$,₽€£\s,.]/g,"").trim(),s=e.toString().trim().startsWith("-"),a=parseFloat(s?`-${t}`:t);return isNaN(a)?null:a})(e);return{prefix:a,suffix:r,numeric:n}})(t),d="up"===n?S:D,m=o?"glass-card-strong glass-hover":"";return s.jsxs(se,{className:`dashboard-card metric-card group border-0 shadow-premium card-hover-subtle overflow-hidden relative ${m}`,children:[s.jsxs(ae,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-slate-100 to-slate-50 rounded-xl flex items-center justify-center group-hover:from-slate-200 group-hover:to-slate-100 transition-all duration-300 floating",children:s.jsx(a,{className:"w-6 h-6 text-slate-700"})}),r&&s.jsxs("div",{className:"flex items-center gap-1 px-2.5 py-1 rounded-full transition-all duration-200 "+("up"===n?"bg-green-50 text-green-700 group-hover:bg-green-100":"bg-red-50 text-red-700 group-hover:bg-red-100"),children:[s.jsx(d,{className:"w-3.5 h-3.5"}),s.jsx("span",{className:"text-sm font-semibold",children:r})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:null!==c.numeric?s.jsx(ie,{end:c.numeric,duration:1500,decimals:"%"===c.suffix?1:0,prefix:c.prefix,suffix:c.suffix,separator:","}):t}),s.jsx("p",{className:"text-sm text-slate-600 font-medium",children:e}),l&&l.length>0&&s.jsx("div",{className:"pt-2 mt-2 border-t border-slate-100",children:s.jsx(le,{data:l,width:200,height:32,showArea:!0,showTooltip:!0})})]})]}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/0 to-slate-50/0 group-hover:from-white/30 group-hover:to-slate-50/30 pointer-events-none transition-all duration-300"})]})},at=({className:e})=>s.jsx("div",{className:`animate-pulse rounded-md bg-muted ${e}`}),rt=()=>s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(at,{className:"h-8 w-64"}),s.jsx(at,{className:"h-4 w-96"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(at,{className:"h-9 w-20"}),s.jsx(at,{className:"h-9 w-20"})]})]}),s.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6",children:Array.from({length:4}).map((e,t)=>s.jsx(se,{children:s.jsxs(ae,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx(at,{className:"h-8 w-8 rounded-md"}),s.jsx(at,{className:"h-4 w-16"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(at,{className:"h-4 w-24"}),s.jsx(at,{className:"h-6 w-32"})]})]})},t))}),s.jsxs(se,{children:[s.jsx(oe,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(at,{className:"h-6 w-48"}),s.jsx(at,{className:"h-4 w-64"})]}),s.jsx(at,{className:"h-8 w-24"})]})}),s.jsx(ae,{children:s.jsx(at,{className:"h-64 w-full"})})]}),s.jsxs(se,{children:[s.jsx(oe,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsx(at,{className:"h-6 w-32"}),s.jsx(at,{className:"h-4 w-48"})]})}),s.jsx(ae,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsx(at,{className:"h-10 w-full"}),Array.from({length:5}).map((e,t)=>s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(at,{className:"h-4 w-4"}),s.jsx(at,{className:"h-4 w-24"}),s.jsx(at,{className:"h-4 w-32"}),s.jsx(at,{className:"h-4 w-20"}),s.jsx(at,{className:"h-4 w-16"})]},t))]})})]})]}),nt=Object.freeze(Object.defineProperty({__proto__:null,CardSkeleton:()=>s.jsxs(se,{children:[s.jsx(oe,{children:s.jsx(at,{className:"h-6 w-32"})}),s.jsx(ae,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsx(at,{className:"h-4 w-full"}),s.jsx(at,{className:"h-4 w-3/4"}),s.jsx(at,{className:"h-4 w-1/2"})]})})]}),Skeleton:at,SkeletonLoader:rt,TableSkeleton:({rows:e=5,columns:t=4})=>s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex items-center space-x-4",children:Array.from({length:t}).map((e,t)=>s.jsx(at,{className:"h-4 w-24"},t))}),Array.from({length:e}).map((e,a)=>s.jsx("div",{className:"flex items-center space-x-4",children:Array.from({length:t}).map((e,t)=>s.jsx(at,{className:"h-4 w-24"},t))},a))]})},Symbol.toStringTag,{value:"Module"})),it=({stats:e,loading:t=!1,onStatClick:a})=>t?s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(4)].map((e,t)=>s.jsx(rt,{className:"h-32"},t))}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:e.map((e,t)=>s.jsx("div",{children:s.jsx(st,{label:e.label,value:e.value,icon:e.icon,change:e.change,trend:e.trend,loading:!1})},t))}),lt=({onExport:e,onFilter:t,onRefresh:a,onSettings:r,refreshing:n=!1,isGeneratingReport:i=!1})=>{const{t:l}=Q();return s.jsxs("div",{className:"flex items-center gap-2",children:[t&&s.jsxs(te,{variant:"outline",size:"sm",onClick:t,className:"h-9 px-3 bg-white border-gray-200 text-gray-700 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-900 transition-all duration-200",children:[s.jsx(T,{className:"w-4 h-4 mr-2"}),l("common.filter")||"Filter"]}),e&&s.jsxs(te,{variant:"outline",size:"sm",onClick:e,disabled:i,className:"h-9 px-3 bg-white border-gray-200 text-gray-700 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-900 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx(E,{className:"w-4 h-4 mr-2 "+(i?"animate-pulse":"")}),i?l("common.loading")||"Generating...":l("clients.export")||"Export"]}),a&&s.jsxs(te,{variant:"outline",size:"sm",onClick:a,disabled:n,className:"h-9 px-3 bg-white border-gray-200 text-gray-700 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-900 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx(A,{className:"w-4 h-4 mr-2 "+(n?"animate-spin":"")}),l("common.refresh")||"Refresh"]}),r&&s.jsxs(te,{variant:"outline",size:"sm",onClick:r,className:"h-9 px-3 bg-white border-gray-200 text-gray-700 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-900 transition-all duration-200",children:[s.jsx(N,{className:"w-4 h-4 mr-2"}),l("common.settings")||"Settings"]})]})},ot=({timeRange:e,viewType:t,refreshing:a,isGeneratingReport:r,lastUpdated:n,onTimeRangeChange:i,onViewTypeChange:l,onRefresh:o,onExport:c})=>{const{t:d}=Q();return s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(L,{className:"w-6 h-6 text-gray-700"}),d("dashboard.title")||"Dashboard"]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:d("dashboard.description")||"Overview of your business performance"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ce,{status:a?"syncing":"online",showLabel:!1,pulse:!a,size:"sm"}),n&&s.jsx(de,{lastUpdated:n})]}),s.jsxs("select",{value:e,onChange:e=>i(e.target.value),className:"px-3 py-2 bg-white border border-gray-200 rounded-lg text-sm text-gray-700 font-medium hover:border-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-300 transition-all duration-200",children:[s.jsx("option",{value:"all",children:"All Time"}),s.jsx("option",{value:"7d",children:"Last 7 days"}),s.jsx("option",{value:"30d",children:"Last 30 days"}),s.jsx("option",{value:"90d",children:"Last 90 days"}),s.jsx("option",{value:"6m",children:"Last 6 months"}),s.jsx("option",{value:"1y",children:"Last year"})]}),s.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1",children:[s.jsx("button",{onClick:()=>l("net"),className:"px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200 "+("net"===t?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900 hover:bg-white/50"),children:d("dashboard.net_revenue")||"Net"}),s.jsx("button",{onClick:()=>l("gross"),className:"px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200 "+("gross"===t?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900 hover:bg-white/50"),children:d("ledger.gross_amount")||"Gross"})]}),s.jsx(lt,{onExport:c,onRefresh:o,refreshing:a,isGeneratingReport:r})]})]})},ct=({title:t,icon:a,period:r,data:n,breakdown:l,loading:o,selectedDate:c,isCurrentPeriod:m,onPrevious:h,onNext:x,onToday:g,formatDate:p,navigatePath:y,showWithCommission:f=!1})=>{e(),Q();const b=l.filter(e=>e.timePeriod===r&&["Total Bank","CC (Credit Card)","Tether","Conv"].includes(e.metric)),j=l.filter(e=>e.timePeriod===r&&["Tot Dep","Tot WD","Net Cash"].includes(e.metric)),v=n&&"object"==typeof n&&Object.keys(n).length>0,N=l&&l.length>0&&(b.length>0||j.length>0),w=v||N,k=v;return s.jsxs(se,{className:"bg-white border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200 group",children:[s.jsx(oe,{className:"pb-4",children:s.jsx(me,{title:t,icon:a,size:"md",badge:s.jsx(ce,{status:"online",label:"Live",pulse:!0,size:"sm"})})}),s.jsx(ae,{children:o?s.jsx(Ke,{}):w?0===b.length&&0===j.length?s.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500",children:[s.jsx(a,{className:"w-12 h-12 mb-3 opacity-50"}),s.jsx("p",{className:"text-sm font-medium",children:"No data for this period"}),s.jsxs("p",{className:"text-xs mt-1",children:["for ",p(c)]})]}):k&&n?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-gray-50 rounded border border-gray-100 hover:bg-gray-100 hover:border-gray-200 hover:shadow-sm transition-all duration-200 group",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(d,{className:"w-4 h-4 text-blue-600 group-hover:scale-110 transition-transform duration-200"}),s.jsx("span",{className:"text-sm font-medium text-gray-700 group-hover:text-gray-900 transition-colors duration-200",children:"Total Bank"})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-sm font-semibold text-gray-900 group-hover:text-gray-950 transition-colors duration-200",children:["₺",Math.abs(n.total_bank_tl||0).toLocaleString("tr-TR",{maximumFractionDigits:0})]}),n.bank_count>0&&s.jsxs("div",{className:"text-xs text-gray-500",children:[n.bank_count," txns"]})]})]}),s.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-gray-50 rounded border border-gray-100 hover:bg-gray-100 hover:border-gray-200 hover:shadow-sm transition-all duration-200 group",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(R,{className:"w-4 h-4 text-purple-600 group-hover:scale-110 transition-transform duration-200"}),s.jsx("span",{className:"text-sm font-medium text-gray-700 group-hover:text-gray-900 transition-colors duration-200",children:"CC (Credit Card)"})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-sm font-semibold text-gray-900 group-hover:text-gray-950 transition-colors duration-200",children:["₺",Math.abs(n.total_cc_tl||0).toLocaleString("tr-TR",{maximumFractionDigits:0})]}),n.cc_count>0&&s.jsxs("div",{className:"text-xs text-gray-500",children:[n.cc_count," txns"]})]})]}),s.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-gray-50 rounded border border-gray-100 hover:bg-gray-100 hover:border-gray-200 hover:shadow-sm transition-all duration-200 group",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(i,{className:"w-4 h-4 text-green-600 group-hover:scale-110 transition-transform duration-200"}),s.jsx("span",{className:"text-sm font-medium text-gray-700 group-hover:text-gray-900 transition-colors duration-200",children:"Tether"})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-sm font-semibold text-gray-900 group-hover:text-gray-950 transition-colors duration-200",children:["$",Math.abs(n.total_tether_usd||0).toLocaleString("tr-TR",{maximumFractionDigits:0})]}),n.tether_count>0&&s.jsxs("div",{className:"text-xs text-gray-500",children:[n.tether_count," txns"]})]})]}),s.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-gray-50 rounded border border-gray-100 hover:bg-gray-100 hover:border-gray-200 hover:shadow-sm transition-all duration-200 group",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(_,{className:"w-4 h-4 text-blue-600 group-hover:scale-110 transition-transform duration-200"}),s.jsx("span",{className:"text-sm font-medium text-gray-700 group-hover:text-gray-900 transition-colors duration-200",children:"Conv"})]}),s.jsx("div",{className:"text-right",children:s.jsxs("div",{className:"text-sm font-semibold text-gray-900 group-hover:text-gray-950 transition-colors duration-200",children:["$",Math.abs(n.conv_usd||0).toLocaleString("tr-TR",{maximumFractionDigits:0})]})})]})]}),s.jsxs("div",{className:"space-y-2 pt-2 border-t-2 border-gray-300",children:[s.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-gray-50 rounded border border-gray-100 hover:bg-gray-100 hover:border-gray-200 hover:shadow-sm transition-all duration-200 group",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(S,{className:"w-4 h-4 text-green-600 group-hover:scale-110 transition-transform duration-200"}),s.jsx("span",{className:"text-sm font-medium text-gray-700 group-hover:text-gray-900 transition-colors duration-200",children:"Tot Dep"})]}),s.jsx("div",{className:"text-right",children:s.jsxs("div",{className:"text-sm font-semibold text-gray-900 group-hover:text-gray-950 transition-colors duration-200",children:["₺",Math.abs(n.total_deposits_tl||0).toLocaleString("tr-TR",{maximumFractionDigits:0})]})})]}),s.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-gray-50 rounded border border-gray-100 hover:bg-gray-100 hover:border-gray-200 hover:shadow-sm transition-all duration-200 group",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(D,{className:"w-4 h-4 text-red-600 group-hover:scale-110 transition-transform duration-200"}),s.jsx("span",{className:"text-sm font-medium text-gray-700 group-hover:text-gray-900 transition-colors duration-200",children:"Tot WD"})]}),s.jsx("div",{className:"text-right",children:s.jsxs("div",{className:"text-sm font-semibold text-gray-900 group-hover:text-gray-950 transition-colors duration-200",children:["₺",Math.abs(n.total_withdrawals_tl||0).toLocaleString("tr-TR",{maximumFractionDigits:0})]})})]}),(()=>{const e=n.net_cash_tl||0,t=n.total_commission_tl||n.total_commission||0,a=f?e-t:e,r=a>=0;return s.jsxs("div",{className:"flex items-center justify-between py-3 px-4 rounded border border-gray-100 hover:border-gray-200 hover:shadow-sm transition-all duration-200 group "+(r?"bg-green-50":"bg-red-50"),children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(i,{className:"w-4 h-4 group-hover:scale-110 transition-transform duration-200 "+(r?"text-green-600":"text-red-600")}),s.jsx("span",{className:"text-sm font-medium text-gray-700 group-hover:text-gray-900 transition-colors duration-200",children:f?"Net Cash (After Commission)":"Net Cash"})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-sm font-semibold group-hover:text-gray-950 transition-colors duration-200 "+(r?"text-green-700":"text-red-700"),children:["₺",Math.abs(a).toLocaleString("tr-TR",{maximumFractionDigits:0})]}),f&&t>0&&s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Commissions: -₺",t.toLocaleString("tr-TR",{maximumFractionDigits:0})]})]})]})})()]})]}),"Total"!==r&&s.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-center w-full",children:[s.jsxs("div",{className:"flex items-center gap-3 w-full max-w-md",children:[s.jsx(te,{variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),h()},className:"h-8 w-8 p-0 hover:bg-blue-50 hover:border-blue-300",children:s.jsx(P,{className:"w-4 h-4"})}),s.jsx("span",{className:"text-sm font-medium text-gray-700 flex-1 text-center",children:p(c)}),s.jsx(te,{variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),x()},disabled:m,className:"h-8 w-8 p-0 hover:bg-blue-50 hover:border-blue-300 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(u,{className:"w-4 h-4"})})]}),!m&&g&&s.jsx(te,{variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),g()},className:"h-8 px-3 text-xs hover:bg-blue-50 hover:border-blue-300 ml-4",children:"Daily"===r?"Today":"Current Month"})]})})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"space-y-2",children:b.map((e,t)=>s.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-gray-50 rounded border border-gray-100 hover:bg-gray-100 hover:border-gray-200 hover:shadow-sm transition-all duration-200 group",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(e.icon,{className:`w-4 h-4 ${e.iconColor} group-hover:scale-110 transition-transform duration-200`}),s.jsx("span",{className:"text-sm font-medium text-gray-700 group-hover:text-gray-900 transition-colors duration-200",children:e.metric})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-sm font-semibold text-gray-900 group-hover:text-gray-950 transition-colors duration-200",children:("Tether"===e.metric||"Conv"===e.metric?"$":"₺")+(e.amount||0).toLocaleString("tr-TR",{maximumFractionDigits:0})}),e.count>0&&s.jsxs("div",{className:"text-xs text-gray-500",children:[e.count," txns"]})]})]},t))}),s.jsx("div",{className:"space-y-2 pt-2 border-t-2 border-gray-300",children:j.map((e,t)=>s.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-gray-50 rounded border border-gray-100 hover:bg-gray-100 hover:border-gray-200 hover:shadow-sm transition-all duration-200 group",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(e.icon,{className:`w-4 h-4 ${e.iconColor} group-hover:scale-110 transition-transform duration-200`}),s.jsx("span",{className:"text-sm font-medium text-gray-700 group-hover:text-gray-900 transition-colors duration-200",children:e.metric})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-sm font-semibold text-gray-900 group-hover:text-gray-950 transition-colors duration-200",children:["₺",(e.amount||0).toLocaleString("tr-TR",{maximumFractionDigits:0})]}),e.count>0&&s.jsxs("div",{className:"text-xs text-gray-500",children:[e.count," txns"]})]})]},t))})]}),"Total"!==r&&s.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-center w-full",children:[s.jsxs("div",{className:"flex items-center gap-3 w-full max-w-md",children:[s.jsx(te,{variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),h()},className:"h-8 w-8 p-0 hover:bg-blue-50 hover:border-blue-300",children:s.jsx(P,{className:"w-4 h-4"})}),s.jsx("span",{className:"text-sm font-medium text-gray-700 flex-1 text-center",children:p(c)}),s.jsx(te,{variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),x()},disabled:m,className:"h-8 w-8 p-0 hover:bg-blue-50 hover:border-blue-300 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(u,{className:"w-4 h-4"})})]}),!m&&g&&s.jsx(te,{variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),g()},className:"h-8 px-3 text-xs hover:bg-blue-50 hover:border-blue-300 ml-4",children:"Daily"===r?"Today":"Current Month"})]})})]}):s.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500",children:[s.jsx(a,{className:"w-12 h-12 mb-3 opacity-50"}),s.jsx("p",{className:"text-sm font-medium",children:"No data available"}),s.jsxs("p",{className:"text-xs mt-1",children:["for ",p(c)]})]})})]})},dt=new class{baseUrl="/api/v1";cache=new Map;CACHE_DURATION=3e4;pendingRequests=new Map;isCacheValid(e){const t=this.cache.get(e);return!!t&&Date.now()-t.timestamp<this.CACHE_DURATION}async getCachedOrFetch(e,t,s=!1){if(!s&&this.isCacheValid(e))return Le.debug(`Using cached data for ${e}`),this.cache.get(e).data;if(this.pendingRequests.has(e))return Le.debug(`Waiting for pending request for ${e}`),this.pendingRequests.get(e);Le.debug(`Fetching fresh data for ${e} ${s?"(cache bypassed)":""}`);const a=t().then(t=>(this.cache.set(e,{data:t,timestamp:Date.now()}),this.pendingRequests.delete(e),t)).catch(t=>{throw this.pendingRequests.delete(e),t});return this.pendingRequests.set(e,a),a}clearCache(e){e?(this.cache.delete(e),this.pendingRequests.delete(e),Le.debug(`Cleared cache for ${e}`)):(this.cache.clear(),this.pendingRequests.clear(),Le.debug("Cleared all cache and pending requests"))}async getDashboardStats(e="all"){const t=`dashboard-stats-${e}`;return this.getCachedOrFetch(t,async()=>(await Re.get(`/dashboard/consolidated?range=${e}`,{timeout:1e4,retries:2})).data)}async getSystemPerformance(){return(await Re.get("/analytics/system/performance",{timeout:1e4,retries:2})).data}async getDataQuality(){return(await Re.get("/analytics/data/quality",{timeout:1e4,retries:2})).data}async getSecurityMetrics(){return(await Re.get("/analytics/security/metrics",{timeout:1e4,retries:2})).data}async getConsolidatedDashboard(e="all",t=!1){const s=`consolidated-dashboard-${e}`;return this.getCachedOrFetch(s,async()=>{const s=t?`&_t=${Date.now()}`:"",a=(await Re.get(`/dashboard/consolidated?range=${e}${s}`,{timeout:15e3,retries:3})).data;if(!a)throw new Error("Empty response from consolidated dashboard endpoint");return a},t)}async getRevenueTrends(e="all"){return(await Re.get(`/analytics/revenue/trends?range=${e}`,{timeout:1e4,retries:2})).data}async getTopPerformers(e="all"){return(await Re.get(`/analytics/top-performers?range=${e}`,{timeout:1e4,retries:2})).data}async getCommissionAnalytics(e="all"){const t=`commission-analytics-${e}`;return this.getCachedOrFetch(t,async()=>(await Re.get(`/analytics/commission/analytics?range=${e}`,{timeout:1e4,retries:2})).data)}async getExchangeRates(){return this.getCachedOrFetch("exchange-rates",async()=>(await Re.get("/exchange-rates/rates",{timeout:1e4,retries:2})).data)}async getTransactionVolumeAnalysis(e="all"){return(await Re.get(`/analytics/transactions/volume-analysis?range=${e}`,{timeout:1e4,retries:2})).data}async getClientAnalytics(e="all"){return(await Re.get(`/analytics/clients/analytics?range=${e}`,{timeout:1e4,retries:2})).data.data}async getPspRolloverSummary(){return(await Re.get("/analytics/psp-rollover-summary",{timeout:1e4,retries:2})).data}async getFinancialPerformance(e="all",t="net"){const s=`financial-performance-${e}-${t}`;return this.getCachedOrFetch(s,async()=>{try{const s=(await Re.get(`/financial-performance?range=${e}&view=${t}`,{timeout:6e4,retries:2})).data;if(!s)throw new Error("Empty response from backend");if(s&&s.data&&(s.data.daily||s.data.monthly||s.data.annual))return s;throw new Error("Invalid data structure in response")}catch(s){throw s.message?.includes("timeout")||s.message?.includes("Timeout")||Le.error("Error loading financial performance:",s),s}})}async refreshDashboard(e="all"){return this.clearCache(),this.getDashboardStats(e)}},mt=(e,t,s=0)=>{const a=e?.[t];return"number"!=typeof a||isNaN(a)?s:a},ht=(e,t,s)=>{const{daily:a,monthly:r,annual:n}=e,l=[],o=(e,t,s,a,r,n)=>{const i="Net Cash"===t,l="Tot Dep"===t,o="Tot WD"===t;let c=0,d=0,m=0,h=0;"Total Bank"===t?(c=s.total_bank_tl||0,d=s.total_bank_usd||0,m=s.total_bank_tl||0,h=s.bank_count||0):"CC (Credit Card)"===t?(c=s.total_cc_tl||0,d=s.total_cc_usd||0,m=s.total_cc_tl||0,h=s.cc_count||0):"Tether"===t?(c=s.total_tether_usd||0,d=s.total_tether_usd||0,m=s.total_tether_tl||0,h=s.tether_count||0):"Conv"===t?(c=s.conv_usd||0,d=s.conv_usd||0,m=0,h=0):l?(c=mt(s,"total_deposits_tl"),d=mt(s,"total_deposits_usd"),m=mt(s,"total_deposits_tl"),h=0):o?(c=mt(s,"total_withdrawals_tl"),d=mt(s,"total_withdrawals_usd"),m=mt(s,"total_withdrawals_tl"),h=0):i&&(c=mt(s,"net_cash_tl"),d=mt(s,"net_cash_usd"),m=mt(s,"net_cash_tl"),h=0);const u=i?c:0,x=u>=0?"text-green-600":"text-red-600",g=i?u>=0?"bg-green-50":"bg-red-50":n,p=i?u>=0?"green":"red":r;return{timePeriod:e,metric:t,amount:c,usdAmount:d,tlAmount:m,count:h,trend:0,icon:a,description:`${e.toLowerCase()} ${t.toLowerCase()}`,color:p,bgColor:g,iconColor:"text-gray-800",trendColor:x}};return l.push(o("Daily","Total Bank",a,d,"blue","bg-blue-50")),l.push(o("Daily","CC (Credit Card)",a,R,"purple","bg-purple-50")),l.push(o("Daily","Tether",a,i,"green","bg-green-50")),l.push(o("Daily","Conv",a,_,"blue","bg-blue-50")),l.push(o("Daily","Tot Dep",a,S,"green","bg-green-50")),l.push(o("Daily","Tot WD",a,D,"red","bg-red-50")),l.push(o("Daily","Net Cash",a,i,"green","bg-green-50")),l.push(o("Monthly","Total Bank",r,d,"blue","bg-blue-50")),l.push(o("Monthly","CC (Credit Card)",r,R,"purple","bg-purple-50")),l.push(o("Monthly","Tether",r,i,"green","bg-green-50")),l.push(o("Monthly","Conv",r,_,"blue","bg-blue-50")),l.push(o("Monthly","Tot Dep",r,S,"green","bg-green-50")),l.push(o("Monthly","Tot WD",r,D,"red","bg-red-50")),l.push(o("Monthly","Net Cash",r,i,"green","bg-green-50")),l.push(o("Total","Total Bank",n,d,"blue","bg-blue-50")),l.push(o("Total","CC (Credit Card)",n,R,"purple","bg-purple-50")),l.push(o("Total","Tether",n,i,"green","bg-green-50")),l.push(o("Total","Conv",n,_,"blue","bg-blue-50")),l.push(o("Total","Tot Dep",n,S,"green","bg-green-50")),l.push(o("Total","Tot WD",n,D,"red","bg-red-50")),l.push(o("Total","Net Cash",n,i,"green","bg-green-50")),l};class ut{static async generateComprehensiveReport(e="all"){try{const[t,s,a,r,n,i]=await Promise.all([dt.getDashboardStats(e),dt.getSystemPerformance(),dt.getDataQuality(),dt.getSecurityMetrics(),dt.getCommissionAnalytics(e),dt.getExchangeRates()]),l=M.book_new();this.addDashboardOverviewSheet(l,t),this.addTransactionsSheet(l,t?.recent_transactions||[]),this.addAnalyticsSheet(l,t),this.addSystemPerformanceSheet(l,s),this.addExchangeRatesSheet(l,i),this.addCommissionAnalyticsSheet(l,n),this.addDataQualitySheet(l,a),this.addSecurityMetricsSheet(l,r);const o=(new Date).toISOString().slice(0,19).replace(/:/g,"-");O(l,`PipLinePro_Report_${e}_${o}.xlsx`)}catch(t){throw t}}static addDashboardOverviewSheet(e,t){const s=[["PipLinePro Dashboard Overview"],["Generated:",(new Date).toLocaleString()],[""],["Key Metrics"],["Total Revenue",t?.total_revenue||0],["Total Transactions",t?.total_transactions||0],["Active Clients",t?.active_clients||0],["Average Transaction",t?.average_transaction||0],[""],["Revenue Breakdown"],["Deposits",t?.total_deposits||0],["Withdrawals",t?.total_withdrawals||0],["Net Revenue",t?.net_revenue||0],[""],["Performance Metrics"],["Success Rate",t?.success_rate||0],["Growth Rate",t?.growth_rate||0],["Client Satisfaction",t?.client_satisfaction||0]],a=M.aoa_to_sheet(s);this.formatWorksheet(a,"A1:B20"),M.book_append_sheet(e,a,"Dashboard Overview")}static addTransactionsSheet(e,t){if(!t||0===t.length){const t=[["No transaction data available"]],s=M.aoa_to_sheet(t);return void M.book_append_sheet(e,s,"Transactions")}const s=[["Transaction ID","Client Name","Amount","Currency","Status","Date","PSP","Category"]];t.forEach(e=>{s.push([e.id||"",e.client_name||"",e.amount||0,e.currency||"TL",e.status||"",e.date?new Date(e.date).toLocaleDateString():"",e.psp||"",e.category||""])});const a=M.aoa_to_sheet(s);this.formatWorksheet(a,"A1:H"+(t.length+1)),M.book_append_sheet(e,a,"Transactions")}static addAnalyticsSheet(e,t){const s=[["Analytics Summary"],["Generated:",(new Date).toLocaleString()],[""],["Revenue Analytics"],["Total Revenue",t?.total_revenue||0],["Monthly Growth",t?.monthly_growth||0],["Yearly Growth",t?.yearly_growth||0],[""],["Transaction Analytics"],["Total Transactions",t?.total_transactions||0],["Successful Transactions",t?.successful_transactions||0],["Failed Transactions",t?.failed_transactions||0],["Success Rate",t?.success_rate||0],[""],["Client Analytics"],["Total Clients",t?.total_clients||0],["Active Clients",t?.active_clients||0],["New Clients (30d)",t?.new_clients_30d||0],["Client Retention Rate",t?.client_retention_rate||0]],a=M.aoa_to_sheet(s);this.formatWorksheet(a,"A1:B20"),M.book_append_sheet(e,a,"Analytics")}static addSystemPerformanceSheet(e,t){const s=[["System Performance Metrics"],["Generated:",(new Date).toLocaleString()],[""],["CPU Usage",t?.cpu_usage||0,"%"],["Memory Usage",t?.memory_usage||0,"%"],["Disk Usage",t?.disk_usage||0,"%"],["Network Latency",t?.network_latency||0,"ms"],[""],["Database Performance"],["Query Response Time",t?.db_query_time||0,"ms"],["Connection Pool",t?.db_connections||0,"connections"],["Cache Hit Rate",t?.cache_hit_rate||0,"%"],[""],["Application Metrics"],["Response Time",t?.response_time||0,"ms"],["Throughput",t?.throughput||0,"requests/min"],["Error Rate",t?.error_rate||0,"%"],["Uptime",t?.uptime||0,"%"]],a=M.aoa_to_sheet(s);this.formatWorksheet(a,"A1:C20"),M.book_append_sheet(e,a,"System Performance")}static addExchangeRatesSheet(e,t){const s=[["Exchange Rates"],["Generated:",(new Date).toLocaleString()],[""],["Currency Pair","Rate","Last Updated","Age (minutes)","Status"]];t?.success&&t.rates?Object.entries(t.rates).forEach(([e,t])=>{s.push([t.currency_pair||e,t.rate||0,t.last_updated||"",t.age_minutes||0,t.is_stale?"Stale":"Fresh"])}):s.push(["No exchange rate data available","","","",""]);const a=M.aoa_to_sheet(s);this.formatWorksheet(a,"A1:E10"),M.book_append_sheet(e,a,"Exchange Rates")}static addCommissionAnalyticsSheet(e,t){const s=[["Commission Analytics"],["Generated:",(new Date).toLocaleString()],[""],["PSP","Total Volume","Total Commission","Commission Rate","Transaction Count"]];t?.success&&t.data?.psp_commission?t.data.psp_commission.forEach(e=>{s.push([e.psp||"Unknown",e.total_volume||0,e.total_commission||0,e.commission_rate||0,e.transaction_count||0])}):s.push(["No commission data available","","","",""]);const a=M.aoa_to_sheet(s);this.formatWorksheet(a,"A1:E20"),M.book_append_sheet(e,a,"Commission Analytics")}static addDataQualitySheet(e,t){const s=[["Data Quality Metrics"],["Generated:",(new Date).toLocaleString()],[""],["Metric","Value","Status"],["Data Completeness",t?.completeness||0,"%"],["Data Accuracy",t?.accuracy||0,"%"],["Data Consistency",t?.consistency||0,"%"],["Data Timeliness",t?.timeliness||0,"%"],[""],["Quality Issues"],["Missing Values",t?.missing_values||0],["Duplicate Records",t?.duplicates||0],["Invalid Formats",t?.invalid_formats||0],["Data Conflicts",t?.conflicts||0]],a=M.aoa_to_sheet(s);this.formatWorksheet(a,"A1:C15"),M.book_append_sheet(e,a,"Data Quality")}static addSecurityMetricsSheet(e,t){const s=[["Security Metrics"],["Generated:",(new Date).toLocaleString()],[""],["Metric","Today","This Week","This Month"],["Failed Logins",t?.failed_logins?.today||0,t?.failed_logins?.week||0,t?.failed_logins?.month||0],["Blocked IPs",t?.blocked_ips?.today||0,t?.blocked_ips?.week||0,t?.blocked_ips?.month||0],["Security Alerts",t?.security_alerts?.today||0,t?.security_alerts?.week||0,t?.security_alerts?.month||0],[""],["Access Control"],["Active Sessions",t?.active_sessions||0],["Admin Users",t?.admin_users||0],["Regular Users",t?.regular_users||0],["Locked Accounts",t?.locked_accounts||0]],a=M.aoa_to_sheet(s);this.formatWorksheet(a,"A1:D15"),M.book_append_sheet(e,a,"Security Metrics")}static formatWorksheet(e,t){e["!cols"]=[{wch:20},{wch:15},{wch:15},{wch:15},{wch:15}];const s=M.decode_range(t);for(let a=s.s.r;a<=s.e.r;++a)for(let t=s.s.c;t<=s.e.c;++t){const s=M.encode_cell({r:a,c:t});e[s]&&(e[s].s={border:{top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},alignment:{horizontal:"center",vertical:"center"}})}}static async exportSpecificData(e,t="all"){switch(e){case"all":await this.generateComprehensiveReport(t);break;case"transactions":await this.exportTransactions(t);break;case"clients":await this.exportClients(t);break;case"analytics":await this.exportAnalytics(t);break;default:throw new Error("Invalid export type")}}static async exportTransactions(e){const t=await dt.getDashboardStats(e),s=M.book_new();this.addTransactionsSheet(s,t?.recent_transactions||[]);const a=(new Date).toISOString().slice(0,19).replace(/:/g,"-");O(s,`Transactions_${e}_${a}.xlsx`)}static async exportClients(e){}static async exportAnalytics(e){const t=await dt.getDashboardStats(e),s=M.book_new();this.addAnalyticsSheet(s,t);const a=(new Date).toISOString().slice(0,19).replace(/:/g,"-");O(s,`Analytics_${e}_${a}.xlsx`)}}const xt={plain:"bg-transparent",slate:"bg-gradient-to-br from-slate-50 via-white to-slate-100","slate-blue":"bg-gradient-to-br from-slate-50 via-white to-blue-50","slate-indigo":"bg-gradient-to-br from-slate-50 via-white to-indigo-50"};function gt({children:e,theme:t="slate",minHeightScreen:a=!1,className:r}){return s.jsx("div",{className:ge("w-full",xt[t],a&&"min-h-screen",r),children:e})}const pt=t.lazy(()=>Ae(()=>Promise.resolve().then(()=>Yt),void 0).then(e=>({default:e.RecentActivityFeed}))),yt=t.lazy(()=>Ae(()=>Promise.resolve().then(()=>Ht),void 0).then(e=>({default:e.CryptoWalletBalancesCard}))),ft=x.memo(({user:a})=>{const r=e(),{t:n}=Q(),[l,o]=t.useState(null);t.useEffect(()=>(Le.dashboard("ModernDashboard mounted"),()=>{Le.dashboard("ModernDashboard unmounted")}),[]),t.useEffect(()=>{const e=e=>{Le.error("Dashboard runtime error:",e.error),o(e.error)},t=e=>{Le.error("Dashboard unhandled promise rejection:",e.reason),o(e.reason instanceof Error?e.reason:new Error(String(e.reason)))};return window.addEventListener("error",e),window.addEventListener("unhandledrejection",t),()=>{window.removeEventListener("error",e),window.removeEventListener("unhandledrejection",t)}},[]);const[d,m]=t.useState("all"),[h,u]=t.useState("net"),[x,g]=t.useState("monthly"),[p,y]=t.useState(!0),[f,j]=t.useState(!1),[v,N]=t.useState(!1),[w,k]=t.useState(new Date),[D,T]=t.useState(new Date),[E,A]=t.useState(null),[R,P]=t.useState(null),[M,O]=t.useState(!1),[z,F]=t.useState(!1),{data:U,loading:I,error:B,refresh:W,lastUpdated:G}=(({timeRange:e,viewType:s,enabled:a=!0})=>{const[r,n]=t.useState(null),[i,l]=t.useState(!0),[o,c]=t.useState(null),[d,m]=t.useState(null),h=t.useRef(null),u=t.useRef(!0),x=t.useCallback(async()=>{if(a){h.current&&h.current.abort(),h.current=new AbortController,l(!0),c(null);try{Le.dashboard("Loading dashboard data",{timeRange:e,viewType:s});const t=await dt.getConsolidatedDashboard(e,!0);if(!u.current||h.current.signal.aborted)return;const a=(e,t=0)=>{if(!e)return t;const s=String(e).replace(/[₺,%,]/g,""),a=parseFloat(s);return isNaN(a)?t:a},r=(e,t=0)=>{if(!e)return t;const s=String(e).replace(/[,]/g,""),a=parseInt(s);return isNaN(a)?t:a};let i=t?.chart_data||{daily_revenue:[],client_distribution:[]};i.daily_revenue&&Array.isArray(i.daily_revenue)||(i={...i,daily_revenue:[]});const l={stats:t?.stats||{total_revenue:{value:"0",change:"0%",changeType:"positive"},total_transactions:{value:"0",change:"0%",changeType:"positive"},active_clients:{value:"0",change:"0%",changeType:"positive"},growth_rate:{value:"0%",change:"0%",changeType:"positive"}},chart_data:i,recent_transactions:t?.recent_transactions||[],summary:{total_revenue:a(t?.stats?.total_revenue?.value),total_commission:t?.commission_analytics?.total_commission||0,total_net:a(t?.stats?.total_revenue?.value)-(t?.commission_analytics?.total_commission||0),transaction_count:r(t?.stats?.total_transactions?.value),active_clients:r(t?.stats?.active_clients?.value),growth_rate:a(t?.stats?.growth_rate?.value),net_cash:(()=>{const e=t?.summary?.net_cash;if(null!=e){const t="number"==typeof e?e:parseFloat(String(e));return isNaN(t)?0:t}const s=t?.financial_performance?.annual?.net_cash_tl;if(null!=s){const e="number"==typeof s?s:parseFloat(String(s));return isNaN(e)?0:e}return 0})()},exchange_rates:t?.exchange_rates||{USD_TRY:48},financial_performance:t?.financial_performance||null};n(l),m(new Date),Le.dashboard("Dashboard data loaded successfully")}catch(t){if(!u.current||h.current.signal.aborted)return;const e=t.message?.includes("Failed to fetch")||t.message?.includes("NetworkError")?"Bağlantı hatası. Lütfen internet bağlantınızı kontrol edin.":t.message?.includes("401")||t.message?.includes("403")?"Yetki hatası. Lütfen tekrar giriş yapın.":t.message?.includes("500")?"Sunucu hatası. Lütfen daha sonra tekrar deneyin.":"Dashboard verisi yüklenemedi. Lütfen tekrar deneyin.";Le.error("Error loading dashboard data:",t),c(e),n({stats:{total_revenue:{value:"0",change:"0%",changeType:"positive"},total_transactions:{value:"0",change:"0%",changeType:"positive"},active_clients:{value:"0",change:"0%",changeType:"positive"},growth_rate:{value:"0%",change:"0%",changeType:"positive"}},chart_data:{daily_revenue:[],client_distribution:[]},recent_transactions:[],summary:{total_revenue:0,total_commission:0,total_net:0,transaction_count:0,active_clients:0,growth_rate:0}})}finally{u.current&&l(!1)}}},[e,s,a]),g=t.useCallback(async()=>{dt.clearCache(),await x()},[x]);return t.useEffect(()=>(u.current=!0,x(),()=>{u.current=!1,h.current&&h.current.abort()}),[x]),{data:r,loading:i,error:o,refresh:g,lastUpdated:d}})({timeRange:d,viewType:h}),{data:Y,loading:q,error:H,refresh:V,getDayData:Z,getMonthData:J}=(({timeRange:e,viewType:s,enabled:a=!0})=>{const[r,n]=t.useState(null),[i,l]=t.useState(!0),[o,c]=t.useState(null),d=t.useRef(null),m=t.useRef(!0),h=t.useCallback(async()=>{if(a){d.current&&d.current.abort(),d.current=new AbortController,l(!0),c(null);try{Le.dashboard("Loading financial performance data",{timeRange:e,viewType:s});const t=await dt.getFinancialPerformance(e,s);if(!m.current||d.current.signal.aborted)return;n(t),Le.dashboard("Financial performance data loaded successfully")}catch(t){if(!m.current||d.current.signal.aborted)return;const e=t.message?.includes("Failed to fetch")||t.message?.includes("NetworkError")?"Bağlantı hatası. Lütfen internet bağlantınızı kontrol edin.":t.message?.includes("401")||t.message?.includes("403")?"Yetki hatası. Lütfen tekrar giriş yapın.":t.message?.includes("500")?"Sunucu hatası. Lütfen daha sonra tekrar deneyin.":"Finansal performans verisi yüklenemedi. Lütfen tekrar deneyin.";Le.error("Error loading financial performance:",t),c(e);const s={total_bank_usd:0,total_bank_tl:0,total_cc_usd:0,total_cc_tl:0,total_tether_usd:0,total_tether_tl:0,conv_usd:0,conv_tl:0,total_transactions:0,bank_count:0,cc_count:0,tether_count:0};n({success:!0,data:{daily:s,monthly:s,annual:s,exchange_rate:48}})}finally{m.current&&l(!1)}}},[e,s,a]),u=t.useCallback(async()=>{dt.clearCache(),await h()},[h]),x=t.useCallback(async e=>{try{const t=e.toISOString().split("T")[0],s=(await Re.get(`/financial-performance/daily?date=${t}`,{timeout:3e4,retries:1})).data;return s&&s.success&&s.data?s.data:(Le.warn("Day data response missing data:",s),null)}catch(t){return t.message?.includes("timeout")||t.message?.includes("Timeout")?Le.warn("Day data request timeout - backend may be slow"):t.message?.includes("ERR_EMPTY_RESPONSE")||t.message?.includes("Failed to fetch")?Le.warn("Backend not responding for day data (non-critical)"):Le.error("Error fetching day data:",t),null}},[]),g=t.useCallback(async e=>{try{const t=e.getFullYear(),a=e.getMonth()+1,r=(await Re.get(`/financial-performance/monthly?year=${t}&month=${a}&view=${s}`,{timeout:3e4,retries:1})).data;return r&&r.success&&r.data?r.data:(Le.warn("Month data response missing data:",r),null)}catch(t){return t.message?.includes("timeout")||t.message?.includes("Timeout")?Le.warn("Month data request timeout - backend may be slow"):Le.error("Error fetching month data:",t),null}},[s]);return t.useEffect(()=>(m.current=!0,h(),()=>{m.current=!1,d.current&&d.current.abort()}),[h]),{data:r,loading:i,error:o,refresh:u,getDayData:x,getMonthData:g}})({timeRange:d,viewType:h});t.useEffect(()=>{(()=>{if("undefined"!=typeof document&&!document.getElementById("shimmer-styles")){const e=document.createElement("style");e.id="shimmer-styles",e.textContent="\n@keyframes shimmer {\n  0% {\n    transform: translateX(-100%);\n  }\n  100% {\n    transform: translateX(100%);\n  }\n}\n\n.animate-shimmer {\n  animation: shimmer 2s infinite;\n}\n",document.head.appendChild(e)}})()},[]);const K=t.useCallback(()=>{const e=new Date(w);e.setMonth(e.getMonth()-1),k(e)},[w]),X=t.useCallback(()=>{const e=new Date(w);e.setMonth(e.getMonth()+1),k(e)},[w]),ee=t.useCallback(()=>{const e=new Date;return w.getMonth()===e.getMonth()&&w.getFullYear()===e.getFullYear()},[w]),re=t.useCallback(()=>{const e=new Date(D);e.setDate(e.getDate()-1),T(e)},[D]),ne=t.useCallback(()=>{const e=new Date(D);e.setDate(e.getDate()+1),T(e)},[D]),ie=t.useCallback(()=>{const e=new Date;return D.getDate()===e.getDate()&&D.getMonth()===e.getMonth()&&D.getFullYear()===e.getFullYear()},[D]),le=t.useCallback(e=>e.toLocaleDateString("en-US",{month:"long",year:"numeric"}),[]),de=t.useCallback(e=>e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),[]);t.useEffect(()=>{(async()=>{O(!0);try{if(ie()&&Y?.data)A(Y.data.daily);else{const e=await Z(D);A(e||(Y?.data?.daily?Y.data.daily:null))}}catch(e){e?.message?.includes("ERR_EMPTY_RESPONSE")||e?.message?.includes("Failed to fetch")?(Le.warn("Backend not responding for day data (non-critical)"),A(Y?.data?.daily?Y.data.daily:null)):(Le.error("Error loading day data:",e),A(null))}finally{O(!1)}})()},[D,Y,ie,Z]),t.useEffect(()=>{(async()=>{F(!0);try{if(ee()&&Y?.data)P(Y.data.monthly);else{const e=await J(w);P(e||(Y?.data?.monthly?Y.data.monthly:null))}}catch(e){e?.message?.includes("ERR_EMPTY_RESPONSE")||e?.message?.includes("Failed to fetch")?(Le.warn("Backend not responding for month data (non-critical)"),P(Y?.data?.monthly?Y.data.monthly:null)):(Le.error("Error loading month data:",e),P(null))}finally{F(!1)}})()},[w,Y,ee,J,h]);const he=t.useMemo(()=>{try{return((e,t,s)=>{if(!e)return[{label:s("dashboard.net_cash"),value:"₺0",icon:i,change:"0%",trend:"up"},{label:s("dashboard.active_clients"),value:"0",icon:c,change:"0%",trend:"up"},{label:s("dashboard.total_transactions"),value:"0",icon:_,change:"0%",trend:"up"},{label:s("dashboard.growth_rate"),value:"0%",icon:b,change:"0%",trend:"up"}];let a=0;const r=e?.summary?e.summary.net_cash:void 0;if(null==r||isNaN(Number(r))){const s=e?.financial_performance?.annual?.net_cash_tl;if(null==s||isNaN(Number(s))){const e=t?.annual?.net_cash_tl;null==e||isNaN(Number(e))||(a=Number(e))}else a=Number(s)}else a=Number(r);const n=e?.stats?.active_clients?.value||"0",l="string"==typeof n?parseInt(n.replace(/[,]/g,""))||0:n,o=e?.stats?.total_transactions?.value||"0",d="string"==typeof o?parseInt(o.replace(/[,]/g,""))||0:o,m=e?.stats?.growth_rate?.value||"0%",h="string"==typeof m?parseFloat(m.replace(/[%,]/g,""))||0:m,u=e?.stats?.net_cash?.change||e?.stats?.total_revenue?.change||"0%",x=e?.stats?.active_clients?.change||"0%",g=e?.stats?.total_transactions?.change||"0%",p=e?.stats?.growth_rate?.change||"0%",y=e=>(parseFloat(e.replace(/[+%]/g,""))||0)>=0?"up":"down";return[{label:s("dashboard.net_cash"),value:`₺${a.toLocaleString("tr-TR",{maximumFractionDigits:0})}`,icon:i,change:u,trend:y(u)},{label:s("dashboard.active_clients"),value:l.toLocaleString("tr-TR"),icon:c,change:x,trend:y(x)},{label:s("dashboard.total_transactions"),value:d.toLocaleString("tr-TR"),icon:_,change:g,trend:y(g)},{label:s("dashboard.growth_rate"),value:`${h.toFixed(1)}%`,icon:b,change:p,trend:y(p)}]})(U,Y?.data||null,n)}catch(e){return Le.error("Error calculating quick stats:",e),[]}},[U,Y,n]),ue=t.useMemo(()=>{if(E&&Object.keys(E).length>0)return E;const e=U?.financial_performance?.daily;return e&&Object.keys(e).length>0?e:Y?.data?.daily||null},[E,U,Y]),xe=t.useMemo(()=>{if(R&&Object.keys(R).length>0)return R;const e=U?.financial_performance?.monthly;return e&&Object.keys(e).length>0?e:Y?.data?.monthly||null},[R,U,Y]),ge=t.useMemo(()=>{const e=U?.financial_performance?.annual;return e&&Object.keys(e).length>0?e:Y?.data?.annual||null},[U,Y]);Le.debug("[DIRECT DATA CHECK]",{selectedDay:D?.toDateString(),selectedMonth:w?.toLocaleDateString("en-US",{month:"long",year:"numeric"}),directDailyData:ue?{total_bank_tl:ue.total_bank_tl,total_cc_tl:ue.total_cc_tl,total_tether_usd:ue.total_tether_usd,conv_usd:ue.conv_usd,total_deposits_tl:ue.total_deposits_tl,total_withdrawals_tl:ue.total_withdrawals_tl,net_cash_tl:ue.net_cash_tl,bank_count:ue.bank_count,cc_count:ue.cc_count,tether_count:ue.tether_count}:"NULL",directMonthlyData:xe?{total_bank_tl:xe.total_bank_tl,total_cc_tl:xe.total_cc_tl,total_tether_usd:xe.total_tether_usd,conv_usd:xe.conv_usd,total_deposits_tl:xe.total_deposits_tl,total_withdrawals_tl:xe.total_withdrawals_tl,net_cash_tl:xe.net_cash_tl,bank_count:xe.bank_count,cc_count:xe.cc_count,tether_count:xe.tether_count}:"NULL",directAnnualData:ge?{total_bank_tl:ge.total_bank_tl,total_cc_tl:ge.total_cc_tl,total_tether_usd:ge.total_tether_usd,conv_usd:ge.conv_usd,total_deposits_tl:ge.total_deposits_tl,total_withdrawals_tl:ge.total_withdrawals_tl,net_cash_tl:ge.net_cash_tl,bank_count:ge.bank_count,cc_count:ge.cc_count,tether_count:ge.tether_count}:"NULL"});const pe=t.useMemo(()=>{try{const e=U?.financial_performance,t=Y?.data||null,s=U?.exchange_rates?.USD_TRY||t?.exchange_rate||48;let a=null;e&&Object.keys(e).length>0?a={daily:e.daily||{},monthly:e.monthly||{},annual:e.annual||{},exchange_rate:s}:t&&(a={...t,exchange_rate:s});const r=((e,t,s)=>{const a={total_bank_usd:0,total_bank_tl:0,total_cc_usd:0,total_cc_tl:0,total_tether_usd:0,total_tether_tl:0,conv_usd:0,conv_tl:0,total_transactions:0,bank_count:0,cc_count:0,tether_count:0,total_deposits_usd:0,total_deposits_tl:0,total_withdrawals_usd:0,total_withdrawals_tl:0,net_cash_usd:0,net_cash_tl:0};if(!e)return ht({daily:a,monthly:a,annual:a});const r=e,n=(e,t)=>t&&0!==Object.keys(t).length?{...e,net_cash_tl:void 0!==e.net_cash_tl&&null!==e.net_cash_tl?e.net_cash_tl:t.net_cash_tl??0,net_cash_usd:void 0!==e.net_cash_usd&&null!==e.net_cash_usd?e.net_cash_usd:t.net_cash_usd??0,total_deposits_tl:void 0!==e.total_deposits_tl&&null!==e.total_deposits_tl?e.total_deposits_tl:t.total_deposits_tl??0,total_deposits_usd:void 0!==e.total_deposits_usd&&null!==e.total_deposits_usd?e.total_deposits_usd:t.total_deposits_usd??0,total_withdrawals_tl:void 0!==e.total_withdrawals_tl&&null!==e.total_withdrawals_tl?e.total_withdrawals_tl:t.total_withdrawals_tl??0,total_withdrawals_usd:void 0!==e.total_withdrawals_usd&&null!==e.total_withdrawals_usd?e.total_withdrawals_usd:t.total_withdrawals_usd??0,total_bank_usd:void 0!==e.total_bank_usd&&null!==e.total_bank_usd?e.total_bank_usd:t.total_bank_usd??0,total_bank_tl:void 0!==e.total_bank_tl&&null!==e.total_bank_tl?e.total_bank_tl:t.total_bank_tl??0,total_cc_usd:void 0!==e.total_cc_usd&&null!==e.total_cc_usd?e.total_cc_usd:t.total_cc_usd??0,total_cc_tl:void 0!==e.total_cc_tl&&null!==e.total_cc_tl?e.total_cc_tl:t.total_cc_tl??0,total_tether_usd:void 0!==e.total_tether_usd&&null!==e.total_tether_usd?e.total_tether_usd:t.total_tether_usd??0,total_tether_tl:void 0!==e.total_tether_tl&&null!==e.total_tether_tl?e.total_tether_tl:t.total_tether_tl??0,conv_usd:void 0!==e.conv_usd&&null!==e.conv_usd?e.conv_usd:t.conv_usd??0,conv_tl:void 0!==e.conv_tl&&null!==e.conv_tl?e.conv_tl:t.conv_tl??0,bank_count:void 0!==e.bank_count&&null!==e.bank_count?e.bank_count:t.bank_count??0,cc_count:void 0!==e.cc_count&&null!==e.cc_count?e.cc_count:t.cc_count??0,tether_count:void 0!==e.tether_count&&null!==e.tether_count?e.tether_count:t.tether_count??0,total_transactions:void 0!==e.total_transactions&&null!==e.total_transactions?e.total_transactions:t.total_transactions??0}:e;let i,l;i=t&&Object.keys(t).length>0?t:r.daily&&Object.keys(r.daily).length>0?n(a,r.daily):a,l=s&&Object.keys(s).length>0?s:r.monthly&&Object.keys(r.monthly).length>0?n(a,r.monthly):a;const o=r.annual&&Object.keys(r.annual).length>0?n(a,r.annual):a;return ht({daily:i,monthly:l,annual:o})})(a,E,R);return r}catch(e){return Le.error("Error generating financial breakdown:",e),[]}},[Y,U,E,R]),ye=t.useMemo(()=>{try{if(!U?.chart_data?.daily_revenue)return Le.warn("No chart data available in dashboardData"),[];const e=((e,t,s=!0)=>{if(!e||0===e.length)return[];let a=s?e:e.filter(e=>0!==(e.net_cash||e.amount));if("daily"===t)return a;if("monthly"===t){const e=new Map;return a.forEach(t=>{const s=new Date(t.date),a=`${s.getFullYear()}-${(s.getMonth()+1).toString().padStart(2,"0")}`;e.has(a)?e.get(a).amount+=t.amount:e.set(a,{date:a,amount:t.amount})}),Array.from(e.values()).sort((e,t)=>e.date.localeCompare(t.date))}if("annual"===t){const e=new Map;return a.forEach(t=>{const s=new Date(t.date).getFullYear().toString();e.has(s)?e.get(s).amount+=t.amount:e.set(s,{date:s,amount:t.amount})}),Array.from(e.values()).sort((e,t)=>e.date.localeCompare(t.date))}return a})(U.chart_data.daily_revenue,x,p);return 0===e.length&&Le.warn("Transformed chart data is empty"),e}catch(e){return Le.error("Error transforming chart data:",e),[]}},[U,x,p]),fe=t.useCallback(async()=>{try{o(null),await Promise.all([W(),V()])}catch(e){Le.error("Error refreshing dashboard:",e),o(e instanceof Error?e:new Error("Refresh failed"))}},[W,V]),be=t.useCallback(async()=>{if(U){N(!0);try{await ut.generateComprehensiveReport(d),Le.info("Report generated successfully")}catch(e){Le.error("Error generating report:",e)}finally{N(!1)}}},[U,d]),je=I||q,ve=B||H||(l?l.message:null)||null;return l?s.jsx(gt,{theme:"slate",minHeightScreen:!0,className:"flex-1",children:s.jsx("main",{className:"flex-1 min-h-screen",children:s.jsx("div",{className:"px-6 py-8",children:s.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:s.jsx(se,{className:"w-full max-w-md border-0 shadow-2xl bg-white/80 backdrop-blur-sm",children:s.jsxs(ae,{className:"p-8 text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:s.jsx("span",{className:"text-2xl",children:"⚠️"})}),s.jsx("h2",{className:"text-2xl font-semibold text-slate-900 mb-3",children:"Component Error"}),s.jsx("p",{className:"text-slate-600 mb-4",children:l.message}),s.jsx(te,{onClick:()=>{o(null),window.location.reload()},className:"bg-slate-900 hover:bg-slate-800 text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 hover:scale-105",children:"Reload Page"})]})})})})})}):(t.useEffect(()=>{},[je,I,q,U,Y,E,R,ve,l]),!je||U||Y?!ve||U||Y?s.jsx("main",{style:{flex:1,backgroundColor:"#f9fafb",minHeight:"100vh"},className:"flex-1 bg-gray-50 min-h-screen",children:s.jsx("div",{style:{padding:"1.5rem 2rem"},className:"px-6 lg:px-8 py-6 lg:py-8",children:s.jsxs("div",{className:"space-y-6",children:[s.jsx(ot,{timeRange:d,viewType:h,refreshing:je,isGeneratingReport:v,lastUpdated:G,onTimeRangeChange:m,onViewTypeChange:u,onRefresh:fe,onExport:be}),he.length>0&&s.jsx(it,{stats:he,loading:je&&!U}),s.jsxs(se,{className:"bg-white border border-gray-200 shadow-sm hover:shadow-md transition-shadow duration-200",children:[s.jsx(oe,{className:"pb-6",children:s.jsx(me,{title:n("transactions.title"),description:n("dashboard.revenue_trend"),icon:$,size:"md",badge:s.jsx(ce,{status:"online",label:"Live Data",pulse:!0,size:"sm"}),actions:s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1",children:["daily","monthly","annual"].map(e=>s.jsx("button",{onClick:()=>g(e),className:"px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200 "+(x===e?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900 hover:bg-white/50"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),s.jsx("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1",children:s.jsx("button",{onClick:()=>y(!p),className:"px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200 flex items-center gap-2 "+(p?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900 hover:bg-white/50"),title:p?"Hide days with zero values":"Show all days including zeros",children:s.jsx("span",{children:p?"With Zeros":"Without Zeros"})})}),s.jsx("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1",children:s.jsx("button",{onClick:()=>j(!f),className:"px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200 flex items-center gap-2 "+(f?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900 hover:bg-white/50"),title:f?"Show Net Cash without commission":"Show Net Cash with commission",children:s.jsx("span",{children:f?"With Commission":"Without Commission"})})})]})})}),s.jsx(ae,{children:s.jsx("div",{className:"h-96 chart-container",children:ye.length>0?s.jsx(et,{data:ye,type:"bar",height:350,showWithCommission:f}):s.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:s.jsx("p",{children:"Chart verisi yükleniyor..."})})})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsx(ct,{title:n("dashboard.daily_revenue"),icon:C,period:"Daily",data:ue,breakdown:pe,loading:M||je,selectedDate:D,isCurrentPeriod:ie(),onPrevious:re,onNext:ne,onToday:()=>T(new Date),formatDate:de,navigatePath:"/analytics/revenue?period=daily",showWithCommission:f}),s.jsx(ct,{title:n("dashboard.monthly_revenue"),icon:L,period:"Monthly",data:xe,breakdown:pe,loading:z||je,selectedDate:w,isCurrentPeriod:ee(),onPrevious:K,onNext:X,onToday:()=>k(new Date),formatDate:le,navigatePath:"/analytics/revenue?period=monthly",showWithCommission:f}),s.jsx(ct,{title:n("dashboard.performance"),icon:S,period:"Total",data:ge,breakdown:pe,loading:je,selectedDate:new Date,isCurrentPeriod:!0,onPrevious:()=>{},onNext:()=>{},formatDate:()=>"All Time",navigatePath:"/analytics/revenue?period=annual",showWithCommission:f})]}),s.jsx(t.Suspense,{fallback:s.jsxs(se,{className:"bg-white border border-gray-200 shadow-sm",children:[s.jsx(oe,{className:"pb-4",children:s.jsx("div",{className:"h-6 bg-gray-200 rounded w-32 animate-pulse"})}),s.jsx(ae,{children:s.jsx("div",{className:"space-y-2",children:[...Array(3)].map((e,t)=>s.jsx("div",{className:"h-16 bg-gray-100 rounded-lg animate-pulse"},t))})})]}),children:s.jsx(pt,{limit:5,onClickTransaction:e=>{r(`/transactions?highlight=${e}`)}})}),s.jsx(t.Suspense,{fallback:s.jsxs(se,{className:"bg-white border border-gray-200 shadow-sm",children:[s.jsx(oe,{className:"pb-4",children:s.jsx("div",{className:"h-6 bg-gray-200 rounded w-32 animate-pulse"})}),s.jsx(ae,{children:s.jsx("div",{className:"space-y-2",children:[...Array(3)].map((e,t)=>s.jsx("div",{className:"h-16 bg-gray-100 rounded-lg animate-pulse"},t))})})]}),children:s.jsx(yt,{limit:5})})]})})}):s.jsx(gt,{theme:"slate",minHeightScreen:!0,className:"flex-1",children:s.jsx("main",{className:"flex-1 min-h-screen",children:s.jsx("div",{className:"px-6 py-8",children:s.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:s.jsx(se,{className:"w-full max-w-md border-0 shadow-2xl bg-white/80 backdrop-blur-sm",children:s.jsxs(ae,{className:"p-8 text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:s.jsx("span",{className:"text-2xl",children:"⚠️"})}),s.jsx("h2",{className:"text-2xl font-semibold text-slate-900 mb-3",children:"Error Loading Dashboard"}),s.jsx("p",{className:"text-slate-600 mb-6",children:ve}),s.jsx(te,{onClick:fe,disabled:je,className:"bg-slate-900 hover:bg-slate-800 text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 hover:scale-105",children:"Try Again"})]})})})})})}):s.jsx(Xe,{}))}),bt=Object.freeze(Object.defineProperty({__proto__:null,default:ft},Symbol.toStringTag,{value:"Module"})),jt=({data:e,columns:r,searchable:n=!0,sortable:i=!0,pagination:l=!0,pageSize:o=10,onEdit:c,onDelete:d,onView:m,title:h,description:u})=>{const[x,g]=t.useState(""),[p,y]=t.useState(null),[f,b]=t.useState(1),j=t.useMemo(()=>x?e.filter(e=>r.some(t=>{const s=e[t.key];return s&&s.toString().toLowerCase().includes(x.toLowerCase())})):e,[e,x,r]),N=t.useMemo(()=>p?[...j].sort((e,t)=>{const s=e[p.key],a=t[p.key];return s<a?"asc"===p.direction?-1:1:s>a?"asc"===p.direction?1:-1:0}):j,[j,p]),w=t.useMemo(()=>{if(!l)return N;const e=(f-1)*o;return N.slice(e,e+o)},[N,f,o,l]),_=Math.ceil(j.length/o);return s.jsxs(se,{children:[(h||u)&&s.jsxs(oe,{children:[h&&s.jsx(he,{children:h}),u&&s.jsx("p",{className:"text-sm text-muted-foreground",children:u})]}),s.jsxs(ae,{children:[n&&s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"relative",children:[s.jsx(a,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),s.jsx(ee,{placeholder:"Search...",value:x,onChange:e=>g(e.target.value),className:"pl-10"})]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-border",children:[r.map(e=>{return s.jsx("th",{className:"text-left py-3 px-4 font-medium text-sm text-muted-foreground "+(e.sortable?"cursor-pointer hover:text-foreground":""),onClick:()=>{return e.sortable&&(t=e.key,void(i&&y(e=>({key:t,direction:e?.key===t&&"asc"===e.direction?"desc":"asc"}))));var t},children:s.jsxs("div",{className:"flex items-center gap-2",children:[e.label,e.sortable&&(t=e.key,p&&p.key===t?"asc"===p.direction?s.jsx(I,{className:"w-4 h-4"}):s.jsx(v,{className:"w-4 h-4"}):s.jsx(I,{className:"w-4 h-4 opacity-50"}))]})},e.key);var t}),(c||d||m)&&s.jsx("th",{className:"text-right py-3 px-4 font-medium text-sm text-muted-foreground",children:"Actions"})]})}),s.jsx("tbody",{children:w.map((e,t)=>s.jsxs("tr",{className:"border-b border-border hover:bg-muted/50",children:[r.map(t=>s.jsx("td",{className:"py-3 px-4 text-sm",children:t.render?t.render(e[t.key],e):e[t.key]},t.key)),(c||d||m)&&s.jsx("td",{className:"py-3 px-4 text-right",children:s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[m&&s.jsx(te,{variant:"ghost",size:"sm",onClick:()=>m(e),children:s.jsx(z,{className:"w-4 h-4"})}),c&&s.jsx(te,{variant:"ghost",size:"sm",onClick:()=>c(e),children:s.jsx(F,{className:"w-4 h-4"})}),d&&s.jsx(te,{variant:"ghost",size:"sm",onClick:()=>d(e),className:"text-destructive hover:text-destructive",children:s.jsx(U,{className:"w-4 h-4"})})]})})]},t))})]})}),l&&_>1&&s.jsxs("div",{className:"flex items-center justify-between mt-4",children:[s.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(f-1)*o+1," to ",Math.min(f*o,j.length)," of ",j.length," entries"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(te,{variant:"outline",size:"sm",onClick:()=>b(e=>Math.max(e-1,1)),disabled:1===f,children:"Previous"}),s.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:_},(e,t)=>t+1).map(e=>s.jsx(te,{variant:f===e?"default":"outline",size:"sm",onClick:()=>b(e),className:"w-8 h-8 p-0",children:e},e))}),s.jsx(te,{variant:"outline",size:"sm",onClick:()=>b(e=>Math.min(e+1,_)),disabled:f===_,children:"Next"})]})]})]})]})},vt=Object.freeze(Object.defineProperty({__proto__:null,DataTable:jt,default:jt},Symbol.toStringTag,{value:"Module"})),Nt=Object.freeze(Object.defineProperty({__proto__:null,NotificationSystem:({notifications:e=[],onMarkAsRead:a,onMarkAllAsRead:n,onDelete:i,onClearAll:o})=>{const[c,d]=t.useState(!1),[m,h]=t.useState(e);t.useEffect(()=>{0===e.length&&h([{id:"1",type:"success",title:"Payment Processed",message:"Transaction TXN-001 has been successfully processed for $12,500",timestamp:new Date(Date.now()-12e4),read:!1,priority:"medium",action:{label:"View Transaction",onClick:()=>{}}},{id:"2",type:"warning",title:"High Transaction Volume",message:"Unusual activity detected. 15 transactions processed in the last hour.",timestamp:new Date(Date.now()-9e5),read:!1,priority:"high",action:{label:"Review Activity",onClick:()=>{}}},{id:"3",type:"info",title:"System Update",message:"New features have been added to the dashboard. Check out the analytics tab.",timestamp:new Date(Date.now()-18e5),read:!0,priority:"low"},{id:"4",type:"error",title:"API Error",message:"Failed to sync with external payment processor. Retrying...",timestamp:new Date(Date.now()-27e5),read:!0,priority:"high",action:{label:"Check Status",onClick:()=>{}}}])},[e]);const u=m.filter(e=>!e.read).length,x=e=>{switch(e){case"success":return s.jsx(b,{className:"w-4 h-4 text-green-500"});case"warning":return s.jsx(f,{className:"w-4 h-4 text-yellow-500"});case"error":return s.jsx(f,{className:"w-4 h-4 text-red-500"});case"info":return s.jsx(y,{className:"w-4 h-4 text-blue-500"});default:return s.jsx(y,{className:"w-4 h-4 text-gray-500"})}},g=e=>{switch(e){case"high":return"border-l-red-500";case"medium":return"border-l-yellow-500";case"low":return"border-l-blue-500";default:return"border-l-gray-500"}},j=e=>{const t=(new Date).getTime()-e.getTime(),s=Math.floor(t/6e4),a=Math.floor(t/36e5),r=Math.floor(t/864e5);return s<1?"Just now":s<60?`${s}m ago`:a<24?`${a}h ago`:`${r}d ago`};return s.jsxs("div",{className:"relative",children:[s.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>d(!c),className:"relative",children:[s.jsx(p,{className:"w-5 h-5"}),u>0&&s.jsx(re,{variant:"destructive",className:"absolute -top-1 -right-1 w-5 h-5 p-0 flex items-center justify-center text-xs",children:u})]}),c&&s.jsxs(se,{className:"absolute right-0 mt-2 w-96 z-50 max-h-96 overflow-hidden",children:[s.jsx(oe,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(he,{className:"text-lg",children:"Notifications"}),s.jsxs("div",{className:"flex items-center gap-2",children:[u>0&&s.jsx(te,{variant:"ghost",size:"sm",onClick:()=>{h(e=>e.map(e=>({...e,read:!0}))),n?.()},className:"text-xs",children:"Mark all read"}),s.jsx(te,{variant:"ghost",size:"sm",onClick:()=>d(!1),children:s.jsx(r,{className:"w-4 h-4"})})]})]})}),s.jsx(ae,{className:"p-0 max-h-80 overflow-y-auto",children:0===m.length?s.jsxs("div",{className:"p-6 text-center text-muted-foreground",children:[s.jsx(p,{className:"w-8 h-8 mx-auto mb-2 text-muted-foreground/50"}),s.jsx("p",{children:"No notifications"})]}):s.jsx("div",{className:"divide-y divide-border",children:m.map(e=>s.jsx("div",{className:`p-4 hover:bg-muted/50 cursor-pointer border-l-4 ${g(e.priority)} ${e.read?"":"bg-muted/30"}`,onClick:()=>{return!e.read&&(t=e.id,h(e=>e.map(e=>e.id===t?{...e,read:!0}:e)),void a?.(t));var t},children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex-shrink-0 mt-0.5",children:x(e.type)}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("h4",{className:"text-sm font-medium text-foreground",children:e.title}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[s.jsx(l,{className:"w-3 h-3"}),j(e.timestamp)]}),s.jsx(te,{variant:"ghost",size:"sm",onClick:t=>{var s;t.stopPropagation(),s=e.id,h(e=>e.filter(e=>e.id!==s)),i?.(s)},className:"h-6 w-6 p-0 text-muted-foreground hover:text-destructive",children:s.jsx(U,{className:"w-3 h-3"})})]})]}),s.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:e.message}),e.action&&s.jsx(te,{variant:"outline",size:"sm",onClick:t=>{t.stopPropagation(),e.action?.onClick()},className:"text-xs",children:e.action.label}),!e.read&&s.jsx("div",{className:"mt-2",children:s.jsx(re,{variant:"outline",className:"text-xs",children:"New"})})]})]})},e.id))})}),m.length>0&&s.jsx("div",{className:"p-3 border-t border-border bg-muted/30",children:s.jsx(te,{variant:"ghost",size:"sm",onClick:()=>{h([]),o?.()},className:"w-full text-destructive hover:text-destructive",children:"Clear all notifications"})})]})]})}},Symbol.toStringTag,{value:"Module"})),wt=Object.freeze(Object.defineProperty({__proto__:null,CircularProgress:({value:e,max:t=100,size:a=120,strokeWidth:r=8,showValue:n=!0,label:i,className:l=""})=>{const o=(a-r)/2,c=2*o*Math.PI,d=e/t*c,m=Math.round(e/t*100);return s.jsxs("div",{className:`flex flex-col items-center ${l}`,children:[s.jsxs("div",{className:"relative",style:{width:a,height:a},children:[s.jsxs("svg",{width:a,height:a,className:"transform -rotate-90",children:[s.jsx("circle",{cx:a/2,cy:a/2,r:o,stroke:"hsl(var(--muted))",strokeWidth:r,fill:"none"}),s.jsx("circle",{cx:a/2,cy:a/2,r:o,stroke:"hsl(var(--primary))",strokeWidth:r,fill:"none",strokeDasharray:c,strokeDashoffset:c-d,strokeLinecap:"round",className:"transition-all duration-300 ease-in-out"})]}),n&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsxs("span",{className:"text-2xl font-bold text-foreground",children:[m,"%"]})})]}),i&&s.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:i})]})},ProgressIndicator:({steps:e,orientation:t="horizontal",showTimestamps:a=!1,className:r=""})=>{const n=e=>{switch(e){case"completed":return s.jsx(b,{className:"w-5 h-5 text-green-500"});case"current":return s.jsx(l,{className:"w-5 h-5 text-gray-500"});case"error":return s.jsx(B,{className:"w-5 h-5 text-red-500"});default:return s.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-muted-foreground"})}},i=e=>{switch(e){case"completed":return"text-green-600 bg-green-50 border-green-200";case"current":return"text-gray-600 bg-gray-50 border-gray-200";case"error":return"text-red-600 bg-red-50 border-red-200";default:return"text-muted-foreground bg-muted border-border"}},c=(e,t)=>"completed"===e?"bg-green-500":"current"===e?"bg-gray-500":"error"===e?"bg-red-500":"bg-muted-foreground";return"vertical"===t?s.jsx("div",{className:`space-y-4 ${r}`,children:e.map((t,r)=>s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("div",{className:`p-2 rounded-full border ${i(t.status)}`,children:n(t.status)}),r<e.length-1&&s.jsx("div",{className:`w-0.5 h-8 mt-2 ${c(t.status)}`})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h4",{className:"font-medium "+("upcoming"===t.status?"text-muted-foreground":"text-foreground"),children:t.title}),"current"===t.status&&s.jsx(re,{variant:"outline",className:"text-gray-600 border-gray-200",children:"In Progress"}),"error"===t.status&&s.jsx(re,{variant:"destructive",children:"Error"})]}),t.description&&s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:t.description}),a&&t.timestamp&&s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:t.timestamp.toLocaleString()})]})]},t.id))}):s.jsx(se,{className:r,children:s.jsx(ae,{className:"p-6",children:s.jsx("div",{className:"flex items-center justify-between",children:e.map((t,r)=>s.jsxs(x.Fragment,{children:[s.jsxs("div",{className:"flex flex-col items-center text-center",children:[s.jsx("div",{className:`p-3 rounded-full border ${i(t.status)} mb-2`,children:n(t.status)}),s.jsx("h4",{className:"text-sm font-medium "+("upcoming"===t.status?"text-muted-foreground":"text-foreground"),children:t.title}),t.description&&s.jsx("p",{className:"text-xs text-muted-foreground mt-1 max-w-24",children:t.description}),a&&t.timestamp&&s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:t.timestamp.toLocaleDateString()})]}),r<e.length-1&&s.jsxs("div",{className:"flex-1 flex items-center justify-center mx-4",children:[s.jsx("div",{className:`h-0.5 w-full ${c(t.status)}`}),s.jsx(o,{className:"w-4 h-4 text-muted-foreground mx-2"})]})]},t.id))})})})}},Symbol.toStringTag,{value:"Module"})),_t={default:"",card:"bg-card border border-border rounded-lg shadow-sm",section:"bg-background",container:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},kt={none:"",sm:"space-y-2",md:"space-y-4",lg:"space-y-6",xl:"space-y-8"},Ct={none:"",sm:"p-3",md:"p-4",lg:"p-6",xl:"p-8"},St={none:"",sm:"m-2",md:"m-4",lg:"m-6",xl:"m-8"},Dt={default:"bg-background",muted:"bg-muted",card:"bg-card",transparent:"bg-transparent"},Tt={none:"",sm:"shadow-sm",md:"shadow-md",lg:"shadow-lg"},Et={none:"",sm:"rounded-sm",md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl"},At=({children:e,className:t,variant:a="default",spacing:r="md",padding:n="md",margin:i="none",background:l="default",border:o=!1,shadow:c="none",rounded:d="md"})=>s.jsx("div",{className:Me("transition-colors duration-200",_t[a],kt[r],Ct[n],St[i],Dt[l],o&&"border border-border",Tt[c],Et[d],t),children:e}),Lt=({children:e,title:t,description:a,className:r,headerClassName:n,contentClassName:i,actions:l})=>s.jsxs(At,{variant:"section",spacing:"lg",className:r,children:[(t||a||l)&&s.jsxs("div",{className:Me("flex items-center justify-between",n),children:[s.jsxs("div",{className:"space-y-1",children:[t&&s.jsx("h2",{className:"text-2xl font-semibold text-foreground",children:t}),a&&s.jsx("p",{className:"text-muted-foreground",children:a})]}),l&&s.jsx("div",{className:"flex items-center gap-2",children:l})]}),s.jsx("div",{className:Me("space-y-4",i),children:e})]}),Rt=({children:e,cols:t=1,gap:a="md",className:r,responsive:n=!0})=>s.jsx("div",{className:Me("grid",n?{1:"grid-cols-1",2:"grid-cols-1 sm:grid-cols-2",3:"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",4:"grid-cols-1 sm:grid-cols-2 lg:grid-cols-4",5:"grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5",6:"grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-6",12:"grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 2xl:grid-cols-12"}[t]:{1:"grid-cols-1",2:"grid-cols-2",3:"grid-cols-3",4:"grid-cols-4",5:"grid-cols-5",6:"grid-cols-6",12:"grid-cols-12"}[t],{sm:"gap-2",md:"gap-4",lg:"gap-6",xl:"gap-8"}[a],r),children:e}),Pt=({children:e,className:t,header:a,footer:r,variant:n="default",size:i="md",padding:l="md",showGlass:o=!1})=>{const c={none:"",sm:"p-3",md:"p-4",lg:"p-6"},d=o?"glass-card card-hover-subtle":"";return s.jsxs(se,{className:Me({default:"bg-card border border-border shadow-sm",outlined:"bg-transparent border-2 border-border",elevated:"bg-card shadow-lg border-0",flat:"bg-card border-0 shadow-none"}[n],{sm:"text-sm",md:"text-base",lg:"text-lg"}[i],d,t),children:[a&&s.jsx(oe,{className:Me("border-b border-border",c[l]),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-1",children:[a.title&&s.jsx(he,{className:"text-lg font-semibold text-foreground",children:a.title}),a.description&&s.jsx(ue,{className:"text-muted-foreground",children:a.description})]}),a.actions&&s.jsx("div",{className:"flex items-center gap-2",children:a.actions})]})}),s.jsx(ae,{className:Me(c[l]),children:e}),r&&s.jsx("div",{className:Me("border-t border-border",c[l]),children:r})]})},Mt=({children:e,variant:t="primary",size:a="md",className:r,disabled:n=!1,loading:i=!1,icon:l,iconPosition:o="left",onClick:c,type:d="button"})=>s.jsxs(te,{type:d,variant:"ghost",disabled:n||i,onClick:c,className:Me("inline-flex items-center justify-center whitespace-nowrap rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{primary:"bg-primary text-primary-foreground hover:bg-primary/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",ghost:"hover:bg-accent hover:text-accent-foreground",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",success:"bg-green-600 text-white hover:bg-green-700",warning:"bg-yellow-600 text-white hover:bg-yellow-700"}[t],{sm:"h-8 px-3 text-sm",md:"h-10 px-4 py-2",lg:"h-12 px-6 text-lg"}[a],r),children:[i&&s.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin mr-2"}),l&&"left"===o&&s.jsx("span",{className:"mr-2",children:l}),e,l&&"right"===o&&s.jsx("span",{className:"ml-2",children:l})]}),Ot=({children:e,variant:t="default",size:a="md",className:r})=>s.jsx(re,{variant:"outline",className:Me("inline-flex items-center rounded-full font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{default:"bg-primary text-primary-foreground hover:bg-primary/80",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground border border-border",success:"bg-green-100 text-green-800 hover:bg-green-200",warning:"bg-yellow-100 text-yellow-800 hover:bg-yellow-200",info:"bg-blue-100 text-blue-800 hover:bg-blue-200"}[t],{sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-0.5 text-sm",lg:"px-3 py-1 text-base"}[a],r),children:e}),$t=({data:e,columns:t,className:a,striped:r=!0,hover:n=!0,size:i="md"})=>{const l={sm:"text-xs",md:"text-sm",lg:"text-base"};return s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:Me("w-full border-collapse",a),children:[s.jsx("thead",{children:s.jsx("tr",{className:"border-b border-border",children:t.map(e=>s.jsx("th",{className:Me("text-left font-medium text-muted-foreground",l[i],"px-4 py-3"),children:e.label},e.key))})}),s.jsx("tbody",{children:e.map((e,a)=>s.jsx("tr",{className:Me("border-b border-border transition-colors",r&&a%2==0&&"bg-muted/50",n&&"hover:bg-muted/50"),children:t.map(t=>s.jsx("td",{className:Me("px-4 py-3",l[i]),children:t.render?t.render(e[t.key],e):e[t.key]},t.key))},a))})]})})},zt=({isOpen:e,onClose:a,title:n,children:i,size:l="md",showCloseButton:o=!0,subtitle:c,footer:d,closeOnBackdropClick:m=!0,closeOnEscape:h=!0,className:u=""})=>{const x=t.useRef(null);return t.useEffect(()=>{const t=e=>{"Escape"===e.key&&h&&a()};return e&&(document.addEventListener("keydown",t),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",t),document.body.style.overflow="unset"}},[e,a,h]),e?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",onClick:e=>{m&&e.target===e.currentTarget&&a()},children:s.jsxs("div",{ref:x,className:`w-full ${{sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-7xl"}[l]} bg-white rounded-lg shadow-xl ${u}`,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title","aria-describedby":c?"modal-subtitle":void 0,children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("div",{children:[s.jsx("h2",{id:"modal-title",className:"text-lg font-semibold text-gray-900",children:n}),c&&s.jsx("p",{id:"modal-subtitle",className:"text-sm text-gray-600 mt-1",children:c})]}),o&&s.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close modal",children:s.jsx(r,{className:"h-5 w-5","aria-hidden":"true"})})]}),s.jsx("div",{className:"p-6",children:i}),d&&s.jsx("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-gray-200 bg-gray-50 rounded-b-lg",children:d})]})}):null},Ft=({transaction:e})=>{const t=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch{return"Invalid Date"}};return s.jsxs("div",{className:"max-h-[70vh] overflow-y-auto pr-2 space-y-6 business-scrollbar",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"bg-gray-100 p-2 rounded-lg",children:s.jsx(i,{className:"h-6 w-6 text-gray-600"})}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Transaction #",e.id]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Created on ",t(e.created_at)]})]})]})}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center",children:[s.jsx(j,{className:"h-4 w-4 mr-2"}),"Client Information"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Client Name"}),s.jsx("p",{className:"text-sm text-gray-900 font-medium",children:e.client_name})]}),e.company&&s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Company"}),s.jsxs("p",{className:"text-sm text-gray-900 flex items-center",children:[s.jsx(W,{className:"h-4 w-4 mr-2 text-gray-400"}),e.company]})]}),e.iban&&s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"IBAN"}),s.jsx("p",{className:"text-sm text-gray-900 font-mono",children:e.iban})]}),e.payment_method&&s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Payment Method"}),s.jsxs("p",{className:"text-sm text-gray-900 flex items-center",children:[s.jsx(R,{className:"h-4 w-4 mr-2 text-gray-400"}),e.payment_method]})]})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center",children:[s.jsx(i,{className:"h-4 w-4 mr-2"}),"Transaction Details"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Category"}),s.jsx("p",{className:"text-sm text-gray-900",children:e.category})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"PSP"}),s.jsx("p",{className:"text-sm text-gray-900",children:e.psp||"N/A"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Transaction Date"}),s.jsxs("p",{className:"text-sm text-gray-900 flex items-center",children:[s.jsx(C,{className:"h-4 w-4 mr-2 text-gray-400"}),t(e.date)]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Currency"}),s.jsx("p",{className:"text-sm text-gray-900 font-medium",children:e.currency||"TL"})]})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center",children:[s.jsx(i,{className:"h-4 w-4 mr-2"}),"Financial Information"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:"Amount"}),s.jsx("p",{className:"text-lg font-bold text-gray-900",children:$e(e.amount,e.currency)}),e.amount_tl&&s.jsxs("p",{className:"text-xs text-gray-600",children:["(",$e(e.amount_tl,"₺"),")"]})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:"Commission"}),s.jsx("p",{className:"text-lg font-bold text-gray-900",children:Oe(e.commission,e.currency||"₺")}),e.commission_tl&&s.jsxs("p",{className:"text-xs text-gray-600",children:["(",Oe(e.commission_tl,"₺"),")"]})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:"Net Amount"}),s.jsx("p",{className:"text-lg font-bold text-gray-900",children:$e(e.net_amount,e.currency||"₺")}),e.net_amount_tl&&s.jsxs("p",{className:"text-xs text-gray-600",children:["(",$e(e.net_amount_tl,"₺"),")"]})]})]}),e.exchange_rate&&s.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:"Exchange Rate"}),s.jsxs("p",{className:"text-sm text-gray-900",children:["1 ",e.currency," = ",e.exchange_rate.toFixed(4)," TL"]})]})]}),e.notes&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center",children:[s.jsx(n,{className:"h-4 w-4 mr-2"}),"Notes"]}),s.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap",children:e.notes})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Timestamps"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Created"}),s.jsx("p",{className:"text-gray-900",children:t(e.created_at)})]}),e.updated_at&&s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Last Updated"}),s.jsx("p",{className:"text-gray-900",children:t(e.updated_at)})]})]})]})]})},Ut=[{id:"gpt-3.5-turbo",name:"AI Standard",description:"Fast and efficient for most tasks",cost:"Budget",maxTokens:4096,pricePer1kTokens:.0015},{id:"gpt-4o-mini",name:"AI Balanced",description:"Balanced performance and cost",cost:"Economy",maxTokens:128e3,pricePer1kTokens:15e-5},{id:"gpt-4",name:"AI Professional",description:"High-quality reasoning and analysis",cost:"Premium",maxTokens:8192,pricePer1kTokens:.03},{id:"gpt-4o",name:"AI Advanced",description:"Latest model with enhanced capabilities",cost:"Premium+",maxTokens:128e3,pricePer1kTokens:.005},{id:"gpt-4-turbo",name:"AI Enterprise",description:"Enhanced model with larger context",cost:"Enterprise",maxTokens:128e3,pricePer1kTokens:.01}],It={API_KEY:null,API_URL:"/api/v1/ai-assistant/chat",ENABLED:!0};function Bt(){return s.jsxs("div",{className:"relative w-96 h-96 flex items-center justify-center",style:{perspective:1e3,transformStyle:"preserve-3d"},children:[[0,1,2,3,4,5,6,7].map(e=>{const t=70+22*e,a=4+.6*e,r=60+15*e%60,n=45*e;return s.jsxs("div",{children:[s.jsx(G.div,{className:"absolute",style:{width:2*t,height:2*t,left:"50%",top:"50%",marginLeft:-t,marginTop:-t,transformStyle:"preserve-3d"},animate:{rotateX:[r,r],rotateY:[n,n],rotateZ:[0,360]},transition:{rotateZ:{duration:a,repeat:1/0,ease:"linear"}},children:s.jsx("div",{className:"w-full h-full rounded-full border-2 border-purple-500/25",style:{boxShadow:"0 0 15px rgba(168, 85, 247, 0.15)"}})}),[...Array(1)].map((i,l)=>{const o=360*l+30*e,c=1.8+.2*e;return s.jsx(G.div,{className:"absolute",style:{width:2*t,height:2*t,left:"50%",top:"50%",marginLeft:-t,marginTop:-t,transformStyle:"preserve-3d"},animate:{rotateX:[r,r],rotateY:[n,n],rotateZ:[o,o+360]},transition:{rotateZ:{duration:a,repeat:1/0,ease:"linear"}},children:s.jsx(G.div,{className:"absolute w-2.5 h-2.5 rounded-full bg-gray-600",style:{top:"50%",left:"100%",marginTop:-5,marginLeft:-5,boxShadow:"0 0 10px rgba(236, 72, 153, 0.9), 0 0 5px rgba(168, 85, 247, 0.7)"},animate:{scale:[1,1.3,1],boxShadow:["0 0 10px rgba(236, 72, 153, 0.9), 0 0 5px rgba(168, 85, 247, 0.7)","0 0 15px rgba(236, 72, 153, 1), 0 0 8px rgba(168, 85, 247, 0.9)","0 0 10px rgba(236, 72, 153, 0.9), 0 0 5px rgba(168, 85, 247, 0.7)"]},transition:{duration:c,repeat:1/0,ease:"easeInOut"}})},`electron-${e}-${l}`)})]},`orbit-${e}`)}),s.jsx(G.div,{className:"relative z-10",style:{perspective:1200,transformStyle:"preserve-3d"},animate:{rotateY:[0,360],rotateX:[0,15,0,-15,0]},transition:{rotateY:{duration:4,repeat:1/0,ease:"linear"},rotateX:{duration:6,repeat:1/0,ease:"easeInOut"}},children:s.jsxs("svg",{width:"140",height:"140",viewBox:"0 0 140 140",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{filter:"drop-shadow(0 0 60px rgba(168, 85, 247, 0.9)) drop-shadow(0 0 30px rgba(236, 72, 153, 0.6))"},children:[s.jsxs("defs",{children:[s.jsxs("linearGradient",{id:"spark1",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[s.jsx("stop",{offset:"0%",stopColor:"#c084fc"}),s.jsx("stop",{offset:"50%",stopColor:"#f472b6"}),s.jsx("stop",{offset:"100%",stopColor:"#818cf8"})]}),s.jsxs("linearGradient",{id:"spark2",x1:"100%",y1:"0%",x2:"0%",y2:"100%",children:[s.jsx("stop",{offset:"0%",stopColor:"#a855f7"}),s.jsx("stop",{offset:"50%",stopColor:"#ec4899"}),s.jsx("stop",{offset:"100%",stopColor:"#6366f1"})]}),s.jsxs("linearGradient",{id:"sparkHighlight",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[s.jsx("stop",{offset:"0%",stopColor:"#ffffff",stopOpacity:"0.9"}),s.jsx("stop",{offset:"100%",stopColor:"#ffffff",stopOpacity:"0"})]}),s.jsxs("radialGradient",{id:"glow1",children:[s.jsx("stop",{offset:"0%",stopColor:"#ffffff",stopOpacity:"1"}),s.jsx("stop",{offset:"30%",stopColor:"#fbbf24",stopOpacity:"0.8"}),s.jsx("stop",{offset:"60%",stopColor:"#f472b6",stopOpacity:"0.4"}),s.jsx("stop",{offset:"100%",stopColor:"#a855f7",stopOpacity:"0"})]}),s.jsxs("radialGradient",{id:"centerGlow",children:[s.jsx("stop",{offset:"0%",stopColor:"#ffffff",stopOpacity:"1"}),s.jsx("stop",{offset:"100%",stopColor:"#fbbf24",stopOpacity:"0.8"})]}),s.jsxs("filter",{id:"innerGlow",children:[s.jsx("feGaussianBlur",{stdDeviation:"2",result:"blur"}),s.jsx("feComposite",{in:"blur",in2:"SourceGraphic",operator:"atop"})]})]}),s.jsxs("g",{transform:"translate(70, 70)",children:[s.jsx("path",{d:"M 0,-50 L 6,-12 L 6,12 L 0,50 L -6,12 L -6,-12 Z",fill:"url(#spark1)"}),s.jsx("path",{d:"M 0,-50 L 3,-12 L 3,12 L 0,50 L -3,12 L -3,-12 Z",fill:"url(#sparkHighlight)",opacity:"0.6"}),s.jsx("path",{d:"M -50,0 L -12,-6 L 12,-6 L 50,0 L 12,6 L -12,6 Z",fill:"url(#spark2)"}),s.jsx("path",{d:"M -50,0 L -12,-3 L 12,-3 L 50,0 L 12,3 L -12,3 Z",fill:"url(#sparkHighlight)",opacity:"0.6"}),s.jsx("path",{d:"M -35,-35 L -10,-8 L -8,-10 L -35,-35 M 35,35 L 10,8 L 8,10 L 35,35 Z",fill:"url(#spark1)",opacity:"0.9"}),s.jsx("path",{d:"M 35,-35 L 8,-10 L 10,-8 L 35,-35 M -35,35 L -8,10 L -10,8 L -35,35 Z",fill:"url(#spark2)",opacity:"0.9"}),s.jsx("path",{d:"M 0,-30 L 2,-10 L 2,10 L 0,30 L -2,10 L -2,-10 Z",fill:"url(#sparkHighlight)",opacity:"0.4",transform:"rotate(22.5)"}),s.jsx("path",{d:"M -30,0 L -10,-2 L 10,-2 L 30,0 L 10,2 L -10,2 Z",fill:"url(#sparkHighlight)",opacity:"0.4",transform:"rotate(22.5)"})]})]})}),[...Array(8)].map((e,t)=>{const a=45*t*(Math.PI/180),r=100+t%2*30,n=Math.cos(a)*r,i=Math.sin(a)*r,l=.5*t;return s.jsx(G.div,{className:"absolute w-1 h-1 rounded-full",style:{left:"50%",top:"50%",background:"linear-gradient(135deg, #a855f7, #ec4899)",boxShadow:"0 0 8px rgba(168, 85, 247, 0.8)"},animate:{x:[0,n,0],y:[0,i,0],z:[0,50*Math.random()-25,0],scale:[0,1.5,0],opacity:[0,1,0]},transition:{duration:4,repeat:1/0,delay:l,ease:"easeOut"}},`particle-${t}`)})]})}const Wt=({apiKey:e,className:a=""})=>{Q();const[r,n]=t.useState([]),[i,l]=t.useState(""),[o,c]=t.useState(!1),[d,m]=t.useState(null),[h,u]=t.useState("gpt-4o-mini"),[x,g]=t.useState(!1),[p,y]=t.useState({}),f=t.useRef(null),b=It.ENABLED;t.useEffect(()=>{(async()=>{try{const e=await fetch("/api/v1/ai-assistant/sections");if(e.ok){const t=await e.json();y(t.sections||{})}}catch(e){}})()},[b]),t.useEffect(()=>{},[b,d,r.length]),t.useEffect(()=>{f.current?.scrollIntoView({behavior:"smooth"})},[r]);const v=async()=>{if(!i.trim()||o)return;const e={id:Date.now().toString(),role:"user",content:i.trim(),timestamp:new Date};n(t=>[...t,e]),l(""),c(!0),m(null);try{const t=await fetch(It.API_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:h,use_enhanced:x,messages:[{role:"system",content:"You are an intelligent AI assistant integrated into PipLinePro, a comprehensive financial management system. \n\nYour role is to:\n- Provide clear, concise, and accurate responses\n- Help users understand their financial data and business insights\n- Assist with data analysis and interpretation\n- Answer general business and technical questions\n- Maintain a professional and helpful tone\n\nFocus areas:\n- Financial data analysis and insights\n- Business intelligence and reporting\n- Transaction processing and PSP management\n- Client relationship management\n- System usage and troubleshooting\n\nAlways be helpful, accurate, and maintain user privacy and data security."},...r.map(e=>({role:e.role,content:e.content})),{role:"user",content:e.content}]})});if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.message||`API Error: ${t.status} ${t.statusText}`)}const s=await t.json(),a={id:(Date.now()+1).toString(),role:"assistant",content:s.response||"Sorry, I could not generate a response.",timestamp:new Date,model:s.model||h,enhanced:s.enhanced||!1};n(e=>[...e,a])}catch(t){m(t instanceof Error?t.message:"Failed to send message")}finally{c(!1)}};return s.jsxs(se,{className:`h-full flex flex-col ${a}`,children:[s.jsx(oe,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-gray-800 rounded-lg flex items-center justify-center",children:s.jsx(Y,{className:"w-4 h-4 text-white"})}),s.jsxs("div",{children:[s.jsx(he,{className:"text-lg font-semibold text-slate-900",children:"AI Assistant"}),s.jsx("p",{className:"text-sm text-slate-600",children:"Intelligent Analysis & Insights"})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("label",{className:"flex items-center gap-1 text-xs text-slate-600",children:[s.jsx("input",{type:"checkbox",checked:x,onChange:e=>g(e.target.checked),className:"rounded border-slate-300 text-purple-600 focus:ring-purple-500",disabled:o}),s.jsx(Y,{className:"w-3 h-3"}),"Enhanced"]})}),s.jsx("div",{className:"relative",children:s.jsx("select",{value:h,onChange:e=>(e=>{if(e!==h&&r.length>0){const t={id:Date.now().toString(),role:"assistant",content:`Switched to ${Ut.find(t=>t.id===e)?.name||e} model.`,timestamp:new Date,model:e};n(e=>[...e,t])}u(e)})(e.target.value),className:"text-xs border border-slate-300 rounded px-2 py-1 bg-white text-slate-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent cursor-pointer",disabled:o,title:"Select AI model - cheaper models are faster, expensive models are more capable",children:Ut.map(e=>s.jsxs("option",{value:e.id,title:`${e.description} - Cost: ${e.cost}`,children:[e.name," (",e.cost,")"]},e.id))})}),s.jsx(te,{variant:"outline",size:"sm",onClick:()=>{n([]),m(null)},className:"text-slate-600 hover:text-red-600",children:s.jsx(U,{className:"w-4 h-4"})}),s.jsx(te,{variant:"outline",size:"sm",className:"text-slate-600",children:s.jsx(N,{className:"w-4 h-4"})})]})]})}),s.jsxs(ae,{className:"flex-1 flex flex-col p-0",children:[s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 min-h-[400px] max-h-[500px]",children:[0===r.length?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[s.jsx("div",{className:"relative scale-50 origin-center",children:s.jsx(Bt,{})}),x&&Object.keys(p).length>0&&s.jsx("div",{className:"mt-6 max-w-md",children:s.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Y,{className:"w-4 h-4 text-purple-600"}),s.jsx("h4",{className:"text-sm font-medium text-purple-900",children:"Enhanced Mode Active"})]}),s.jsx("p",{className:"text-xs text-purple-700 mb-3",children:"I have read-only access to your PipLinePro data including:"}),s.jsx("div",{className:"grid grid-cols-2 gap-1 text-xs text-purple-600",children:Object.entries(p).slice(0,8).map(([e,t])=>s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"w-1 h-1 bg-purple-400 rounded-full"}),t.name]},e))}),s.jsx("p",{className:"text-xs text-purple-600 mt-2",children:"Ask me about transactions, analytics, reports, or any business data!"}),s.jsx("div",{className:"mt-3 pt-3 border-t border-purple-200",children:s.jsxs("p",{className:"text-xs text-purple-500 flex items-center gap-1",children:[s.jsx(q,{className:"w-3 h-3"}),"Read-only access: I can view and analyze data but cannot modify anything."]})})]})})]}):r.map(e=>s.jsxs("div",{className:"flex gap-3 "+("user"===e.role?"justify-end":"justify-start"),children:["assistant"===e.role&&s.jsx("div",{className:"w-8 h-8 bg-gray-800 rounded-full flex items-center justify-center flex-shrink-0",children:s.jsx(H,{className:"w-4 h-4 text-white"})}),s.jsxs("div",{className:"max-w-[80%] rounded-lg px-4 py-3 "+("user"===e.role?"bg-blue-600 text-white":"bg-slate-100 text-slate-900"),children:[s.jsx("p",{className:"text-sm whitespace-pre-wrap",children:e.content}),s.jsxs("div",{className:"text-xs mt-2 "+("user"===e.role?"text-blue-100":"text-slate-500"),children:[s.jsx("p",{children:e.timestamp.toLocaleTimeString()}),"assistant"===e.role&&s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.model&&s.jsx("p",{className:"text-slate-400",children:Ut.find(t=>t.id===e.model)?.name||e.model}),e.enhanced&&s.jsxs("div",{className:"flex items-center gap-1 text-purple-600",children:[s.jsx(Y,{className:"w-3 h-3"}),s.jsx("span",{children:"Enhanced"})]})]})]})]}),"user"===e.role&&s.jsx("div",{className:"w-8 h-8 bg-gray-800 rounded-full flex items-center justify-center flex-shrink-0",children:s.jsx(j,{className:"w-4 h-4 text-white"})})]},e.id)),o&&s.jsxs("div",{className:"flex gap-3 justify-start",children:[s.jsx("div",{className:"w-8 h-8 bg-gray-800 rounded-full flex items-center justify-center flex-shrink-0",children:s.jsx(H,{className:"w-4 h-4 text-white"})}),s.jsx("div",{className:"bg-slate-100 rounded-lg px-4 py-3",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(V,{className:"w-4 h-4 animate-spin text-purple-600"}),s.jsx("span",{className:"text-sm text-slate-600",children:"AI is thinking..."})]})})]}),d&&b&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:s.jsxs("p",{className:"text-sm text-red-600",children:[s.jsx("strong",{children:"Error:"})," ",d]})}),s.jsx("div",{ref:f})]}),s.jsxs("div",{className:"border-t border-slate-200 p-4",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx("textarea",{value:i,onChange:e=>l(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),v())},placeholder:"Ask me anything about your business or data...",className:"flex-1 resize-none border rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:border-transparent border-slate-300 focus:ring-purple-500",rows:2,disabled:o||!b}),s.jsx(te,{onClick:v,disabled:!i.trim()||o||!b,className:"px-4 py-2 rounded-lg transition-all duration-200 bg-gray-700 hover:bg-gray-800 text-white",children:o?s.jsx(V,{className:"w-4 h-4 animate-spin"}):s.jsx(Z,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-xs mt-2 text-slate-500",children:"Press Enter to send, Shift+Enter for new line"})]})]})]})},Gt=({limit:a=5,onClickTransaction:r})=>{const{t:n}=Q(),i=e(),[l,c]=t.useState([]),[d,m]=t.useState(!0),[h,u]=t.useState(null),[x,g]=t.useState(!1),[p,y]=t.useState(null),[f,b]=t.useState(!1),[j,v]=t.useState(!1),N=t.useCallback(async(e=!1)=>{try{e?g(!0):m(!0),u(null),e&&Pe.clearCacheForUrl("transactions");try{const e=await Pe.get(`/transactions/?per_page=${a}&sort_by=created_at&sort_order=desc`);if(e.ok){const t=await Pe.parseResponse(e);let s=[];if(t&&"object"==typeof t){const e=t;Array.isArray(e.transactions)?s=e.transactions:Array.isArray(e.data)?s=e.data:Array.isArray(e)&&(s=e)}else Array.isArray(t)&&(s=t);c(s.slice(0,a))}else c([]),u(null)}catch(t){c([]),u(null)}}catch(s){c([]),u(null)}finally{m(!1),g(!1)}},[a]);t.useEffect(()=>{N()},[N]),t.useEffect(()=>{const e=e=>{"created"!==e.detail?.action&&"updated"!==e.detail?.action||N(!0)};return window.addEventListener("transactionsUpdated",e),()=>{window.removeEventListener("transactionsUpdated",e)}},[N]);const w=t.useCallback((e,t="TRY")=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"USD"===t?"USD":"TRY",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),[]),k=t.useCallback(e=>{const t=new Date(e),s=new Date,a=Math.floor((s.getTime()-t.getTime())/1e3);return a<60?`${a}s ago`:a<3600?`${Math.floor(a/60)}m ago`:a<86400?`${Math.floor(a/3600)}h ago`:`${Math.floor(a/86400)}d ago`},[]),C=t.useCallback(async e=>{v(!0);try{const t=await Pe.get(`/api/transaction/${e}`);if(t.ok){const e=await Pe.parseResponse(t),s={id:e.id,client_name:e.client_name,company:e.company_order||e.company,iban:e.iban,payment_method:e.payment_method,category:e.category,amount:e.amount,commission:e.commission,net_amount:e.net_amount,currency:e.currency,psp:e.psp,notes:e.notes,date:e.date,created_at:e.created_at,updated_at:e.updated_at,amount_tl:e.amount_tl,commission_tl:e.commission_tl,net_amount_tl:e.net_amount_tl,exchange_rate:e.exchange_rate};y(s),b(!0)}}catch(t){}finally{v(!1)}},[]),T=t.useCallback(e=>{r?r(e.id,e):C(e.id)},[r,C]),E=t.useCallback(()=>{i("/clients?tab=transactions")},[i]),L=t.useCallback(()=>{N(!0)},[N]),R=t.useMemo(()=>l.map(e=>({...e,formattedAmount:w(Math.abs(e.amount),e.currency),formattedTime:k(e.created_at||e.date),isDeposit:"DEP"===e.category||"DEPOSIT"===e.category})),[l,w,k]);return d?s.jsxs(se,{className:"border border-gray-200 shadow-sm hover:shadow-md transition-shadow duration-200",children:[s.jsx(oe,{className:"pb-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(he,{className:"text-base font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(_,{className:"w-4 h-4 text-gray-600"}),n("dashboard.recent_activity")||"Recent Activity"]}),s.jsx(ce,{status:"syncing",size:"sm",showLabel:!1})]})}),s.jsx(ae,{children:s.jsx("div",{className:"space-y-3",children:[...Array(a)].map((e,t)=>s.jsx("div",{className:"animate-pulse",children:s.jsx("div",{className:"h-16 bg-gray-100 rounded-lg"})},t))})})]}):h?s.jsxs(se,{className:"border border-gray-200 shadow-sm",children:[s.jsx(oe,{className:"pb-4",children:s.jsxs(he,{className:"text-base font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(_,{className:"w-4 h-4 text-gray-600"}),n("dashboard.recent_activity")||"Recent Activity"]})}),s.jsx(ae,{children:s.jsx("p",{className:"text-sm text-gray-500",children:h})})]}):s.jsxs(se,{className:"border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200 group",children:[s.jsx(oe,{className:"pb-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(he,{className:"text-base font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(_,{className:"w-4 h-4 text-gray-600 group-hover:text-gray-900 transition-colors"}),n("dashboard.recent_activity")||"Recent Activity"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:L,disabled:x,className:"p-1.5 rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50",title:"Refresh",children:s.jsx(A,{className:"w-4 h-4 text-gray-600 "+(x?"animate-spin":"")})}),s.jsx(ce,{status:x?"syncing":"online",size:"sm",showLabel:!1,pulse:!x})]})]})}),s.jsx(ae,{children:0===l.length?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(_,{className:"w-8 h-8 text-gray-300 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-gray-500",children:"No recent activity"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"space-y-2",children:R.map(e=>{const t=e.isDeposit?S:D;return s.jsxs("div",{onClick:()=>T(e),className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-100 hover:bg-gray-100 hover:border-gray-200 cursor-pointer transition-all duration-200 group/item",children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[s.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center flex-shrink-0 transition-colors "+(e.isDeposit?"bg-green-100 group-hover/item:bg-green-200":"bg-red-100 group-hover/item:bg-red-200"),children:s.jsx(t,{className:"w-4 h-4 "+(e.isDeposit?"text-green-700":"text-red-700")})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900 truncate group-hover/item:text-gray-950",children:e.client_name||"Unknown Client"}),s.jsx("div",{className:"flex items-center gap-2 mt-0.5",children:s.jsxs("p",{className:"text-xs text-gray-500 truncate",children:[e.psp&&`${e.psp} • `,e.formattedTime]})})]})]}),s.jsxs("div",{className:"flex items-center gap-3 ml-3",children:[s.jsx("div",{className:"text-right",children:s.jsxs("p",{className:"text-sm font-semibold "+(e.isDeposit?"text-green-700":"text-red-700"),children:[e.isDeposit?"+":"-",e.formattedAmount]})}),s.jsx(o,{className:"w-4 h-4 text-gray-400 group-hover/item:text-gray-600 transition-colors opacity-0 group-hover/item:opacity-100"})]})]},e.id)})}),s.jsxs("button",{onClick:E,className:"mt-4 w-full text-sm font-medium text-gray-600 hover:text-gray-900 py-2 rounded-lg hover:bg-gray-50 transition-colors duration-200 flex items-center justify-center gap-1",children:["View all transactions",s.jsx(o,{className:"w-3 h-3"})]})]})}),f&&p&&s.jsx(zt,{isOpen:f,onClose:()=>{b(!1),y(null)},title:n("transactions.view_transaction")||"Transaction Details",size:"lg",children:j?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):s.jsx(Ft,{transaction:p})})]})},Yt=Object.freeze(Object.defineProperty({__proto__:null,RecentActivityFeed:Gt,default:Gt},Symbol.toStringTag,{value:"Module"})),qt=({limit:e=5})=>{Q();const[a,r]=t.useState([]),[n,i]=t.useState({}),[l,o]=t.useState(!0),[c,d]=t.useState(!1),[m,h]=t.useState(null),u=t.useCallback(async()=>{try{const t=await Pe.get("/trust-wallet/wallets?active_only=true");if(t.ok){const s=await Pe.parseResponse(t),a=s.wallets||s||[];r(a.slice(0,e))}else r([])}catch(t){r([])}},[e]),x=t.useCallback(async e=>{try{const t=await Pe.get(`/trust-wallet/wallets/${e}/balance`);if(t.ok){const s=await Pe.parseResponse(t),a=s.success&&s.data?s.data:s;i(t=>({...t,[e]:a}))}}catch(t){}},[]),g=t.useCallback(async()=>{if(0!==a.length){d(!0);try{await Promise.all(a.map(e=>x(e.id)))}finally{d(!1)}}},[a,x]);t.useEffect(()=>{(async()=>{o(!0),await u(),o(!1)})()},[u]),t.useEffect(()=>{a.length>0&&g()},[a,g]);const p=t.useCallback(()=>{g()},[g]),y=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e);if(l)return s.jsx(Pt,{variant:"default",header:{title:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(J,{className:"w-4 h-4 text-gray-600"}),s.jsx("span",{className:"h-5 bg-gray-200 rounded w-40 animate-pulse"})]})},padding:"md",children:s.jsx("div",{className:"space-y-3",children:[...Array(3)].map((e,t)=>s.jsx("div",{className:"h-20 bg-gray-100 rounded-lg animate-pulse"},t))})});if(m)return s.jsx(Pt,{variant:"default",header:{title:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(J,{className:"w-4 h-4 text-gray-600"}),s.jsx("span",{children:"Crypto Wallet Balances"})]})},padding:"md",children:s.jsx("p",{className:"text-sm text-gray-500",children:m})});const f=Object.values(n).reduce((e,t)=>e+(t?.total_usd||0),0);return s.jsx(Pt,{variant:"default",header:{title:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(J,{className:"w-4 h-4 text-gray-600"}),s.jsx("span",{className:"text-base font-semibold text-gray-900",children:"Crypto Wallet Balances"})]}),actions:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Mt,{variant:"ghost",size:"sm",onClick:p,disabled:c,className:"p-1.5 h-auto min-w-0 hover:bg-gray-100",children:s.jsx(A,{className:"w-4 h-4 text-gray-600 "+(c?"animate-spin":"")})}),s.jsx(ce,{status:c?"syncing":"online",size:"sm",showLabel:!1,pulse:!c})]})},padding:"md",className:"hover:shadow-md transition-shadow duration-200",children:0===a.length?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(J,{className:"w-8 h-8 text-gray-300 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-gray-500",children:"No active wallets"})]}):s.jsxs(s.Fragment,{children:[f>0&&s.jsx("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg border border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:"Total Value"}),s.jsx("span",{className:"text-lg font-bold text-gray-900",children:y(f)})]})}),s.jsx("div",{className:"space-y-3",children:a.map(e=>{const t=n[e.id],a=t?.total_usd||0,r=t?.balances||{};return s.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200 hover:bg-gray-100 hover:border-gray-300 transition-all duration-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.wallet_name}),s.jsxs("p",{className:"text-xs text-gray-500 truncate",children:[e.network," • ",e.wallet_address.slice(0,8),"...",e.wallet_address.slice(-6)]})]}),a>0&&s.jsx("div",{className:"text-right ml-3",children:s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:y(a)})})]}),Object.keys(r).length>0&&s.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200 space-y-1.5",children:[Object.entries(r).slice(0,3).map(([e,t])=>{return s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{className:"text-gray-600 font-medium",children:e}),s.jsxs("div",{className:"text-right",children:[s.jsx("span",{className:"text-gray-900 font-semibold",children:(a=t.amount,a>=1e-4?a.toLocaleString("en-US",{maximumFractionDigits:6,minimumFractionDigits:0}):a.toExponential(2))}),t.usd_value>0&&s.jsxs("span",{className:"text-gray-500 ml-2",children:["(",y(t.usd_value),")"]})]})]},e);var a}),Object.keys(r).length>3&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1.5",children:["+",Object.keys(r).length-3," more tokens"]})]})]},e.id)})})]})})},Ht=Object.freeze(Object.defineProperty({__proto__:null,CryptoWalletBalancesCard:qt,default:qt},Symbol.toStringTag,{value:"Module"}));export{Wt as C,vt as D,Ue as G,ft as M,Nt as N,gt as P,tt as R,nt as S,Ft as T,Pt as U,Ae as _,Pe as a,Ot as b,Me as c,Mt as d,zt as e,$e as f,Oe as g,Rt as h,ze as i,It as j,Re as k,Le as l,$t as m,Lt as n,He as o,Ge as p,Ve as q,bt as r,wt as s,Ie as u};
