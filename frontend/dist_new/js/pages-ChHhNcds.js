const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/pages-systemmonitor-R69PhKQe.js","js/vendor-react-OTlZW24_.js","js/contexts-ClDLaFbv.js","js/components-modern-C3CPxipx.js","js/components-ui-CpjZxCxu.js","js/vendor-utils-CtF19A-_.js","js/vendor-charts-recharts-DLiVWtHJ.js","js/vendor-i18n-DHLiip7K.js","js/DatabaseManagement-D8EMyVTh.js","js/SecurityManagement-EA-kHYha.js"])))=>i.map(i=>d[i]);
import{j as e,r as s,T as t,aQ as a,o as r,aR as n,H as l,F as i,R as c,u as o,aH as d,ae as m,ad as x,aS as h,C as g,aT as u,aU as p,d as y,aV as j,E as f,I as b,f as N,aW as v,aO as w,P as _,c as k,aX as S,D as C,X as D,k as T,Z as A,a2 as E,m as R,e as P,n as F,x as L,y as U,U as $,aY as z,_ as O,p as M,v as I,l as B,aZ as H,a_ as q,a$ as K,i as W,q as Y,b0 as V,h as J,B as G,b1 as X,t as Q,w as Z,b2 as ee,S as se,b3 as te,b4 as ae,b5 as re,b6 as ne,J as le,b7 as ie,a as ce,s as oe,b8 as de,a5 as me,b as xe,b9 as he,a0 as ge,ba as ue,bb as pe,bc as ye,bd as je,be as fe,bf as be,Q as Ne,bg as ve,bh as we,a8 as _e,bi as ke,ac as Se,V as Ce,bj as De}from"./vendor-react-OTlZW24_.js";import{M as Te,l as Ae,U as Ee,d as Re,a as Pe,b as Fe,f as Le,e as Ue,T as $e,g as ze,u as Oe,h as Me,i as Ie,P as Be,C as He,j as qe,_ as Ke,k as We,m as Ye}from"./components-modern-C3CPxipx.js";import{b as Ve,a as Je}from"./contexts-ClDLaFbv.js";import{l as Ge,m as Xe,n as Qe,o as Ze,p as es,A as ss,q as ts,L as as,I as rs,r as ns,d as ls,f as is,g as cs,a as os,F as ds,B as ms,s as xs,t as hs,u as gs,v as us,w as ps,e as ys,x as js,C as fs,b as bs}from"./components-ui-CpjZxCxu.js";import{R as Ns,L as vs,b as ws,X as _s,Y as ks,T as Ss,c as Cs,P as Ds,a as Ts,C as As,f as Es,B as Rs,d as Ps,A as Fs,e as Ls,S as Us,g as $s}from"./vendor-charts-recharts-DLiVWtHJ.js";import{T as zs}from"./components-trust-DTGixXDn.js";const Os=({size:s="md",variant:t="default",message:a="Loading...",className:r="",fullScreen:n=!1,showDots:l=!1,showBar:i=!1,indeterminate:c=!1})=>{const o=n?"business-loading-overlay":"flex items-center justify-center";return e.jsx("div",{className:`${o} ${r}`,role:"status","aria-live":"polite","aria-label":a,children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[l?e.jsxs("div",{className:"business-loading-dots business-loading-dots-primary",children:[e.jsx("div",{className:"business-loading-dots-dot"}),e.jsx("div",{className:"business-loading-dots-dot"}),e.jsx("div",{className:"business-loading-dots-dot"})]}):i?e.jsx("div",{className:"business-loading-bar",children:e.jsx("div",{className:"business-loading-bar-progress"})}):e.jsx("div",{className:l?`business-loading-dots business-loading-dots-${t}`:i?`business-loading-bar business-loading-bar-${c?"indeterminate":t}`:`${{sm:"business-loading-spinner-sm",md:"business-loading-spinner-md",lg:"business-loading-spinner-lg",xl:"business-loading-spinner-xl"}[s]} ${{default:"business-loading-spinner",primary:"business-loading-spinner-primary",success:"business-loading-spinner-success",warning:"business-loading-spinner-warning",error:"business-loading-spinner-error",neutral:"business-loading-spinner-neutral"}[t]}`,"aria-hidden":"true"}),a&&e.jsx("p",{className:"text-sm text-gray-600 font-medium","aria-live":"polite",children:a})]})})};class Ms extends s.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null,errorId:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e,errorId:`error_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}componentDidCatch(e,s){this.props.onError?.(e,s),this.setState({errorInfo:s}),this.reportError(e,s)}reportError=async(e,s)=>{try{(new Date).toISOString()}catch(t){}};handleRetry=()=>{this.setState({hasError:!1,error:null,errorInfo:null,errorId:null})};handleGoHome=()=>{window.location.href="/"};handleGoBack=()=>{window.history.back()};handleCopyError=()=>{if(this.state.error){const e=`\nError ID: ${this.state.errorId}\nMessage: ${this.state.error.message}\nStack: ${this.state.error.stack}\nComponent Stack: ${this.state.errorInfo?.componentStack}\nTimestamp: ${(new Date).toISOString()}\nURL: ${window.location.href}\n      `.trim();navigator.clipboard.writeText(e).then(()=>{alert("Error details copied to clipboard")}).catch(()=>{const s=document.createElement("textarea");s.value=e,document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s),alert("Error details copied to clipboard")})}};render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{style:{minHeight:"100vh",backgroundColor:"#f9fafb",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem"},children:e.jsxs("div",{className:"max-w-2xl w-full bg-white rounded-2xl shadow-xl border border-gray-200 p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(t,{className:"w-10 h-10 text-red-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Oops! Something went wrong"}),e.jsx("p",{className:"text-gray-600",children:"We encountered an unexpected error. Don't worry, we've been notified and are working to fix it."})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(a,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Error Details"})]}),e.jsx("p",{className:"text-sm text-gray-600 font-mono",children:this.state.error?.message||"Unknown error occurred"}),this.state.errorId&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Error ID: ",this.state.errorId]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-6",children:[e.jsxs("button",{onClick:this.handleRetry,className:"flex-1 flex items-center justify-center gap-2 bg-gray-600 text-white px-4 py-3 rounded-lg font-medium hover:bg-gray-700 transition-colors",children:[e.jsx(r,{className:"w-4 h-4"}),"Try Again"]}),e.jsxs("button",{onClick:this.handleGoBack,className:"flex-1 flex items-center justify-center gap-2 bg-gray-600 text-white px-4 py-3 rounded-lg font-medium hover:bg-gray-700 transition-colors",children:[e.jsx(n,{className:"w-4 h-4"}),"Go Back"]}),e.jsxs("button",{onClick:this.handleGoHome,className:"flex-1 flex items-center justify-center gap-2 bg-green-600 text-white px-4 py-3 rounded-lg font-medium hover:bg-green-700 transition-colors",children:[e.jsx(l,{className:"w-4 h-4"}),"Go Home"]})]}),e.jsx("div",{className:"flex items-center justify-center gap-4 text-sm",children:e.jsxs("button",{onClick:this.handleCopyError,className:"flex items-center gap-2 text-gray-500 hover:text-gray-700 transition-colors",children:[e.jsx(i,{className:"w-4 h-4"}),"Copy Error Details"]})}),e.jsx("div",{className:"mt-6 text-center text-sm text-gray-500",children:e.jsx("p",{children:"If this problem persists, please contact support with the Error ID above."})})]})}):this.props.children}}class Is extends c.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,s){Ae.error("ModernDashboard Error:",e,s)}render(){return this.state.hasError&&this.state.error?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-2xl w-full bg-white shadow-lg rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(t,{className:"w-6 h-6 text-red-500"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Dashboard Error"})]}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Failed to load Modern Dashboard:"}),e.jsxs("pre",{className:"bg-gray-100 p-4 rounded text-sm overflow-auto max-h-96 whitespace-pre-wrap",children:[this.state.error.message,"\n\n",this.state.error.stack]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700",children:"Reload Page"})]})}):this.props.children}}const Bs=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{Ve();const{user:s}=Je();return e.jsx(Is,{children:e.jsx(Te,{user:s||void 0})})}},Symbol.toStringTag,{value:"Module"})),Hs=Object.freeze(Object.defineProperty({__proto__:null,default:function(){return null}},Symbol.toStringTag,{value:"Module"})),qs=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const[a,r]=s.useState(""),[n,l]=s.useState(""),[i,c]=s.useState(!1),[S,C]=s.useState(!1),[D,T]=s.useState(!1),[A,E]=s.useState({}),[R,P]=s.useState(0),[F,L]=s.useState(!1),[U,$]=s.useState(null),[z,O]=s.useState(0),[M,I]=s.useState(!1),[B,H]=s.useState(0),[q,K]=s.useState(navigator.onLine),[W,Y]=s.useState(new Date),[V,J]=s.useState(!1),[G,X]=s.useState(new Date),[Q,Z]=s.useState("operational"),ee=s.useRef(null),se=s.useRef(null),te=s.useRef([]),{login:ae,isAuthenticated:re}=Je(),{t:ne,currentLanguage:le,setLanguage:ie}=Ve(),ce=o(),oe=d();return s.useEffect(()=>{if(re){const e=oe.state?.from?.pathname||"/dashboard";ce(e,{replace:!0})}},[re,ce,oe]),s.useEffect(()=>{const e=localStorage.getItem("pipeline_remember_user");e&&(r(e),C(!0))},[]),s.useEffect(()=>{if(!F||!U)return;const e=setInterval(()=>{const e=Date.now(),s=Math.max(0,Math.ceil((U.getTime()-e)/1e3));O(s),s<=0&&(L(!1),$(null),P(0))},1e3);return()=>clearInterval(e)},[F,U,ne]),s.useEffect(()=>{const e=setInterval(()=>{X(new Date),Y(new Date)},1e3);return()=>clearInterval(e)},[]),s.useEffect(()=>{const e=()=>K(!0),s=()=>K(!1);return window.addEventListener("online",e),window.addEventListener("offline",s),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}},[]),s.useEffect(()=>{ee.current&&ee.current.focus()},[]),e.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f9fafb",padding:"1rem",position:"relative"},className:"min-h-screen flex items-center justify-center bg-gray-50 p-4 relative",children:[e.jsxs("div",{className:"absolute top-4 right-4 flex items-center gap-2 bg-card border rounded-lg px-3 py-2 shadow-sm",children:[q?e.jsx(m,{className:"w-4 h-4 text-green-500"}):e.jsx(x,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:ne(q?"login.online":"login.offline")})]}),e.jsxs("div",{className:"absolute top-4 left-4 flex items-center gap-2 bg-card border rounded-lg px-3 py-2 shadow-sm",children:[e.jsx(h,{className:"w-4 h-4 "+("operational"===Q?"text-green-500":"maintenance"===Q?"text-yellow-500":"text-red-500")}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["operational"===Q&&ne("login.systemOperational"),"maintenance"===Q&&ne("login.systemMaintenance"),"issues"===Q&&ne("login.systemIssues")]})]}),e.jsxs("div",{className:"w-full max-w-md space-y-6 relative z-10",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center",children:e.jsx("img",{src:"/plogo.png",alt:"PipLinePro Logo",className:"w-24 h-24 object-contain"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-3xl font-semibold tracking-tight",children:"PipLinePro"}),e.jsx("p",{className:"text-muted-foreground",children:ne("login.systemTitle")})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(g,{className:"w-4 h-4"}),e.jsx("span",{children:G.toLocaleTimeString("tr"===le?"tr-TR":"en-US")})]}),e.jsx("div",{className:"w-px h-4 bg-border"}),e.jsx("span",{children:G.toLocaleDateString("tr"===le?"tr-TR":"en-US")})]})]}),e.jsx("div",{className:"flex items-center justify-center gap-2",children:e.jsxs(Ge,{value:le,onValueChange:ie,children:[e.jsxs(Xe,{className:"w-auto border-0 bg-transparent hover:bg-muted/50 transition-colors",children:[e.jsx(u,{className:"w-4 h-4 mr-1"}),e.jsx(Qe,{})]}),e.jsxs(Ze,{children:[e.jsx(es,{value:"en",children:"English"}),e.jsx(es,{value:"tr",children:"TÃ¼rkÃ§e"})]})]})}),F&&e.jsxs(ss,{variant:"destructive",children:[e.jsx(p,{className:"h-4 w-4"}),e.jsx(ts,{children:ne("login.accountLockedMessage",{minutes:Math.ceil(z/60),seconds:z%60})})]}),!q&&e.jsxs(ss,{className:"border-orange-200 bg-orange-50",children:[e.jsx(x,{className:"h-4 w-4 text-orange-600"}),e.jsx(ts,{className:"text-orange-800",children:ne("login.offlineMode")})]}),e.jsx(Ee,{variant:"elevated",size:"md",padding:"lg",className:"shadow-md bg-white",header:{title:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-5 h-5"}),ne("login.signIn")]}),description:ne("login.signInDescription")},children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return a.trim()?a.length<3&&(e.username=ne("login.usernameMinLength")):e.username=ne("login.usernameRequired"),n?n.length<5&&(e.password=ne("login.passwordMinLength")):e.password=ne("login.passwordRequired"),E(e),0===Object.keys(e).length})()){E({}),T(!0);try{const e=await ae(a,n,S),s={timestamp:new Date,success:e.success,ip:"192.168.1.100"};if(te.current.push(s),!e.success)throw new Error(e.message||ne("login.invalidCredentials"));{S?localStorage.setItem("pipeline_remember_user",a):localStorage.removeItem("pipeline_remember_user"),P(0);const e=oe.state?.from?.pathname||"/dashboard";ce(e,{replace:!0})}}catch(s){P(R+1);{const e=s instanceof Error?s.message:ne("login.loginFailed");E({general:e})}}finally{T(!1)}}},className:"space-y-4",children:[A.general&&e.jsxs(ss,{variant:"destructive",children:[e.jsx(t,{className:"h-4 w-4"}),e.jsx(ts,{children:A.general})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(as,{htmlFor:"username",className:"flex items-center gap-1",children:[e.jsx(y,{className:"w-4 h-4"}),ne("login.username"),e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(rs,{ref:ee,id:"username",type:"text",placeholder:ne("login.usernamePlaceholder"),value:a,onChange:e=>r(e.target.value),disabled:D||F,className:"bg-input-background transition-all "+(A.username?"border-destructive focus-visible:ring-destructive":""),autoComplete:"username",onKeyDown:e=>{"Enter"===e.key&&se.current&&se.current.focus()}}),A.username&&e.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[e.jsx(t,{className:"w-3 h-3"}),A.username]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(as,{htmlFor:"password",className:"flex items-center gap-1",children:[e.jsx(p,{className:"w-4 h-4"}),ne("login.password"),e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(rs,{ref:se,id:"password",type:i?"text":"password",placeholder:ne("login.passwordPlaceholder"),value:n,onChange:e=>{return s=e.target.value,l(s),void H((e=>{let s=0;return e.length>=6&&(s+=25),/[A-Z]/.test(e)&&(s+=25),/[0-9]/.test(e)&&(s+=25),/[^A-Za-z0-9]/.test(e)&&(s+=25),s})(s));var s},onKeyDown:e=>{if(e.getModifierState){const s=e.getModifierState("CapsLock");I(s)}},onKeyPress:e=>{const s=e.getModifierState&&e.getModifierState("CapsLock");I(s)},disabled:D||F,className:"bg-input-background pr-10 transition-all "+(A.password?"border-destructive focus-visible:ring-destructive":""),autoComplete:"current-password"}),e.jsx(Re,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>c(!i),disabled:D||F,children:i?e.jsx(j,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(f,{className:"h-4 w-4 text-muted-foreground"})})]}),n&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:ne("login.passwordStrength")}),e.jsx("span",{className:"text-xs text-muted-foreground",children:(de=B,ne(de<25?"login.passwordWeak":de<50?"login.passwordFair":de<75?"login.passwordGood":"login.passwordStrong"))})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-1.5",children:e.jsx("div",{className:`h-1.5 rounded-full transition-all duration-300 ${(e=>e<25?"bg-red-500":e<50?"bg-orange-500":e<75?"bg-yellow-500":"bg-green-500")(B)}`,style:{width:`${B}%`}})})]}),A.password&&e.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[e.jsx(t,{className:"w-3 h-3"}),A.password]}),M&&e.jsxs("p",{className:"text-sm text-orange-600 flex items-center gap-1",children:[e.jsx(b,{className:"w-3 h-3"}),ne("login.capsLockOn")]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ns,{id:"remember",checked:S,onCheckedChange:e=>C(!0===e),disabled:D||F}),e.jsx(as,{htmlFor:"remember",className:"text-sm cursor-pointer text-muted-foreground",children:ne("login.rememberMe")})]}),R>0&&e.jsx("span",{className:"text-xs text-orange-600",children:ne("login.failedAttempts",{count:R})})]}),e.jsx(Re,{type:"button",variant:"ghost",size:"sm",onClick:()=>J(!V),className:"w-full text-muted-foreground hover:text-foreground",icon:e.jsx(N,{className:"w-4 h-4"}),iconPosition:"left",children:ne(V?"login.hideAdvanced":"login.showAdvanced")}),V&&e.jsxs("div",{className:"p-3 bg-muted/30 rounded-lg space-y-3 border",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:ne("login.advancedOptions")}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:ne("login.twoFactorAuth")})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:ne("login.notConfigured")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:ne("login.sessionDuration")})]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["8 ",ne("login.hours")]})]})]}),e.jsx(Re,{type:"submit",variant:"primary",size:"lg",className:"w-full",disabled:D||F||!a||!n||!q,loading:D,icon:D?void 0:e.jsx(w,{className:"w-4 h-4"}),iconPosition:"left",children:ne(D?"login.signingIn":"login.signIn")})]}),te.current.length>0&&e.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg border border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(_,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:ne("login.recentActivity")})]}),e.jsx("div",{className:"space-y-1",children:te.current.slice(-3).map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.success?e.jsx(k,{className:"w-3 h-3 text-green-500"}):e.jsx(t,{className:"w-3 h-3 text-red-500"}),e.jsx("span",{className:"text-muted-foreground",children:s.timestamp.toLocaleTimeString()})]}),e.jsx("span",{className:s.success?"text-green-600":"text-red-600",children:s.success?ne("login.success"):ne("login.failed")})]},a))})]})]})}),e.jsxs("div",{className:"text-center space-y-2 text-xs text-muted-foreground",children:[e.jsxs("p",{children:["Â© 2024 PipLinePro ",ne("login.allRightsReserved")]}),e.jsx("p",{children:ne("login.secureTreasuryManagement")}),e.jsxs("p",{className:"flex items-center justify-center gap-1",children:[e.jsx(_,{className:"w-3 h-3"}),ne("login.encryptedConnection")]})]})]})]});var de}},Symbol.toStringTag,{value:"Module"}));function Ks(e){const[t,a]=S(),r=()=>t.get("tab")||e,[n,l]=s.useState(r()),i=s.useRef(r());s.useEffect(()=>{i.current=n},[n]),s.useEffect(()=>{const e=t.get("tab");e&&e!==i.current&&(l(e),i.current=e)},[t]);const c=s.useCallback(e=>{const s=e;l(s);const r=new URLSearchParams(t);r.set("tab",s),a(r,{replace:!0})},[t,a]);return[n,c]}class Ws extends Error{code;status;context;constructor(e,s,t,a){super(e),this.name="PipLineError",this.code=s,this.status=t,this.context=a}}class Ys{static instance;errorLog=[];maxLogSize=100;constructor(){}static getInstance(){return Ys.instance||(Ys.instance=new Ys),Ys.instance}handleApiError(e,s){let t="An unexpected error occurred",a="UNKNOWN_ERROR",r=500;if(e instanceof Ws)return e;if(e.response){const s=e.response.data||{};t=s.message||s.error||"API request failed",a=s.code||`HTTP_${e.response.status}`,r=e.response.status}else e.request?(t="Network error - please check your connection",a="NETWORK_ERROR",r=0):e.message&&(t=e.message,a="GENERIC_ERROR");const n=new Ws(t,a,r,{originalError:e,context:s,timestamp:(new Date).toISOString()});return this.logError(n),n}handleComponentError(e,s,t){const a=new Ws(e.message,"COMPONENT_ERROR",0,{componentName:t,errorInfo:s,stack:e.stack,timestamp:(new Date).toISOString()});this.logError(a)}handleValidationError(e,s){const t=new Ws(e,"VALIDATION_ERROR",400,{field:s,timestamp:(new Date).toISOString()});return this.logError(t),t}handleAuthError(e="Authentication required"){const s=new Ws(e,"AUTH_ERROR",401,{timestamp:(new Date).toISOString()});return this.logError(s),s}handlePermissionError(e="Insufficient permissions"){const s=new Ws(e,"PERMISSION_ERROR",403,{timestamp:(new Date).toISOString()});return this.logError(s),s}logError(e){const s={message:e.message,code:e.code,status:e.status,timestamp:(new Date).toISOString(),context:e.context};this.errorLog.unshift(s),this.errorLog.length>this.maxLogSize&&(this.errorLog=this.errorLog.slice(0,this.maxLogSize))}getErrorLog(){return[...this.errorLog]}clearErrorLog(){this.errorLog=[]}getUserFriendlyMessage(e){const s={NETWORK_ERROR:"Unable to connect to the server. Please check your internet connection and try again.",HTTP_401:"Your session has expired. Please log in again.",HTTP_403:"You do not have permission to perform this action.",HTTP_404:"The requested resource was not found.",HTTP_500:"A server error occurred. Please try again later.",HTTP_502:"The server is temporarily unavailable. Please try again in a few moments.",HTTP_503:"The service is temporarily unavailable. Please try again later.",HTTP_504:"The request took too long. Please try again.",VALIDATION_ERROR:"Please check your input and try again.",AUTH_ERROR:"Authentication failed. Please log in again.",PERMISSION_ERROR:"You do not have permission to perform this action.",TIMEOUT_ERROR:"The request took too long. Please try again.",COMPONENT_ERROR:"Something went wrong. Please refresh the page.",UNKNOWN_ERROR:"An unexpected error occurred. Please try again."},t=e.message||"";if(t.includes("Failed to fetch")||t.includes("NetworkError")||t.includes("network"))return"Connection problem. Please check your internet connection and try again.";if(t.includes("timeout")||t.includes("Timeout"))return"The request took too long. Please try again.";if(t.includes("validation")||t.includes("invalid")||t.includes("required"))return t.length<100&&!t.includes("Error")&&!t.includes("Exception")?t:"Please check your input and try again.";if(t.includes("database")||t.includes("SQL")||t.includes("constraint"))return"A data error occurred. Please check your input or contact support if the problem persists.";if(e.code&&s[e.code])return s[e.code];if(e.status){const t=s[`HTTP_${e.status}`];if(t)return t}return!/(error|exception|failed|undefined|null|NaN|stack|trace)/i.test(t)&&t.length<200&&t.trim().length>0?t:"An unexpected error occurred. Please try again or contact support if the problem persists."}isRetryable(e){return"NETWORK_ERROR"===e.code||e.status&&e.status>=500||0===e.status}getRetryDelay(e){return Math.min(1e3*Math.pow(2,e),1e4)}}const Vs=Ys.getInstance(),Js=({isOpen:t,onClose:a,onRateSelect:r,currentAmount:n,transactionDate:l})=>{const[i,c]=s.useState(null),[o,d]=s.useState(""),[m,x]=s.useState(!1),[h,u]=s.useState(null),[p,y]=s.useState("");s.useEffect(()=>{t&&(async()=>{try{x(!0),u(null);const e=await Pe.get("/exchange-rates/current"),s=await Pe.parseResponse(e);if(e.ok&&s.success&&s.rate){const e={rate:s.rate.rate,timestamp:s.rate.created_at,source:s.rate.source,change_24h:s.rate.change_24h,volume:s.rate.volume};c(e),d(s.rate.rate.toFixed(4)),y(new Date(s.rate.created_at).toLocaleString())}else u(`Failed to fetch current exchange rate: ${s.message||"Unknown error"}`)}catch(e){u(`Unable to fetch current exchange rate: ${e instanceof Error?e.message:"Network error"}`)}finally{x(!1)}})()},[t]);const j=e=>(n*e).toFixed(2);return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl border border-gray-200 max-w-md w-full max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 bg-gradient-to-r from-slate-50 via-white to-indigo-50 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center mr-3",children:e.jsx(C,{className:"h-4 w-4 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Currency Conversion"}),e.jsx("p",{className:"text-sm text-gray-600",children:"USD to TRY Exchange Rate"})]})]}),e.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-all duration-200",children:e.jsx(D,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:e.jsxs("div",{className:"p-6 space-y-6",children:[h&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-red-700",children:h})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Transaction Details"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Amount (USD):"}),e.jsxs("span",{className:"font-medium text-gray-900",children:["$",n.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Date:"}),e.jsx("span",{className:"font-medium text-gray-900",children:l})]})]})]}),m?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Fetching current rate..."})]}):i?e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Current Market Rate"}),e.jsxs("div",{className:"flex items-center text-xs text-gray-700",children:[e.jsx(g,{className:"h-3 w-3 mr-1"}),"Updated: ",p]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["1 USD = â‚º",i.rate.toFixed(4)]}),(s=>{if(!s)return null;const t=s>0;return e.jsxs("div",{className:"flex items-center text-sm "+(t?"text-green-600":"text-red-600"),children:[e.jsx(T,{className:"h-3 w-3 mr-1 "+(t?"":"rotate-180")}),t?"+":"",s.toFixed(4)," (24h)"]})})(i.change_24h)]}),e.jsxs("div",{className:"text-sm text-gray-700",children:[e.jsxs("span",{className:"font-medium",children:["$",n.toFixed(2)," USD"]}),e.jsx("span",{className:"mx-2",children:"â†’"}),e.jsxs("span",{className:"font-bold",children:["â‚º",j(i.rate)]})]})]}),e.jsxs("button",{onClick:()=>{i&&(r(i.rate),a())},className:"w-full mt-4 bg-gray-600 text-white py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors duration-200 flex items-center justify-center",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Use Current Rate"]})]}):null,e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Custom Exchange Rate"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Manual Rate (1 USD = ? TRY)"}),e.jsx("input",{type:"number",step:"0.0001",min:"0",value:o,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-gray-500",placeholder:"Enter exchange rate..."})]}),o&&parseFloat(o)>0&&e.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:e.jsxs("div",{className:"text-sm text-gray-700",children:[e.jsxs("span",{className:"font-medium",children:["$",n.toFixed(2)," USD"]}),e.jsx("span",{className:"mx-2",children:"â†’"}),e.jsxs("span",{className:"font-bold text-gray-900",children:["â‚º",j(parseFloat(o))]})]})}),e.jsxs("button",{onClick:()=>{const e=parseFloat(o);e>0&&(r(e),a())},disabled:!o||parseFloat(o)<=0,className:"w-full bg-gray-600 text-white py-2 px-4 rounded-lg hover:bg-gray-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors duration-200 flex items-center justify-center",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Apply Custom Rate"]})]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-yellow-800",children:["ðŸ’¡ ",e.jsx("strong",{children:"Tip:"})," For historical transactions, you may want to use the exchange rate that was applicable on the transaction date rather than the current rate."]})})]})}),e.jsx("div",{className:"border-t border-gray-200 px-6 py-4 bg-gray-50 flex-shrink-0",children:e.jsx("div",{className:"flex justify-end space-x-3",children:e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors duration-200",children:"Cancel"})})})]})}):null},Gs=({transaction:t,onSave:a,onCancel:r,dropdownOptions:n={categories:[],psps:[],payment_methods:[],companies:[],currencies:[]}})=>{const[l,i]=s.useState({client_name:t.client_name||"",company:t.company||t.company_order||"",iban:t.iban||"",payment_method:t.payment_method||"",category:t.category||"",amount:t.amount?.toString()||"",currency:t.currency||"TL",psp:t.psp||"",notes:t.notes||"",date:t.date?t.date.split("T")[0]:(new Date).toISOString().split("T")[0]}),[c,o]=s.useState(!1),[d,m]=s.useState(""),[x,h]=s.useState(""),[g,u]=s.useState(!1),[p,y]=s.useState("");s.useEffect(()=>{i({client_name:t.client_name||"",company:t.company||t.company_order||"",iban:t.iban||"",payment_method:t.payment_method||"",category:t.category||"",amount:t.amount?.toString()||"",currency:t.currency||"TL",psp:t.psp||"",notes:t.notes||"",date:t.date?t.date.split("T")[0]:(new Date).toISOString().split("T")[0]})},[t]);const j={payment_methods:[...new Set([...n.payment_methods||[],...t.payment_method?[t.payment_method]:[]])],categories:[...new Set([...n.categories||[],...t.category?[t.category]:[]])],psps:[...new Set([...n.psps||[],...t.psp?[t.psp]:[]])],companies:[...new Set([...n.companies||[],...t.company?[t.company]:[],...t.company_order?[t.company_order]:[]])]},[f,b]=s.useState(!1),[N,v]=s.useState(null),[w,_]=s.useState(!1),[S,T]=s.useState(!1),[R,P]=s.useState(t.exchange_rate?.toString()||""),[F,L]=s.useState(t.exchange_rate?.toString()||""),[U,$]=s.useState(null),[z,O]=s.useState(!1);s.useEffect(()=>{"EUR"!==l.currency&&"USD"!==l.currency||!l.date?_(!1):_(!0)},[l.currency,l.date]);const M=(e,s)=>{i(t=>({...t,[e]:s})),v(null),"amount"!==e&&"currency"!==e||($(null),O(!1)),"currency"===e&&"USD"===s&&T(!0)};return e.jsxs("div",{className:"max-h-[80vh] overflow-y-auto overflow-x-hidden pr-2 edit-form-scroll",children:[e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),l.client_name.trim()?!l.amount||0===parseFloat(l.amount)||isNaN(parseFloat(l.amount))?(v("Amount cannot be zero."),0):"EUR"!==l.currency||R?"USD"!==l.currency||F||(v("Please enter the USD exchange rate."),0):(v("Please enter the EUR exchange rate."),0):(v("Client name is required."),0)){b(!0),v(null);try{const e={...l,company_order:l.company,amount:parseFloat(l.amount),eur_rate:"EUR"===l.currency?parseFloat(R):void 0,usd_rate:"USD"===l.currency?parseFloat(F):void 0,...g&&x&&parseFloat(x)>0&&{manual_commission_rate:parseFloat(x),use_manual_commission:!0}},s=await Pe.put(`/transactions/${t.id}`,e);if(s.ok&&s.data){const e=s.data;e.transaction?a(e.transaction):"success"===e.status?e.id?a(e):v("Transaction update succeeded but data format is unexpected."):v(e.message||e.error||"Failed to update transaction.")}else{const e=s.data||{};v(e.message||e.error||`Failed to update transaction. Status: ${s.status}`)}}catch(s){v(s?.message||s?.data?.message||s?.data?.error||"An error occurred while updating the transaction.")}finally{b(!1)}}},className:"space-y-6",noValidate:!0,children:[N&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(A,{className:"h-5 w-5 text-red-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:N})]})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-4",children:"Client Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Client Name *"}),e.jsx("input",{type:"text",value:l.client_name,onChange:e=>M("client_name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company"}),e.jsxs("select",{value:l.company,onChange:e=>M("company",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",children:[e.jsx("option",{value:"",children:"Select Company"}),j?.companies?.map(s=>e.jsx("option",{value:s,children:s},s))||[]]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"IBAN"}),e.jsx("input",{type:"text",value:l.iban,onChange:e=>M("iban",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",placeholder:"Enter IBAN"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Method"}),e.jsxs("select",{value:l.payment_method,onChange:e=>M("payment_method",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",children:[e.jsx("option",{value:"",children:"Select Payment Method"}),j?.payment_methods?.map(s=>e.jsx("option",{value:s,children:s},s))||[]]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-4",children:"Transaction Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category *"}),e.jsxs("select",{value:l.category,onChange:e=>M("category",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",required:!0,children:[e.jsx("option",{value:"",children:"Select Category"}),j?.categories?.map(s=>e.jsx("option",{value:s,children:s},s))||[]]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"PSP"}),e.jsxs("select",{value:l.psp,onChange:e=>M("psp",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",children:[e.jsx("option",{value:"",children:"Select PSP"}),j?.psps?.map(s=>e.jsx("option",{value:s,children:s},s))||[]]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount *"}),e.jsx("input",{type:"number",step:"0.01",value:l.amount,onChange:e=>M("amount",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Currency"}),e.jsxs("select",{value:l.currency,onChange:e=>M("currency",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",children:[e.jsx("option",{value:"TL",children:"TL"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"EUR",children:"EUR"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transaction Date"}),e.jsx("input",{type:"date",value:l.date,onChange:e=>M("date",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500"})]})]})]}),w&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-4",children:"Exchange Rate"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:["EUR"===l.currency&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"EUR Rate (1 EUR = ? TL)"}),e.jsx("input",{type:"number",step:"0.0001",min:"0",value:R,onChange:e=>{P(e.target.value),$(null),O(!1)},className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",required:!0})]}),"USD"===l.currency&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"USD Rate (1 USD = ? TL)"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[e.jsx("input",{type:"number",step:"0.0001",min:"0",value:F,onChange:e=>{L(e.target.value),$(null),O(!1)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500 min-w-0",required:!0}),e.jsxs("button",{type:"button",onClick:()=>T(!0),className:"px-4 py-2 bg-gray-100 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200 flex items-center justify-center space-x-2 whitespace-nowrap",children:[e.jsx(C,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Get Rate"})]})]}),F&&e.jsxs("p",{className:"text-xs text-gray-600 mt-1 break-words",children:["$",l.amount||0," USD = â‚º",((parseFloat(l.amount)||0)*(parseFloat(F)||0)).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{const e=parseFloat(l.amount)||0;let s=0;if("USD"===l.currency?s=parseFloat(F)||0:"EUR"===l.currency&&(s=parseFloat(R)||0),s>0&&e>0){const t=e*s,a=0;$({amount_try:t,commission_try:a,net_amount_try:t-a}),O(!0),v(null)}else v("Please enter valid amount and exchange rate.")},disabled:!l.amount||"USD"===l.currency&&!F||"EUR"===l.currency&&!R,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2 whitespace-nowrap",children:e.jsx("span",{children:"Apply Exchange Rate"})}),z&&e.jsx("span",{className:"text-sm text-green-600 font-medium text-center sm:text-right",children:"âœ“ Rate applied successfully"})]}),U&&e.jsxs("div",{className:"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg overflow-hidden",children:[e.jsx("h5",{className:"text-sm font-medium text-green-800 mb-3",children:"Converted Amounts (Turkish Lira)"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1 sm:gap-2",children:[e.jsx("span",{className:"text-green-700 text-sm",children:"Amount:"}),e.jsxs("span",{className:"font-medium text-green-900 text-sm break-all",children:["â‚º",U.amount_try.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1 sm:gap-2",children:[e.jsx("span",{className:"text-green-700 text-sm",children:"Commission:"}),e.jsxs("span",{className:"font-medium text-green-900 text-sm break-all",children:["â‚º",U.commission_try.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1 sm:gap-2",children:[e.jsx("span",{className:"text-green-700 text-sm",children:"Net Amount:"}),e.jsxs("span",{className:"font-medium text-green-900 text-sm break-all",children:["â‚º",U.net_amount_try.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),e.jsx("div",{className:"mt-3 pt-2 border-t border-green-200",children:e.jsxs("div",{className:"text-xs text-green-600 break-words",children:["Exchange Rate: 1 ",l.currency," = â‚º","USD"===l.currency?F:R]})})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Manual Commission"}),g&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-green-700 bg-green-100 rounded-full",children:[e.jsx(k,{className:"h-3 w-3"}),"Active"]})]}),g?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",step:"0.01",value:x,onChange:e=>h(e.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Commission %"}),e.jsx("button",{type:"button",onClick:()=>{u(!1),o(!1),m(""),h(""),y("")},className:"px-3 py-2 text-sm font-medium text-gray-600 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:"Disable"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Overrides automatic PSP commission rate"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"password",value:d,onChange:e=>m(e.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Security code"}),e.jsx("button",{type:"button",onClick:()=>{"4561"===d?(u(!0),y(""),o(!0)):(y("Invalid security code. Please try again."),u(!1))},className:"px-3 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:ring-1 focus:ring-blue-500",children:"Enable"})]}),p&&e.jsx("p",{className:"text-xs text-red-600",children:p})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-4",children:"Additional Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx("textarea",{value:l.notes,onChange:e=>M("notes",e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",placeholder:"Enter transaction notes..."})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[e.jsxs("button",{type:"button",onClick:r,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:[e.jsx(D,{className:"h-4 w-4 mr-2 inline"}),"Cancel"]}),e.jsx("button",{type:"submit",disabled:f,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 disabled:opacity-50 disabled:cursor-not-allowed",children:f?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"h-4 w-4 mr-2 inline"}),"Save Changes"]})})]})]}),e.jsx(Js,{isOpen:S,onClose:()=>T(!1),onRateSelect:e=>{L(e.toString()),T(!1),$(null),O(!1)},currentAmount:parseFloat(l.amount)||0,transactionDate:l.date})]})};function Xs({filters:s,dropdownOptions:t,expandedFilterSections:a,displayLimit:n,transactionsLength:l,exporting:i,onFilterChange:c,onToggleFilterSection:o,onClearAllFilters:d,onApplyFilters:m,onExportDisplayed:x,onExportAll:h,onApplyQuickFilter:g}){const{t:u}=Ve(),p=Object.values(s).filter(e=>e&&"created_at"!==e&&"desc"!==e&&"all"!==e).length;return e.jsxs(Ee,{variant:"outlined",className:"overflow-hidden border-slate-300 bg-white",children:[e.jsx(ls,{className:"bg-white border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-slate-100 rounded-lg",children:e.jsx(R,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx(is,{className:"text-lg font-semibold text-slate-900",children:"Transaction Filters"}),e.jsxs(cs,{className:"text-slate-600",children:["Filter and search transactions",p>0&&e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-slate-900 text-white text-xs font-medium rounded",children:p})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[p>0&&e.jsx(Re,{variant:"outline",size:"sm",onClick:d,icon:e.jsx(D,{className:"h-4 w-4"}),className:"text-slate-700 hover:bg-slate-100 border-slate-300",children:"Clear All"}),e.jsx(Re,{variant:"ghost",size:"sm",onClick:()=>{},icon:e.jsx(D,{className:"h-4 w-4"}),className:"text-slate-600 hover:bg-slate-100",children:"Close"})]})]})}),e.jsx(os,{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Quick Filters"})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(Re,{variant:"outline",size:"sm",onClick:()=>g("today"),className:"bg-white hover:bg-slate-100 border-slate-300 text-slate-700",children:"Today"}),e.jsx(Re,{variant:"outline",size:"sm",onClick:()=>g("thisWeek"),className:"bg-white hover:bg-slate-100 border-slate-300 text-slate-700",children:"This Week"}),e.jsx(Re,{variant:"outline",size:"sm",onClick:()=>g("deposits"),className:"bg-white hover:bg-slate-100 border-slate-300 text-slate-700",children:"Deposits"}),e.jsx(Re,{variant:"outline",size:"sm",onClick:()=>g("withdrawals"),className:"bg-white hover:bg-slate-100 border-slate-300 text-slate-700",children:"Withdrawals"}),e.jsx(Re,{variant:"outline",size:"sm",onClick:()=>g("highValue"),className:"bg-white hover:bg-slate-100 border-slate-300 text-slate-700",children:"High Value (â‚º10K+)"})]})]}),e.jsxs("div",{className:"border border-slate-200 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"flex items-center justify-between cursor-pointer bg-slate-50 p-3 hover:bg-slate-100 transition-colors",onClick:()=>o("basic"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"transition-transform duration-200 "+(a.basic?"rotate-180":""),children:e.jsx(P,{className:"h-4 w-4 text-slate-600"})}),e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Basic Filters"}),(s.search||s.category&&"all"!==s.category||s.status&&"all"!==s.status)&&e.jsx(Fe,{variant:"secondary",size:"sm",className:"bg-slate-900 text-white",children:(s.search?1:0)+(s.category&&"all"!==s.category?1:0)+(s.status&&"all"!==s.status?1:0)})]})}),a.basic&&e.jsx("div",{className:"p-4 bg-white border-t border-slate-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(ds,{label:"Search",children:e.jsx(rs,{placeholder:"Search transactions...",variant:"default",size:"default",value:s.search,onChange:e=>c("search",e.target.value)})}),e.jsx(ds,{label:"Category",children:e.jsxs(Ge,{value:s.category,onValueChange:e=>c("category",e),children:[e.jsx(Xe,{variant:"default",size:"default",children:e.jsx(Qe,{placeholder:"All Categories"})}),e.jsxs(Ze,{children:[e.jsx(es,{value:"all",children:"All Categories"}),e.jsx(es,{value:"DEP",children:"Deposit (DEP)"}),e.jsx(es,{value:"WD",children:"Withdrawal (WD)"})]})]})}),e.jsx(ds,{label:"Status",children:e.jsxs(Ge,{value:s.status,onValueChange:e=>c("status",e),children:[e.jsx(Xe,{variant:"default",size:"default",children:e.jsx(Qe,{placeholder:"All Status"})}),e.jsxs(Ze,{children:[e.jsx(es,{value:"all",children:"All Status"}),e.jsx(es,{value:"completed",children:"Completed"}),e.jsx(es,{value:"pending",children:"Pending"}),e.jsx(es,{value:"failed",children:"Failed"})]})]})})]})})]}),e.jsxs("div",{className:"border border-slate-200 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"flex items-center justify-between cursor-pointer bg-slate-50 p-3 hover:bg-slate-100 transition-colors",onClick:()=>o("advanced"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"transition-transform duration-200 "+(a.advanced?"rotate-180":""),children:e.jsx(P,{className:"h-4 w-4 text-slate-600"})}),e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Advanced Filters"}),(s.psp&&"all"!==s.psp||s.company&&"all"!==s.company||s.payment_method&&"all"!==s.payment_method||s.currency&&"all"!==s.currency)&&e.jsx(Fe,{variant:"secondary",size:"sm",className:"bg-slate-900 text-white",children:(s.psp&&"all"!==s.psp?1:0)+(s.company&&"all"!==s.company?1:0)+(s.payment_method&&"all"!==s.payment_method?1:0)+(s.currency&&"all"!==s.currency?1:0)})]})}),a.advanced&&e.jsx("div",{className:"p-4 bg-white border-t border-slate-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(ds,{label:"PSP",children:e.jsxs(Ge,{value:s.psp,onValueChange:e=>c("psp",e),children:[e.jsx(Xe,{variant:"default",size:"default",children:e.jsx(Qe,{placeholder:"All PSPs"})}),e.jsxs(Ze,{children:[e.jsx(es,{value:"all",children:"All PSPs"}),t.psps.map(s=>e.jsx(es,{value:s,children:s},s))]})]})}),e.jsx(ds,{label:"Company",children:e.jsxs(Ge,{value:s.company,onValueChange:e=>c("company",e),children:[e.jsx(Xe,{variant:"default",size:"default",children:e.jsx(Qe,{placeholder:"All Companies"})}),e.jsxs(Ze,{children:[e.jsx(es,{value:"all",children:"All Companies"}),t.companies.map(s=>e.jsx(es,{value:s,children:s},s))]})]})}),e.jsx(ds,{label:"Payment Method",children:e.jsxs(Ge,{value:s.payment_method,onValueChange:e=>c("payment_method",e),children:[e.jsx(Xe,{variant:"default",size:"default",children:e.jsx(Qe,{placeholder:"All Methods"})}),e.jsxs(Ze,{children:[e.jsx(es,{value:"all",children:"All Methods"}),t.payment_methods.map(s=>e.jsx(es,{value:s,children:s},s))]})]})}),e.jsx(ds,{label:"Currency",children:e.jsxs(Ge,{value:s.currency,onValueChange:e=>c("currency",e),children:[e.jsx(Xe,{variant:"default",size:"default",children:e.jsx(Qe,{placeholder:"All Currencies"})}),e.jsxs(Ze,{children:[e.jsx(es,{value:"all",children:"All Currencies"}),t.currencies.map(s=>e.jsx(es,{value:s,children:s},s))]})]})})]})})]}),e.jsxs("div",{className:"border border-slate-200 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"flex items-center justify-between cursor-pointer bg-slate-50 p-3 hover:bg-slate-100 transition-colors",onClick:()=>o("amounts"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"transition-transform duration-200 "+(a.amounts?"rotate-180":""),children:e.jsx(P,{className:"h-4 w-4 text-slate-600"})}),e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Amount Filters"}),(s.amount_min||s.amount_max||s.commission_min||s.commission_max)&&e.jsx(Fe,{variant:"secondary",size:"sm",className:"bg-slate-900 text-white",children:(s.amount_min?1:0)+(s.amount_max?1:0)+(s.commission_min?1:0)+(s.commission_max?1:0)})]})}),a.amounts&&e.jsx("div",{className:"p-4 bg-white border-t border-slate-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:u("clients.min_amount")}),e.jsx(rs,{type:"number",placeholder:"0.00",value:s.amount_min,onChange:e=>c("amount_min",e.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:u("clients.max_amount")}),e.jsx(rs,{type:"number",placeholder:"1000000.00",value:s.amount_max,onChange:e=>c("amount_max",e.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:u("clients.min_commission")}),e.jsx(rs,{type:"number",placeholder:"0.00",value:s.commission_min,onChange:e=>c("commission_min",e.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:u("clients.max_commission")}),e.jsx(rs,{type:"number",placeholder:"10000.00",value:s.commission_max,onChange:e=>c("commission_max",e.target.value)})]})]})})]}),e.jsxs("div",{className:"border border-slate-200 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"flex items-center justify-between cursor-pointer bg-slate-50 p-3 hover:bg-slate-100 transition-colors",onClick:()=>o("dates"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"transition-transform duration-200 "+(a.dates?"rotate-180":""),children:e.jsx(P,{className:"h-4 w-4 text-slate-600"})}),e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Date & Sorting"}),(s.date_from||s.date_to||"date"!==s.sort_by||"desc"!==s.sort_order)&&e.jsx(Fe,{variant:"secondary",size:"sm",className:"bg-slate-900 text-white",children:(s.date_from?1:0)+(s.date_to?1:0)+("date"!==s.sort_by?1:0)+("desc"!==s.sort_order?1:0)})]})}),a.dates&&e.jsx("div",{className:"p-4 bg-white border-t border-slate-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(ds,{label:"From Date",children:e.jsx(rs,{type:"date",variant:"default",size:"default",value:s.date_from,onChange:e=>c("date_from",e.target.value)})}),e.jsx(ds,{label:"To Date",children:e.jsx(rs,{type:"date",variant:"default",size:"default",value:s.date_to,onChange:e=>c("date_to",e.target.value)})}),e.jsx(ds,{label:"Sort By",children:e.jsxs(Ge,{value:s.sort_by,onValueChange:e=>c("sort_by",e),children:[e.jsx(Xe,{variant:"default",size:"default",children:e.jsx(Qe,{placeholder:"Sort By"})}),e.jsxs(Ze,{children:[e.jsx(es,{value:"created_at",children:"Date Created"}),e.jsx(es,{value:"amount",children:"Amount"}),e.jsx(es,{value:"commission",children:"Commission"}),e.jsx(es,{value:"client_name",children:"Client Name"}),e.jsx(es,{value:"psp",children:"PSP"})]})]})}),e.jsx(ds,{label:"Sort Order",children:e.jsxs(Ge,{value:s.sort_order,onValueChange:e=>c("sort_order",e),children:[e.jsx(Xe,{variant:"default",size:"default",children:e.jsx(Qe,{placeholder:"Sort Order"})}),e.jsxs(Ze,{children:[e.jsx(es,{value:"desc",children:"Descending"}),e.jsx(es,{value:"asc",children:"Ascending"})]})]})})]})})]}),p>0&&e.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Active Filters"}),e.jsx(Fe,{variant:"secondary",size:"sm",className:"bg-slate-900 text-white",children:p})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.search&&e.jsxs(Fe,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:['Search: "',s.search,'"']}),s.category&&"all"!==s.category&&e.jsxs(Fe,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:["Category: ",s.category]}),s.psp&&"all"!==s.psp&&e.jsxs(Fe,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:["PSP: ",s.psp]}),s.company&&"all"!==s.company&&e.jsxs(Fe,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:["Company: ",s.company]}),s.payment_method&&"all"!==s.payment_method&&e.jsxs(Fe,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:["Method: ",s.payment_method]}),s.currency&&"all"!==s.currency&&e.jsxs(Fe,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:["Currency: ",s.currency]}),s.status&&"all"!==s.status&&e.jsxs(Fe,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:["Status: ",s.status]}),s.date_from&&e.jsxs(Fe,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:["From: ",s.date_from]}),s.date_to&&e.jsxs(Fe,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:["To: ",s.date_to]}),s.amount_min&&e.jsxs(Fe,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:["Min: â‚º",s.amount_min]}),s.amount_max&&e.jsxs(Fe,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:["Max: â‚º",s.amount_max]})]})]}),e.jsx("div",{className:"border-t border-slate-200 pt-4 mt-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-slate-600",children:p>0?e.jsxs("span",{children:[p," filter",1!==p?"s":""," applied Â· Showing ",Math.min(n,l)," of ",l," transactions"]}):e.jsxs("span",{children:["No filters applied Â· Showing ",Math.min(n,l)," transactions"]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Re,{variant:"outline",size:"sm",onClick:x,disabled:0===l,icon:e.jsx(F,{className:"h-4 w-4"}),iconPosition:"left",children:["Export Displayed (",Math.min(n,l),")"]}),e.jsx(Re,{variant:"outline",size:"sm",onClick:h,disabled:i,icon:i?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-slate-600"}):e.jsx(F,{className:"h-4 w-4"}),iconPosition:"left",children:i?"Exporting...":"Export All"}),e.jsx(Re,{variant:"outline",size:"sm",onClick:d,disabled:0===p,icon:e.jsx(D,{className:"h-4 w-4"}),children:"Clear All"}),e.jsx(Re,{variant:"primary",size:"sm",onClick:m,icon:e.jsx(r,{className:"h-4 w-4"}),iconPosition:"left",children:"Apply Filters"})]})]})})]})})]})}function Qs({transaction:s,onView:t,onEdit:a,onDelete:r,normalizePaymentMethodName:n=e=>e,onRowClick:l}){const i=o();return e.jsxs("tr",{className:"hover:scale-[1.02] transition-all duration-300 ease-in-out cursor-pointer "+("WD"===s.category?"bg-gray-100 hover:bg-gray-200":"bg-white hover:bg-gray-50"),onClick:e=>{const t=e.target;if(t.closest("button"))return;const a=t.closest("td");if(a){const e=a.closest("tr");if(e){const s=e.querySelectorAll("td"),t=s[s.length-1];if(t&&(t===a||t.contains(a)))return}}l?l(s):s.client_name&&i(`/clients/${encodeURIComponent(s.client_name)}`)},children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center mr-3 "+("WD"===s.category?"bg-gray-300":"bg-gray-100"),children:e.jsx(y,{className:"h-4 w-4 "+("WD"===s.category?"text-gray-700":"text-gray-600")})}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.client_name||"Unknown"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 border-b border-gray-100",children:s.company||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 border-b border-gray-100",children:n(s.payment_method||"N/A")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 border-b border-gray-100",children:s.category||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900 text-right border-b border-gray-100",children:Le(s.amount||0,s.currency)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900 text-right border-b border-gray-100",children:Le(s.commission||0,s.currency)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-600 text-right border-b border-gray-100",children:Le(s.net_amount||0,s.currency)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 border-b border-gray-100",children:s.currency||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 border-b border-gray-100",children:s.psp||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center border-b border-gray-100","data-action-cell":"true",onClick:e=>e.stopPropagation(),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(ms,{onClick:e=>{e.stopPropagation(),t(s)},variant:"ghost",size:"icon-sm",className:"text-gray-600 hover:text-gray-900",title:"View Details",children:e.jsx(f,{className:"h-3 w-3"})}),e.jsx(ms,{onClick:e=>{e.stopPropagation(),a(s)},variant:"ghost",size:"icon-sm",className:"text-green-600 hover:text-green-900",title:"Edit Transaction",children:e.jsx(L,{className:"h-3 w-3"})}),e.jsx(ms,{onClick:e=>{e.stopPropagation(),r(s)},variant:"ghost",size:"icon-sm",className:"text-red-600 hover:text-red-900",title:"Delete Transaction",children:e.jsx(U,{className:"h-3 w-3"})})]})})]},s.id)}const Zs={gray:{text:"text-gray-600",bg:"bg-gray-50",iconBg:"bg-gray-100"},green:{text:"text-green-600",bg:"bg-green-50",iconBg:"bg-green-100"},purple:{text:"text-purple-600",bg:"bg-purple-50",iconBg:"bg-purple-100"},orange:{text:"text-orange-600",bg:"bg-orange-50",iconBg:"bg-orange-100"},red:{text:"text-red-600",bg:"bg-red-50",iconBg:"bg-red-100"},teal:{text:"text-teal-600",bg:"bg-teal-50",iconBg:"bg-teal-100"},indigo:{text:"text-indigo-600",bg:"bg-indigo-50",iconBg:"bg-indigo-100"},pink:{text:"text-pink-600",bg:"bg-pink-50",iconBg:"bg-pink-100"}},et=({title:t,value:a,icon:r,color:n,subtitle:l,className:i="",animated:c=!1,animationDuration:o=400,showGlass:d=!1})=>{const m=Zs[n],x="string"==typeof a?parseFloat(a.replace(/[^\d.-]/g,""))||0:a,h=((e,t={})=>{const{duration:a=400,easing:r="easeOut",decimals:n=0,prefix:l="",suffix:i="",separator:c=","}=t,[o,d]=s.useState(0),[m,x]=s.useState(!1),h=s.useRef(),g=s.useRef(),u=s.useRef(0),p={linear:e=>e,easeOut:e=>1-Math.pow(1-e,5),easeIn:e=>Math.pow(e,3),easeInOut:e=>e<.5?4*Math.pow(e,3):1-Math.pow(-2*e+2,3)/2},y=s=>{g.current||(g.current=s);const t=s-g.current,n=Math.min(t/a,1),l=p[r](n),i=u.current+(e-u.current)*l,c=Math.abs(i)>1e3?Math.round(i):i;d(c),n<1?h.current=requestAnimationFrame(y):(d(e),x(!1),h.current=void 0,g.current=void 0)};return s.useEffect(()=>{if(h.current&&cancelAnimationFrame(h.current),e!==o&&0!==e)return x(!0),u.current=o,g.current=void 0,h.current=requestAnimationFrame(y),()=>{h.current&&cancelAnimationFrame(h.current)};d(e)},[e]),s.useEffect(()=>()=>{h.current&&cancelAnimationFrame(h.current)},[]),{displayValue:(e=>{const s=e.toFixed(n).split(".");s[0]=s[0].replace(/\B(?=(\d{3})+(?!\d))/g,c);const t=s.join(".");return`${l}${t}${i}`})(o),rawValue:o,isAnimating:m,targetValue:e}})(x,{duration:o,easing:"easeOut",decimals:0,prefix:"string"==typeof a&&a.includes("â‚º")?"â‚º":"",suffix:"string"==typeof a&&a.includes("%")?"%":""}),g=c&&!isNaN(x)?h.displayValue:a,u=d?"glass-card card-hover-subtle":"";return e.jsxs(Ee,{variant:"elevated",className:`relative overflow-hidden shadow-premium ${u} ${i}`,children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 ${m.bg} rounded-full -translate-y-16 translate-x-16`}),e.jsxs(os,{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:`w-12 h-12 ${m.bg} rounded-xl flex items-center justify-center shadow-lg`,children:e.jsx(r,{className:`h-6 w-6 ${m.text}`})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:t}),e.jsx("p",{className:"text-lg font-bold text-gray-900 transition-all duration-75 ease-out",style:{fontVariantNumeric:"tabular-nums",willChange:c?"contents":"auto"},children:g}),l&&e.jsx("p",{className:"text-xs text-gray-500",children:l})]})]})]})},st=({className:s="",width:t,height:a,rounded:r="md",animate:n="shimmer",delay:l=0})=>e.jsx("div",{className:`bg-gray-200 ${{none:"",sm:"rounded-sm",md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl","2xl":"rounded-2xl",full:"rounded-full"}[r]} ${{pulse:"animate-pulse",wave:"animate-pulse",shimmer:"skeleton-shimmer"}[n]} ${s}`,style:{width:t,height:a,animationDelay:`${l}ms`}}),tt=({variant:s="default",delay:t=0})=>{const a=t;return"compact"===s?e.jsx("div",{className:"bg-white rounded-md border border-gray-200 p-2.5 animate-pulse",style:{animationDelay:`${a}ms`},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(st,{className:"w-6 h-6",rounded:"md",delay:a+100}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(st,{className:"h-3 w-20 mb-1",delay:a+200}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(st,{className:"h-4 w-16",delay:a+300}),e.jsx(st,{className:"h-3 w-8",delay:a+400})]})]})]})}):"minimal"===s?e.jsx("div",{className:"bg-white rounded-md border border-gray-200 p-3 animate-pulse",style:{animationDelay:`${a}ms`},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(st,{className:"w-6 h-6",rounded:"md",delay:a+100}),e.jsxs("div",{children:[e.jsx(st,{className:"h-3 w-20 mb-1",delay:a+200}),e.jsx(st,{className:"h-4 w-24",delay:a+300})]})]}),e.jsx(st,{className:"h-3 w-12",delay:a+400})]})}):"gradient"===s?e.jsxs("div",{className:"bg-gradient-to-br from-gray-100 to-gray-200 rounded-lg shadow-sm p-4 animate-pulse",style:{animationDelay:`${a}ms`},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(st,{className:"w-8 h-8 bg-white/20",rounded:"lg",delay:a+100}),e.jsx(st,{className:"h-4 w-16 bg-white/20",rounded:"full",delay:a+200})]}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(st,{className:"h-3 w-24 bg-white/20",delay:a+300}),e.jsx(st,{className:"h-5 w-32 bg-white/20",delay:a+400}),e.jsx(st,{className:"h-3 w-20 bg-white/20",delay:a+500})]})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 animate-pulse",style:{animationDelay:`${a}ms`},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(st,{className:"w-8 h-8",rounded:"lg",delay:a+100}),e.jsx(st,{className:"h-4 w-16",rounded:"full",delay:a+200})]}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(st,{className:"h-3 w-24",delay:a+300}),e.jsx(st,{className:"h-5 w-32",delay:a+400}),e.jsx(st,{className:"h-3 w-20",delay:a+500})]})]})},at=({rows:s=5,columns:t=5,showHeader:a=!0,delay:r=0})=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden animate-pulse",style:{animationDelay:`${r}ms`},children:[a&&e.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:e.jsx("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${t}, 1fr)`},children:[...Array(t)].map((s,t)=>e.jsx(st,{className:"h-4 w-20",delay:r+50*t},t))})}),e.jsx("div",{className:"divide-y divide-gray-200",children:[...Array(s)].map((s,a)=>e.jsx("div",{className:"px-6 py-4",children:e.jsx("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${t}, 1fr)`},children:[...Array(t)].map((s,t)=>e.jsx("div",{className:"flex items-center",children:0===t?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(st,{className:"w-8 h-8",rounded:"full",delay:r+100*a+50*t}),e.jsx(st,{className:"h-4 w-24",delay:r+100*a+50*t+25})]}):e.jsx(st,{className:"h-4 w-16",delay:r+100*a+50*t})},t))})},a))})]}),rt=({type:s="line",showLegend:t=!0,delay:a=0})=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6 animate-pulse",style:{animationDelay:`${a}ms`},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx(st,{className:"h-6 w-32 mb-2",delay:a+100}),e.jsx(st,{className:"h-4 w-48",delay:a+200})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(st,{className:"h-8 w-20",rounded:"lg",delay:a+300}),e.jsx(st,{className:"h-8 w-8",rounded:"lg",delay:a+350})]})]}),e.jsxs("div",{className:"h-80 bg-gray-50 rounded-lg p-4 relative overflow-hidden",children:["pie"===s?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(st,{className:"w-48 h-48",rounded:"full",delay:a+400})}):e.jsx("div",{className:"h-full flex items-end justify-between gap-2",children:[...Array(12)].map((s,t)=>e.jsx("div",{className:"flex-1 flex flex-col justify-end",children:e.jsx(st,{className:"w-full",height:60*Math.random()+20+"%",delay:a+400+50*t})},t))}),"pie"!==s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute bottom-4 left-4 right-4 h-px bg-gray-300"}),e.jsx("div",{className:"absolute bottom-4 left-4 top-4 w-px bg-gray-300"})]})]}),t&&e.jsx("div",{className:"mt-4 flex flex-wrap gap-4",children:[...Array("pie"===s?5:3)].map((s,t)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(st,{className:"w-3 h-3",rounded:"full",delay:a+600+50*t}),e.jsx(st,{className:"h-4 w-16",delay:a+625+50*t})]},t))})]}),nt=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((s,t)=>e.jsx(tt,{delay:100*t},t))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx(rt,{type:"pie",delay:200}),e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((s,t)=>e.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200 animate-pulse",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(st,{className:"w-10 h-10",rounded:"full",delay:300+50*t}),e.jsxs("div",{children:[e.jsx(st,{className:"h-4 w-24 mb-1",delay:325+50*t}),e.jsx(st,{className:"h-3 w-16",delay:350+50*t})]})]}),e.jsx(st,{className:"h-6 w-20",delay:375+50*t})]})},t))})]}),e.jsx(at,{rows:8,columns:7,delay:500})]}),lt=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((s,t)=>e.jsx(tt,{delay:100*t},t))}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((s,t)=>e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-200 animate-pulse",style:{animationDelay:200+100*t+"ms"},children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(st,{className:"w-14 h-14",rounded:"2xl",delay:250+100*t}),e.jsxs("div",{children:[e.jsx(st,{className:"h-6 w-20 mb-2",delay:275+100*t}),e.jsx(st,{className:"h-4 w-32",delay:300+100*t})]})]})}),e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((s,a)=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-xl",children:[e.jsx(st,{className:"h-4 w-24",delay:325+100*t+25*a}),e.jsx(st,{className:"h-4 w-16",delay:350+100*t+25*a})]},a))})]},t))})]}),it=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{t:t}=Ve(),{isAuthenticated:a,isLoading:n}=Je(),l=o(),{refreshPSPDataSilent:m}=(()=>{const e=s.useCallback(async()=>{try{Pe.clearCacheForUrl("psp_summary_stats");const e=await Pe.get("/transactions/psp_summary_stats");if(200===e.status)return Pe.parseResponse(e);throw new Error("Failed to fetch PSP data")}catch(P){throw P}},[]),t=s.useCallback(async()=>{try{await e()}catch(P){}},[e]);return{refreshPSPData:e,refreshPSPDataSilent:t}})(),x=s.useRef(!1),h=s.useRef(!1),g=s.useRef(0);s.useEffect(()=>{try{localStorage.removeItem("pipeline_clients_data"),localStorage.removeItem("pipeline_transactions_data"),localStorage.removeItem("pipeline_dashboard_cache")}catch(e){}},[]);const[p,j]=s.useState([]),[N,v]=s.useState([]),[w,_]=s.useState(null),[S,E]=s.useState(!1),[P,ee]=s.useState(null),[se,te]=s.useState(null),[ae,re]=s.useState({clients:!1,transactions:!1,analytics:!1,dropdowns:!1,allLoaded:!1}),[ne,le]=s.useState(null);s.useState([]);const[ie,ce]=s.useState(!1),[oe,de]=s.useState(!1),[me,xe]=s.useState(!1);s.useState(!1);const[he,ge]=s.useState(""),[ue,pe]=s.useState(!1);s.useState(new Set);const[ye,je]=s.useState({});s.useState({});const[fe,be]=s.useState(!1),[Ne,ve]=s.useState(null),[we,_e]=s.useState(!1),[ke,Se]=s.useState(""),[Ce,De]=s.useState({}),[Te,Ae]=s.useState(!1),[Le,Oe]=s.useState(""),[Me,Ie]=s.useState(""),[Be,He]=s.useState(!1),[qe,Ke]=s.useState(!1),[We,Ye]=s.useState(""),[Ge,Xe]=s.useState(48.9);s.useEffect(()=>{(async()=>{try{const e=await Pe.get("/exchange-rates/current");if(e.ok){const s=await Pe.parseResponse(e);s&&s.rates&&s.rates.USD_TRY&&Xe(s.rates.USD_TRY.rate)}}catch(e){}})()},[]);const[Qe,Ze]=s.useState({psps:[],categories:[],payment_methods:[],currencies:[],companies:[]}),[es,ss]=s.useState({search:"",category:"all",psp:"all",company:"all",payment_method:"all",currency:"all",status:"all",date_from:"",date_to:"",amount_min:"",amount_max:"",commission_min:"",commission_max:"",client_name:"",sort_by:"date",sort_order:"desc"}),[ts,as]=s.useState(!1),[ns,ds]=s.useState({basic:!0,advanced:!1,amounts:!1,dates:!1}),[ps,ys]=s.useState({currentOffset:0,itemsPerLoad:100,total:0,hasMore:!0,loading:!1,oldestDate:null}),[js,fs]=s.useState(100),[bs,Fs]=s.useState(!1),Ls=d(),[Us,$s]=Ks("overview");s.useEffect(()=>{const e=new URLSearchParams(Ls.search),s=e.get("client")||e.get("client_name"),t="true"===e.get("show_details");if(s){const e=decodeURIComponent(s);if(ss(s=>({...s,client_name:e})),t&&p.length>0){const s=p.find(s=>s.client_name.toLowerCase()===e.toLowerCase());if(s){le(s),Ws(!0);const e=new URLSearchParams(Ls.search);e.delete("show_details"),l(`/clients?${e.toString()}`,{replace:!0})}}}else ss(e=>({...e,client_name:""}))},[Ls.search,p,l]);const[zs,Os]=s.useState(!1),[Ms,Is]=s.useState(!1),[Bs,Hs]=s.useState(null),[qs,Ws]=s.useState(!1),[Ys,Js]=s.useState(!1);s.useState(!1);const[Zs,st]=s.useState(!1),[tt,at]=s.useState(!1),[rt,lt]=s.useState(null),[it,ct]=s.useState(!1),[ot,dt]=s.useState(!1),[mt,xt]=s.useState(!1),[ht,gt]=s.useState([]),[ut,pt]=s.useState([]),[yt,jt]=s.useState(!1),[ft,bt]=s.useState(""),Nt=s.useCallback(async()=>{if(!h.current&&!x.current&&a&&!n){h.current=!0,E(!0),ee(null);try{const[e,s,t]=await Promise.allSettled([wt(),_t(),kt()]);re(a=>({...a,clients:"fulfilled"===e.status,dropdowns:"fulfilled"===s.status,transactions:"fulfilled"===t.status,allLoaded:!0})),"fulfilled"===e.status&&te(null),"fulfilled"===t.status&&ee(null),x.current=!0}catch(e){ee("Failed to load data. Please try again.")}finally{h.current=!1,E(!1)}}},[a,n]);s.useEffect(()=>{const e=e=>{const s=e;s?.detail?.skipCurrentPage||a&&!n&&("create"===s?.detail?.action&&ys(e=>({...e,currentOffset:0,hasMore:!0,oldestDate:null})),kt(!0),wt())};return window.addEventListener("transactionsUpdated",e),()=>{window.removeEventListener("transactionsUpdated",e)}},[a,n]),s.useEffect(()=>()=>{Bs&&clearTimeout(Bs)},[Bs]);const vt=s.useCallback(async()=>{if(!S)try{E(!0),ee(null),ys(e=>({...e,currentOffset:0,hasMore:!0,oldestDate:null})),await kt(!0,!1)}catch(e){const s=(e=>Vs.handleApiError(e,"fetchTransactions"))(e);ee((e=>Vs.getUserFriendlyMessage(e))(s))}finally{E(!1),Is(!1),Bs&&(clearTimeout(Bs),Hs(null))}},[es,ps.itemsPerLoad,S]);s.useEffect(()=>{zs||"/transactions"===Ls.pathname&&($s("transactions"),a&&!n&&0===N.length&&Nt())},[Ls.pathname,a,n,zs,Nt]),s.useEffect(()=>{if(a&&!n)0===p.length&&0===N.length&&Nt();else if(!a&&!n&&(p.length>0||N.length>0)){j([]),v([]),ee(null);try{localStorage.removeItem("pipeline_clients_data"),localStorage.removeItem("pipeline_transactions_data")}catch(e){}}},[a,n,Nt]),s.useEffect(()=>{},[Us]),s.useEffect(()=>{"transactions"!==Us||!a||n||0!==N.length||S||kt()},[Us,a,n]),s.useEffect(()=>{try{const e=localStorage.getItem("clients_transactions_display_limit");if(e&&"transactions"===Us){const s=parseInt(e,10);!isNaN(s)&&s>=100?fs(s):fs(100)}else fs(100)}catch(e){fs(100)}},[Ls.pathname,Us]),s.useEffect(()=>{if("transactions"===Us&&js>0)try{localStorage.setItem("clients_transactions_display_limit",js.toString())}catch(e){}},[js,Us]);const wt=async()=>{try{if(Date.now()-g.current<5e3)return[];if(te(null),!a)return te("Authentication required"),[];const e=await Pe.get(`/transactions/clients?_t=${Date.now()}&_refresh=${Math.random()}`);if(401===e.status)return[];if(e.ok){const s=await Pe.parseResponse(e);let t,a=null;s&&"object"==typeof s&&"clients"in s?(t=s.clients||[],a=s.summary||null):t=Array.isArray(s)?s:[];const r=t.map(e=>({client_name:e.client_name||"Unknown",company_name:e.company_name||null,payment_method:e.payment_method||null,category:e.category||null,total_amount:e.total_amount||0,total_commission:e.total_commission||0,total_net:e.total_net||0,transaction_count:e.transaction_count||0,first_transaction:e.first_transaction||"",last_transaction:e.last_transaction||"",currencies:e.currencies||[],psps:e.psps||[],avg_transaction:e.avg_transaction||0}));return j(r),_(a),te(null),r}return te("Failed to load clients data"),j([]),[]}catch(e){return te("Failed to load clients data. Please try again."),j([]),[]}},_t=async()=>{try{const e=await Pe.get("/transactions/dropdown-options");if(e.ok){const s=await Pe.parseResponse(e);return s&&Ze({currencies:(s.currencies||s.currency||[]).map(e=>e.value),payment_methods:(s.payment_method||[]).map(e=>e.value),categories:(s.category||[]).map(e=>e.value),psps:(s.psp||[]).map(e=>e.value),companies:(s.company||[]).map(e=>e.value)}),s}return{}}catch(e){return{}}},kt=async(e=!1,s=!1)=>{try{const r=Date.now();if(!e&&!s&&r-g.current<5e3)return[];if(g.current=r,!a)return[];if(S&&!e)return[];const n=new URLSearchParams;if(n.append("page","1"),n.append("per_page",ps.itemsPerLoad.toString()),es.search&&""!==es.search.trim()&&n.append("search",es.search),es.category&&""!==es.category.trim()&&"all"!==es.category&&n.append("category",es.category),es.psp&&""!==es.psp.trim()&&"all"!==es.psp&&n.append("psp",es.psp),es.company&&""!==es.company.trim()&&"all"!==es.company&&n.append("company",es.company),es.payment_method&&""!==es.payment_method.trim()&&"all"!==es.payment_method&&n.append("payment_method",es.payment_method),es.currency&&""!==es.currency.trim()&&"all"!==es.currency&&n.append("currency",es.currency),es.status&&""!==es.status.trim()&&"all"!==es.status&&n.append("status",es.status),es.date_from&&""!==es.date_from.trim()&&n.append("date_from",es.date_from),s&&ps.oldestDate){const e=new Date(ps.oldestDate);e.setDate(e.getDate()-1),n.append("date_to",e.toISOString().split("T")[0])}else es.date_to&&""!==es.date_to.trim()&&n.append("date_to",es.date_to);es.amount_min&&""!==es.amount_min.trim()&&n.append("amount_min",es.amount_min),es.amount_max&&""!==es.amount_max.trim()&&n.append("amount_max",es.amount_max),es.commission_min&&""!==es.commission_min.trim()&&n.append("commission_min",es.commission_min),es.commission_max&&""!==es.commission_max.trim()&&n.append("commission_max",es.commission_max),es.client_name&&""!==es.client_name.trim()&&n.append("client",es.client_name),es.sort_by&&""!==es.sort_by.trim()&&n.append("sort_by",es.sort_by),es.sort_order&&""!==es.sort_order.trim()&&n.append("sort_order",es.sort_order);const l=await Pe.get(`/transactions/?${n.toString()}`);if(401===l.status)return v([]),ee("Authentication required. Please log in again."),[];if(!l.ok){try{const e=await Pe.parseResponse(l),s=e?.message||e?.error||`Failed to fetch transactions: ${l.status} ${l.statusText}`;ee(s)}catch(t){ee(`Failed to fetch transactions: ${l.status} ${l.statusText}`)}return[]}const i=l.data;if(l.ok){const e=await Pe.parseResponse(l);let t=[];Array.isArray(e)?t=e:i?.data&&Array.isArray(i.data)?t=i.data:Array.isArray(e?.transactions)?t=e.transactions:Array.isArray(e?.meta?.transactions)&&(t=e.meta.transactions);const a=i?.meta?.pagination?.total||i?.meta?.total||e?.pagination?.total||e?.meta?.pagination?.total||0;if(t.length,t.length>0){const e=t.map(e=>e.date).filter(Boolean);e.length>0&&Math.min(...e.map(e=>new Date(e).getTime())),e.length>0&&Math.max(...e.map(e=>new Date(e).getTime()))}v(s?e=>{const s=new Set(e.map(e=>e.id)),a=t.filter(e=>!s.has(e.id)&&!(ps.oldestDate&&e.date&&new Date(e.date).toISOString().split("T")[0]>=new Date(ps.oldestDate).toISOString().split("T")[0]));return[...e,...a]}:t);let r=ps.oldestDate;if(t.length>0){const e=t.map(e=>e.date||e.created_at).filter(e=>null!=e).sort();if(e.length>0){const s=e[0];(!r||s<r)&&(r=s)}}const n=a||0,c=s?ps.currentOffset+t.length:t.length,o=t.length===ps.itemsPerLoad,d=s?ps.currentOffset+t.length:t.length,m=o||n>0&&!(n>0&&d>=n);return ys(e=>({...e,currentOffset:c,total:n,hasMore:m,oldestDate:r})),Et(t),t}return[]}catch(r){return ee(`Failed to load transactions: ${r instanceof Error?r.message:"Unknown error"}`),[]}},St=async()=>{E(!0),await wt(),E(!1)},Ct=()=>Object.values(es).filter(e=>e&&"created_at"!==e&&"desc"!==e).length,Dt=(e,s)=>ze(e,s||"USD"),Tt=e=>{if(!e)return"N/A";const s=new Date(e),t=new Date,a=new Date(t);return a.setDate(a.getDate()-1),s.toDateString()===t.toDateString()?"Today":s.toDateString()===a.toDateString()?"Yesterday":s.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},At=e=>{const s=e.reduce((e,s)=>{const t=s.date||"Unknown";return e[t]||(e[t]=[]),e[t].push(s),e},{}),t=Object.entries(s).sort(([e],[s])=>s.localeCompare(e)).map(([e,s])=>({dateKey:e,date:e,transactions:s.sort((e,s)=>{const t=e.created_at?new Date(e.created_at).getTime():0;return(s.created_at?new Date(s.created_at).getTime():0)-t}),grossBalance:Ce[e]||null}));return t.slice(0,3).forEach((e,s)=>{}),t},Et=async e=>{const s=[...new Set(e.map(e=>e.date).filter(Boolean))],t={};if(0!==s.length){try{const e=s.join(","),r=await fetch(`/api/summary/batch?dates=${encodeURIComponent(e)}`,{credentials:"include",headers:{Accept:"application/json"}});if(r.ok){const e=await r.json();e&&e.success&&e.summaries&&Object.entries(e.summaries).forEach(([e,s])=>{if(s&&void 0!==s.gross_balance_tl){let a=Number(s.exchange_rate)||0;0!==a&&s.exchange_rate||(a=Ge||48),t[e]={tl:Number(s.gross_balance_tl)||0,usd:Number(s.gross_balance_usd)||0,rate:a}}})}else try{await r.json()}catch(a){}}catch(r){r instanceof Error&&r.message}De(t)}else De(t)},Rt=(e,s)=>{const t=e.map(e=>{const s=e=>{if(null==e)return"";const s=String(e);return s.includes(",")||s.includes('"')||s.includes("\n")?`"${s.replace(/"/g,'""')}"`:s},t=e.amount&&e.amount>0?((e.commission||0)/e.amount*100).toFixed(2):0;return[s(e.id),s(e.date),s(e.client_name||"Unknown"),s(e.payment_method||"-"),s(e.psp||"-"),s(e.amount_tl||e.amount||0),s(e.amount_usd||0),s(e.currency||"TRY"),s(e.transaction_type||e.category||"deposit"),s(t+"%"),s(e.commission_tl||e.commission||0),s(e.net_amount_tl||e.net_amount||0),s(e.notes||""),s(e.created_at)]}),a=[["ID","Date","Client Name","Payment Method","PSP","Amount (TRY)","Amount (USD)","Currency","Transaction Type","Commission Rate","Commission Amount","Net Amount","Description","Created At"].join(","),...t.map(e=>e.join(","))].join("\n"),r=new Blob(["\ufeff"+a],{type:"text/csv;charset=utf-8;"}),n=window.URL.createObjectURL(r),l=document.createElement("a");l.href=n,l.download=s,l.click(),window.URL.revokeObjectURL(n)},Pt=async()=>{Fs(!0);try{const e=[],s=500;let t=1,a=!0,r=1;const n=new URLSearchParams;for(es.search&&""!==es.search.trim()&&n.append("search",es.search),es.client_name&&""!==es.client_name.trim()&&"all"!==es.client_name&&n.append("client_name",es.client_name),es.payment_method&&""!==es.payment_method.trim()&&"all"!==es.payment_method&&n.append("payment_method",es.payment_method),es.psp&&""!==es.psp.trim()&&"all"!==es.psp&&n.append("psp",es.psp),es.date_from&&""!==es.date_from.trim()&&n.append("date_from",es.date_from),es.date_to&&""!==es.date_to.trim()&&n.append("date_to",es.date_to),es.amount_min&&""!==es.amount_min.trim()&&n.append("amount_min",es.amount_min),es.amount_max&&""!==es.amount_max.trim()&&n.append("amount_max",es.amount_max);a&&t<=r;){const l=new URLSearchParams(n);l.append("per_page",s.toString()),l.append("page",t.toString());const i=await Pe.get(`/transactions/?${l.toString()}`),c=await Pe.parseResponse(i),o=c.transactions||[];if(e.push(...o),c.pagination?(r=c.pagination.pages||1,a=t<r&&o.length===s):a=o.length===s,t++,t>100)break}const l=(new Date).toISOString().split("T")[0],i=`transactions_all_${e.length}_${l}.csv`;Rt(e,i)}catch(e){alert(t("transactions.export_failed"))}finally{Fs(!1)}},Ft=async e=>{const s=e.target,t=s.files?.[0];if(!t)return;const a=t.name.split(".").pop()?.toLowerCase();if("xlsx"===a||"xls"===a){ct(!0);try{const e=new FormData;e.append("file",t);const s=["HAZIRAN","TEMMUZ","AÄžUSTOS","EKÄ°M","KASIM"];e.append("sheets",JSON.stringify(s));const a=await fetch("/api/v1/transactions/import-excel",{method:"POST",body:e,credentials:"include"});if(!a.ok){const e=await a.json();throw new Error(e.message||"Import failed")}const r=await a.json();let n="Excel Import Completed!\n\n";n+=`âœ… Imported: ${r.data.imported_count} transactions\n`,n+=`âš ï¸ Skipped: ${r.data.skipped_count} rows\n`,n+=`ðŸ“„ Sheets processed: ${r.data.sheets_processed}\n`,r.data.warnings&&r.data.warnings.length>0&&(n+=`\nâš ï¸ Warnings (${r.data.warnings.length}):\n`,r.data.warnings.slice(0,5).forEach(e=>n+=`â€¢ ${e}\n`),r.data.warnings.length>5&&(n+=`â€¢ ... and ${r.data.warnings.length-5} more\n`)),r.data.errors&&r.data.errors.length>0&&(n+=`\nâŒ Errors (${r.data.errors.length}):\n`,r.data.errors.slice(0,5).forEach(e=>n+=`â€¢ ${e}\n`)),alert(n),"transactions"===Us&&await vt(),await St(),await Jt()}catch(r){alert(`Import Error: ${r.message}\n\nPlease check the file format and try again.`)}finally{ct(!1)}}else alert("Please upload an Excel file (.xlsx or .xls)")},Lt=e=>{lt(e),st(!0)},Ut=async e=>{try{await _t();const s=await Pe.get(`/transactions/${e.id}`);if(s.ok){const e=await Pe.parseResponse(s);lt(e.transaction||e),at(!0)}else lt(e),at(!0)}catch(s){lt(e),at(!0)}},$t=async e=>{if(confirm(`${t("transactions.confirm_delete_transaction")}\n\n${t("transactions.client_name")}: ${e.client_name}\n${t("common.amount")}: ${Dt(e.amount,e.currency)}`))try{const a=await Pe.delete(`/transactions/${e.id}`);if(a.ok){const r=await Pe.parseResponse(a);if(r?.success){v(s=>s.filter(s=>s.id!==e.id)),ys(e=>({...e,total:e.total>0?e.total-1:0}));try{await m()}catch(s){}window.dispatchEvent(new CustomEvent("transactionsUpdated",{detail:{action:"delete",transactionId:e.id}})),alert(t("transactions.transaction_deleted_success"))}else alert(r?.message||t("transactions.failed_delete_transaction"))}else{const e=await Pe.parseResponse(a);alert(e?.message||t("transactions.failed_delete_transaction"))}}catch(a){const e=a instanceof Error?a.message:"Unknown error";alert(`${t("transactions.delete_transaction_error")}: ${e}`)}},zt=()=>{Ws(!1),Js(!1),ce(!1),xe(!1),le(null)},Ot=Array.isArray(p)?p.filter(e=>{const s=!es.search||e.client_name.toLowerCase().includes(es.search.toLowerCase())||e.company_name&&e.company_name.toLowerCase().includes(es.search.toLowerCase()),t=!es.client_name||e.client_name.toLowerCase().includes(es.client_name.toLowerCase()),a=!es.payment_method||"all"===es.payment_method||e.payment_method&&e.payment_method.toLowerCase().includes(es.payment_method.toLowerCase()),r=!es.category||"all"===es.category||e.category&&e.category.toLowerCase().includes(es.category.toLowerCase()),n=!es.psp||"all"===es.psp||Array.isArray(e.psps)&&e.psps.some(e=>e.toLowerCase().includes(es.psp.toLowerCase())),l=!es.currency||"all"===es.currency||Array.isArray(e.currencies)&&e.currencies.some(e=>e.toLowerCase().includes(es.currency.toLowerCase()));return s&&t&&a&&r&&n&&l}):[];Array.isArray(Ot)&&Ot.length>0?Ot.reduce((e,s)=>e+s.total_amount,0):Array.isArray(p)&&p.length>0&&p.reduce((e,s)=>e+s.total_amount,0);const Mt=Array.isArray(Ot)&&Ot.length>0?Ot.reduce((e,s)=>e+s.total_commission,0):Array.isArray(p)&&p.length>0?p.reduce((e,s)=>e+s.total_commission,0):0;Array.isArray(Ot)&&Ot.length>0?Ot.reduce((e,s)=>e+s.transaction_count,0):Array.isArray(p)&&p.length>0&&p.reduce((e,s)=>e+s.transaction_count,0);const[It,Bt]=s.useState(null),[Ht,qt]=s.useState(null),[Kt,Wt]=s.useState(0),Yt=s.useCallback(async()=>{try{const e=await Pe.get("/analytics/dashboard/stats?range=all");if(e.ok){const s=await Pe.parseResponse(e);Bt({total_revenue:s.summary?.total_revenue||0,total_commission:s.summary?.total_commission||0,net_cash:s.summary?.net_cash||0,total_deposits:s.summary?.total_deposits||0,total_withdrawals:s.summary?.total_withdrawals||0})}}catch(e){}},[]),Vt=e=>{const s={KK:"Credit Card",BANKA:"Bank",Banka:"Bank",BANK:"Bank",CC:"Credit Card",CARD:"Credit Card","CREDIT CARD":"Credit Card",CASH:"Cash",WIRE:"Wire Transfer",TRANSFER:"Transfer",PAYPAL:"PayPal",STRIPE:"Stripe",SQUARE:"Square",TETHER:"Tether",USDT:"Tether",UNKNOWN:"Unknown"};if(s[e])return s[e];const t=e.toUpperCase();return s[t]?s[t]:t.includes("CREDIT")&&t.includes("CARD")?"Credit Card":t.includes("BANK")?"Bank":t.includes("TETHER")||t.includes("USDT")?"Tether":e},Jt=s.useCallback(async()=>{try{const e=await Pe.get("/transactions/?per_page=500&page=1");if(200===e.status){const s=Pe.parseResponse(e),t=s&&s.transactions&&Array.isArray(s.transactions)?s.transactions:[],a={};t.forEach(e=>{const s=e.payment_method||"Unknown",t=Vt(s);a[t]||(a[t]={deposits:0,withdrawals:0,total:0,count:0});const r=s.toLowerCase().includes("tether")||"TETHER"===s?e.amount||0:null!==e.amount_tl&&void 0!==e.amount_tl?e.amount_tl:e.amount||0;a[t].count+=1,"DEP"===e.category||"Deposit"===e.category||"Investment"===e.category?(a[t].deposits+=r,a[t].total+=r):"WD"!==e.category&&"Withdraw"!==e.category&&"Withdrawal"!==e.category||(a[t].withdrawals+=r,a[t].total-=r)}),qt(a),Wt(t.length)}}catch(e){}},[]);s.useEffect(()=>{a&&!n&&(Yt(),Jt())},[a,n]);const Gt=s.useMemo(()=>{if(It)return{totalDeposits:It.total_deposits,totalWithdrawals:It.total_withdrawals};if(!Array.isArray(N))return{totalDeposits:0,totalWithdrawals:0};const e=N.filter(e=>"DEP"===e.category||"Deposit"===e.category||"Investment"===e.category),s=N.filter(e=>"WD"===e.category||"Withdraw"===e.category||"Withdrawal"===e.category);return{totalDeposits:e.reduce((e,s)=>e+(null!==s.amount_tl&&void 0!==s.amount_tl?s.amount_tl:s.amount||0),0),totalWithdrawals:s.reduce((e,s)=>e+(null!==s.amount_tl&&void 0!==s.amount_tl?s.amount_tl:s.amount||0),0)}},[It,N]),{totalDeposits:Xt,totalWithdrawals:Qt}=Gt;s.useMemo(()=>{if(Ht&&Object.keys(Ht).length>0)return Ht;if(!Array.isArray(N))return{};const e={};return N.forEach(s=>{const t=s.payment_method||"Unknown",a=Vt(t);e[a]||(e[a]={deposits:0,withdrawals:0,total:0,count:0});const r=t.toLowerCase().includes("tether")||"TETHER"===t?s.amount||0:null!==s.amount_tl&&void 0!==s.amount_tl?s.amount_tl:s.amount||0;e[a].count+=1,"DEP"===s.category||"Deposit"===s.category||"Investment"===s.category?(e[a].deposits+=r,e[a].total+=r):"WD"!==s.category&&"Withdraw"!==s.category&&"Withdrawal"!==s.category||(e[a].withdrawals+=r,e[a].total-=r)}),e},[Ht,N]);const Zt=()=>{Ae(!1),Oe(""),Ie("")},ea=async e=>{try{_e(!0),Se(e);const t=await fetch(`/api/summary/${e}`,{credentials:"include",headers:{"Content-Type":"application/json"}});if(t.ok){const e=await t.json(),s={...e,usd_rate:null!==e.usd_rate&&void 0!==e.usd_rate?"number"==typeof e.usd_rate?e.usd_rate:Number(e.usd_rate):null,gross_balance_tl:void 0!==e.gross_balance_tl?Number(e.gross_balance_tl):void 0,gross_balance_usd:void 0!==e.gross_balance_usd?Number(e.gross_balance_usd):void 0,total_deposits_tl:void 0!==e.total_deposits_tl?Number(e.total_deposits_tl):0,total_deposits_usd:void 0!==e.total_deposits_usd?Number(e.total_deposits_usd):0,total_withdrawals_tl:void 0!==e.total_withdrawals_tl?Number(e.total_withdrawals_tl):0,total_withdrawals_usd:void 0!==e.total_withdrawals_usd?Number(e.total_withdrawals_usd):0,payment_method_totals:e.payment_method_totals?{BANK:e.payment_method_totals.BANK?{amount_tl:Number(e.payment_method_totals.BANK.amount_tl||0),amount_usd:Number(e.payment_method_totals.BANK.amount_usd||0),count:Number(e.payment_method_totals.BANK.count||0)}:void 0,CC:e.payment_method_totals.CC?{amount_tl:Number(e.payment_method_totals.CC.amount_tl||0),amount_usd:Number(e.payment_method_totals.CC.amount_usd||0),count:Number(e.payment_method_totals.CC.count||0)}:void 0,TETHER:e.payment_method_totals.TETHER?{amount_tl:Number(e.payment_method_totals.TETHER.amount_tl||0),amount_usd:Number(e.payment_method_totals.TETHER.amount_usd||0),count:Number(e.payment_method_totals.TETHER.count||0)}:void 0}:void 0};ve(s),be(!0)}else{try{await t.json()}catch(s){}const a={date:e,date_str:new Date(e).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),usd_rate:null,total_amount_tl:0,total_amount_usd:0,total_commission_tl:0,total_commission_usd:0,total_net_tl:0,total_net_usd:0,transaction_count:0,unique_clients:0,psp_summary:[],category_summary:[],payment_method_summary:[],transactions:[]};ve(a),be(!0)}}catch(t){t instanceof Error&&t.message;const s={date:e,date_str:new Date(e).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),usd_rate:null,total_amount_tl:0,total_amount_usd:0,total_commission_tl:0,total_commission_usd:0,total_net_tl:0,total_net_usd:0,transaction_count:0,unique_clients:0,psp_summary:[],category_summary:[],payment_method_summary:[],transactions:[]};ve(s),be(!0)}finally{_e(!1)}},sa=()=>{const e=N.reduce((e,s)=>{const t=s.payment_method||"Unknown",a=Vt(t);return e[a]||(e[a]={method:a,volume:0,count:0}),e[a].volume+=Math.abs(s.amount),e[a].count+=1,e},{});return Object.values(e).sort((e,s)=>s.volume-e.volume).slice(0,5)},ta=["#3b82f6","#8b5cf6","#10b981","#f59e0b","#ef4444","#06b6d4"];if(n)return e.jsx(nt,{});if(P&&!se)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 mb-4",children:e.jsx(A,{className:"h-16 w-16 mx-auto"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Application Error"}),e.jsx("p",{className:"text-gray-600 mb-6",children:P}),e.jsxs(ms,{variant:"default",onClick:()=>window.location.reload(),className:"inline-flex items-center gap-2",children:[e.jsx(r,{className:"h-4 w-4"}),"Reload Page"]})]})});const aa=(e,s)=>{if("essential"===e)if("csv"===s){const e=new Blob(["Client,Company,Payment Method,Category,Amount,Currency,PSP,Date\nJohn Doe,ABC Corporation,Credit Card,DEP,1000.50,USD,Stripe,2025-08-18\nJane Smith,XYZ Ltd,Bank Transfer,WIT,2500.00,EUR,PayPal,2025-08-19\nMike Johnson,Global Inc,TR1122334455,Wire Transfer,DEP,5000.00,GBP,Bank of America,2025-08-20"],{type:"text/csv"}),s=window.URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="essential_transaction_template.csv",t.click(),window.URL.revokeObjectURL(s)}else{const e=[["Client","Company","Payment Method","Category","Amount","Currency","PSP","Date"],["John Doe","ABC Corporation","Credit Card","DEP",1000.5,"USD","Stripe","2025-08-18"],["Jane Smith","XYZ Ltd","Bank Transfer","WIT",2500,"EUR","PayPal","2025-08-19"],["Mike Johnson","Global Inc","TR1122334455","Wire Transfer","DEP",5e3,"GBP","Bank of America","2025-08-20"]],s=Q.aoa_to_sheet(e),t=Q.book_new();Q.book_append_sheet(t,s,"Transactions"),Z(t,"essential_transaction_template.xlsx")}else if("csv"===s){const e=new Blob(["Client,Company,Payment Method,Category,Amount,Commission,Net Amount,Currency,PSP,Date,Notes\nJohn Doe,ABC Corporation,Credit Card,DEP,1000.50,25.00,975.50,USD,Stripe,2025-08-18,Monthly payment\nJane Smith,XYZ Ltd,Bank Transfer,WIT,2500.00,50.00,2450.00,EUR,PayPal,2025-08-19,Quarterly transfer\nMike Johnson,Global Inc,TR1122334455,Wire Transfer,DEP,5000.00,100.00,4900.00,GBP,Bank of America,2025-08-20,Annual deposit"],{type:"text/csv"}),s=window.URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="full_transaction_template.csv",t.click(),window.URL.revokeObjectURL(s)}else{const e=[["Client","Company","Payment Method","Category","Amount","Commission","Net Amount","Currency","PSP","Date","Notes"],["John Doe","ABC Corporation","Credit Card","DEP",1000.5,25,975.5,"USD","Stripe","2025-08-18","Monthly payment"],["Jane Smith","XYZ Ltd","Bank Transfer","WIT",2500,50,2450,"EUR","PayPal","2025-08-19","Quarterly transfer"],["Mike Johnson","Global Inc","TR1122334455","Wire Transfer","DEP",5e3,100,4900,"GBP","Bank of America","2025-08-20","Annual deposit"]],s=Q.aoa_to_sheet(e),t=Q.book_new();Q.book_append_sheet(t,s,"Transactions"),Z(t,"full_transaction_template.xlsx")}};return S?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading clients..."})]})}):e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx($,{className:"h-8 w-8 text-gray-600"}),t("clients.title")]}),e.jsx("p",{className:"text-gray-600",children:t("clients.description")})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Re,{variant:"outline",size:"sm",onClick:Pt,disabled:bs,icon:bs?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-600"}):e.jsx(F,{className:"h-4 w-4"}),iconPosition:"left",className:"bg-gray-50 border-gray-300 text-gray-700 hover:bg-gray-100",children:t(bs?"common.loading":"clients.export_all_transactions")}),e.jsx(Re,{variant:"outline",size:"sm",onClick:()=>{const e=document.createElement("input");e.type="file",e.accept=".xlsx,.xls",e.onchange=Ft,e.click()},disabled:it,icon:e.jsx(z,{className:"h-4 w-4"}),iconPosition:"left",className:"bg-gray-50 border-gray-300 text-gray-700 hover:bg-gray-100",children:t(it?"common.loading":"clients.import")}),e.jsx(Re,{variant:"outline",size:"sm",onClick:()=>jt(!0),disabled:it,icon:e.jsx(i,{className:"h-4 w-4"}),iconPosition:"left",className:"bg-gray-50 border-gray-300 text-gray-700 hover:bg-gray-100",children:t("clients_page.paste_import")}),e.jsx(Re,{variant:"outline",size:"sm",onClick:()=>dt(!0),icon:e.jsx(b,{className:"h-4 w-4"}),iconPosition:"left",className:"bg-gray-50 border-gray-300 text-gray-700 hover:bg-gray-100",children:t("clients.guide")}),e.jsx(Re,{variant:"outline",size:"sm",onClick:()=>xe(!0),icon:e.jsx(U,{className:"h-4 w-4"}),iconPosition:"left",className:"bg-gray-50 border-gray-300 text-gray-700 hover:bg-gray-100",children:t("clients.bulk")}),e.jsx(Re,{variant:"outline",size:"sm",onClick:()=>{},icon:e.jsx(T,{className:"h-4 w-4"}),iconPosition:"left",className:"bg-gray-50 border-gray-300 text-gray-500 cursor-not-allowed opacity-60",disabled:!0,children:t("clients.brate")}),e.jsx(Re,{variant:"outline",size:"sm",onClick:async()=>{try{await St(),await vt(),await(async()=>{try{Pe.clearCacheForUrl("psp_summary_stats");const e=await Pe.get("/transactions/psp_summary_stats");if(200===e.status)return Pe.parseResponse(e);throw new Error("Failed to fetch PSP data")}catch(e){throw e}})(),alert(t("transactions.data_refreshed"))}catch(e){const s=e instanceof Error?e.message:"Unknown error";alert(`${t("transactions.error_refreshing_data")}: ${s}`)}},icon:e.jsx(r,{className:"h-4 w-4"}),iconPosition:"left",className:"bg-gray-50 border-gray-300 text-gray-700 hover:bg-gray-100",children:t("clients.fetch")}),e.jsx(Re,{variant:"outline",size:"sm",onClick:()=>l("/transactions/add"),icon:e.jsx(O,{className:"h-4 w-4"}),iconPosition:"left",className:"bg-gray-50 border-gray-300 text-gray-700 hover:bg-gray-100",children:t("clients.add_transaction")})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(xs,{value:Us,onValueChange:e=>{const s=e;$s(e),"transactions"===Us&&"transactions"!==s&&fs(100)},className:"w-full",children:[e.jsxs(hs,{className:"grid w-full grid-cols-4 bg-gray-50/80 border border-gray-200/60 rounded-lg shadow-sm",children:[e.jsxs(gs,{value:"overview",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg data-[state=active]:border data-[state=active]:border-gray-200",children:[e.jsx(M,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-gray-700"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:t("tabs.overview")})]}),e.jsxs(gs,{value:"clients",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg data-[state=active]:border data-[state=active]:border-gray-200",children:[e.jsx($,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-gray-700"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:t("navigation.clients")})]}),e.jsxs(gs,{value:"transactions",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg data-[state=active]:border data-[state=active]:border-gray-200",children:[e.jsx(i,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-gray-700"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:t("navigation.transactions")})]}),e.jsxs(gs,{value:"analytics",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg data-[state=active]:border data-[state=active]:border-gray-200",children:[e.jsx(I,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-gray-700"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:t("tabs.analytics")})]})]}),e.jsxs(us,{value:"overview",className:"mt-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5 text-gray-600"}),t("clients.financial_overview")]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t("clients.key_financial_metrics")})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(et,{title:t("ledger.total_deposits"),value:Dt(It?.total_deposits||Xt,"â‚º"),subtitle:t("clients.all_dep_transactions"),icon:T,color:"green",animated:!0,animationDuration:500,showGlass:!0}),e.jsx(et,{title:t("ledger.total_withdrawals"),value:Dt(Math.abs(It?.total_withdrawals||Qt),"â‚º"),subtitle:t("clients.all_wd_transactions"),icon:B,color:"red",animated:!0,animationDuration:500,showGlass:!0}),e.jsx(et,{title:t("dashboard.net_cash"),value:Dt((It?.total_deposits||Xt)-(It?.total_withdrawals||Qt),"â‚º"),subtitle:t("clients.all_transactions_net"),icon:C,color:(It?.total_deposits||Xt)-(It?.total_withdrawals||Qt)>=0?"gray":"red",animated:!0,animationDuration:500}),e.jsx(et,{title:t("dashboard.total_commissions"),value:Dt(It?.total_commission||Mt,"â‚º"),subtitle:t("clients.all_transactions_commission"),icon:i,color:"purple",animated:!0,animationDuration:500})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx($,{className:"h-5 w-5 text-gray-600"}),t("clients.client_insights")]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t("clients.distribution_top_performers")})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(Ee,{variant:"elevated",className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-4 right-4 w-20 h-20 bg-gray-100 rounded-full opacity-20"}),e.jsx(os,{className:"p-6 relative",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"bg-gray-100 p-3 rounded-lg",children:e.jsx($,{className:"h-6 w-6 text-gray-700"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Client Distribution"}),e.jsx("div",{className:"text-4xl font-bold text-gray-900 mb-2",children:w?.total_clients||p.length}),e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:[w?.multi_currency_count||p.filter(e=>Array.isArray(e.currencies)&&e.currencies.length>1).length," multi-currency"]}),e.jsxs("div",{className:"space-y-2 pt-3 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-gray-600 flex items-center gap-1",children:[e.jsx(T,{className:"h-3 w-3"}),"New This Month"]}),e.jsxs("span",{className:"text-sm font-semibold text-emerald-600",children:["+",w?.new_clients_this_month||0]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-gray-600 flex items-center gap-1",children:[e.jsx(C,{className:"h-3 w-3"}),"Avg Transaction"]}),e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:Dt(w?.avg_transaction_value||0,"â‚º")})]})]})]})]})})]}),e.jsxs(Ee,{variant:"elevated",className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-4 right-4 w-20 h-20 bg-purple-100 rounded-full opacity-20"}),e.jsx(os,{className:"p-6 relative",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"bg-purple-100 p-3 rounded-lg",children:e.jsx(H,{className:"h-6 w-6 text-purple-700"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Top Performers"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 mb-1 truncate",children:w?.most_active?.client_name||(p.length>0?p.reduce((e,s)=>s.transaction_count>e.transaction_count?s:e).client_name:"N/A")}),e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Most transactions: ",w?.most_active?.transaction_count||(p.length>0?p.reduce((e,s)=>s.transaction_count>e.transaction_count?s:e).transaction_count:0)," txns"]}),e.jsxs("div",{className:"space-y-2 pt-3 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-xs text-gray-600 flex items-center gap-1",children:[e.jsx(T,{className:"h-3 w-3"}),"Top by Volume"]}),e.jsx("span",{className:"text-xs font-medium text-gray-800 mt-0.5 truncate max-w-[120px]",children:w?.top_by_volume?.client_name||"N/A"})]}),e.jsx("span",{className:"text-sm font-semibold text-emerald-600",children:Dt(w?.top_by_volume?.total_amount||0,"â‚º")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-xs text-gray-600 flex items-center gap-1",children:[e.jsx(q,{className:"h-3 w-3"}),"Highest Commission"]}),e.jsx("span",{className:"text-xs font-medium text-gray-800 mt-0.5 truncate max-w-[120px]",children:w?.top_by_commission?.client_name||"N/A"})]}),e.jsx("span",{className:"text-sm font-semibold text-purple-600",children:Dt(w?.top_by_commission?.total_commission||0,"â‚º")})]})]})]})]})})]})]})]})]}),e.jsx(us,{value:"transactions",className:"mt-6",children:e.jsxs(Ee,{children:[e.jsx(ls,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsxs(is,{className:"flex items-center gap-3",children:["Transaction Management",e.jsx(Fe,{variant:"secondary",size:"sm",className:"bg-gray-100 text-gray-800",children:"Enhanced Filters Available"})]}),e.jsx(cs,{children:"All transaction records"})]})}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(Re,{variant:ts?"primary":"outline",onClick:()=>as(!ts),icon:e.jsx(R,{className:"h-4 w-4"}),className:"transition-all duration-200 "+(ts?"bg-gray-600 hover:bg-gray-700 text-white shadow-lg":"border-gray-300 text-gray-600 hover:bg-gray-50 hover:border-gray-400"),children:ts?"Hide Filters":"Show Filters"+(Ct()>0?` (${Ct()})`:"")})})]})}),e.jsxs(os,{children:[ts&&e.jsx("div",{className:"mb-6 animate-in slide-in-from-top-4 duration-300",children:e.jsx(Xs,{filters:es,dropdownOptions:Qe,expandedFilterSections:ns,displayLimit:js,transactionsLength:N.length,exporting:bs,onFilterChange:(e,s)=>{ss(t=>({...t,[e]:s}))},onToggleFilterSection:e=>{ds(s=>({...s,[e]:!s[e]}))},onClearAllFilters:()=>{ss({search:"",category:"",psp:"",company:"",payment_method:"",currency:"",status:"",date_from:"",date_to:"",amount_min:"",amount_max:"",commission_min:"",commission_max:"",client_name:"",sort_by:"date",sort_order:"desc"}),ys(e=>({...e,currentOffset:0,hasMore:!0,oldestDate:null}))},onApplyFilters:()=>{ys(e=>({...e,currentOffset:0,hasMore:!0,oldestDate:null})),vt()},onExportDisplayed:()=>{const e=N.slice(0,js),s=(new Date).toISOString().split("T")[0],t=`transactions_displayed_${e.length}_${s}.csv`;Rt(e,t)},onExportAll:Pt,onApplyQuickFilter:e=>{switch(e){case"today":const e=(new Date).toISOString().split("T")[0];ss(s=>({...s,date_from:e,date_to:e}));break;case"thisWeek":const s=new Date;s.setDate(s.getDate()-s.getDay());const t=new Date;t.setDate(t.getDate()+(6-t.getDay())),ss(e=>({...e,date_from:s.toISOString().split("T")[0],date_to:t.toISOString().split("T")[0]}));break;case"deposits":ss(e=>({...e,category:"DEP"}));break;case"withdrawals":ss(e=>({...e,category:"WD"}));break;case"highValue":ss(e=>({...e,amount_min:"10000"}))}ys(e=>({...e,currentOffset:0,hasMore:!0,oldestDate:null})),setTimeout(()=>{vt()},100)}})}),S?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Loading transactions..."})]}):P?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"text-red-500 mb-4",children:e.jsx(A,{className:"h-16 w-16 mx-auto"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Transactions"}),e.jsx("p",{className:"text-gray-600 mb-6",children:P}),e.jsx(ms,{variant:"default",onClick:vt,className:"flex items-center gap-2",children:"Try Again"})]}):0===N.length?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"text-gray-400 mb-4",children:e.jsx(i,{className:"h-16 w-16 mx-auto"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Transactions Found"}),e.jsx("p",{className:"text-gray-600",children:"No transactions are currently available."})]}):e.jsxs("div",{className:"overflow-x-auto",children:[(()=>{const s=At(N);let t=[];s.forEach(e=>{t=[...t,...e.transactions]});const a=t.slice(0,js),r=At(a);return 0===r.length?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"No transactions to group by date"}):r.map((s,t)=>e.jsxs("div",{className:"border-b border-gray-100 last:border-b-0",children:[e.jsx("div",{className:"px-6 py-4 bg-white border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"text-base font-semibold text-gray-900",children:Tt(s.date)}),e.jsx("span",{className:"text-xs text-gray-500 font-normal",children:new Date(s.date).toLocaleDateString("en-US",{weekday:"short"})})]}),e.jsx("div",{className:"h-4 w-px bg-gray-300"}),e.jsxs("div",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s.transactions.length}),e.jsx("span",{className:"text-gray-600 ml-1",children:"transactions"})]}),e.jsx("div",{className:"h-4 w-px bg-gray-300"}),e.jsx("div",{className:"flex items-center gap-4 text-sm tabular-nums",children:s.grossBalance&&void 0!==s.grossBalance.tl?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-gray-600 text-xs",children:"TRY"}),e.jsx("span",{className:"font-semibold text-gray-900",children:Dt(s.grossBalance.tl,"â‚º")})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-gray-600 text-xs",children:"USD"}),e.jsx("span",{className:"font-semibold text-gray-900",children:Dt(s.grossBalance.usd,"$")})]}),s.grossBalance.rate>0&&e.jsxs("span",{className:"text-xs text-gray-500",children:["@",s.grossBalance.rate.toFixed(2)]})]}):(()=>{let t=0,a=0;s.transactions.forEach(e=>{const s=e.amount||0,r=e.category&&"WD"===e.category.toUpperCase()?-Math.abs(s):s;"TRY"===e.currency||"TL"===e.currency?t+=r:"USD"===e.currency&&(a+=r)});const r=t/Ge+a,n=r*Ge;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-gray-600 text-xs",children:"TRY"}),e.jsx("span",{className:"font-semibold text-gray-900",children:Dt(n,"â‚º")})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-gray-600 text-xs",children:"USD"}),e.jsx("span",{className:"font-semibold text-gray-900",children:Dt(r,"$")})]}),e.jsxs("span",{className:"text-xs text-gray-500",children:["@",Ge.toFixed(2)]})]})})()})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ms,{onClick:()=>ea(s.date),disabled:we,variant:"ghost",size:"sm",className:"h-8 px-3 text-xs text-gray-700 hover:text-gray-900 hover:bg-gray-100",children:we&&ke===s.date?"Loading...":"Summary"}),s.grossBalance&&s.grossBalance.rate>0||s.transactions&&s.transactions.length>0&&s.transactions.some(e=>"USD"===e.currency||"EUR"===e.currency)?e.jsx(ms,{onClick:()=>{return e=s.date,t=s.grossBalance?.rate||Ge||48,Oe(e),Ie(t.toString()),void Ae(!0);var e,t},variant:"ghost",size:"sm",className:"h-8 px-3 text-xs text-gray-700 hover:text-gray-900 hover:bg-gray-100",title:`Edit exchange rate for ${s.date}`,children:"Edit Rate"}):null]})]})}),e.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg bg-white shadow-sm",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",style:{borderCollapse:"separate",borderSpacing:0},children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10 shadow-sm",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/12 border-b border-gray-200",children:"Client"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/12 border-b border-gray-200",children:"Company"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/12 border-b border-gray-200",children:"Payment Method"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/12 border-b border-gray-200",children:"Category"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/12 border-b border-gray-200 tabular-nums",children:"Amount"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/12 border-b border-gray-200 tabular-nums",children:"Commission"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/12 border-b border-gray-200 tabular-nums",children:"Net Amount"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/12 border-b border-gray-200",children:"Currency"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/12 border-b border-gray-200",children:"PSP"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/12 border-b border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.transactions.map(s=>e.jsx(Qs,{transaction:s,onView:Lt,onEdit:Ut,onDelete:$t,normalizePaymentMethodName:Vt},s.id))})]})})]},s.dateKey))})(),e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"font-medium",children:[N.length," ",t("dashboard.total_transactions").toLowerCase()]}),e.jsxs("span",{className:"text-gray-500",children:["across ",At(N).length," date",1!==At(N).length?"s":""]})]}),e.jsxs("span",{className:"font-semibold text-gray-900",children:["Total: ",Dt(N.reduce((e,s)=>e+(s.amount||0),0),"TL")]})]})}),e.jsxs("div",{className:"border-t border-gray-200 bg-gradient-to-b from-white to-gray-50",children:[e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Showing ",N.length.toLocaleString()," ",1===N.length?"transaction":"transactions"]})]}),ps.total>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4 text-blue-500"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Total: ",e.jsx("span",{className:"font-semibold text-gray-900",children:ps.total.toLocaleString()})]})]}),ps.oldestDate&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4 text-purple-500"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Oldest: ",e.jsx("span",{className:"font-semibold text-gray-900",children:new Date(ps.oldestDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:["Displaying: ",Math.min(js,N.length),"/",N.length," | hasMore: ",ps.hasMore?"true":"false"," | Total: ",ps.total]}),js<N.length&&e.jsxs("div",{className:"flex items-center gap-2 bg-blue-50 px-3 py-1.5 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-blue-500"}),e.jsxs("span",{className:"text-xs font-medium text-blue-700",children:[Math.round(js/N.length*100),"% displayed"]})]}),e.jsx("div",{className:"w-24 h-1.5 bg-blue-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full transition-all duration-300",style:{width:`${Math.min(js/N.length*100,100)}%`}})})]})]})]})}),(()=>{const e=js<N.length,s=ps.hasMore;return e||s})()&&e.jsx("div",{className:"flex justify-center pb-6 px-6",children:e.jsx(Re,{variant:"outline",size:"lg",onClick:async()=>{if(ps.loading)return;const e=js+100;if(fs(e),e>=N.length&&ps.hasMore){ys(e=>({...e,loading:!0}));try{await kt(!1,!0)}catch(s){}finally{ys(e=>({...e,loading:!1}))}}},disabled:ps.loading,icon:ps.loading?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}):e.jsx(r,{className:"h-4 w-4"}),iconPosition:"left",className:"min-w-[280px] border-blue-200 text-blue-700 hover:bg-blue-50 hover:border-blue-300 transition-all duration-200 shadow-sm hover:shadow-md",children:ps.loading?e.jsx("span",{children:"Loading older transactions..."}):e.jsxs("span",{children:["Load ",ps.itemsPerLoad," More Transactions"]})})}),!ps.hasMore&&N.length>0&&e.jsx("div",{className:"flex justify-center pb-6 px-6",children:e.jsxs("div",{className:"flex items-center gap-3 bg-green-50 border border-green-200 text-green-700 px-6 py-3 rounded-lg shadow-sm",children:[e.jsx(k,{className:"h-5 w-5"}),e.jsxs("span",{className:"font-medium",children:["All transactions loaded (",N.length.toLocaleString()," total)"]})]})})]})]})]})]})}),e.jsxs(us,{value:"analytics",className:"mt-6",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Analytics Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive insights and performance metrics"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-100 rounded-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Live Data"})]}),e.jsxs(ms,{variant:"outline",size:"sm",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Export Report"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(Ee,{className:"hover:shadow-lg transition-all duration-300",children:e.jsx(os,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:t("clients.total_revenue")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:Dt(p.reduce((e,s)=>e+s.total_amount,0),"â‚º")}),e.jsxs("p",{className:"text-sm text-green-600 mt-1 flex items-center",children:[e.jsx(T,{className:"h-4 w-4 mr-1"}),"+12.5% from last month"]})]}),e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(C,{className:"h-6 w-6 text-green-600"})})]})})}),e.jsx(Ee,{className:"hover:shadow-lg transition-all duration-300",children:e.jsx(os,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:t("clients.active_clients")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:p.filter(e=>e.transaction_count>0).length}),e.jsxs("p",{className:"text-sm text-blue-600 mt-1 flex items-center",children:[e.jsx($,{className:"h-4 w-4 mr-1"}),p.length," total clients"]})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx($,{className:"h-6 w-6 text-blue-600"})})]})})}),e.jsx(Ee,{className:"hover:shadow-lg transition-all duration-300",children:e.jsx(os,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:t("clients.avg_transaction")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:Dt(p.reduce((e,s)=>e+s.total_amount,0)/p.reduce((e,s)=>e+s.transaction_count,0)||0,"â‚º")}),e.jsxs("p",{className:"text-sm text-purple-600 mt-1 flex items-center",children:[e.jsx(M,{className:"h-4 w-4 mr-1"}),"Per transaction"]})]}),e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:e.jsx(M,{className:"h-6 w-6 text-purple-600"})})]})})}),e.jsx(Ee,{className:"hover:shadow-lg transition-all duration-300",children:e.jsx(os,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:t("clients.commission")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:Dt(p.reduce((e,s)=>e+s.total_commission,0),"â‚º")}),e.jsxs("p",{className:"text-sm text-orange-600 mt-1 flex items-center",children:[e.jsx(Y,{className:"h-4 w-4 mr-1"}),"8.5% avg rate"]})]}),e.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center",children:e.jsx(Y,{className:"h-6 w-6 text-orange-600"})})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[e.jsxs(Ee,{children:[e.jsxs(ls,{children:[e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5 text-blue-600"}),t("clients_page.transaction_volume_trend")]}),e.jsx(cs,{children:t("clients_page.monthly_deposits_withdrawals")})]}),e.jsxs(os,{children:[e.jsx("div",{className:"h-80",children:e.jsx(Ns,{width:"100%",height:"100%",children:e.jsxs(vs,{data:(()=>{const e=N.reduce((e,s)=>{if(!s.date)return e;const t=new Date(s.date),a=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`;return e[a]||(e[a]={month:a,deposits:0,withdrawals:0,net:0,count:0}),s.amount>0?e[a].deposits+=s.amount:e[a].withdrawals+=Math.abs(s.amount),e[a].net+=s.amount,e[a].count+=1,e},{});return Object.values(e).sort((e,s)=>e.month.localeCompare(s.month)).slice(-6)})(),children:[e.jsx(ws,{strokeDasharray:"3 3",stroke:"#f3f4f6"}),e.jsx(_s,{dataKey:"month",stroke:"#6b7280",fontSize:12,tickFormatter:e=>{const[s,t]=e.split("-");return`${t}/${s.slice(2)}`}}),e.jsx(ks,{stroke:"#6b7280",fontSize:12,tickFormatter:e=>Dt(e,"â‚º")}),e.jsx(Ss,{formatter:e=>[Dt(e,"â‚º"),""],labelFormatter:e=>{const[s,t]=e.split("-");return`${t}/${s}`},contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(Cs,{type:"monotone",dataKey:"deposits",stroke:"#10b981",strokeWidth:3,dot:{fill:"#10b981",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#10b981",strokeWidth:2}}),e.jsx(Cs,{type:"monotone",dataKey:"withdrawals",stroke:"#ef4444",strokeWidth:3,dot:{fill:"#ef4444",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#ef4444",strokeWidth:2}})]})})}),e.jsxs("div",{className:"flex items-center justify-center gap-6 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-600",children:t("clients_page.deposits")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-600",children:t("clients_page.withdrawals")})]})]})]})]}),e.jsxs(Ee,{children:[e.jsxs(ls,{children:[e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5 text-purple-600"}),t("clients_page.payment_method_distribution")]}),e.jsx(cs,{children:t("clients_page.volume_breakdown_payment")})]}),e.jsx(os,{children:e.jsx("div",{className:"h-80",children:e.jsx(Ns,{width:"100%",height:"100%",children:e.jsxs(Ds,{children:[e.jsx(Ts,{data:sa(),cx:"50%",cy:"50%",innerRadius:60,outerRadius:120,paddingAngle:5,dataKey:"volume",children:sa().map((s,t)=>e.jsx(As,{fill:ta[t%ta.length]},`cell-${t}`))}),e.jsx(Ss,{formatter:e=>[Dt(e,"â‚º"),"Volume"],contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(Es,{verticalAlign:"bottom",height:36,formatter:s=>e.jsx("span",{className:"text-sm text-gray-700",children:s})})]})})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs(Ee,{children:[e.jsxs(ls,{children:[e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5 text-green-600"}),t("clients_page.top_client_performance")]}),e.jsx(cs,{children:t("clients_page.volume_by_client_ranking")})]}),e.jsx(os,{children:e.jsx("div",{className:"h-80",children:e.jsx(Ns,{width:"100%",height:"100%",children:e.jsxs(Rs,{data:p.map(e=>({name:e.client_name,volume:e.total_amount,transactions:e.transaction_count,avgTransaction:e.avg_transaction,commission:e.total_commission})).sort((e,s)=>s.volume-e.volume).slice(0,10),children:[e.jsx(ws,{strokeDasharray:"3 3",stroke:"#f3f4f6"}),e.jsx(_s,{dataKey:"name",stroke:"#6b7280",fontSize:10,angle:-45,textAnchor:"end",height:80,tickFormatter:e=>e.length>12?e.substring(0,12)+"...":e}),e.jsx(ks,{stroke:"#6b7280",fontSize:12,tickFormatter:e=>Dt(e,"â‚º")}),e.jsx(Ss,{formatter:e=>[Dt(e,"â‚º"),"Volume"],contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(Ps,{dataKey:"volume",fill:"#3b82f6",radius:[4,4,0,0]})]})})})})]}),e.jsxs(Ee,{children:[e.jsxs(ls,{children:[e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-5 w-5 text-blue-600"}),t("clients_page.currency_distribution")]}),e.jsx(cs,{children:t("clients_page.volume_breakdown_currency")})]}),e.jsx(os,{children:e.jsx("div",{className:"h-80",children:e.jsx(Ns,{width:"100%",height:"100%",children:e.jsxs(Rs,{data:(()=>{const e=N.reduce((e,s)=>{const t=s.currency||"Unknown";return e[t]||(e[t]={currency:t,volume:0,count:0}),e[t].volume+=Math.abs(s.amount),e[t].count+=1,e},{});return Object.values(e).sort((e,s)=>s.volume-e.volume)})(),children:[e.jsx(ws,{strokeDasharray:"3 3",stroke:"#f3f4f6"}),e.jsx(_s,{dataKey:"currency",stroke:"#6b7280",fontSize:12}),e.jsx(ks,{stroke:"#6b7280",fontSize:12,tickFormatter:e=>Dt(e,"â‚º")}),e.jsx(Ss,{formatter:e=>[Dt(e,"â‚º"),"Volume"],contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(Ps,{dataKey:"volume",fill:"#8b5cf6",radius:[4,4,0,0]})]})})})})]})]})]}),e.jsx(us,{value:"clients",className:"mt-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"px-8 py-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-xl flex items-center justify-center",children:e.jsx($,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:t("clients_page.client_information")}),e.jsx("p",{className:"text-sm text-gray-500",children:t("clients_page.manage_client_relationships")})]})]}),e.jsx("div",{className:"flex items-center gap-3"})]})}),e.jsx("div",{className:"p-8",children:S?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-600"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:t("clients_page.client")}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:t("clients_page.company")}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:t("clients.total_amount")}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:t("clients_page.transactions")}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:t("clients_page.last_transaction")}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:t("common.actions")})]})}),e.jsx("tbody",{children:Ot.length>0?Ot.map((s,a)=>e.jsx(c.Fragment,{children:e.jsxs("tr",{className:"border-b border-gray-50 hover:bg-gray-50 hover:scale-[1.01] transition-all duration-300 ease-in-out cursor-pointer",children:[e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-gray-600",children:s.client_name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.client_name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.company_name||t("common.na","N/A")})]})]})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("div",{className:"text-sm text-gray-900",children:s.company_name||t("common.na","N/A")})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:Dt(s.total_amount,"TL")})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("div",{className:"text-sm text-gray-600",children:s.transaction_count})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("div",{className:"text-sm text-gray-600",children:s.last_transaction?new Date(s.last_transaction).toLocaleDateString():t("common.na","N/A")})}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ms,{variant:"outline",size:"sm",onClick:()=>(e=>{le(e),Ws(!0)})(s),className:"text-gray-600 hover:text-gray-700",children:e.jsx(f,{className:"w-4 h-4"})}),e.jsx(ms,{variant:"outline",size:"sm",onClick:()=>(e=>{le(e),Js(!0)})(s),className:"text-green-600 hover:text-green-700",children:e.jsx(L,{className:"w-4 h-4"})}),e.jsx(ms,{variant:"outline",size:"sm",onClick:()=>(e=>{le(e),ce(!0)})(s),className:"text-red-600 hover:text-red-700",children:e.jsx(U,{className:"w-4 h-4"})})]})})]})},a)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-12 text-center text-gray-500",children:es.client_name?t("clients_page.no_clients_matching",{name:es.client_name}):t("clients.no_clients_found")})})})]})})})]})})]}),qs&&ne&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:t("clients_page.client_details")}),e.jsx(ms,{onClick:zt,variant:"ghost",size:"icon-sm",className:"text-gray-400 hover:text-gray-600",children:e.jsx(D,{className:"h-5 w-5"})})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-accent-100 rounded-full flex items-center justify-center",children:e.jsx(y,{className:"h-8 w-8 text-accent-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-semibold text-gray-900",children:ne.client_name}),e.jsx("p",{className:"text-gray-600",children:ne.company_name||t("clients_page.no_company")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:t("clients.total_volume")}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:Dt(ne.total_amount,Array.isArray(ne.currencies)&&ne.currencies.length>0?ne.currencies[0]:"USD")})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:t("clients_page.commissions")}),e.jsx("p",{className:"text-xl font-bold text-success-600",children:Dt(ne.total_commission,Array.isArray(ne.currencies)&&ne.currencies.length>0?ne.currencies[0]:"USD")})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:t("clients_page.net_amount")}),e.jsx("p",{className:"text-xl font-bold text-accent-600",children:Dt(ne.total_net,Array.isArray(ne.currencies)&&ne.currencies.length>0?ne.currencies[0]:"USD")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:t("clients_page.transaction_count")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ne.transaction_count})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:t("clients.avg_transaction")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Dt(ne.avg_transaction,Array.isArray(ne.currencies)&&ne.currencies.length>0?ne.currencies[0]:"USD")})]})]}),e.jsxs("div",{className:"space-y-4",children:[ne.payment_method&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t("clients_page.payment_method")}),e.jsx("p",{className:"text-sm text-gray-600",children:ne.payment_method})]})]}),ne.currencies&&ne.currencies.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:t("clients_page.currencies")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ne.currencies.map(s=>e.jsx("span",{className:"inline-flex px-3 py-1 text-sm font-medium rounded-full bg-accent-100 text-accent-800",children:s},s))})]}),ne.psps&&ne.psps.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:t("clients_page.payment_service_providers")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ne.psps.map(s=>e.jsx("span",{className:"inline-flex px-3 py-1 text-sm font-medium rounded-full bg-success-100 text-success-800",children:s},s))})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(W,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t("clients_page.last_transaction")}),e.jsx("p",{className:"text-sm text-gray-600",children:ne.last_transaction?(ra=ne.last_transaction,ra?new Date(ra).toLocaleDateString():"N/A"):t("common.na","N/A")})]})]})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-100",children:e.jsx(ms,{onClick:zt,variant:"outline",className:"w-full",children:t("common.close")})})]})}),Ys&&ne&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:t("clients_page.edit_client")}),e.jsx("button",{onClick:zt,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:e.jsx(D,{className:"h-5 w-5"})})]})}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-600 mb-6",children:t("clients_page.edit_functionality_placeholder")}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:zt,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200",children:t("common.cancel")}),e.jsx("button",{onClick:zt,className:"flex-1 px-4 py-2 bg-accent-600 text-white rounded-lg hover:bg-accent-700 transition-colors duration-200",children:t("clients_page.save_changes")})]})]})]})}),ie&&ne&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[e.jsx("div",{className:"p-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:t("clients_page.delete_client")}),e.jsx("button",{onClick:zt,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:e.jsx(D,{className:"h-5 w-5"})})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-danger-100 rounded-full flex items-center justify-center",children:e.jsx(U,{className:"h-6 w-6 text-danger-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:t("clients_page.are_you_sure")}),e.jsx("p",{className:"text-gray-600",children:t("clients_page.action_cannot_undone")})]})]}),e.jsx("p",{className:"text-gray-600 mb-6",children:t("clients_page.about_to_delete",{name:ne.client_name})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:zt,disabled:oe,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 disabled:opacity-50",children:t("common.cancel")}),e.jsx("button",{onClick:async()=>{if(ne)try{de(!0);const e=await Pe.delete(`/clients/${encodeURIComponent(ne.client_name)}`);if(e.ok)j(e=>e.filter(e=>e.client_name!==ne.client_name)),ce(!1),le(null);else{const s=await Pe.parseResponse(e);alert(s?.message||t("transactions.failed_delete_client"))}}catch(e){alert(t("transactions.failed_delete_client"))}finally{de(!1)}},disabled:oe,className:"flex-1 px-4 py-2 bg-danger-600 text-white rounded-lg hover:bg-danger-700 transition-colors duration-200 disabled:opacity-50",children:t(oe?"clients_page.deleting":"clients_page.delete_client")})]})]})]})}),fe&&Ne&&e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] overflow-hidden border border-gray-200",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(W,{className:"h-5 w-5 text-gray-700"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:t("daily_summary.title")}),e.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:Ne.date_str})]})]}),e.jsx("button",{onClick:()=>{be(!1),ve(null),Se("")},className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center hover:bg-gray-200 transition-colors duration-200",children:e.jsx(D,{className:"h-4 w-4 text-gray-600"})})]})}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-100px)]",children:we?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-300 border-t-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600 text-sm",children:t("daily_summary.loading_summary")})]})}):e.jsx("div",{className:"space-y-6",children:(()=>{const s=(e=>{if(Ne&&Ne.date===e)return{totalDeposits:Ne.total_deposits_tl||0,totalWithdrawals:Ne.total_withdrawals_tl||0,transactionCount:Ne.transaction_count||0,uniqueClients:Ne.unique_clients||0};if(Array.isArray(N)){const s=N.filter(s=>(s.date?s.date.split("T")[0]:null)===e),t=s.filter(e=>"DEP"===e.category||"Deposit"===e.category||"Investment"===e.category),a=s.filter(e=>"WD"===e.category||"Withdraw"===e.category||"Withdrawal"===e.category),r=t.reduce((e,s)=>{const t=null!==s.amount_tl&&void 0!==s.amount_tl?s.amount_tl:s.amount||0;return e+Math.abs(t)},0),n=a.reduce((e,s)=>{const t=null!==s.amount_tl&&void 0!==s.amount_tl?s.amount_tl:s.amount||0;return e+Math.abs(t)},0),l=s.length,i=new Set(s.map(e=>e.client_name).filter(e=>e)).size;if(l>0)return{totalDeposits:r,totalWithdrawals:n,transactionCount:l,uniqueClients:i}}return{totalDeposits:0,totalWithdrawals:0,transactionCount:0,uniqueClients:0}})(Ne.date),a=s.totalDeposits+s.totalWithdrawals,r=(Ne.total_deposits_tl||s.totalDeposits)-(Ne.total_withdrawals_tl||s.totalWithdrawals),n=Ne.total_commission_tl||0,l=s.transactionCount>0?a/s.transactionCount:0,i=Math.abs(r),c=i>0?n/i*100:0,o=Ne.usd_rate||42.64;let d=Ne.payment_method_totals?.BANK?.amount_usd||0;0===d&&Ne.payment_method_totals?.BANK?.amount_tl&&(d=Ne.payment_method_totals.BANK.amount_tl/o);let m=Ne.payment_method_totals?.CC?.amount_usd||0;0===m&&Ne.payment_method_totals?.CC?.amount_tl&&(m=Ne.payment_method_totals.CC.amount_tl/o);const x=Ne.payment_method_totals?.TETHER?.amount_usd||0;let h=0;Ne.payment_method_summary&&Array.isArray(Ne.payment_method_summary)&&Ne.payment_method_summary.forEach(e=>{const s=(e=>{if(!e)return"OTHER";const s=e.toLowerCase();return s.includes("bank")||s.includes("banka")||s.includes("havale")||s.includes("eft")||s.includes("iban")||s.includes("transfer")||s.includes("wire")?"BANK":s.includes("kk")||s.includes("credit")||s.includes("card")||s.includes("kredi")||s.includes("visa")||s.includes("mastercard")||s.includes("amex")?"CC":s.includes("tether")||s.includes("usdt")||s.includes("crypto")||s.includes("kasa")?"TETHER":"OTHER"})(e.name||"");if("BANK"===s||"CC"===s){let s=e.commission_usd||0;0===s&&e.commission_tl&&(s=e.commission_tl/o),h+=s}}),0===h&&(h=Ne.total_commission_usd||0);const g=d+m+x,p=d+m-h+x,y=Array.isArray(N)?N.filter(e=>(e.date?e.date.split("T")[0]:null)===Ne.date):[],j=y.reduce((e,s)=>{const t=s.client_name||"Unknown";e[t]||(e[t]={total:0,count:0});const a=null!==s.amount_tl&&void 0!==s.amount_tl?s.amount_tl:s.amount||0;return e[t].total+=Math.abs(a),e[t].count+=1,e},{}),f=Object.entries(j).map(([e,s])=>({name:e,total:s.total,count:s.count})).sort((e,s)=>s.total-e.total).slice(0,5),b=y.filter(e=>"TRY"===e.currency||"TL"===e.currency),v=y.filter(e=>"USD"===e.currency),w=b.reduce((e,s)=>{const t=null!==s.amount_tl&&void 0!==s.amount_tl?s.amount_tl:s.amount||0;return e+Math.abs(t)},0),_=v.reduce((e,s)=>{const t=s.amount_usd||s.amount||0;return e+Math.abs(t)},0);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2.5",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:t("daily_summary.total_dep")}),e.jsx(T,{className:"h-4 w-4 text-gray-400"})]}),e.jsx("p",{className:"text-3xl font-semibold text-gray-900 mb-1",children:Dt(Ne.total_deposits_tl||s.totalDeposits,"â‚º")}),e.jsxs("div",{className:"flex flex-col gap-1 text-xs text-gray-500 mt-2 pt-2 border-t border-gray-100",children:[e.jsxs("span",{children:["TRY: ",Dt(Ne.total_deposits_tl||s.totalDeposits,"â‚º")]}),e.jsxs("span",{children:["USD: $",(Ne.total_deposits_usd||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2.5",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:t("daily_summary.total_wd")}),e.jsx(B,{className:"h-4 w-4 text-gray-400"})]}),e.jsx("p",{className:"text-3xl font-semibold text-gray-900 mb-1",children:Dt(Ne.total_withdrawals_tl||s.totalWithdrawals,"â‚º")}),e.jsxs("div",{className:"flex flex-col gap-1 text-xs text-gray-500 mt-2 pt-2 border-t border-gray-100",children:[e.jsxs("span",{children:["TRY: ",Dt(Ne.total_withdrawals_tl||s.totalWithdrawals,"â‚º")]}),e.jsxs("span",{children:["USD: $",(Ne.total_withdrawals_usd||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2.5",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:t("daily_summary.net")}),e.jsx(J,{className:"h-4 w-4 text-gray-400"})]}),e.jsx("p",{className:"text-3xl font-semibold mb-1 "+(r>=0?"text-gray-900":"text-red-600"),children:Dt(r,"â‚º")}),e.jsxs("div",{className:"flex flex-col gap-1 text-xs text-gray-500 mt-2 pt-2 border-t border-gray-100",children:[e.jsxs("span",{children:["TRY: ",Dt(r,"â‚º")]}),e.jsxs("span",{children:["USD: $",((Ne.total_deposits_usd||0)-(Ne.total_withdrawals_usd||0)).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:t("daily_summary.total_bank")}),e.jsx(Y,{className:"h-4 w-4 text-gray-400"})]}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900 mb-1",children:Dt(Ne.payment_method_totals?.BANK?.amount_tl||0,"â‚º")})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:t("daily_summary.total_cc")}),e.jsx(Y,{className:"h-4 w-4 text-gray-400"})]}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900 mb-1",children:Dt(Ne.payment_method_totals?.CC?.amount_tl||0,"â‚º")})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:t("daily_summary.tether")}),e.jsx(C,{className:"h-4 w-4 text-gray-400"})]}),e.jsxs("p",{className:"text-2xl font-semibold text-gray-900 mb-1",children:["$",(Ne.payment_method_totals?.TETHER?.amount_usd||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:t("daily_summary.commission")}),e.jsx(C,{className:"h-4 w-4 text-gray-400"})]}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900 mb-1",children:Dt(n,"â‚º")}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[c.toFixed(2),"% ",t("daily_summary.of_net")]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:t("daily_summary.net_cash_usd")}),e.jsx(C,{className:"h-4 w-4 text-gray-400"})]}),e.jsxs("p",{className:"text-2xl font-semibold mb-1 "+(g>=0?"text-gray-900":"text-red-600"),children:["$",g.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:t("daily_summary.without_commission")})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:t("daily_summary.net_cash_usd_commission")}),e.jsx(C,{className:"h-4 w-4 text-gray-400"})]}),e.jsxs("p",{className:"text-2xl font-semibold mb-1 "+(p>=0?"text-gray-900":"text-red-600"),children:["$",p.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:t("daily_summary.with_commission")})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:t("daily_summary.activity")}),e.jsx($,{className:"h-4 w-4 text-gray-400"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-600",children:t("daily_summary.transactions")}),e.jsx("span",{className:"font-semibold text-gray-900",children:s.transactionCount})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-600",children:t("daily_summary.clients")}),e.jsx("span",{className:"font-semibold text-gray-900",children:s.uniqueClients})]}),s.transactionCount>0&&e.jsxs("div",{className:"flex justify-between items-center text-sm pt-1 border-t border-gray-100",children:[e.jsx("span",{className:"text-gray-600",children:t("daily_summary.avg_value")}),e.jsx("span",{className:"font-semibold text-gray-900",children:Dt(l,"â‚º")})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[null!==Ne.usd_rate&&void 0!==Ne.usd_rate&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:t("daily_summary.usd_exchange_rate")}),e.jsx(C,{className:"h-4 w-4 text-gray-400"})]}),e.jsxs("p",{className:"text-xl font-semibold text-gray-900",children:[Number(Ne.usd_rate).toFixed(2)," â‚º"]})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:t("daily_summary.currency_distribution")}),e.jsx(u,{className:"h-4 w-4 text-gray-400"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-600",children:t("daily_summary.try_volume")}),e.jsx("span",{className:"font-semibold text-gray-900",children:Dt(w,"â‚º")})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-600",children:t("daily_summary.usd_volume")}),e.jsxs("span",{className:"font-semibold text-gray-900",children:["$",_.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]}),f.length>0&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:t("daily_summary.top_client")}),e.jsx(H,{className:"h-4 w-4 text-gray-400"})]}),e.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate mb-1",children:f[0].name}),e.jsx("p",{className:"text-xs text-gray-600",children:Dt(f[0].total,"â‚º")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[Ne.psp_summary.length>0&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-3 border-b border-gray-200",children:[e.jsx(G,{className:"h-4 w-4 text-gray-600"}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:t("daily_summary.payment_service_providers")}),e.jsxs("span",{className:"ml-auto text-xs text-gray-500",children:[Ne.psp_summary.length," ",t("daily_summary.psps")]})]}),e.jsxs("div",{className:"space-y-3",children:[Ne.psp_summary.slice(0,5).map((s,a)=>{const r=s.is_tether||s.name&&(s.name.toLowerCase().includes("tether")||"TETHER"===s.name),n=r?s.gross_usd||s.amount_usd||0:s.gross_tl||s.amount_tl||0,l=r?s.commission_usd:s.commission_tl,i=r?s.net_usd:s.net_tl,c=r?"$":"â‚º";return e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-100",children:[e.jsx("div",{className:"flex justify-between items-start mb-2",children:e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s.name})})}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-2 pt-2 border-t border-gray-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-0.5",children:t("daily_summary.gross")}),e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[c,n.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-0.5",children:t("daily_summary.commission_label")}),e.jsxs("p",{className:"text-sm font-semibold text-gray-700",children:[c,l.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-0.5",children:t("daily_summary.net")}),e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[c,i.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})]})]})]})]},a)}),Ne.psp_summary.length>5&&e.jsx("div",{className:"text-center pt-2 border-t border-gray-100",children:e.jsx("span",{className:"text-xs text-gray-500",children:t("daily_summary.more_psps",{count:Ne.psp_summary.length-5})})})]})]}),Ne.payment_method_summary.length>0&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-3 border-b border-gray-200",children:[e.jsx(Y,{className:"h-4 w-4 text-gray-600"}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:t("daily_summary.payment_methods")}),e.jsxs("span",{className:"ml-auto text-xs text-gray-500",children:[Ne.payment_method_summary.length," ",t("daily_summary.methods")]})]}),e.jsxs("div",{className:"space-y-3",children:[Ne.payment_method_summary.slice(0,5).map((s,a)=>{const r=s.name&&(s.name.toLowerCase().includes("tether")||"TETHER"===s.name),n=r?s.gross_usd||s.amount_usd||0:s.gross_tl||s.amount_tl||0,l=r?s.commission_usd:s.commission_tl,i=r?s.net_usd:s.net_tl,c=r?"$":"â‚º";return e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-100",children:[e.jsx("div",{className:"flex justify-between items-start mb-2",children:e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("p",{className:"text-sm font-medium text-gray-900",children:Vt(s.name)})})}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-2 pt-2 border-t border-gray-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-0.5",children:t("daily_summary.gross")}),e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[c,n.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-0.5",children:t("daily_summary.commission_label")}),e.jsxs("p",{className:"text-sm font-semibold text-gray-700",children:[c,l.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-0.5",children:t("daily_summary.net")}),e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[c,i.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})]})]})]})]},a)}),Ne.payment_method_summary.length>5&&e.jsx("div",{className:"text-center pt-2 border-t border-gray-100",children:e.jsx("span",{className:"text-xs text-gray-500",children:t("daily_summary.more_methods",{count:Ne.payment_method_summary.length-5})})})]})]})]})]})})()})})]})}),Zs&&rt&&e.jsx(Ue,{isOpen:Zs,onClose:()=>st(!1),title:t("transactions.view_transaction"),children:e.jsx($e,{transaction:rt})}),tt&&rt&&e.jsx(Ue,{isOpen:tt,onClose:()=>at(!1),title:t("transactions.edit_transaction"),children:e.jsx(Gs,{transaction:rt,onSave:e=>{v(s=>s.map(s=>s.id===e.id?e:s)),ye[e.client_name]&&je(s=>({...s,[e.client_name]:s[e.client_name].map(s=>s.id===e.id?e:s)})),Ne&&Ne.date===e.date&&ea(e.date),at(!1),window.dispatchEvent(new CustomEvent("transactionsUpdated",{detail:{action:"update",transactionId:e.id,skipCurrentPage:!0}}))},onCancel:()=>at(!1),dropdownOptions:Qe})}),ot&&e.jsx(Ue,{isOpen:ot,onClose:()=>dt(!1),title:t("transactions.import_guide"),size:"lg",children:e.jsxs("div",{className:"space-y-6 max-h-96 overflow-y-auto",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-800 mb-2",children:"âœ… Supported File Formats:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full font-medium",children:"CSV (Fully Supported)"}),e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full font-medium",children:"XLSX (Fully Supported)"}),e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full font-medium",children:"XLS (Fully Supported)"}),e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full font-medium",children:"XLSM (Fully Supported)"})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-800 mb-2",children:"ðŸŽ¯ Essential vs Optional Fields:"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"font-medium text-green-700 mb-1",children:"âœ… Essential Fields (Recommended):"}),e.jsxs("ul",{className:"text-green-600 space-y-1",children:[e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Client"})," - Client's full name"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Amount"})," - Transaction amount"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Company"})," - Company name"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Payment Method"})," - How payment was made"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Category"})," - Transaction category"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Currency"})," - Transaction currency"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"PSP"})," - Payment service provider"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Date"})," - Transaction date"]})]})]}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-medium text-gray-700 mb-1",children:"â“ Optional Fields:"}),e.jsxs("ul",{className:"text-gray-600 space-y-1",children:[e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Commission"})," - Auto-calculated if not provided"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Net Amount"})," - Auto-calculated if not provided"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Notes"})," - Additional transaction details"]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-800 mb-2",children:"ðŸ“‹ Essential Column Structure (in exact order):"}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 text-xs font-mono text-gray-700 overflow-x-auto",children:[e.jsxs("div",{className:"grid grid-cols-9 gap-1 text-center font-medium text-gray-600 mb-2",children:[e.jsx("div",{className:"col-span-1",children:"1"}),e.jsx("div",{className:"col-span-1",children:"2"}),e.jsx("div",{className:"col-span-1",children:"3"}),e.jsx("div",{className:"col-span-1",children:"4"}),e.jsx("div",{className:"col-span-1",children:"5"}),e.jsx("div",{className:"col-span-1",children:"6"}),e.jsx("div",{className:"col-span-1",children:"7"}),e.jsx("div",{className:"col-span-1",children:"8"}),e.jsx("div",{className:"col-span-1",children:"9"})]}),e.jsxs("div",{className:"grid grid-cols-9 gap-1 text-center",children:[e.jsx("div",{className:"col-span-1",children:"Client"}),e.jsx("div",{className:"col-span-1",children:"Company"}),e.jsx("div",{className:"col-span-1",children:"Payment"}),e.jsx("div",{className:"col-span-1",children:"Category"}),e.jsx("div",{className:"col-span-1",children:"Amount"}),e.jsx("div",{className:"col-span-1",children:"Currency"}),e.jsx("div",{className:"col-span-1",children:"PSP"}),e.jsx("div",{className:"col-span-1",children:"Date"})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[e.jsx("div",{className:"text-xs text-gray-600 text-center mb-2",children:"Optional Columns (if needed):"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1 text-center text-xs",children:[e.jsx("div",{className:"col-span-1",children:"10"}),e.jsx("div",{className:"col-span-1",children:"11"}),e.jsx("div",{className:"col-span-1",children:"12"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-1 text-center text-xs",children:[e.jsx("div",{className:"col-span-1",children:"Commission"}),e.jsx("div",{className:"col-span-1",children:"Net Amount"}),e.jsx("div",{className:"col-span-1",children:"Notes"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-800 mb-2",children:"ðŸ’¡ Example File Formats:"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-2",children:"ðŸ“„ CSV Format (Essential Columns):"}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 text-xs font-mono text-gray-700 overflow-x-auto",children:[e.jsx("div",{className:"text-gray-600 font-medium mb-1",children:"Essential Header Row:"}),e.jsx("div",{className:"text-gray-800",children:"Client,Company,Payment Method,Category,Amount,Currency,PSP,Date"}),e.jsx("div",{className:"text-gray-600 font-medium mt-2 mb-1",children:"Essential Data Row (Example):"}),e.jsx("div",{className:"text-gray-800",children:"John Doe,ABC Corp,Credit Card,DEP,1000.50,USD,Stripe,2025-08-18"}),e.jsxs("div",{className:"mt-3 pt-2 border-t border-gray-200",children:[e.jsx("div",{className:"text-gray-600 font-medium mb-1",children:"Full Header Row (with optional columns):"}),e.jsx("div",{className:"text-gray-800",children:"Client,Company,Payment Method,Category,Amount,Commission,Net Amount,Currency,PSP,Date,Notes"}),e.jsx("div",{className:"text-gray-600 font-medium mt-2 mb-1",children:"Full Data Row (Example):"}),e.jsx("div",{className:"text-gray-800",children:"John Doe,ABC Corp,Credit Card,DEP,1000.50,25.00,975.50,USD,Stripe,2025-08-18,Monthly payment"})]})]})]}),e.jsxs("div",{children:[e.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-2",children:"ðŸ“Š Excel Format (XLSX/XLS/XLSM):"}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 text-xs font-mono text-gray-700 overflow-x-auto",children:[e.jsx("div",{className:"text-gray-600 font-medium mb-1",children:"Essential Column Structure:"}),e.jsx("div",{className:"text-gray-800",children:"Column A: Client | Column B: Company | Column C: Payment Method"}),e.jsx("div",{className:"text-gray-800",children:"Column D: Category | Column E: Amount | Column F: Currency | Column G: PSP | Column H: Date"}),e.jsxs("div",{className:"mt-3 pt-2 border-t border-gray-200",children:[e.jsx("div",{className:"text-gray-600 font-medium mb-1",children:"Optional Columns (if needed):"}),e.jsx("div",{className:"text-gray-800",children:"Column J: Commission | Column K: Net Amount | Column L: Notes"})]}),e.jsx("div",{className:"text-gray-600 font-medium mt-2 mb-1",children:"ðŸ’¡ Tip: Excel files are automatically parsed - just ensure your first row contains headers!"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-800 mb-2",children:"ðŸ“¥ Download Template Examples:"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{className:"text-sm font-medium text-green-700 mb-2",children:"âœ… Essential Template (9 columns):"}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[e.jsxs("div",{className:"text-sm text-green-800 mb-2",children:[e.jsx("strong",{children:"Perfect for most imports:"})," Contains only the essential columns needed for complete transaction data."]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>aa("essential","csv"),className:"px-3 py-1.5 bg-green-600 text-white text-xs rounded-lg hover:bg-green-700 transition-colors duration-200 flex items-center gap-1",children:[e.jsx(F,{className:"w-3 h-3"}),"Download CSV Template"]}),e.jsxs("button",{onClick:()=>aa("essential","xlsx"),className:"px-3 py-1.5 bg-green-600 text-white text-xs rounded-lg hover:bg-green-700 transition-colors duration-200 flex items-center gap-1",children:[e.jsx(F,{className:"w-3 h-3"}),"Download Excel Template"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-2",children:"ðŸ“‹ Full Template (12 columns):"}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:[e.jsxs("div",{className:"text-sm text-gray-800 mb-2",children:[e.jsx("strong",{children:"Complete template:"})," Includes all columns including commission, net amount, and notes for advanced users."]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>aa("full","csv"),className:"px-3 py-1.5 bg-gray-600 text-white text-xs rounded-lg hover:bg-gray-700 transition-colors duration-200 flex items-center gap-1",children:[e.jsx(F,{className:"w-3 h-3"}),"Download CSV Template"]}),e.jsxs("button",{onClick:()=>aa("full","xlsx"),className:"px-3 py-1.5 bg-gray-600 text-white text-xs rounded-lg hover:bg-gray-700 transition-colors duration-200 flex items-center gap-1",children:[e.jsx(F,{className:"w-3 h-3"}),"Download Excel Template"]})]})]})]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[e.jsx("h6",{className:"text-sm font-medium text-green-800 mb-1",children:"ðŸ§® Smart Import Features:"}),e.jsxs("ul",{className:"text-sm text-green-700 space-y-1",children:[e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Essential 9 columns"})," provide complete transaction data"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Commission & Net Amount"})," are auto-calculated if not provided"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Transaction summaries"})," are automatically generated"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Client statistics"})," are updated in real-time"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Flexible import"})," - use 9 essential columns or all 12 columns"]}),e.jsxs("li",{children:["â€¢ Only import ",e.jsx("strong",{children:"raw data"})," - let the system handle calculations!"]})]})]})]})}),mt&&e.jsx(Ue,{isOpen:mt,onClose:()=>xt(!1),title:t("transactions.import_preview"),size:"lg",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-800 mb-2",children:"ðŸ“Š Import Summary:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-600 font-medium",children:[t("clients.total_transactions"),":"]}),e.jsx("span",{className:"ml-2 text-gray-800",children:ht.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"File Type:"}),e.jsx("span",{className:"ml-2 text-gray-800",children:"CSV"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-800 mb-3",children:"ðŸ‘€ Preview (First 5 transactions):"}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Company"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Currency"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ut.map((s,t)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900",children:s.client_name}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900",children:s.company||"-"}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm font-medium text-gray-900",children:s.amount}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500",children:s.currency}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500",children:s.category})]},t))})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>xt(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(ht&&0!==ht.length){ct(!0);try{const e=ht.map(e=>({client_name:e.client_name,company:e.company||"",payment_method:e.payment_method||"",category:e.category,amount:e.amount,commission:e.commission||0,net_amount:e.net_amount||e.amount,currency:e.currency||"TL",psp:e.psp||"",notes:e.notes||"",date:e.date||(new Date).toISOString().split("T")[0]})),s=await Pe.post("/transactions/bulk-import",{transactions:e});if(s.ok){const e=await Pe.parseResponse(s);let t="Import completed successfully!\n\n";t+="ðŸ“Š Import Summary:\n",t+=`âœ… Successfully imported: ${e.data.successful_imports} transactions\n`,t+=`âŒ Failed imports: ${e.data.failed_imports} transactions\n`,t+=`âš ï¸ Duplicates skipped: ${e.data.skipped_duplicates} transactions\n`,t+=`ðŸ“ Total rows processed: ${e.data.total_rows}\n`,e.data.warnings&&e.data.warnings.length>0&&(t+="\nâš ï¸ Warnings:\n",e.data.warnings.slice(0,5).forEach(e=>{t+=`â€¢ ${e}\n`}),e.data.warnings.length>5&&(t+=`â€¢ ... and ${e.data.warnings.length-5} more warnings\n`)),e.data.errors&&e.data.errors.length>0&&(t+="\nâŒ Errors:\n",e.data.errors.slice(0,5).forEach(e=>{t+=`â€¢ ${e}\n`}),e.data.errors.length>5&&(t+=`â€¢ ... and ${e.data.errors.length-5} more errors\n`)),e.data.summary&&(t+="\nðŸ’° Summary:\n",t+=`â€¢ Total amount imported: ${e.data.summary.total_amount?.toLocaleString()||"N/A"} â‚º\n`,t+=`â€¢ Categories imported: ${e.data.summary.categories_imported?.join(", ")||"N/A"}\n`),alert(t),xt(!1),gt([]),pt([]),"transactions"===Us&&vt(),St()}else alert(`${t("transactions.import_failed")}: ${s.statusText||"Unknown error"}`)}catch(e){alert(`${t("transactions.import_error")}: ${e.message||"Unknown error occurred"}`)}finally{ct(!1)}}else alert(t("transactions.no_data_import"))},disabled:it,className:"px-4 py-2 text-sm font-medium text-white bg-gray-600 border border-transparent rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 disabled:opacity-50 disabled:cursor-not-allowed",children:it?"Importing...":`Import ${ht.length} Transactions`})]})]})}),yt&&e.jsx(Ue,{isOpen:yt,onClose:()=>{jt(!1),bt("")},title:t("clients_page.paste_import_transactions"),size:"lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Format:"})," Tab-separated values (her satÄ±r bir transaction)",e.jsx("br",{}),e.jsx("strong",{children:"Kolonlar:"})," MÃ¼ÅŸteri AdÄ± | Ã–deme YÃ¶ntemi | Åžirket | ORDER | Tarih (DD.MM.YYYY) | Kategori (YATIRIM/Ã‡EKME) | Tutar | Komisyon | Net Tutar | Para Birimi | PSP | MÃœÅžTERÄ°"]})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"pasteData",className:"block text-sm font-medium text-gray-700 mb-2",children:"Transaction Verileri (Tab-separated):"}),e.jsx("textarea",{id:"pasteData",value:ft,onChange:e=>bt(e.target.value),placeholder:"Verileri buraya yapÄ±ÅŸtÄ±rÄ±n...",className:"w-full h-64 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 font-mono text-sm"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[ft.split("\n").filter(e=>e.trim()).length," satÄ±r tespit edildi"]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>{jt(!1),bt("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Ä°ptal"}),e.jsx("button",{onClick:async()=>{if(ft.trim())try{const e=(e=>{const s=[],t=e.trim().split("\n"),a=e=>{const s=e.replace(/\./g,"").replace(",",".");return parseFloat(s)||0},r=e=>{try{const s=e.split(".");if(3===s.length){const e=s[0].padStart(2,"0"),t=s[1].padStart(2,"0");return`${s[2]}-${t}-${e}`}return null}catch{return null}},n=e=>{const s=e.trim().toUpperCase();return"YATIRIM"===s?"DEP":"Ã‡EKME"===s?"WD":"DEP"};for(const l of t){if(!l.trim())continue;const e=l.split("\t");if(e.length<12)continue;const t=e[0].trim(),i=e[1].trim(),c=e[2].trim(),o=e[4].trim(),d=e[5].trim(),m=e[6].trim(),x=e[7].trim(),h=e[8].trim(),g=e[9].trim(),u=e[10].trim(),p=r(o);if(!p)continue;const y=n(d);let j=a(m);const f=a(x);let b=a(h);"WD"===y&&j>0&&(j=-j,b=-b);const N={id:0,client_name:t,company:c||"Unknown",payment_method:i,category:y,date:p,amount:j,commission:f,net_amount:b,currency:g,psp:u,notes:""};"USD"===g&&(N.exchange_rate=42.6),s.push(N)}return s})(ft);if(0===e.length)return void alert("Parse edilen transaction bulunamadÄ±. LÃ¼tfen veri formatÄ±nÄ± kontrol edin.");ct(!0);const s=e.map(e=>({client_name:e.client_name,company:e.company||"",payment_method:e.payment_method||"",category:e.category,amount:e.amount,commission:e.commission||0,net_amount:e.net_amount||e.amount,currency:e.currency||"TL",psp:e.psp||"",notes:e.notes||"",date:e.date||(new Date).toISOString().split("T")[0],exchange_rate:e.exchange_rate})),t=await Pe.post("/transactions/bulk-import",{transactions:s});if(t.ok){const e=await Pe.parseResponse(t);let s="Import tamamlandÄ±!\n\n";s+=`âœ… BaÅŸarÄ±lÄ±: ${e.data.successful_imports} transaction\n`,s+=`âŒ BaÅŸarÄ±sÄ±z: ${e.data.failed_imports} transaction\n`,s+=`âš ï¸ AtlandÄ±: ${e.data.skipped_duplicates} transaction\n`,s+=`ðŸ“ Toplam iÅŸlenen: ${e.data.total_rows} satÄ±r\n`,e.data.warnings&&e.data.warnings.length>0&&(s+="\nâš ï¸ UyarÄ±lar:\n",e.data.warnings.slice(0,5).forEach(e=>{s+=`â€¢ ${e}\n`})),e.data.errors&&e.data.errors.length>0&&(s+="\nâŒ Hatalar:\n",e.data.errors.slice(0,5).forEach(e=>{s+=`â€¢ ${e}\n`})),alert(s),jt(!1),bt(""),"transactions"===Us&&await vt(),await St(),await Jt()}else{const e=await Pe.parseResponse(t);alert(`Import baÅŸarÄ±sÄ±z: ${e.error||"Bilinmeyen hata"}`)}}catch(e){alert(`Import hatasÄ±: ${e.message||"Bilinmeyen hata oluÅŸtu"}`)}finally{ct(!1)}else alert("LÃ¼tfen veri yapÄ±ÅŸtÄ±rÄ±n")},disabled:it||!ft.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 border border-transparent rounded-md hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed",children:it?"Importing...":"Import Et"})]})]})}),me&&e.jsx(Ue,{isOpen:me,onClose:()=>xe(!1),title:t("transactions.bulk_delete_all"),size:"md",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(A,{className:"w-5 h-5 text-red-600"}),e.jsx("h5",{className:"text-sm font-medium text-red-800",children:"âš ï¸ DANGER ZONE"})]}),e.jsxs("p",{className:"text-sm text-red-700",children:["This action will ",e.jsx("strong",{children:"permanently delete ALL transactions"})," from the system. This action cannot be undone and will affect all client data, reports, and analytics."]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmationCode",className:"block text-sm font-medium text-gray-700 mb-2",children:"Enter Confirmation Code:"}),e.jsx("input",{type:"text",id:"confirmationCode",value:he,onChange:e=>ge(e.target.value),placeholder:"Enter 4-digit code",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-gray-500",maxLength:4,autoComplete:"off"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"You must enter the exact 4-digit confirmation code to proceed with deletion."})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>xe(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if("4561"===he){if(confirm(t("transactions.confirm_delete_all"))){pe(!0);try{const s=await Pe.post("/transactions/bulk-delete",{confirmation_code:he});if(s.ok){const a=await Pe.parseResponse(s);alert(t("transactions.deleted_success").replace("{count}",a.data.deleted_count)),xe(!1),ge(""),qt(null),Wt(0);try{localStorage.removeItem("pipeline_transactions_data"),localStorage.removeItem("pipeline_clients_data"),localStorage.removeItem("pipeline_dashboard_cache")}catch(e){}v([]),j([]),x.current=!1,await Nt(),await Jt()}else{const e=await Pe.parseResponse(s);alert(`${t("transactions.bulk_delete_failed")}: ${e.error||"Unknown error"}`)}}catch(s){alert(`${t("transactions.bulk_delete_failed")}: ${s.message||"Unknown error"}`)}finally{pe(!1)}}}else alert(t("transactions.invalid_confirmation_code"))},disabled:ue||"4561"!==he,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed",children:ue?"Deleting...":"Delete All Transactions"})]})]})}),Te&&e.jsx(Ue,{isOpen:Te,onClose:Zt,title:`${t("exchange_rates.edit_rate")} - ${Le}`,size:"md",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ee,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center",children:e.jsx(b,{className:"w-4 h-4 text-gray-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-1",children:t("clients.exchange_rate_modal.exchange_rate_label")}),e.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:t("clients.exchange_rate_modal.description",{date:Le})})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t("clients.exchange_rate_modal.exchange_rate_label")}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(rs,{type:"number",step:"0.0001",min:"0",value:Me,onChange:e=>Ie(e.target.value),className:"flex-1",placeholder:t("clients.exchange_rate_modal.enter_rate_placeholder"),disabled:Be}),e.jsxs(Re,{onClick:()=>{Ke(!0),Ye(Le)},disabled:Be,variant:"secondary",className:"flex items-center gap-2 whitespace-nowrap",children:[e.jsx(X,{className:"w-4 h-4"}),t("clients.exchange_rate_modal.select_date")]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:t("clients.exchange_rate_modal.rate_example")})]}),Me&&parseFloat(Me)>0&&e.jsxs(Ee,{className:"p-4",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-3",children:t("clients.exchange_rate_modal.preview")}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100 last:border-b-0",children:[e.jsx("span",{className:"text-sm text-gray-600",children:t("clients.exchange_rate_modal.new_rate")}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["1 USD = ",parseFloat(Me).toFixed(4)," TRY"]})]}),e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:t("clients.exchange_rate_modal.inverse")}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["1 TRY = ",(1/parseFloat(Me)).toFixed(6)," USD"]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(Re,{onClick:Zt,disabled:Be,variant:"outline",children:t("common.cancel")}),e.jsx(Re,{onClick:async()=>{if(Le&&Me)try{He(!0);const e=parseFloat(Me);if(isNaN(e)||e<=0)return void alert(t("transactions.invalid_rate"));De(s=>({...s,[Le]:{...s[Le],rate:e}}));const s=await Pe.put(`/exchange-rates/${Le}`,{rate:e});if(s.ok)await Pe.parseResponse(s),await vt(),await Et(N),Zt(),alert(t("transactions.rate_updated_success").replace("{date}",Le));else{await Et(N);const e=await Pe.parseResponse(s);alert(`${t("transactions.failed_update_rate")}: ${e.error||"Unknown error"}`)}}catch(e){await Et(N),alert(t("transactions.failed_save_rate"))}finally{He(!1)}},disabled:Be||!Me||parseFloat(Me)<=0,variant:"primary",children:t(Be?"clients.exchange_rate_modal.saving":"clients.exchange_rate_modal.save_rate")})]})]})}),qe&&e.jsx(Ue,{isOpen:qe,onClose:()=>Ke(!1),title:t("exchange_rates.select_date"),size:"sm",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(Ee,{className:"p-4 text-center",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 rounded-full bg-gray-100",children:e.jsx(X,{className:"w-6 h-6 text-gray-600"})}),e.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-2",children:t("clients.exchange_rate_modal.choose_date")}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:t("clients.exchange_rate_modal.select_date_description")}),e.jsx(rs,{type:"date",value:We,onChange:e=>Ye(e.target.value),className:"w-full max-w-xs mx-auto",max:(new Date).toISOString().split("T")[0]})]}),e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsx(Re,{onClick:()=>Ke(!1),variant:"outline",children:t("common.cancel")}),e.jsx(Re,{onClick:()=>(async e=>{if(e)try{He(!0),Ke(!1);const s=await Pe.post(`/exchange-rates/${e}/fetch`);if(s.ok){const a=await Pe.parseResponse(s);if(a.success&&a.data){const s=a.data.rate;Ie(s.toString()),Oe(e)}else alert(t("transactions.yfinance_failed"))}else alert(t("transactions.yfinance_failed"))}catch(s){alert(t("transactions.yfinance_error"))}finally{He(!1)}})(We),disabled:!We||Be,variant:"primary",children:t(Be?"clients.exchange_rate_modal.fetching":"clients.exchange_rate_modal.get_rate")})]})]})})]})]});var ra}},Symbol.toStringTag,{value:"Module"})),ct=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{clientName:t}=ee(),a=o(),l=d(),{t:i}=Ve(),{isAuthenticated:c,isLoading:m}=Je(),{error:x}=Oe(),[h,g]=s.useState(null),[u,p]=s.useState(!0),[y,j]=s.useState("overview"),f=async()=>{const e=(()=>{if(t)try{return decodeURIComponent(t.replace(/\+/g," "))}catch(a){return t}const e=new URLSearchParams(l.search),s=e.get("client_name")||e.get("client")||"";if(s)try{return decodeURIComponent(s.replace(/\+/g," "))}catch(a){return s}return""})();if(!e)return x("Client name is required"),void a("/clients");p(!0);try{const t=await Pe.get(`/transactions/client-details/${encodeURIComponent(e)}`);if(t.ok){const e=await Pe.parseResponse(t);if(e.client_name)try{e.client_name=decodeURIComponent(e.client_name)}catch(s){}g(e),Ae.info("Client details loaded:",e.client_name)}else x("Failed to load client details"),a("/clients")}catch(r){Ae.error("Error fetching client details:",r),x(r.message||"Failed to load client details"),a("/clients")}finally{p(!1)}};if(s.useEffect(()=>{c&&!m&&f()},[c,m,t,l.search]),u)return e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-gray-300 border-t-gray-900 rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading client details..."})]})});if(!h)return e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Client not found"}),e.jsx(Re,{onClick:()=>a("/clients"),icon:e.jsx(n,{className:"w-4 h-4"}),children:"Back to Clients"})]})});const{statistics:b,metadata:N,transactions:v}=h;return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(ps,{items:[{label:i("navigation.dashboard"),href:"/dashboard"},{label:i("navigation.clients"),href:"/clients"},{label:h.client_name}]}),e.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Re,{variant:"ghost",size:"sm",onClick:()=>a("/clients"),icon:e.jsx(n,{className:"w-4 h-4"}),className:"text-gray-700 hover:text-gray-900",children:"Back"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900 flex items-center gap-2",children:h.client_name}),h.company_name&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:h.company_name})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Re,{variant:"outline",size:"sm",onClick:f,icon:e.jsx(r,{className:"w-4 h-4"}),className:"text-gray-700 border-gray-300 hover:bg-gray-50",children:"Refresh"}),e.jsx(Re,{variant:"outline",size:"sm",onClick:()=>a(`/clients?client_name=${encodeURIComponent(h.client_name)}&tab=clients`),icon:e.jsx(L,{className:"w-4 h-4"}),className:"text-gray-700 border-gray-300 hover:bg-gray-50",children:"Edit"})]})]})]}),e.jsxs(Me,{cols:4,gap:"md",className:"mb-6",children:[e.jsx(Ee,{variant:"flat",className:"border border-gray-200",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Total Volume"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:ze(b.total_amount,"TRY")})]})}),e.jsx(Ee,{variant:"flat",className:"border border-gray-200",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Total Commission"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:ze(b.total_commission,"TRY")})]})}),e.jsx(Ee,{variant:"flat",className:"border border-gray-200",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Net Amount"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:ze(b.total_net,"TRY")})]})}),e.jsx(Ee,{variant:"flat",className:"border border-gray-200",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Transactions"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:b.transaction_count})]})})]}),e.jsxs(Me,{cols:3,gap:"md",className:"mb-6",children:[e.jsx(Ee,{variant:"flat",className:"border border-gray-200",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Total Deposits"}),e.jsx("p",{className:"text-xl font-semibold text-gray-900",children:ze(b.total_deposits,"TRY")})]})}),e.jsx(Ee,{variant:"flat",className:"border border-gray-200",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Total Withdrawals"}),e.jsx("p",{className:"text-xl font-semibold text-gray-900",children:ze(b.total_withdrawals,"TRY")})]})}),e.jsx(Ee,{variant:"flat",className:"border border-gray-200",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Average Transaction"}),e.jsx("p",{className:"text-xl font-semibold text-gray-900",children:ze(b.avg_transaction,"TRY")})]})})]}),e.jsxs(xs,{value:y,onValueChange:e=>j(e),className:"w-full",children:[e.jsxs(hs,{className:"grid w-full grid-cols-2 bg-white border-b border-gray-200 rounded-none h-auto p-0",children:[e.jsx(gs,{value:"overview",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-gray-900 data-[state=active]:bg-transparent data-[state=active]:text-gray-900 py-3 px-4",children:"Overview"}),e.jsxs(gs,{value:"transactions",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-gray-900 data-[state=active]:bg-transparent data-[state=active]:text-gray-900 py-3 px-4",children:["Transactions (",v.length,")"]})]}),e.jsx(us,{value:"overview",className:"mt-6",children:e.jsxs(Me,{cols:2,gap:"md",children:[e.jsx(Ee,{variant:"flat",className:"border border-gray-200",header:{title:"Client Information",description:"Payment methods, currencies, and providers"},children:e.jsxs("div",{className:"space-y-5",children:[N.currencies.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Currencies"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:N.currencies.map(s=>e.jsx(Fe,{variant:"outline",className:"bg-white border-gray-300 text-gray-700",children:s},s))})]}),N.payment_methods.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Payment Methods"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:N.payment_methods.map(s=>e.jsx(Fe,{variant:"outline",className:"bg-white border-gray-300 text-gray-700",children:s},s))})]}),N.psps.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Payment Service Providers"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:N.psps.map(s=>e.jsx(Fe,{variant:"outline",className:"bg-white border-gray-300 text-gray-700",children:s},s))})]}),N.categories.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Categories"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:N.categories.map(s=>e.jsx(Fe,{variant:"outline",className:"bg-white border-gray-300 text-gray-700",children:s},s))})]})]})}),e.jsx(Ee,{variant:"flat",className:"border border-gray-200",header:{title:"Transaction Timeline",description:"First and last transaction dates"},children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-3 pb-4 border-b border-gray-100",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"First Transaction"}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:b.first_transaction?new Date(b.first_transaction).toLocaleDateString():"N/A"})]})}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Last Transaction"}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:b.last_transaction?new Date(b.last_transaction).toLocaleDateString():"N/A"})]})})]})})]})}),e.jsx(us,{value:"transactions",className:"mt-6",children:e.jsx(Ee,{variant:"flat",className:"border border-gray-200",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-3 px-4 text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Date"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Category"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Payment Method"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs font-medium text-gray-500 uppercase tracking-wide",children:"PSP"}),e.jsx("th",{className:"text-right py-3 px-4 text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Amount"}),e.jsx("th",{className:"text-right py-3 px-4 text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Commission"}),e.jsx("th",{className:"text-right py-3 px-4 text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Net Amount"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Currency"})]})}),e.jsx("tbody",{children:v.map(s=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"py-3 px-4 text-sm text-gray-900",children:s.date?new Date(s.date).toLocaleDateString():"N/A"}),e.jsx("td",{className:"py-3 px-4",children:e.jsx(Fe,{variant:"outline",size:"sm",className:"bg-white border-gray-300 text-gray-700",children:s.category||"N/A"})}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:s.payment_method||"N/A"}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:s.psp||"N/A"}),e.jsx("td",{className:"py-3 px-4 text-sm text-right font-medium text-gray-900",children:ze(s.amount,s.currency||"TRY")}),e.jsx("td",{className:"py-3 px-4 text-sm text-right font-medium text-gray-900",children:ze(s.commission,s.currency||"TRY")}),e.jsx("td",{className:"py-3 px-4 text-sm text-right font-semibold text-gray-900",children:ze(s.net_amount,s.currency||"TRY")}),e.jsx("td",{className:"py-3 px-4",children:e.jsx(Fe,{variant:"outline",size:"sm",className:"bg-white border-gray-300 text-gray-700",children:s.currency||"TRY"})})]},s.id))})]})})})})]})]})})}},Symbol.toStringTag,{value:"Module"})),ot={primary:{iconBg:"bg-blue-50",icon:"text-blue-600",accent:"#2D5EFF"},success:{iconBg:"bg-green-50",icon:"text-green-600",accent:"#16A34A"},warning:{iconBg:"bg-amber-50",icon:"text-amber-600",accent:"#F59E0B"},danger:{iconBg:"bg-red-50",icon:"text-red-600",accent:"#DC2626"},neutral:{iconBg:"bg-gray-50",icon:"text-gray-600",accent:"#6B7280"},turquoise:{iconBg:"bg-teal-50",icon:"text-teal-600",accent:"#2CC5A7"},gray:{iconBg:"bg-gray-50",icon:"text-gray-600",accent:"#6B7280"},green:{iconBg:"bg-green-50",icon:"text-green-600",accent:"#16A34A"},red:{iconBg:"bg-red-50",icon:"text-red-600",accent:"#DC2626"},purple:{iconBg:"bg-purple-50",icon:"text-purple-600",accent:"#7C3AED"},orange:{iconBg:"bg-orange-50",icon:"text-orange-600",accent:"#F59E0B"},indigo:{iconBg:"bg-indigo-50",icon:"text-indigo-600",accent:"#4F46E5"},teal:{iconBg:"bg-teal-50",icon:"text-teal-600",accent:"#2CC5A7"},pink:{iconBg:"bg-pink-50",icon:"text-pink-600",accent:"#EC4899"}},dt=s.memo(({title:s,value:t,icon:a,variant:r="default",color:n="primary",loading:l=!1,subtitle:i,onClick:c,className:o=""})=>{const d=ot[n]||ot.primary,m=!!c;if(l)return e.jsx(tt,{variant:r});const x=()=>{const s=a;return e.jsx(s,{style:{width:"var(--icon-default)",height:"var(--icon-default)"}})},h=`\n    enterprise-card\n    ${m?"cursor-pointer":""}\n    ${o}\n  `;switch(r){case"gradient":return e.jsxs("div",{className:`${h} enterprise-card enterprise-card-gradient`,onClick:c,children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("div",{className:"rounded-lg flex items-center justify-center backdrop-blur-sm",style:{width:"var(--space-8)",height:"var(--space-8)",backgroundColor:"rgba(255, 255, 255, 0.2)"},children:e.jsx("div",{className:"text-white",children:x()})})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"text-sm font-medium text-white/90",children:s}),e.jsx("p",{className:"text-lg font-semibold text-white",children:t}),i&&e.jsx("p",{className:"text-xs text-white/70",children:i})]})]});case"minimal":return e.jsx("div",{className:`${h} enterprise-card-compact`,onClick:c,children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`${d.iconBg} rounded-md flex items-center justify-center`,style:{width:"var(--space-6)",height:"var(--space-6)"},children:e.jsx("div",{className:d.icon,children:x()})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:s}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:t}),i&&e.jsx("p",{className:"text-xs text-gray-500",children:i})]})]})})});case"compact":return e.jsx("div",{className:`${h} enterprise-card-compact`,onClick:c,style:{padding:"var(--space-2)"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`${d.iconBg} rounded-md flex items-center justify-center`,style:{width:"var(--space-6)",height:"var(--space-6)"},children:e.jsx("div",{className:d.icon,children:x()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide truncate",children:s}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:t})}),i&&e.jsx("p",{className:"text-xs text-gray-500 truncate",children:i})]})]})});default:return e.jsxs("div",{className:h,onClick:c,children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("div",{className:`${d.iconBg} rounded-lg flex items-center justify-center`,style:{width:"var(--space-8)",height:"var(--space-8)"},children:e.jsx("div",{className:d.icon,children:x()})})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:s}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:t}),i&&e.jsx("p",{className:"text-xs text-gray-500",children:i})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 opacity-0 group-hover:opacity-100 transition-opacity duration-200",style:{backgroundColor:d.accent}})]})}});dt.displayName="StandardMetricsCard";const mt=Object.freeze(Object.defineProperty({__proto__:null,default:function(){o();const{t:t}=Ve(),[a,n]=s.useState([]),[l,i]=s.useState(""),[c,d]=s.useState("all"),[m,x]=s.useState("all"),[h,g]=s.useState("all"),[u,p]=s.useState(!1),[y,j]=s.useState(!1),[b,N]=Ks("overview"),v=()=>{try{const e=localStorage.getItem("systemDepartments");if(e)return JSON.parse(e)}catch(e){}return["Conversion","Retention","Marketing","Research","Operation","Management","Facility"]},[w,_]=s.useState(v());s.useEffect(()=>{const e=()=>{_(v())};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]);const[k,S]=s.useState({startDate:"",companyName:"",nickname:"",salary:0,insurance:!1,name:"",email:"",phone:"",role:"",department:""}),A=a.filter(e=>{const s=e.name.toLowerCase().includes(l.toLowerCase())||e.email.toLowerCase().includes(l.toLowerCase()),t="all"===c||e.status===c,a="all"===m||e.department===m,r="all"===h||e.department===h;return s&&t&&a&&r}),E=A.length,P=A.filter(e=>"active"===e.status).length,z=A.reduce((e,s)=>e+s.totalTransactions,0),B=A.length>0?Math.round(A.reduce((e,s)=>e+s.performance,0)/A.length):0,q=()=>{j(!0)},K=()=>{j(!1),S({startDate:"",companyName:"",nickname:"",salary:0,insurance:!1,name:"",email:"",phone:"",role:"",department:""})},W=(e,s)=>{S(t=>({...t,[e]:s}))};return e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx($,{className:"h-8 w-8 text-gray-600"}),"Agent Management"]}),e.jsx("p",{className:"text-gray-600",children:"Team management"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Re,{variant:"outline",size:"sm",onClick:()=>{const e=[["Name","Email","Phone","Role","Department","Status","Hire Date","Total Transactions","Performance","Company","Nickname","Salary","Insurance"].join(","),...a.map(e=>[`"${e.name}"`,`"${e.email}"`,`"${e.phone}"`,`"${e.role}"`,`"${e.department}"`,`"${e.status}"`,`"${e.hireDate}"`,e.totalTransactions,e.performance,`"${e.companyName||""}"`,`"${e.nickname||""}"`,e.salary||0,e.insurance?"Yes":"No"].join(","))].join("\n"),s=new Blob([e],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a"),r=URL.createObjectURL(s);t.setAttribute("href",r),t.setAttribute("download",`agents_export_${(new Date).toISOString().split("T")[0]}.csv`),t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t)},icon:e.jsx(F,{className:"h-4 w-4"}),iconPosition:"left",children:"Export"}),e.jsx(Re,{variant:"primary",size:"sm",onClick:q,icon:e.jsx(O,{className:"h-4 w-4"}),iconPosition:"left",children:"Add Agent"})]})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"bg-gray-50/50 border border-gray-200/60 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("span",{className:"font-medium",children:["Active Agents: ",P]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full"}),e.jsxs("span",{className:"font-medium",children:[t("dashboard.total_transactions"),": ",z.toLocaleString()]})]})]})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100/50 px-6 py-2",children:e.jsxs("nav",{className:"flex space-x-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>N("overview"),className:"tab-button px-6 py-3 rounded-xl font-medium text-sm transition-all duration-200 flex items-center gap-2 "+("overview"===b?"bg-white text-gray-600 shadow-md border border-gray-200":"text-gray-600 hover:text-gray-800 hover:bg-white/50"),children:[e.jsx(M,{className:"h-4 w-4"}),"Overview"]}),"overview"===b&&e.jsx("button",{onClick:()=>{window.location.reload()},className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-white/60 rounded-lg transition-all duration-200 hover:shadow-sm",title:"Refresh Overview data",children:e.jsx(r,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>N("agents"),className:"tab-button px-6 py-3 rounded-xl font-medium text-sm transition-all duration-200 flex items-center gap-2 "+("agents"===b?"bg-white text-gray-600 shadow-md border border-gray-200":"text-gray-600 hover:text-gray-800 hover:bg-white/50"),children:[e.jsx($,{className:"h-4 w-4"}),"Agents"]}),"agents"===b&&e.jsx("button",{onClick:()=>{window.location.reload()},className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-white/60 rounded-lg transition-all duration-200 hover:shadow-sm",title:"Refresh Agents data",children:e.jsx(r,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>N("analytics"),className:"tab-button px-6 py-3 rounded-xl font-medium text-sm transition-all duration-200 flex items-center gap-2 "+("analytics"===b?"bg-white text-gray-600 shadow-md border border-gray-200":"text-gray-600 hover:text-gray-800 hover:bg-white/50"),children:[e.jsx(I,{className:"h-4 w-4"}),"Analytics"]}),"analytics"===b&&e.jsx("button",{onClick:()=>{window.location.reload()},className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-white/60 rounded-lg transition-all duration-200 hover:shadow-sm",title:"Refresh Analytics data",children:e.jsx(r,{className:"h-4 w-4"})})]})]})})}),"overview"===b&&e.jsx("div",{children:e.jsxs(Ee,{variant:"elevated",className:"mb-6",children:[e.jsxs(ls,{children:[e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5 text-gray-600"}),"Performance Overview"]}),e.jsx(cs,{children:"Key metrics and performance indicators for your agent team"})]}),e.jsx(os,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(dt,{title:"Total Agents",value:E,subtitle:"+5.2% from last month",icon:$,color:"primary",variant:"default"}),e.jsx(dt,{title:"Active Agents",value:P,subtitle:"+8.7% from last month",icon:J,color:"success",variant:"default"}),e.jsx(dt,{title:t("dashboard.total_transactions"),value:z.toLocaleString(),subtitle:"+12.3% from last month",icon:C,color:"orange",variant:"default"}),e.jsx(dt,{title:"Avg. Performance",value:`${B}%`,subtitle:"+3.1% from last month",icon:H,color:"purple",variant:"default"})]})})]})}),"agents"===b&&e.jsx("div",{children:e.jsxs(Ee,{variant:"elevated",className:"mb-6",children:[e.jsxs(ls,{children:[e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-5 w-5 text-gray-600"}),"Agent Management"]}),e.jsx(cs,{children:"Search, filter, and manage your agent team"})]}),e.jsxs(os,{children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:[e.jsx("div",{className:"p-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-5 w-5 text-gray-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Filters"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",[l,c,m].filter(e=>e&&"all"!==e).length," ","active)"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ms,{variant:"outline",size:"sm",onClick:()=>{i(""),d("all"),x("all"),g("all")},className:"flex items-center gap-2","aria-label":"Reset filters",children:"Reset"}),e.jsxs(ms,{variant:"outline",size:"sm",onClick:()=>p(!u),className:"flex items-center gap-2","aria-label":u?"Hide filters":"Show filters",children:[e.jsx(R,{className:"h-4 w-4 transition-transform duration-200 "+(u?"rotate-180":""),"aria-hidden":"true"}),u?"Hide":"Show"," Filters"]})]})]})}),u&&e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Agents"}),e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by name or email...",value:l,onChange:e=>i(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:c,onChange:e=>d(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),e.jsxs("select",{value:m,onChange:e=>x(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",children:[e.jsx("option",{value:"all",children:"All Departments"}),w.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"px-8 py-6 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-gray-100/50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-700 rounded-xl flex items-center justify-center shadow-sm",children:e.jsx($,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Agents"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage and view all agent records"})]})]})}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("div",{className:"bg-white px-4 py-2 rounded-xl border border-gray-200 shadow-sm",children:e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[A.length," agent",1!==A.length?"s":""]})})})]})}),e.jsx("div",{className:"px-8 py-4 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-gray-100/30",children:e.jsxs("nav",{className:"flex space-x-1 overflow-x-auto",children:[e.jsxs("button",{onClick:()=>g("all"),className:"tab-button px-4 py-2 rounded-lg font-medium text-sm transition-all duration-200 flex items-center gap-2 whitespace-nowrap "+("all"===h?"bg-gray-600 text-white shadow-md":"text-gray-600 hover:text-gray-800 hover:bg-white/50"),children:[e.jsx($,{className:"h-4 w-4"}),"All Departments",e.jsx("span",{className:"ml-1 px-2 py-0.5 text-xs bg-white/20 rounded-full",children:a.length})]}),w.map(s=>{const t=(e=>{switch(e){case"Conversion":return T;case"Retention":return ne;case"Marketing":return M;case"Research":return se;case"Operation":return J;case"Management":return $;default:return G}})(s);return e.jsxs("button",{onClick:()=>g(s),className:"tab-button px-4 py-2 rounded-lg font-medium text-sm transition-all duration-200 flex items-center gap-2 whitespace-nowrap "+(h===s?"bg-gray-600 text-white shadow-md":"text-gray-600 hover:text-gray-800 hover:bg-white/50"),children:[e.jsx(t,{className:"h-4 w-4"}),s,e.jsx("span",{className:"ml-1 px-2 py-0.5 text-xs bg-white/20 rounded-full",children:a.filter(e=>e.department===s).length})]},s)})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-3 w-3"}),"Agent"]})}),e.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-3 w-3"}),"Contact"]})}),e.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-3 w-3"}),"Role & Department"]})}),e.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-3 w-3"}),"Performance"]})}),e.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-3 w-3"}),"Transactions"]})}),e.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-3 w-3"}),"Status"]})}),e.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-3 w-3"}),"Actions"]})})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:A.map((s,t)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-all duration-200 group "+(t%2==0?"bg-white":"bg-gray-50/30"),children:[e.jsx("td",{className:"px-8 py-5 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-500 to-gray-600 rounded-xl flex items-center justify-center shadow-sm",children:e.jsx("span",{className:"text-white font-semibold text-sm",children:s.name.split(" ").map(e=>e[0]).join("")})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:s.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Hired: ",new Date(s.hireDate).toLocaleDateString()]})]})]})}),e.jsxs("td",{className:"px-8 py-5 whitespace-nowrap",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-900 font-medium",children:s.email})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx(re,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-500",children:s.phone})]})]}),e.jsxs("td",{className:"px-8 py-5 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:s.role}),e.jsx("div",{className:"text-sm text-gray-500",children:s.department})]}),e.jsx("td",{className:"px-8 py-5 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2.5 mr-3",children:e.jsx("div",{className:"h-2.5 rounded-full transition-all duration-300 "+(s.performance>=90?"bg-green-500":s.performance>=70?"bg-yellow-500":"bg-red-500"),style:{width:`${s.performance}%`}})}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900 min-w-[3rem]",children:[s.performance,"%"]})]})}),e.jsx("td",{className:"px-8 py-5 whitespace-nowrap",children:e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:s.totalTransactions.toLocaleString()})}),e.jsx("td",{className:"px-8 py-5 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex px-3 py-1 text-xs font-semibold rounded-full "+("active"===s.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})}),e.jsx("td",{className:"px-8 py-5 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-50 rounded transition-colors duration-200",title:"View Details",children:e.jsx(f,{className:"h-3.5 w-3.5"})}),e.jsx("button",{className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors duration-200",title:"Edit Agent",children:e.jsx(L,{className:"h-3.5 w-3.5"})}),e.jsx("button",{className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors duration-200",title:"Delete Agent",children:e.jsx(U,{className:"h-3.5 w-3.5"})})]})})]},s.id))})]})}),0===A.length&&e.jsxs("div",{className:"text-center py-16 px-6",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx($,{className:"h-10 w-10 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:l||"all"!==c||"all"!==m||"all"!==h?"No agents found":"No agents yet"}),e.jsx("p",{className:"text-gray-500 mb-6 max-w-md mx-auto",children:l||"all"!==c||"all"!==m||"all"!==h?"Try adjusting your search criteria or filters to find what you're looking for.":"Start building your team by adding your first agent to the system."}),e.jsxs("button",{onClick:q,className:"inline-flex items-center px-6 py-3 border border-transparent rounded-lg text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors shadow-sm",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Add Your First Agent"]})]}),A.length>0&&e.jsx("div",{className:"px-6 py-4 border-t border-gray-100 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-700",children:[e.jsxs("span",{children:["Showing ",A.length," agent",1!==A.length?"s":""]}),e.jsxs("span",{className:"font-semibold",children:["Avg Performance: ",B,"%"]})]})})]})]})]})}),"analytics"===b&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Agent Analytics"}),e.jsx("p",{className:"text-gray-600",children:"Analytics content will be implemented here."})]})}),y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Add New Agent"}),e.jsx("button",{onClick:K,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:e.jsx(D,{className:"h-5 w-5"})})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),e.jsx("input",{type:"text",value:k.name,onChange:e=>W("name",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",placeholder:"Enter full name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",value:k.email,onChange:e=>W("email",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",placeholder:"Enter email address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone *"}),e.jsx("input",{type:"tel",value:k.phone,onChange:e=>W("phone",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",placeholder:"Enter phone number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date *"}),e.jsx("input",{type:"date",value:k.startDate,onChange:e=>W("startDate",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Company Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Name"}),e.jsx("input",{type:"text",value:k.companyName,onChange:e=>W("companyName",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",placeholder:"Enter company name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nickname"}),e.jsx("input",{type:"text",value:k.nickname,onChange:e=>W("nickname",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",placeholder:"Enter nickname"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Role & Department"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role *"}),e.jsxs("select",{value:k.role,onChange:e=>W("role",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",children:[e.jsx("option",{value:"",children:"Select role"}),e.jsx("option",{value:"Senior Agent",children:"Senior Agent"}),e.jsx("option",{value:"Agent",children:"Agent"}),e.jsx("option",{value:"Junior Agent",children:"Junior Agent"}),e.jsx("option",{value:"Team Lead",children:"Team Lead"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department *"}),e.jsxs("select",{value:k.department,onChange:e=>W("department",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",children:[e.jsx("option",{value:"",children:"Select department"}),w.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Financial Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Salary (â‚º)"}),e.jsx("input",{type:"number",value:k.salary,onChange:e=>W("salary",parseFloat(e.target.value)||0),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",placeholder:"Enter salary amount"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Insurance"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"insurance",checked:!0===k.insurance,onChange:()=>W("insurance",!0),className:"h-4 w-4 text-gray-600 focus:ring-gray-500 border-gray-300"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Yes"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"insurance",checked:!1===k.insurance,onChange:()=>W("insurance",!1),className:"h-4 w-4 text-gray-600 focus:ring-gray-500 border-gray-300"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"No"})]})]})]})]})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-100",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:K,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200",children:"Cancel"}),e.jsx("button",{onClick:()=>{const e={id:Date.now(),...k,status:"active",hireDate:k.startDate,totalTransactions:0,performance:85};n(s=>[...s,e]),S({startDate:"",companyName:"",nickname:"",salary:0,insurance:!1,name:"",email:"",phone:"",role:"",department:""}),j(!1)},disabled:!(k.name&&k.email&&k.phone&&k.startDate&&k.role&&k.department),className:"flex-1 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Add Agent"})]})})]})})]})]})}},Symbol.toStringTag,{value:"Module"})),xt=e=>0===e?"text-gray-500":e<=2?"text-green-600":e<=5?"text-yellow-600":e<=10?"text-orange-600":"text-red-600",ht=e=>0===e?"bg-gray-100 text-gray-600":e<=2?"bg-green-100 text-green-800":e<=5?"bg-yellow-100 text-yellow-800":e<=10?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800",gt=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{isAuthenticated:a,isLoading:n}=Je(),{t:l}=Ve(),i=o(),d=(e,s)=>"TETHER"===s.toUpperCase()?Ie(e):ze(e,"â‚º"),[m,x]=s.useState([]),[h,u]=s.useState(!0),[p,y]=s.useState(null),[j,f]=s.useState(""),[b,N]=s.useState("all"),[v,w]=s.useState(!1);s.useState(!1);const[k,S]=Ks("overview");s.useEffect(()=>{"trust"===k&&i("/trust",{replace:!0})},[k,i]);const[R,U]=s.useState(!1);s.useState("idle"),s.useState(!1);const[$,z]=s.useState(!1),[O,H]=s.useState(null),[q,K]=s.useState(null),[G,X]=s.useState([]),[Q,Z]=s.useState(!1),[ee,se]=s.useState((new Date).getFullYear()),[te,ae]=s.useState((new Date).getMonth()+1),[re,me]=s.useState(new Set),[xe,he]=s.useState(1),[ge]=s.useState(10);s.useState("30"),s.useState(""),s.useState(""),s.useState(!1);const[ue,pe]=s.useState(null),[ye,je]=s.useState([]),[fe,be]=s.useState(!1);s.useState({}),s.useState({});const[Ne,ve]=s.useState({}),[we,_e]=s.useState([]),[ke,Se]=s.useState(!1),[Ce,De]=s.useState(null),[Te,Ae]=s.useState({}),[Re,Fe]=s.useState(!1),[Le,Ue]=s.useState([]),[$e,Oe]=s.useState(!1),[Me,Be]=s.useState(null),[He,qe]=s.useState(!1),[Ke,We]=s.useState(null),[Ye,Ge]=s.useState(""),[Xe,Qe]=s.useState(!1),[Ze,es]=s.useState(!1),[ss,ts]=s.useState(null),[as,ns]=s.useState(""),[ds,ps]=s.useState(!1),[js,fs]=s.useState(""),[bs,vs]=s.useState(!1),[Cs,Es]=s.useState(null),[zs,Os]=s.useState(""),[Ms,Is]=s.useState(!1),[Bs,Hs]=s.useState(""),[qs,Ws]=s.useState({startDate:"",endDate:"",psp:"",type:"",page:1}),Ys=(e,s,t)=>{const a=((e,s)=>{const t=new Date(e,s,0).getDate(),a=[];for(let r=1;r<=t;r++){const t=new Date(e,s-1,r),n=`${e}-${String(s).padStart(2,"0")}-${String(r).padStart(2,"0")}`;a.push({date:n,day:r,dayName:t.toLocaleDateString("tr-TR",{weekday:"short"}),isWeekend:0===t.getDay()||6===t.getDay()})}return a})(s,t),r=e.daily_breakdown||[],n=new Map;return r.forEach(e=>{n.set(e.date,e)}),a.map(e=>{const s=n.get(e.date);return s?{...s,day:e.day,dayName:e.dayName,isWeekend:e.isWeekend}:{date:e.date,day:e.day,dayName:e.dayName,isWeekend:e.isWeekend,yatimim:0,cekme:0,toplam:0,komisyon:0,net:0,tahs_tutari:0,kasa_top:0,devir:0,transaction_count:0}})};s.useEffect(()=>{window.scrollTo({top:0,behavior:"instant"})},[]),s.useEffect(()=>{a&&!n&&(y(null),Vs(),"overview"===k&&Xs())},[a,n,k]),s.useEffect(()=>{"monthly"===k&&a&&!n&&(Gs(ee,te),st(qs.page))},[k,a,n,ee,te,qs.startDate,qs.endDate,qs.psp,qs.type]),s.useEffect(()=>{const e=e=>{a&&!n&&(Vs(!0),"overview"===k&&Xs(!0))};return window.addEventListener("transactionsUpdated",e),()=>{window.removeEventListener("transactionsUpdated",e)}},[a,n,k]),s.useEffect(()=>()=>{Pe.clearCacheForUrl("psp_summary_stats"),Pe.clearCacheForUrl("ledger-data")},[]);const Vs=async(e=!1)=>{try{u(!0),y(null),e&&Pe.clearCacheForUrl("psp_summary_stats");const s=await Pe.get("/transactions/psp_summary_stats");if(401===s.status)return;const t=Pe.parseResponse(s);if(200===s.status&&t){const e=(Array.isArray(t)?t:[]).map(e=>({psp:e.psp||"Unknown",total_amount:e.total_amount||0,total_commission:e.total_commission||0,total_net:e.total_net||0,total_allocations:e.total_allocations||0,total_deposits:e.total_deposits||0,total_withdrawals:e.total_withdrawals||0,transaction_count:e.transaction_count||0,commission_rate:e.commission_rate||0}));x(e)}else{const e=t&&"object"==typeof t&&"message"in t?t.message:"Failed to load PSP data";y(e),x([])}}catch(s){y(`Failed to load PSP data: ${s instanceof Error?s.message:"Unknown error"}`),x([])}finally{u(!1)}},Js=(e,s)=>{if(0===s)return"Normal";const t=e/s;return t>.3?"Critical":t>.2?"High":t>.1?"Medium":"Normal"},Gs=async(e,s,t=!1,a=!0)=>{try{Z(!0),y(null);const r=`/transactions/psp_monthly_stats?year=${e}&month=${s}${a?"&include_daily=true":"&include_daily=false"}${t?`&_t=${Date.now()}`:""}`,n=await Pe.get(r,void 0,!t);if(401===n.status)return;if(!n.ok){const e=await n.json().catch(()=>({}));throw new Error(e.message||`HTTP ${n.status}: ${n.statusText}`)}const l=await Pe.parseResponse(n);let i=[];if(Array.isArray(l))i=l;else if(l&&Array.isArray(l.data))i=l.data;else if(l&&"object"==typeof l){const e=["psps","psp_data","monthly_data","results"];for(const s of e)if(Array.isArray(l[s])){i=l[s];break}}X(i),0===i.length?y(`No PSP data available for ${new Date(e,s-1).toLocaleString("default",{month:"long",year:"numeric"})}`):y(null)}catch(r){const e=r instanceof Error?r.message:"Failed to fetch monthly data";y(e),X([])}finally{Z(!1)}},Xs=async(e=!1)=>{be(!0);try{e&&Pe.clearCacheForUrl("ledger-data");const t=await Pe.get("/analytics/ledger-data",void 0,!e);if(t.ok){const e=await Pe.parseResponse(t),s=e.ledger_data||[];je(s);const a={};if(s.forEach(e=>{Object.entries(e.psps).forEach(([s,t])=>{const r=`${e.date}-${s}`,n=t;a[r]=n.allocation||0})}),ve(a),Qs(s,m),e&&"object"==typeof e&&"validation_errors"in e){const s=e.validation_errors;Array.isArray(s)&&s.length>0?y(`Data loaded with warnings: ${s.join(", ")}`):y(null)}else y(null)}else{let e="Failed to fetch ledger data";try{const s=await Pe.parseResponse(t).catch(()=>({}));s&&"object"==typeof s&&"error"in s?e=s.error||e:404===t.status&&(e="Ledger data endpoint not found. Please check backend configuration.")}catch(s){404===t.status&&(e="Ledger data endpoint not found. Please check backend configuration.")}y(e)}}catch(t){const e=t?.message||"Network error occurred";e.includes("bulunamadÄ±")||e.includes("404")||e.includes("Not Found")?y("Endpoint bulunamadÄ±. Backend servisinin Ã§alÄ±ÅŸtÄ±ÄŸÄ±ndan emin olun."):y(`Failed to load ledger data: ${e}`),je([])}finally{be(!1)}},Qs=s.useCallback((e,s)=>{const t=new Map;e.forEach(e=>{Object.entries(e.psps).forEach(([s,a])=>{t.has(s)||t.set(s,{psp:s,total_deposits:0,total_withdrawals:0,total_net:0,total_allocations:0,total_rollover:0,transaction_count:0,average_transaction:0,last_activity:e.date_str});const r=t.get(s);r.total_deposits+=a.deposit||0,r.total_withdrawals+=a.withdraw||0,r.total_net+=a.net||0,r.transaction_count+=a.transaction_count||1,r.last_activity=e.date_str})}),t.forEach(e=>{const t=s.find(s=>s.psp===e.psp);e.total_allocations=t?.total_allocations||0,e.average_transaction=e.transaction_count>0?e.total_net/e.transaction_count:0,e.total_rollover=e.total_net-e.total_allocations});const a=Array.from(t.values());_e(a)},[]),Zs=()=>{Se(!1),De(null),Ae({})},st=async(e=1)=>{Oe(!0);try{const s=new URLSearchParams({page:e.toString(),per_page:"50"});qs.startDate&&s.append("start_date",qs.startDate),qs.endDate&&s.append("end_date",qs.endDate),qs.psp&&s.append("psp",qs.psp),qs.type&&s.append("type",qs.type);const t=await Pe.get(`/analytics/unified-history?${s}`);if(t.ok){const e=await Pe.parseResponse(t);if(e&&"object"==typeof e&&"success"in e&&e.success){const s=e.data||[];Ue(s),Be(e.pagination||null)}else e&&"object"==typeof e&&"error"in e&&y(e.error||"Failed to load history data")}else{const e=await Pe.parseResponse(t).catch(()=>({}));y(e?.error||"Failed to fetch history data")}}catch(s){const e=s instanceof Error?s.message:"Failed to fetch history data";y(e),Ue([]),Be(null)}finally{Oe(!1)}},tt=(e,s)=>{const t={...qs,[e]:s,page:1};Ws(t),st(1)},at=e=>{Ws(s=>({...s,page:e})),st(e)},rt=async e=>{try{const s=new URLSearchParams({format:e});qs.startDate&&s.append("start_date",qs.startDate),qs.endDate&&s.append("end_date",qs.endDate),qs.psp&&s.append("psp",qs.psp),qs.type&&s.append("type",qs.type);const t=await Pe.get(`/analytics/unified-history/export?${s}`,{responseType:"blob"});if(t.ok){const s=window.URL.createObjectURL(await t.blob()),a=document.createElement("a");a.href=s,a.setAttribute("download",`unified_history_${(new Date).toISOString().split("T")[0]}.${e}`),document.body.appendChild(a),a.click(),a.remove(),window.URL.revokeObjectURL(s)}}catch(s){}},nt=async(e,s,t)=>{let a=0;for(;a<=2;)try{if(a>0)try{Pe.clearToken?.(),await Pe.get("/auth/csrf-token"),await new Promise(e=>setTimeout(e,300))}catch(r){}const l=await Pe.post("/analytics/update-allocation",{date:e,psp:s,allocation:t});if(!l.ok){let e="Allocation kaydedilemedi",s="";try{const t=await Pe.parseResponse(l);if((t?.csrf_error||t?.error?.includes("CSRF")||t?.error?.includes("token")||t?.error?.includes("Security token")||t?.message?.includes("CSRF")||t?.message?.includes("token"))&&a<2){a++;continue}e=t?.error||t?.message||e,s=t?.details||t?.message||""}catch(n){if(a<2){a++;continue}e=`HTTP ${l.status}`}const t=s?`${e} - ${s}`:e;throw new Error(t)}try{return await Pe.parseResponse(l)||{success:!0}}catch(n){return{success:!0}}}catch(l){if((l?.message?.includes("CSRF")||l?.message?.includes("token")||l?.message?.includes("Security token"))&&a<2){a++,await new Promise(e=>setTimeout(e,300));continue}throw l.message?l:new Error("AÄŸ hatasÄ± veya istek baÅŸarÄ±sÄ±z oldu")}throw new Error("GÃ¼venlik token hatasÄ± - LÃ¼tfen sayfayÄ± yenileyin ve tekrar deneyin")},it=()=>{qe(!1),We(null),Ge("")},ct=()=>{es(!1),ts(null),ns(""),fs("")},ot=()=>{vs(!1),Es(null),Os(""),Hs("")},dt=()=>{z(!1),H(null),K(null),pe(null)},mt=e=>new Intl.NumberFormat("en-US").format(e),gt=Array.isArray(m)?m.filter(e=>{const s=e.psp.toLowerCase().includes(j.toLowerCase()),t="all"===b||e.psp===b;return s&&t}):[];return gt.reduce((e,s)=>e+s.total_amount,0),gt.reduce((e,s)=>e+s.total_commission,0),gt.reduce((e,s)=>e+s.total_net,0),gt.reduce((e,s)=>e+s.transaction_count,0),!Array.isArray(m)||new Set(m.map(e=>e.psp)),n||h?e.jsx(lt,{}):p?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(A,{className:"h-10 w-10 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Error Loading Data"}),e.jsx("p",{className:"text-gray-600 mb-6",children:p}),e.jsxs("button",{onClick:()=>Vs(!0),className:"inline-flex items-center gap-2 px-6 py-3 bg-accent-600 text-white rounded-lg hover:bg-accent-700 transition-colors duration-200",children:[e.jsx(r,{className:"h-4 w-4"}),"Try Again"]})]})}):e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx(ys,{title:l("ledger.psp_ledger"),description:l("ledger.psp_transactions_balances"),icon:le,actions:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(ms,{variant:"outline",size:"default",onClick:async()=>{w(!0);try{const e=[Vs(!0),Xs(!0)];"monthly"===k&&e.push(Gs(ee,te,!0)),await Promise.all(e)}finally{w(!1)}},disabled:v,className:"flex items-center gap-2 h-10 px-4 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-sm",children:[e.jsx(r,{className:"h-4 w-4 "+(v?"animate-spin":"")}),l(v?"ledger.refreshing":"ledger.refresh")]}),e.jsxs(ms,{variant:"outline",size:"default",onClick:()=>{try{const e=["Date","PSP","Deposits","Withdrawals","Total","Commission","Net","Allocation","Rollover","Risk Level"],s=[];ye.forEach(e=>{Object.entries(e.psps).forEach(([t,a])=>{const r=(a.net||0)-(a.allocation||0),n=Js(r,a.net||0);s.push([e.date_str,t,a.deposit||0,a.withdraw||0,a.toplam||0,a.komisyon||0,a.net||0,a.allocation||0,r,n])})});const t=[e,...s].map(e=>e.map(e=>`"${e}"`).join(",")).join("\n"),a=new Blob([t],{type:"text/csv;charset=utf-8;"}),r=window.URL.createObjectURL(a),n=document.createElement("a");n.href=r,n.download=`ledger_export_${(new Date).toISOString().split("T")[0]}.csv`,n.click(),window.URL.revokeObjectURL(r)}catch(e){alert(l("ledger.export_failed"))}},className:"flex items-center gap-2 h-10 px-4 hover:bg-gray-50 hover:border-gray-300 transition-all shadow-sm",children:[e.jsx(F,{className:"h-4 w-4"}),l("ledger.export")]})]})})}),e.jsx("div",{className:"p-6",children:e.jsxs(xs,{value:k,onValueChange:S,className:"w-full",children:[e.jsxs(hs,{className:"grid w-full grid-cols-3 bg-gray-50/80 border border-gray-200/60 rounded-lg shadow-sm",children:[e.jsxs(gs,{value:"overview",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg",children:[e.jsx(ie,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-gray-700"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:l("tabs.overview")})]}),e.jsxs(gs,{value:"monthly",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg",children:[e.jsx(W,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-gray-700"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:l("tabs.monthly")})]}),e.jsxs(gs,{value:"analytics",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg",children:[e.jsx(M,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-gray-700"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:l("tabs.analytics")})]})]}),e.jsxs(us,{value:"overview",className:"mt-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5 text-gray-600"}),l("ledger.psp_overview")]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:l("ledger.key_performance_all_psps")})]}),e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(et,{title:l("ledger.total_psps"),value:mt(m.length),subtitle:l("ledger.active_providers"),icon:le,color:"gray",animated:!0,animationDuration:500}),(()=>{const s=ye.reduce((e,s)=>(Object.entries(s.psps).forEach(([s,t])=>{const a=(t.net||0)-(t.allocation||0),r=Js(a,t.net||0);"Critical"===r?e.critical++:"High"===r?e.high++:"Medium"===r?e.medium++:e.normal++,e.totalRollover+=a}),e),{critical:0,high:0,medium:0,normal:0,totalRollover:0}),a=s.critical>0||s.high>0,r=a?"red":"green",n=a?t:_,i=a?`${s.critical+s.high}`:"0",c=a?`${s.critical} critical, ${s.high} high`:"Healthy levels";return e.jsx(et,{title:l("ledger.rollover_risk"),value:i,subtitle:c,icon:n,color:r,animated:!0,animationDuration:500})})(),e.jsx(et,{title:l("ledger.total_allocations"),value:ze(m.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.total_allocations),0),"â‚º"),subtitle:l("ledger.funds_allocated"),icon:Y,color:"orange",animated:!0,animationDuration:500}),e.jsx(et,{title:l("ledger.total_rollover"),value:ze(m.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.total_allocations-s.total_net),0),"â‚º"),subtitle:l("ledger.available_balance"),icon:J,color:"purple",animated:!0,animationDuration:500})]})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-gray-600"}),l("ledger.psp_overview_cards")]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:`${m.length} ${l("ledger.psp_count")} - ${l("ledger.all_available_data")}`})]}),e.jsxs("div",{children:[fe?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(s=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 space-y-4 animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-5 bg-gray-200 rounded w-24 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-100 rounded w-32"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-16 bg-gray-100 rounded"}),e.jsx("div",{className:"h-16 bg-gray-100 rounded"})]})]},s))}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map((s,t)=>{const a=(e=>{const s=[le,Y,J,de,M,V];return s[e.length%s.length]})(s.psp)||le,r=s.total_net-s.total_allocations,n=s.total_net>0?r/s.total_net*100:0,i=r>0;return e.jsxs("div",{className:"bg-white rounded-xl shadow-md hover:shadow-xl transition-all duration-300 group border border-gray-100 hover:border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-100 bg-gradient-to-br from-white to-gray-50/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center shadow-sm group-hover:shadow-md transition-shadow",children:e.jsx(a,{className:"h-6 w-6 text-gray-600 group-hover:scale-110 transition-transform"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 group-hover:text-gray-700 transition-colors",children:s.psp}),e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:l("ledger.payment_provider")})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold "+(i?"text-green-600":"text-red-600"),children:[n.toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-gray-500 font-medium",children:l("ledger.rollover_rate")})]})]})}),e.jsxs("div",{className:"p-6 space-y-4 bg-white",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-xl border border-gray-100 hover:border-gray-200 transition-all group/metric",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:l("ledger.total_deposits")}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:d(s.total_deposits,s.psp)})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:l("ledger.total_withdrawals")}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:d(s.total_withdrawals,s.psp)})]})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:l("ledger.net_amount")}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:d(s.total_net,s.psp)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:l("ledger.allocations")}),e.jsx("div",{className:"text-sm font-semibold text-warning-600",children:d(s.total_allocations,s.psp)})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:l("ledger.rollover")}),e.jsx("div",{className:"text-sm font-semibold "+(i?"text-success-600":"text-destructive-600"),children:d(r,s.psp)})]})]})]}),e.jsx("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-600",children:l("ledger.total_transactions")}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:mt(s.transaction_count)})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-600",children:l("ledger.avg_transaction")}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:d(s.transaction_count>0?s.total_net/s.transaction_count:0,s.psp)})]})]})})]},s.psp)})}),0===m.length&&!fe&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(le,{className:"h-10 w-10 text-gray-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:l("ledger.no_psp_data_available")}),e.jsx("p",{className:"text-sm text-gray-600 max-w-md mx-auto mb-6",children:l("ledger.no_psp_data_desc")}),e.jsxs("div",{className:"flex flex-col items-center gap-3 text-xs text-gray-500 max-w-sm mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full"}),e.jsx("span",{children:"Transaction data appears automatically when processed"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full"}),e.jsx("span",{children:"Use the refresh button to update statistics"})]})]})]})]})]})]}),e.jsxs(us,{value:"monthly",className:"mt-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden",children:[e.jsx("div",{className:"bg-slate-100 px-6 py-3 border-b border-slate-300",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-700 rounded-lg flex items-center justify-center",children:e.jsx(W,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 tracking-tight",children:l("ledger.monthly_psp_report")}),e.jsx("p",{className:"text-sm text-slate-600",children:l("tabs.monthly_desc")})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Year:"}),e.jsx("select",{value:ee,onChange:e=>se(parseInt(e.target.value)),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",children:Array.from({length:5},(e,s)=>(new Date).getFullYear()-s).map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Month:"}),e.jsx("select",{value:te,onChange:e=>ae(parseInt(e.target.value)),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",children:Array.from({length:12},(e,s)=>s+1).map(s=>e.jsx("option",{value:s,children:new Date(2024,s-1).toLocaleString("default",{month:"long"})},s))})]}),e.jsxs(ms,{onClick:()=>Gs(ee,te,!0),variant:"outline",size:"sm",className:"flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:Q,children:[e.jsx(r,{className:"h-4 w-4 "+(Q?"animate-spin":"")}),Q?"Refreshing...":"Refresh"]})]})]})}),Q?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r,{className:"h-5 w-5 animate-spin text-slate-600"}),e.jsx("span",{className:"text-slate-600",children:"Loading monthly data..."})]})}):p?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(A,{className:"h-8 w-8 text-red-500"})}),e.jsx("h3",{className:"text-lg font-medium text-red-900 mb-2",children:"Error Loading Monthly Data"}),e.jsx("p",{className:"text-red-600 mb-4",children:p}),e.jsxs(ms,{onClick:()=>Gs(ee,te,!0),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(r,{className:"h-4 w-4"}),"Try Again"]})]}):0===G.length?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(W,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:l("ledger.no_psp_data_available")}),e.jsx("p",{className:"text-slate-600 mb-4",children:l("ledger.no_psp_data")}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Selected: ",new Date(ee,te-1).toLocaleString("default",{month:"long",year:"numeric"})]})]}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-100 border-b border-slate-300",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider w-12"}),e.jsx("th",{className:"text-left py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[180px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-3.5 w-3.5 text-slate-600"}),l("ledger.psp_count")]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[120px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx(T,{className:"h-3.5 w-3.5 text-slate-600"}),"YATIRIM"]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[120px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx(B,{className:"h-3.5 w-3.5 text-slate-600"}),"Ã‡EKME"]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[120px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx(C,{className:"h-3.5 w-3.5 text-slate-600"}),"TOPLAM"]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[140px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[R?e.jsx("div",{className:"animate-spin h-3.5 w-3.5 border-2 border-slate-600 border-t-transparent rounded-full"}):e.jsx(J,{className:"h-3.5 w-3.5 text-slate-600"}),e.jsx("span",{children:"KOMÄ°SYON"})]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[120px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx(ne,{className:"h-3.5 w-3.5 text-slate-600"}),"NET"]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[140px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx(Y,{className:"h-3.5 w-3.5 text-slate-600"}),"TAHS TUTARI"]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[120px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx(M,{className:"h-3.5 w-3.5 text-slate-600"}),"KASA TOP"]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[120px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx(r,{className:"h-3.5 w-3.5 text-slate-600"}),"DEVÄ°R"]})})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200",children:G.filter(e=>e&&e.psp).slice((xe-1)*ge,xe*ge).map((s,t)=>e.jsxs(c.Fragment,{children:[e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"py-4 px-6",children:e.jsx("button",{onClick:()=>{return e=s.psp,void me(s=>{const t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t});var e},className:"p-1.5 hover:bg-slate-200 rounded transition-colors",title:re.has(s.psp)?"Collapse details":"Expand details",children:re.has(s.psp)?e.jsx(P,{className:"h-3.5 w-3.5 text-slate-600"}):e.jsx(ce,{className:"h-3.5 w-3.5 text-slate-600"})})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded flex items-center justify-center",children:e.jsx(le,{className:"h-4 w-4 text-slate-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-slate-900 text-sm",children:s.psp}),e.jsxs("div",{className:"text-xs text-slate-500",children:[s.transaction_count||0," txns"]})]})]})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:d(s.yatimim||0,s.psp)})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:d(s.cekme||0,s.psp)})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:d(s.toplam||0,s.psp)})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:d(s.komisyon||0,s.psp)}),void 0!==s.commission_rate&&"TETHER"!==s.psp.toUpperCase()&&e.jsxs("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-slate-200 text-slate-700",children:[s.commission_rate,"%"]})]})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:d(s.net||0,s.psp)})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:d(s.tahs_tutari||0,s.psp)})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:d(s.kasa_top||0,s.psp)})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsx("span",{className:"font-semibold text-sm "+((s.devir||0)>=0?"text-slate-900":"text-red-700"),children:d(s.devir||0,s.psp)})})]}),re.has(s.psp)&&e.jsx("tr",{className:"bg-gray-50",children:e.jsx("td",{colSpan:10,className:"py-6 px-6",children:e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-xl border border-slate-200/60 shadow-lg shadow-slate-200/20",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50 rounded-t-xl",children:e.jsxs("h4",{className:"text-sm font-bold text-slate-800 flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-800 rounded-lg flex items-center justify-center",children:e.jsx(W,{className:"h-4 w-4 text-white"})}),"Daily Transaction Breakdown - ",s.psp,e.jsxs("span",{className:"ml-auto text-xs font-medium text-slate-600 bg-slate-200/60 px-3 py-1 rounded-full",children:[Ys(s,ee,te).length," days"]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gradient-to-r from-slate-50 to-slate-100/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"YATIRIM"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"Ã‡EKME"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"TOPLAM"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{children:"KOMÄ°SYON"}),e.jsx("span",{className:"text-xs font-normal text-slate-500 normal-case",children:"Deposits Only"})]})}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"NET"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"TAHS TUTARI"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"KASA TOP"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"DEVÄ°R"}),e.jsx("th",{className:"text-center py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"Tx Count"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100/60",children:Ys(s,ee,te).map((t,a)=>e.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors duration-150 "+(t.transaction_count>0?a%2==0?"bg-white/50":"bg-slate-50/30":t.isWeekend?"bg-orange-50/30":"bg-gray-50/20"),children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full "+(t.transaction_count>0?"bg-blue-400":t.isWeekend?"bg-orange-300":"bg-gray-300")}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-medium text-slate-800 text-sm",children:[t.day," ",t.dayName]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(t.date).toLocaleDateString("tr-TR")})]})]})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsx("span",{className:"font-mono text-sm font-semibold "+(t.transaction_count>0?"text-emerald-700":"text-gray-400"),children:d(t.yatimim||0,s.psp)})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsx("span",{className:"font-mono text-sm font-semibold "+(t.transaction_count>0?"text-red-700":"text-gray-400"),children:d(t.cekme||0,s.psp)})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsx("span",{className:"font-mono text-sm font-bold "+(t.transaction_count>0?"text-slate-800":"text-gray-400"),children:d(t.toplam||0,s.psp)})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-mono text-sm font-semibold ${t.transaction_count>0?xt(s.commission_rate||0):"text-gray-400"}`,children:d(t.komisyon||0,s.psp)}),"TETHER"===s.psp.toUpperCase()?e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:"Internal KASA"}):void 0!==s.commission_rate?e.jsxs("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium ${ht(s.commission_rate)}`,children:[s.commission_rate,"%"]}):null]}),e.jsx("span",{className:"text-xs text-slate-500 mt-1",children:"Deposits Only"})]})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsx("span",{className:"font-mono text-sm font-semibold "+(t.transaction_count>0?"text-blue-700":"text-gray-400"),children:d(t.net||0,s.psp)})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("span",{className:"font-mono text-sm font-semibold "+(t.transaction_count>0?"text-purple-700":"text-gray-400"),children:d(t.tahs_tutari||0,s.psp)}),e.jsx("button",{onClick:()=>((e,s,t)=>{We({psp:e,date:s,currentAmount:t}),Ge(t.toString()),qe(!0)})(s.psp,t.date,t.tahs_tutari||0),className:"p-1.5 hover:bg-purple-100 rounded-md transition-colors duration-200 group opacity-70 hover:opacity-100",title:"Edit allocation amount",children:e.jsx(L,{className:"h-4 w-4 text-purple-600 group-hover:text-purple-700"})})]})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("span",{className:"font-mono text-sm font-semibold "+(t.transaction_count>0?"text-indigo-700":"text-gray-400"),children:d(t.kasa_top||0,s.psp)}),e.jsx("button",{onClick:()=>((e,s,t)=>{Es({psp:e,date:s,currentAmount:t}),Os(t.toString()),Hs(""),vs(!0)})(s.psp,t.date,t.kasa_top||0),className:"p-1.5 hover:bg-indigo-100 rounded-md transition-colors duration-200 group opacity-70 hover:opacity-100",title:"Edit KASA TOP amount",children:e.jsx(L,{className:"h-4 w-4 text-indigo-600 group-hover:text-indigo-700"})})]})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("span",{className:"font-mono text-sm font-semibold "+(t.transaction_count>0?(t.devir||0)>=0?"text-emerald-700":"text-red-700":"text-gray-400"),children:d(t.devir||0,s.psp)}),e.jsx("button",{onClick:()=>((e,s,t)=>{ts({psp:e,date:s,currentAmount:t}),ns(t.toString()),fs(""),es(!0)})(s.psp,t.date,t.devir||0),className:"p-1.5 hover:bg-emerald-100 rounded-md transition-colors duration-200 group opacity-70 hover:opacity-100",title:"Edit Devir amount",children:e.jsx(L,{className:"h-4 w-4 text-emerald-600 group-hover:text-emerald-700"})})]})}),e.jsx("td",{className:"py-3 px-4 text-center",children:e.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 rounded-full text-xs font-medium "+(t.transaction_count>0?"bg-slate-100 text-slate-700":"bg-gray-50 text-gray-400"),children:t.transaction_count||0})})]},t.date))}),e.jsx("tfoot",{className:"bg-gradient-to-r from-slate-100 to-slate-200/60 border-t border-slate-200",children:e.jsxs("tr",{className:"font-bold",children:[e.jsx("td",{className:"py-4 px-4 text-slate-800",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-slate-400 rounded-full"}),"Daily Totals"]})}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-emerald-800 text-sm",children:d(Ys(s,ee,te).reduce((e,s)=>e+(s.yatimim||0),0),s.psp)}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-red-800 text-sm",children:d(Ys(s,ee,te).reduce((e,s)=>e+(s.cekme||0),0),s.psp)}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-slate-800 text-sm",children:d(Ys(s,ee,te).reduce((e,s)=>e+(s.toplam||0),0),s.psp)}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-amber-800 text-sm",children:d(Ys(s,ee,te).reduce((e,s)=>e+(s.komisyon||0),0),s.psp)}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-blue-800 text-sm",children:d(Ys(s,ee,te).reduce((e,s)=>e+(s.net||0),0),s.psp)}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-purple-800 text-sm",children:d(Ys(s,ee,te).reduce((e,s)=>e+(s.tahs_tutari||0),0),s.psp)}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-indigo-800 text-sm",children:d((()=>{const e=Ys(s,ee,te),t=e[e.length-1];return t?.kasa_top||0})(),s.psp)}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-slate-800 text-sm",children:d((()=>{const e=Ys(s,ee,te),t=e[e.length-1];return t?.devir||0})(),s.psp)}),e.jsx("td",{className:"py-4 px-4 text-center",children:e.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 bg-slate-300 rounded-full text-xs font-bold text-slate-800",children:Ys(s,ee,te).reduce((e,s)=>e+(s.transaction_count||0),0)})})]})})]})})]})})},`${s.psp}-daily`)]},s.psp))})]}),G.length>ge&&e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 bg-slate-50 border-t border-slate-200",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:["Showing ",(xe-1)*ge+1," to ",Math.min(xe*ge,G.length)," of ",G.length," PSPs"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ms,{onClick:()=>he(Math.max(1,xe-1)),disabled:1===xe,variant:"outline",size:"sm",className:"flex items-center gap-1",children:[e.jsx(oe,{className:"h-4 w-4"}),"Previous"]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.ceil(G.length/ge)},(e,s)=>s+1).map(s=>e.jsx(ms,{onClick:()=>he(s),variant:xe===s?"default":"outline",size:"sm",className:"w-10",children:s},s))}),e.jsxs(ms,{onClick:()=>he(Math.min(Math.ceil(G.length/ge),xe+1)),disabled:xe===Math.ceil(G.length/ge),variant:"outline",size:"sm",className:"flex items-center gap-1",children:["Next",e.jsx(ce,{className:"h-4 w-4"})]})]})]}),e.jsx("table",{className:"w-full",children:e.jsx("tfoot",{className:"bg-gradient-to-r from-slate-100 via-slate-200/80 to-slate-100 border-t-2 border-slate-300",children:e.jsxs("tr",{className:"font-bold",children:[e.jsx("td",{className:"py-6 px-6"}),e.jsx("td",{className:"py-6 px-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-slate-600 to-slate-700 rounded-lg flex items-center justify-center shadow-lg",children:e.jsx(M,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-900 text-sm font-bold",children:"MONTHLY TOTALS"}),e.jsxs("div",{className:"text-xs text-slate-600",children:[G.length," PSPs"]})]})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold text-emerald-800",children:ze(G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.yatimim||0),0))}),e.jsx("span",{className:"text-xs text-emerald-700/70 font-medium",children:l("ledger.total_deposits")})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold text-red-800",children:ze(G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.cekme||0),0))}),e.jsx("span",{className:"text-xs text-red-700/70 font-medium",children:l("ledger.total_withdrawals")})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold text-slate-900",children:ze(G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.toplam||0),0))}),e.jsx("span",{className:"text-xs text-slate-700/70 font-medium",children:"Net Total"})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold text-amber-800",children:ze(G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.komisyon||0),0))}),e.jsx("span",{className:"text-xs text-amber-700/70 font-medium",children:l("ledger.total_commission")})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold text-blue-800",children:ze(G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.net||0),0))}),e.jsx("span",{className:"text-xs text-blue-700/70 font-medium",children:"Net Amount"})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold text-purple-800",children:ze(G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.tahs_tutari||0),0))}),e.jsx("span",{className:"text-xs text-purple-700/70 font-medium",children:l("ledger.total_allocations")})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold text-indigo-800",children:ze(G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.kasa_top||0),0))}),e.jsx("span",{className:"text-xs text-indigo-700/70 font-medium",children:l("ledger.total_revenue")})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold "+(G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.kasa_top||0),0)-G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.tahs_tutari||0),0)>=0?"text-emerald-800":"text-red-800"),children:ze(G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.kasa_top||0),0)-G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.tahs_tutari||0),0))}),e.jsx("span",{className:"text-xs font-medium "+(G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.kasa_top||0),0)-G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.tahs_tutari||0),0)>=0?"text-emerald-700/70":"text-red-700/70"),children:"Total Rollover"})]})})]})})})]})]}),e.jsx("div",{className:"mt-6",children:e.jsxs(Ee,{variant:"elevated",className:"mb-6",children:[e.jsxs(ls,{children:[e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5 text-gray-600"}),"Audit History"]}),e.jsx(cs,{children:"Complete audit trail of all manual overrides (Allocation, Devir, KASA TOP) with filtering and export capabilities"})]}),e.jsxs(os,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx(rs,{type:"date",value:qs.startDate,onChange:e=>tt("startDate",e.target.value),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx(rs,{type:"date",value:qs.endDate,onChange:e=>tt("endDate",e.target.value),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:l("ledger.psp_filter")}),e.jsx(rs,{type:"text",placeholder:l("ledger.filter_by_psp"),value:qs.psp,onChange:e=>tt("psp",e.target.value),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type Filter"}),e.jsxs("select",{value:qs.type,onChange:e=>tt("type",e.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"allocation",children:"Allocation"}),e.jsx("option",{value:"devir",children:"Devir"}),e.jsx("option",{value:"kasa_top",children:"KASA TOP"})]})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsxs(ms,{onClick:()=>rt("csv"),variant:"outline",className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),"CSV"]}),e.jsxs(ms,{onClick:()=>rt("json"),variant:"outline",className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),"JSON"]})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:$e?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(r,{className:"h-6 w-6 animate-spin text-gray-400"}),e.jsx("span",{className:"ml-2 text-gray-500",children:"Loading history data..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:l("ledger.psp_name")}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Created At"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Updated At"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:0===Le.length?e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:[e.jsx(g,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"No history found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your filters or check back later"})]})}):Le.map((s,t)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+("Allocation"===s.type?"bg-purple-100 text-purple-800":"Devir"===s.type?"bg-emerald-100 text-emerald-800":"bg-indigo-100 text-indigo-800"),children:s.type})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:new Date(s.date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4 text-gray-400"}),s.psp_name]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-semibold text-gray-900",children:ze(s.amount,"â‚º")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(s.created_at).toLocaleString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(s.updated_at).toLocaleString()})]},`${s.id}-${t}`))})]})}),Me&&Me.pages>1&&e.jsx("div",{className:"bg-gray-50 px-6 py-3 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",(Me.page-1)*Me.per_page+1," to"," ",Math.min(Me.page*Me.per_page,Me.total)," of"," ",Me.total," entries"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ms,{variant:"outline",size:"sm",onClick:()=>at(Me.page-1),disabled:!Me.has_prev,children:"Previous"}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",Me.page," of ",Me.pages]}),e.jsx(ms,{variant:"outline",size:"sm",onClick:()=>at(Me.page+1),disabled:!Me.has_next,children:"Next"})]})]})})]})})]})]})})]}),e.jsxs(us,{value:"analytics",className:"mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(M,{className:"h-6 w-6 text-gray-600"}),"Analytics Dashboard"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive insights and performance metrics"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(ms,{onClick:()=>{Vs(!0),Xs(!0)},variant:"outline",size:"default",className:"flex items-center gap-2 h-10 px-4 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 transition-all shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",disabled:fe,children:[e.jsx(r,{className:"h-4 w-4 "+(fe?"animate-spin":"")}),fe?"Refreshing...":"Refresh Data"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(et,{title:l("ledger.total_volume"),value:ze(m.reduce((e,s)=>e+s.total_amount,0),"â‚º"),subtitle:l("ledger.all_psps_combined"),icon:C,color:"indigo",animated:!0,animationDuration:500}),e.jsx(et,{title:l("ledger.active_psps"),value:m.length.toString(),subtitle:l("ledger.payment_providers"),icon:le,color:"green",animated:!0,animationDuration:500}),e.jsx(et,{title:l("ledger.avg_commission_rate"),value:`${(m.reduce((e,s)=>e+s.commission_rate,0)/m.length||0).toFixed(1)}%`,subtitle:l("ledger.weighted_average"),icon:ne,color:"orange",animated:!0,animationDuration:500}),e.jsx(et,{title:l("ledger.total_transactions"),value:mt(m.reduce((e,s)=>e+s.transaction_count,0)),subtitle:l("ledger.all_time"),icon:J,color:"purple",animated:!0,animationDuration:500})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(Ee,{variant:"elevated",className:"p-6",children:[e.jsxs(ls,{className:"pb-4",children:[e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5 text-gray-600"}),l("ledger.psp_performance_comparison")]}),e.jsx(cs,{children:l("ledger.net_amounts_transaction_counts")})]}),e.jsx(os,{children:e.jsx("div",{className:"h-80",children:e.jsx(Ns,{width:"100%",height:"100%",children:e.jsxs(Rs,{data:m.map(e=>({name:e.psp,net:e.total_net,transactions:e.transaction_count,commission:e.total_commission})),children:[e.jsx(ws,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(_s,{dataKey:"name",tick:{fontSize:12},angle:-45,textAnchor:"end",height:80}),e.jsx(ks,{tick:{fontSize:12}}),e.jsx(Ss,{formatter:(e,s)=>["net"===s||"commission"===s?ze(Number(e),"â‚º"):e,"net"===s?"Net Amount":"transactions"===s?"Transactions":"Commission"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(Ps,{dataKey:"net",fill:"#3b82f6",radius:[4,4,0,0]})]})})})})]}),e.jsxs(Ee,{variant:"elevated",className:"p-6",children:[e.jsxs(ls,{className:"pb-4",children:[e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5 text-gray-600"}),l("ledger.psp_market_share")]}),e.jsx(cs,{children:l("ledger.distribution_total_volume")})]}),e.jsx(os,{children:e.jsx("div",{className:"h-80",children:e.jsx(Ns,{width:"100%",height:"100%",children:e.jsxs(Ds,{children:[e.jsx(Ts,{data:m.map(e=>({name:e.psp,value:e.total_amount,net:e.total_net})),cx:"50%",cy:"50%",labelLine:!1,label:({name:e,percent:s})=>`${e} ${(100*s).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:m.map((s,t)=>e.jsx(As,{fill:`hsl(${60*t}, 70%, 50%)`},`cell-${t}`))}),e.jsx(Ss,{formatter:e=>[ze(Number(e),"â‚º"),"Total Amount"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}})]})})})})]})]}),e.jsxs(Ee,{variant:"elevated",className:"p-6",children:[e.jsxs(ls,{className:"pb-4",children:[e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5 text-gray-600"}),"Daily Transaction Trends"]}),e.jsx(cs,{children:"Net amounts and transaction counts over time"})]}),e.jsx(os,{children:e.jsx("div",{className:"h-80",children:e.jsx(Ns,{width:"100%",height:"100%",children:e.jsxs(Fs,{data:ye.map(e=>({date:new Date(e.date).toLocaleDateString("en-US",{month:"short",day:"numeric"}),net:e.totals.net,transactions:e.totals.total_psp,commission:e.totals.commission})),children:[e.jsx(ws,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(_s,{dataKey:"date",tick:{fontSize:12}}),e.jsx(ks,{tick:{fontSize:12}}),e.jsx(Ss,{formatter:(e,s)=>["net"===s||"commission"===s?ze(Number(e),"â‚º"):e,"net"===s?"Net Amount":"transactions"===s?"Transactions":"Commission"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(Ls,{type:"monotone",dataKey:"net",stackId:"1",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.6}),e.jsx(Ls,{type:"monotone",dataKey:"commission",stackId:"2",stroke:"#f59e0b",fill:"#f59e0b",fillOpacity:.6})]})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(Ee,{variant:"elevated",className:"p-6",children:[e.jsxs(ls,{className:"pb-4",children:[e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-5 w-5 text-gray-600"}),l("ledger.allocation_vs_net")]}),e.jsx(cs,{children:l("ledger.allocation_vs_net_desc")})]}),e.jsx(os,{children:e.jsx("div",{className:"h-80",children:e.jsx(Ns,{width:"100%",height:"100%",children:e.jsxs(Us,{data:m.map(e=>({net:e.total_net,allocation:e.total_allocations,psp:e.psp,rollover:e.total_net-e.total_allocations})),children:[e.jsx(ws,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(_s,{type:"number",dataKey:"net",name:"Net Amount",tick:{fontSize:12},tickFormatter:e=>ze(e,"â‚º")}),e.jsx(ks,{type:"number",dataKey:"allocation",name:"Allocation",tick:{fontSize:12},tickFormatter:e=>ze(e,"â‚º")}),e.jsx(Ss,{formatter:(e,s)=>[ze(Number(e),"â‚º"),"net"===s?"Net Amount":"allocation"===s?"Allocation":"Rollover"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx($s,{dataKey:"allocation",fill:"#3b82f6",r:6})]})})})})]}),e.jsxs(Ee,{variant:"elevated",className:"p-6",children:[e.jsxs(ls,{className:"pb-4",children:[e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5 text-gray-600"}),l("ledger.rollover_analysis")]}),e.jsx(cs,{children:l("ledger.rollover_risk_levels")})]}),e.jsx(os,{children:e.jsx("div",{className:"h-80",children:e.jsx(Ns,{width:"100%",height:"100%",children:e.jsxs(Rs,{data:m.map(e=>{const s=e.total_net-e.total_allocations,t=e.total_net>0?s/e.total_net*100:0;return{name:e.psp,rollover:s,percentage:t,color:s>0?"#ef4444":"#10b981"}}),children:[e.jsx(ws,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(_s,{dataKey:"name",tick:{fontSize:12},angle:-45,textAnchor:"end",height:80}),e.jsx(ks,{tick:{fontSize:12}}),e.jsx(Ss,{formatter:(e,s)=>["rollover"===s?ze(Number(e),"â‚º"):`${Number(e).toFixed(1)}%`,"rollover"===s?"Rollover Amount":"Rollover %"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(Ps,{dataKey:"rollover",fill:"#3b82f6",radius:[4,4,0,0]})]})})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4 lg:gap-6",children:[e.jsxs(Ee,{variant:"elevated",className:"p-6",children:[e.jsxs(ls,{className:"pb-4",children:[e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-5 w-5 text-gray-600"}),l("ledger.commission_rates_comparison")]}),e.jsx(cs,{children:l("ledger.commission_rates_all_psps")})]}),e.jsx(os,{children:e.jsx("div",{className:"h-64 sm:h-72 lg:h-80",children:e.jsx(Ns,{width:"100%",height:"100%",children:e.jsxs(Rs,{data:m.map(e=>({psp:e.psp,rate:e.commission_rate,deposits:e.total_deposits,commission:e.total_commission})),children:[e.jsx(ws,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(_s,{dataKey:"psp",tick:{fontSize:10},angle:-45,textAnchor:"end",height:60,interval:0}),e.jsx(ks,{tick:{fontSize:10},tickFormatter:e=>`${e}%`,width:40}),e.jsx(Ss,{formatter:(e,s)=>["rate"===s?`${e}%`:ze(Number(e),"â‚º"),"rate"===s?"Commission Rate":"deposits"===s?"Total Deposits":"Commission Amount"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(Ps,{dataKey:"rate",fill:"#f59e0b",radius:[4,4,0,0],name:"Commission Rate"})]})})})})]}),e.jsxs(Ee,{variant:"elevated",className:"p-6",children:[e.jsxs(ls,{className:"pb-4",children:[e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5 text-gray-600"}),l("ledger.commission_vs_deposits")]}),e.jsx(cs,{children:l("ledger.commission_vs_deposits_desc")})]}),e.jsx(os,{children:e.jsx("div",{className:"h-64 sm:h-72 lg:h-80",children:e.jsx(Ns,{width:"100%",height:"100%",children:e.jsxs(Us,{data:m.map(e=>({deposits:e.total_deposits,commission:e.total_commission,psp:e.psp,rate:e.commission_rate})),children:[e.jsx(ws,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(_s,{type:"number",dataKey:"deposits",name:"Total Deposits",tick:{fontSize:10},tickFormatter:e=>ze(e,"â‚º"),width:60}),e.jsx(ks,{type:"number",dataKey:"commission",name:"Commission",tick:{fontSize:10},tickFormatter:e=>ze(e,"â‚º"),width:60}),e.jsx(Ss,{formatter:(e,s)=>["deposits"===s||"commission"===s?ze(Number(e),"â‚º"):e,"deposits"===s?"Total Deposits":"commission"===s?"Commission Amount":"rate"===s?"Commission Rate":"PSP"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx($s,{dataKey:"commission",fill:"#f59e0b",r:6})]})})})})]})]}),e.jsxs(Ee,{variant:"elevated",className:"p-6",children:[e.jsxs(ls,{className:"pb-4",children:[e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-5 w-5 text-gray-600"}),"Commission Rate Comparison"]}),e.jsx(cs,{children:"Detailed comparison of commission rates and their impact"})]}),e.jsx(os,{children:e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs("table",{className:"w-full min-w-[600px]",children:[e.jsx("thead",{className:"bg-gradient-to-r from-slate-50 to-slate-100/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:l("ledger.psp")}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:l("ledger.commission_rate")}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:l("ledger.total_deposits")}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:l("ledger.commission_amount")}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"Efficiency"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100/60",children:m.sort((e,s)=>s.commission_rate-e.commission_rate).map((s,t)=>{const a=s.total_deposits>0?s.total_commission/s.total_deposits*100:0;return e.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors duration-150 "+(t%2==0?"bg-white/50":"bg-slate-50/30"),children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${ht(s.commission_rate).split(" ")[0]}`}),e.jsx("span",{className:"font-medium text-slate-800 text-sm",children:s.psp})]})}),e.jsx("td",{className:"py-3 px-4 text-right",children:"TETHER"===s.psp.toUpperCase()?e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Internal KASA"}):e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${ht(s.commission_rate)}`,children:[s.commission_rate,"%"]})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsx("span",{className:"font-mono text-sm font-semibold text-slate-800",children:ze(s.total_deposits)})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsx("span",{className:`font-mono text-sm font-semibold ${xt(s.commission_rate)}`,children:ze(s.total_commission||0)})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsxs("span",{className:"text-sm font-medium text-slate-600",children:[a.toFixed(2),"%"]})})]},s.psp)})})]})})})]}),e.jsxs(Ee,{variant:"elevated",className:"p-6",children:[e.jsxs(ls,{className:"pb-4",children:[e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-gray-600"}),"Performance Insights"]}),e.jsx(cs,{children:"Key findings and recommendations based on current data"})]}),e.jsx(os,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-600 rounded-lg flex items-center justify-center",children:e.jsx(T,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Top Performer"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Highest net amount"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:m.length>0?m.reduce((e,s)=>s.total_net>e.total_net?s:e).psp:"N/A"}),e.jsx("p",{className:"text-sm text-gray-700",children:m.length>0?ze(m.reduce((e,s)=>s.total_net>e.total_net?s:e).total_net,"â‚º"):"â‚º0"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-600 rounded-lg flex items-center justify-center",children:e.jsx(ne,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Most Efficient"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Best allocation ratio"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:m.length>0?m.reduce((e,s)=>(s.total_net>0?s.total_allocations/s.total_net:0)>(e.total_net>0?e.total_allocations/e.total_net:0)?s:e).psp:"N/A"}),e.jsx("p",{className:"text-sm text-gray-700",children:m.length>0?`${(m.reduce((e,s)=>(s.total_net>0?s.total_allocations/s.total_net:0)>(e.total_net>0?e.total_allocations/e.total_net:0)?s:e).total_net>0?m.reduce((e,s)=>(s.total_net>0?s.total_allocations/s.total_net:0)>(e.total_net>0?e.total_allocations/e.total_net:0)?s:e).total_allocations/m.reduce((e,s)=>(s.total_net>0?s.total_allocations/s.total_net:0)>(e.total_net>0?e.total_allocations/e.total_net:0)?s:e).total_net*100:0).toFixed(1)}%`:"0%"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-600 rounded-lg flex items-center justify-center",children:e.jsx(t,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Risk Alert"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Highest rollover"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:m.length>0?m.reduce((e,s)=>s.total_allocations-s.total_net>e.total_allocations-e.total_net?s:e).psp:"N/A"}),e.jsx("p",{className:"text-sm text-gray-700",children:m.length>0?ze(m.reduce((e,s)=>s.total_allocations-s.total_net>e.total_allocations-e.total_net?s:e).total_allocations-m.reduce((e,s)=>s.total_allocations-s.total_net>e.total_allocations-e.total_net?s:e).total_net,"â‚º"):"â‚º0"})]})]})]})})]})]})]})}),$&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-300",onClick:e=>{e.target===e.currentTarget&&dt()},onKeyDown:e=>{"Escape"===e.key&&dt()},tabIndex:-1,children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-5 border-b border-gray-100",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-xl flex items-center justify-center",children:e.jsx(le,{className:"h-5 w-5 text-blue-600"})}),"psp"===ue?.type?`${l("ledger.psp_details")}: ${ue.psp}`:`${l("ledger.psp_details")}: ${ue?.date} - ${ue?.psp}`]}),e.jsx("button",{onClick:dt,className:"h-10 w-10 p-0 hover:bg-gray-100 rounded-xl transition-colors flex items-center justify-center",children:e.jsx(D,{className:"h-5 w-5 text-gray-500"})})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:ue?.error?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(A,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-red-600",children:ue.error})]}):ue?.transactions?.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:l("ledger.total_transactions")}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:ue.transactions.length})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:l("ledger.total_amount")}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:ze(ue.transactions.reduce((e,s)=>e+(s.amount||0),0),"â‚º")})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:l("ledger.total_commission")}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:ze(ue.transactions.reduce((e,s)=>e+(s.commission||0),0),"â‚º")})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Commission"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Net Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ue.transactions.map((s,t)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(s.date||s.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ze(s.amount||0,"â‚º")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ze(s.commission||0,"â‚º")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ze(s.net_amount||0,"â‚º")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full "+("DEP"===s.category?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:"DEP"===s.category?"Deposit":"Withdrawal"})})]},s.id||`${s.date||s.created_at}-${s.amount}-${t}`))})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(J,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No transactions found"})]})})]})}),ke&&Ce&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-300",onClick:e=>{e.target===e.currentTarget&&Zs()},onKeyDown:e=>{"Escape"===e.key&&Zs()},tabIndex:-1,children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-5xl w-full max-h-[92vh] overflow-hidden animate-in zoom-in-95 duration-300",children:[e.jsx("div",{className:"px-10 py-8 border-b border-gray-100 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center shadow-sm",children:e.jsx(le,{className:"h-8 w-8 text-gray-700"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 tracking-tight",children:l("ledger.bulk_allocation")}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(W,{className:"h-4 w-4 text-gray-500"}),e.jsx("p",{className:"text-base text-gray-600 font-medium",children:ye.find(e=>e.date===Ce)?.date_str})]})]})]}),e.jsx("button",{onClick:Zs,className:"w-12 h-12 rounded-xl bg-gray-100/80 hover:bg-gray-200/80 flex items-center justify-center transition-all duration-200 hover:scale-105",children:e.jsx(D,{className:"h-6 w-6 text-gray-600"})})]})}),e.jsx("div",{className:"px-10 py-8 max-h-[60vh] overflow-y-auto",children:e.jsx("div",{className:"space-y-4",children:m.map((s,t)=>{const a=`${Ce}-${s.psp}`,r=Te[a]||0,n=ye.find(e=>e.date===Ce),i=n?.psps[s.psp],c=i?.net||0,o=i?.allocation||0,d=o-c,m=s.total_allocations-s.total_net,x=!!i;return e.jsx("div",{className:"group bg-white shadow-sm rounded-2xl p-8 hover:shadow-lg hover:shadow-gray-100/20 transition-all duration-300 hover:-translate-y-0.5",style:{animationDelay:50*t+"ms"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl flex items-center justify-center shadow-sm transition-all duration-200 "+(x?"bg-gray-100 group-hover:bg-gray-200":"bg-gray-100"),children:e.jsx(le,{className:"h-7 w-7 transition-colors duration-200 "+(x?"text-gray-700":"text-gray-500")})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("h4",{className:"text-lg font-bold text-gray-900",children:s.psp}),!x&&e.jsx("span",{className:"px-3 py-1.5 text-xs font-semibold bg-gray-100 text-gray-700 rounded-full border border-gray-200",children:l("ledger.no_activity")}),x&&e.jsx("span",{className:"px-3 py-1.5 text-xs font-semibold bg-gray-100 text-gray-700 rounded-full border border-gray-200",children:l("ledger.active")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-warning-50/80 rounded-xl p-4 border border-warning-200",children:[e.jsx("div",{className:"text-xs font-medium text-warning-600 uppercase tracking-wide mb-1",children:l("ledger.allocations")}),e.jsx("div",{className:"text-lg font-bold text-warning-700",children:ze(x?o:s.total_allocations,"â‚º")})]}),e.jsxs("div",{className:"rounded-xl p-4 border "+((x?d:m)>0?"bg-destructive-50/80 border-destructive-200":"bg-success-50/80 border-success-200"),children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:l("ledger.rollover")}),e.jsx("div",{className:"text-lg font-bold "+((x?d:m)>0?"text-destructive-600":"text-success-600"),children:ze(x?d:m,"â‚º")})]})]})]})]})}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"text-right",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:l("ledger.new_allocation")}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:r,onChange:e=>((e,s)=>{if(!Ce)return;const t=`${Ce}-${e}`;Ae(e=>({...e,[t]:s}))})(s.psp,parseFloat(e.target.value)||0),className:"w-40 px-5 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-right font-bold text-lg transition-all duration-200 bg-white shadow-sm",placeholder:"0.00",step:"0.01"}),e.jsx("div",{className:"absolute inset-y-0 right-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-sm font-bold text-gray-500",children:"â‚º"})})]})})]})})]})},s.psp)})})}),e.jsx("div",{className:"px-10 py-8 border-t border-gray-100 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-xl flex items-center justify-center",children:e.jsx(le,{className:"h-5 w-5 text-gray-700"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold text-gray-700",children:[Object.keys(Te).length," ",l("ledger.psps_selected")]}),e.jsx("div",{className:"text-xs text-gray-500",children:l("ledger.ready_for_allocation")})]})]}),e.jsx("div",{className:"h-8 w-px bg-gray-200"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(C,{className:"h-5 w-5 text-green-700"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700",children:l("ledger.total_allocation")}),e.jsx("div",{className:"text-lg font-bold text-green-600",children:ze(Object.values(Te).reduce((e,s)=>e+s,0),"â‚º")})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:Zs,className:"px-8 py-3 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-xl transition-all duration-200 font-semibold shadow-sm hover:shadow",children:l("common.cancel")}),e.jsx("button",{onClick:async()=>{if(Ce){Fe(!0);try{const e=Object.entries(Te).map(async([e,s])=>{const t=e.lastIndexOf("-"),a=e.substring(0,t),r=e.substring(t+1);return nt(a,r,s)});await Promise.all(e),ve(e=>({...e,...Te})),Se(!1),De(null),Ae({}),await Promise.all([Xs(!0),Vs(!0)])}catch(e){}finally{Fe(!1)}}},disabled:Re,className:"px-8 py-3 bg-gray-700 text-white rounded-xl hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center gap-3 font-semibold shadow-lg hover:shadow-xl hover:-translate-y-0.5",children:Re?e.jsxs(e.Fragment,{children:[e.jsx(r,{className:"h-5 w-5 animate-spin"}),l("ledger.processing")]}):e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"h-5 w-5"}),l("ledger.apply_allocations")]})})]})]})})]})}),He&&Ke&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-md w-full animate-in zoom-in-95 duration-300",children:[e.jsx("div",{className:"px-8 py-6 border-b border-gray-100 bg-gray-50 rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-2xl flex items-center justify-center shadow-sm",children:e.jsx(L,{className:"h-6 w-6 text-gray-700"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 tracking-tight",children:l("ledger.edit_allocation")}),e.jsxs("p",{className:"text-sm text-gray-600 font-medium",children:[Ke.psp," - ",new Date(Ke.date).toLocaleDateString("tr-TR")]})]})]}),e.jsx("button",{onClick:it,className:"w-10 h-10 rounded-xl bg-gray-100/80 hover:bg-gray-200/80 flex items-center justify-center transition-all duration-200 hover:scale-105",children:e.jsx(D,{className:"h-5 w-5 text-gray-600"})})]})}),e.jsx("div",{className:"px-8 py-6",children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:l("ledger.allocation_amount_try")}),e.jsx("input",{type:"number",value:Ye,onChange:e=>Ge(e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all duration-200 text-lg font-mono",placeholder:l("ledger.enter_allocation_amount"),min:"0",step:"0.01",autoFocus:!0,disabled:Xe}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[l("ledger.current_amount"),": ",ze(Ke.currentAmount,"â‚º")]})]})})}),e.jsx("div",{className:"px-8 py-6 border-t border-gray-100 bg-gray-50/50 rounded-b-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:it,className:"px-6 py-3 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-all duration-200 font-semibold shadow-sm hover:shadow",children:l("common.cancel")}),e.jsx("button",{onClick:async()=>{if(!Ke)return;const e=parseFloat(Ye);if(isNaN(e)||e<0)alert(l("ledger.enter_valid_amount"));else{Qe(!0);try{await nt(Ke.date,Ke.psp,e),await Promise.all([Gs(ee,te,!0),Xs(!0),st(qs.page)]),it(),alert(l("ledger.allocation_updated"))}catch(s){const e=s?.message||l("ledger.failed_update_allocation");alert(`${l("ledger.failed_update_allocation")}\n\nDetay: ${e}`)}finally{Qe(!1)}}},disabled:Xe,className:"px-6 py-3 bg-gray-700 text-white rounded hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center gap-3 font-semibold shadow-lg hover:shadow-xl hover:-translate-y-0.5",children:Xe?e.jsxs(e.Fragment,{children:[e.jsx(r,{className:"h-4 w-4 animate-spin"}),l("ledger.updating")]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"h-4 w-4"}),l("ledger.update_allocation")]})})]})})]})}),Ze&&ss&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-md w-full animate-in zoom-in-95 duration-300",children:[e.jsx("div",{className:"px-8 py-6 border-b border-gray-100 bg-gray-50 rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-2xl flex items-center justify-center shadow-sm",children:e.jsx(L,{className:"h-6 w-6 text-gray-700"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 tracking-tight",children:l("ledger.edit_devir_amount")}),e.jsxs("p",{className:"text-sm text-gray-600 font-medium",children:[ss.psp," - ",new Date(ss.date).toLocaleDateString("tr-TR")]})]})]}),e.jsx("button",{onClick:ct,className:"w-10 h-10 rounded-xl bg-gray-100/80 hover:bg-gray-200/80 flex items-center justify-center transition-all duration-200 hover:scale-105",children:e.jsx(D,{className:"h-5 w-5 text-gray-600"})})]})}),e.jsx("div",{className:"px-8 py-6",children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:l("ledger.devir_amount_try")}),e.jsx("input",{type:"number",value:as,onChange:e=>ns(e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-all duration-200 text-lg font-mono",placeholder:l("ledger.enter_devir_amount"),step:"0.01",autoFocus:!0}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[l("ledger.current_amount"),": ",ze(ss.currentAmount,"â‚º")]})]})})}),e.jsx("div",{className:"px-8 py-6 border-t border-gray-100 bg-gray-50/50 rounded-b-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:ct,className:"px-6 py-3 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-all duration-200 font-semibold shadow-sm hover:shadow",children:l("common.cancel")}),e.jsx("button",{onClick:async()=>{if(!ss)return;const e=parseFloat(as);if(isNaN(e))alert(l("ledger.enter_valid_amount"));else{ps(!0);try{const t={date:ss.date,psp:ss.psp,devir_amount:e},a=await Pe.post("/analytics/update-devir",t);if(a.ok)try{await Pe.parseResponse(a),await Promise.all([Gs(ee,te,!0),Xs(!0),st(qs.page)]),await new Promise(e=>setTimeout(e,500)),ct(),alert(l("ledger.devir_updated"))}catch(s){await Promise.all([Gs(ee,te,!0),Xs(!0),st(qs.page)]),ct(),alert(l("ledger.devir_updated"))}else try{const e=await Pe.parseResponse(a),s=e?.error||e?.message||`HTTP ${a.status}`;alert(`${l("ledger.failed_update_devir")}: ${s}`)}catch(s){alert(`${l("ledger.failed_update_devir")}: HTTP ${a.status}`)}}catch(t){const e=t?.message||t?.toString()||"Network error";alert(`${l("ledger.failed_save_devir")}\n\nDetay: ${e}`)}finally{ps(!1)}}},disabled:ds,className:"px-6 py-3 bg-gray-700 text-white rounded hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center gap-3 font-semibold shadow-lg hover:shadow-xl hover:-translate-y-0.5",children:ds?e.jsxs(e.Fragment,{children:[e.jsx(r,{className:"h-4 w-4 animate-spin"}),l("ledger.updating")]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"h-4 w-4"}),l("ledger.update_devir")]})})]})})]})}),bs&&Cs&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-md w-full animate-in zoom-in-95 duration-300",children:[e.jsx("div",{className:"px-8 py-6 border-b border-gray-100 bg-gray-50 rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-2xl flex items-center justify-center shadow-sm",children:e.jsx(L,{className:"h-6 w-6 text-gray-700"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 tracking-tight",children:l("ledger.edit_kasa_top_amount")}),e.jsxs("p",{className:"text-sm text-gray-600 font-medium",children:[Cs.psp," - ",new Date(Cs.date).toLocaleDateString("tr-TR")]})]})]}),e.jsx("button",{onClick:ot,className:"w-10 h-10 rounded-xl bg-gray-100/80 hover:bg-gray-200/80 flex items-center justify-center transition-all duration-200 hover:scale-105",children:e.jsx(D,{className:"h-5 w-5 text-gray-600"})})]})}),e.jsx("div",{className:"px-8 py-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:l("ledger.secret_code")}),e.jsx("input",{type:"password",value:Bs,onChange:e=>Hs(e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-all duration-200 text-lg font-mono",placeholder:l("ledger.enter_secret_code"),autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:l("ledger.kasa_top_amount_try")}),e.jsx("input",{type:"number",value:zs,onChange:e=>Os(e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-all duration-200 text-lg font-mono",placeholder:l("ledger.enter_kasa_top_amount"),step:"0.01"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[l("ledger.current_amount"),": ",ze(Cs.currentAmount,"â‚º")]})]})]})}),e.jsx("div",{className:"px-8 py-6 border-t border-gray-100 bg-gray-50/50 rounded-b-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:ot,className:"px-6 py-3 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-all duration-200 font-semibold shadow-sm hover:shadow",children:l("common.cancel")}),e.jsx("button",{onClick:async()=>{if(!Cs)return;if("4561"!==Bs)return void alert(l("ledger.invalid_secret_kasa"));const e=parseFloat(zs);if(isNaN(e))alert(l("ledger.enter_valid_amount"));else{Is(!0);try{const t={date:Cs.date,psp:Cs.psp,kasa_top_amount:e},a=await Pe.post("/analytics/update-kasa-top",t);if(a.ok)try{await Pe.parseResponse(a),await Promise.all([Gs(ee,te,!0),Xs(!0),st(qs.page)]),await new Promise(e=>setTimeout(e,500)),ot(),alert(l("ledger.kasa_updated"))}catch(s){await Promise.all([Gs(ee,te,!0),Xs(!0),st(qs.page)]),ot(),alert(l("ledger.kasa_updated"))}else try{const e=await Pe.parseResponse(a),s=e?.error||e?.message||`HTTP ${a.status}`;alert(`${l("ledger.failed_update_kasa")}: ${s}`)}catch(s){alert(`${l("ledger.failed_update_kasa")}: HTTP ${a.status}`)}}catch(t){const e=t?.message||t?.toString()||"Network error";alert(`${l("ledger.failed_save_kasa")}\n\nDetay: ${e}`)}finally{Is(!1)}}},disabled:Ms||"4561"!==Bs,className:"px-6 py-3 bg-gray-700 text-white rounded hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center gap-3 font-semibold shadow-lg hover:shadow-xl hover:-translate-y-0.5",children:Ms?e.jsxs(e.Fragment,{children:[e.jsx(r,{className:"h-4 w-4 animate-spin"}),l("ledger.updating")]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"h-4 w-4"}),l("ledger.update_kasa_top")]})})]})})]})})]})}},Symbol.toStringTag,{value:"Module"})),ut=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const[t,a]=S(),n=o(),[l,c]=Ks("general"),{t:d,currentLanguage:m,setLanguage:x,supportedLanguages:h}=Ve(),[y,j]=s.useState(!1),f=m||"en",b=h||{en:{flag:"ðŸ‡ºðŸ‡¸",name:"English"},tr:{flag:"ðŸ‡¹ðŸ‡·",name:"TÃ¼rkÃ§e"}};s.useEffect(()=>{const e=t.get("tab"),s=t.get("view");if("admin"===e){const e=new URLSearchParams;return s&&e.set("view",s),void n("/admin/settings"+(e.toString()?`?${e.toString()}`:""),{replace:!0})}e&&["general","dropdowns","departments","notifications","integrations","translations"].includes(e)&&c(e)},[]),s.useEffect(()=>{const e=e=>{y&&(e.target.closest(".custom-dropdown-container")||j(!1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[y]);const[v,w]=s.useState({}),[_,C]=s.useState(!1),[A,R]=s.useState(!1),[z,I]=s.useState(!1);s.useState(null);const[B,H]=s.useState(null),[q,K]=s.useState({field_name:"",value:"",commission_rate:""}),[W,Y]=s.useState(""),[V,X]=s.useState(["Conversion","Retention","Marketing","Research","Operation","Management","Facility"]),[Q,Z]=s.useState(!1),[ee,se]=s.useState(!1),[ae,ne]=s.useState(""),[ie,ce]=s.useState(""),[oe,ue]=s.useState(!1),pe=[{value:"payment_method",label:d("settings.payment_method"),requiresCommission:!1,isStatic:!0,staticValues:["Bank","Credit card","Tether"]},{value:"currency",label:d("settings.currency"),requiresCommission:!1,isStatic:!0,staticValues:["TL","USD","EUR"]},{value:"category",label:d("settings.category"),requiresCommission:!1,isStatic:!0,staticValues:["DEP","WD"]},{value:"psp",label:d("settings.psp_kasa"),requiresCommission:!0,isStatic:!1,isProtected:!1},{value:"company",label:d("settings.company"),requiresCommission:!1,isStatic:!1,isProtected:!1}],ye=async()=>{try{C(!0);const e=await Pe.get("/transactions/dropdown-options");if(e.ok){const s=await Pe.parseResponse(e);w(s||{})}}catch(e){}finally{C(!1)}},je=async()=>{try{Z(!0);const e=localStorage.getItem("systemDepartments");if(e)X(JSON.parse(e));else{const e=["Conversion","Retention","Marketing","Research","Operation","Management","Facility"];X(e),localStorage.setItem("systemDepartments",JSON.stringify(e))}}catch(e){}finally{Z(!1)}},fe=e=>{e?(ne(e),ue(!0)):(ce(""),ue(!1)),se(!0)};s.useEffect(()=>{"dropdowns"===l&&ye(),"departments"===l&&je()},[l]),js([{key:"1",ctrlKey:!0,action:()=>c("general")},{key:"2",ctrlKey:!0,action:()=>c("dropdowns")},{key:"3",ctrlKey:!0,action:()=>c("departments")},{key:"4",ctrlKey:!0,action:()=>c("admin")},{key:"5",ctrlKey:!0,action:()=>c("notifications")},{key:"6",ctrlKey:!0,action:()=>c("integrations")},{key:"7",ctrlKey:!0,action:()=>c("translations")}]);const be=[{id:"general",label:d("settings.general"),icon:N,content:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(fs,{className:"border border-gray-200 shadow-sm",children:[e.jsx(ls,{className:"border-b border-gray-100 bg-gray-50/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(le,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx(is,{className:"text-lg font-semibold text-gray-900",children:d("settings.company_information")}),e.jsx(cs,{className:"text-sm text-gray-600",children:d("settings.order_invest_pipeline_collab")})]})]})}),e.jsxs(os,{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-md",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-2 uppercase tracking-wide",children:d("settings.company_name")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-base font-semibold text-gray-900",children:"Order Invest"}),e.jsx("span",{className:"text-gray-400",children:"Ã—"}),e.jsx("span",{className:"text-base font-semibold text-gray-700",children:"PipLine"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:d("settings.strategic_partnership")})]}),e.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-md",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-2 uppercase tracking-wide",children:d("settings.contact_email")}),e.jsx(rs,{type:"email",placeholder:"contact@orderinvest.com",className:"bg-white border-gray-300"})]})]}),e.jsx("div",{className:"mt-4 p-4 bg-slate-50 border border-slate-200 rounded-md",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"text-slate-600 mt-0.5",children:e.jsx(J,{className:"h-4 w-4"})}),e.jsxs("div",{className:"text-sm text-slate-700",children:[e.jsx("p",{className:"font-medium mb-1",children:d("settings.partnership_overview")}),e.jsx("p",{className:"text-xs leading-relaxed text-slate-600",children:d("settings.partnership_description")})]})]})})]})]}),e.jsxs(fs,{className:"border border-gray-200 shadow-sm",children:[e.jsx(ls,{className:"border-b border-gray-100 bg-gray-50/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(u,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx(is,{className:"text-lg font-semibold text-gray-900",children:d("settings.system_preferences")}),e.jsx(cs,{className:"text-sm text-gray-600",children:d("settings.configure_system")})]})]})}),e.jsxs(os,{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-md",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-2 uppercase tracking-wide",children:d("settings.timezone")}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors bg-white text-sm text-gray-900 appearance-none cursor-pointer",style:{zIndex:9999},children:[e.jsx("option",{className:"bg-white text-gray-900",children:"Europe/Istanbul (UTC+3)"}),e.jsx("option",{className:"bg-white text-gray-900",children:"UTC"}),e.jsx("option",{className:"bg-white text-gray-900",children:"Europe/London (UTC+0)"}),e.jsx("option",{className:"bg-white text-gray-900",children:"America/New_York (UTC-5)"}),e.jsx("option",{className:"bg-white text-gray-900",children:"Asia/Dubai (UTC+4)"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:d("settings.default_europe_istanbul")})]}),e.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-md",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-2 uppercase tracking-wide",children:d("settings.language")}),e.jsx("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors bg-white text-sm text-gray-900 appearance-none cursor-pointer",style:{zIndex:9999},value:f,onChange:e=>(async e=>{try{await x(e)}catch(s){}})(e.target.value),children:Object.entries(b).map(([s,t])=>e.jsxs("option",{value:s,className:"bg-white text-gray-900",children:[t.flag," ",t.name]},s))}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:d("settings.primary_turkish")})]})]}),e.jsx("div",{className:"mt-4 p-4 bg-slate-50 border border-slate-200 rounded-md",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"text-slate-600 mt-0.5",children:e.jsx(J,{className:"h-4 w-4"})}),e.jsxs("div",{className:"text-sm text-slate-700",children:[e.jsx("p",{className:"font-medium mb-1",children:d("settings.currency_standard")}),e.jsx("p",{className:"text-xs leading-relaxed text-slate-600",children:d("settings.currency_standard_desc")})]})]})})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs(ms,{size:"lg",className:"px-8 py-3 bg-slate-700 hover:bg-slate-800 text-white font-medium",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),d("settings.save_config_changes")]})})]})},{id:"dropdowns",label:d("settings.dropdown_management"),icon:me,content:e.jsxs("div",{className:"space-y-6",children:[e.jsx(fs,{className:"border border-gray-200 shadow-sm",children:e.jsx(ls,{className:"border-b border-gray-100 bg-gray-50/50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(me,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx(is,{className:"text-lg font-semibold text-gray-900",children:d("settings.dropdown_management")}),e.jsx(cs,{className:"text-sm text-gray-600",children:d("settings.manage_dropdown_options")})]})]}),e.jsxs(ms,{onClick:()=>{Y(""),R(!0)},className:"bg-slate-700 hover:bg-slate-800 text-white",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),d("settings.add_new_option")]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(fs,{className:"border border-gray-200",children:e.jsx(os,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-slate-700 font-semibold text-base",children:"â‚º"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide",children:d("settings.currency_options")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v.currency?.length||0})]})]})})}),e.jsx(fs,{className:"border border-gray-200",children:e.jsx(os,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-slate-700 font-semibold text-base",children:"ðŸ’³"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide",children:d("settings.payment_methods")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v.payment_method?.length||0})]})]})})}),e.jsx(fs,{className:"border border-gray-200",children:e.jsx(os,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-slate-700 font-semibold text-base",children:"ðŸ¢"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide",children:d("settings.psp_kasa")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v.psp?.length||0})]})]})})}),e.jsx(fs,{className:"border border-gray-200",children:e.jsx(os,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-slate-700 font-semibold text-base",children:"ðŸ“Š"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide",children:d("common.total_options")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Object.values(v).reduce((e,s)=>e+(s?.length||0),0)})]})]})})})]}),_?e.jsx(fs,{className:"p-8 border border-gray-200",children:e.jsxs(os,{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-700 font-medium",children:d("settings.loading_configuration_data")}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:d("settings.please_wait_retrieve_settings")})]})}):e.jsxs(fs,{className:"border border-gray-200 overflow-hidden",children:[e.jsx(ls,{className:"px-6 py-4 border-b border-gray-200 bg-gray-50/50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(is,{className:"text-base font-semibold text-gray-900",children:d("settings.configuration_categories")}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(bs,{variant:"secondary",className:"text-xs bg-slate-100 text-slate-700",children:[Object.values(v).reduce((e,s)=>e+(s?.length||0),0)," ",d("settings.total_items")]})})]})}),e.jsx(os,{className:"p-0",children:e.jsx("div",{className:"divide-y divide-gray-100",children:pe.map(s=>e.jsxs("div",{className:"p-6 hover:bg-gray-50 transition-colors duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-600 to-gray-600 rounded-lg flex items-center justify-center shadow-sm",children:e.jsx(me,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h5",{className:"text-lg font-bold text-gray-900",children:s.label}),s.isProtected&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-amber-100 text-amber-700 rounded-full text-xs font-medium",children:[e.jsx(Shield,{className:"h-3 w-3"}),d("settings.protected")]})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsx("span",{className:"text-sm text-gray-600",children:s.isStatic?`${s.staticValues?.length||0} ${d("settings.fixed_options")}`:`${v[s.value]?.length||0} ${d("settings.options_configured")}`}),s.isStatic&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:d("settings.fixed_values")}),s.isProtected&&!s.isStatic&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-amber-100 text-amber-800",children:[e.jsx(Shield,{className:"h-3 w-3 mr-1"}),d("settings.protected")]}),s.requiresCommission&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:d("settings.commission_required")})]})]})]}),!s.isStatic&&e.jsxs(Re,{variant:"outline",size:"sm",onClick:()=>{K(e=>({...e,field_name:s.value})),R(!0)},icon:e.jsx(O,{className:"h-4 w-4"}),iconPosition:"left",children:["Add ",s.label]})]}),s.isStatic?e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:s.staticValues?.map((s,t)=>e.jsx("div",{className:"bg-white rounded-lg p-3 border border-gray-200 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-semibold text-gray-900 text-sm",children:s}),e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:d("settings.protected")})]}),e.jsx("p",{className:"text-xs text-gray-500",children:d("settings.static_value")})]}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx(p,{className:"h-4 w-4 text-gray-400"})})]})},t))})}):v[s.value]?.length>0?e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:v[s.value].map(t=>e.jsx("div",{className:"bg-white rounded-lg p-3 border border-gray-200 hover:border-gray-300 hover:shadow-sm transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-semibold text-gray-900 text-sm",children:t.value}),"TETHER"===t.value.toUpperCase()?e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:"Internal KASA"}):null!==t.commission_rate&&void 0!==t.commission_rate?e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:[(100*Number(t.commission_rate)).toFixed(1),"%"]}):null,s.isProtected&&e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-amber-100 text-amber-800",children:[e.jsx(Shield,{className:"h-3 w-3 mr-1"}),d("settings.protected")]})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["ID: ",t.id," â€¢ ",d("settings.created"),": ",t.created_at?new Date(t.created_at).toLocaleDateString():"N/A"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),((e,s)=>{H(e);const t=e.commission_rate?(100*parseFloat(e.commission_rate.toString())).toString():"";K({field_name:s,value:e.value,commission_rate:t}),Y(""),I(!0)})(t,s.value)},className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-50 rounded transition-colors duration-200",title:d("settings.edit_option"),type:"button",children:e.jsx(L,{className:"h-4 w-4"})}),e.jsx("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),(async(e,s)=>{const t=pe.find(e=>e.value===s);if(t?.isProtected){const s=d("settings.delete_protected_warning",{field:t?.label||"Unknown"});if("DELETE"!==prompt(s))return void alert(d("settings.must_type_delete"));if(!confirm(d("settings.final_delete_warning",{option:e.value,field:t?.label||"Unknown"})))return void alert(d("settings.deletion_cancelled"))}else if(!confirm("Are you sure you want to delete this option?"))return;try{Pe.clearToken();const s=await Pe.delete(`/transactions/dropdown-options/${e.id}`);if(s.ok)await ye(),Pe.clearToken();else{let e="Failed to delete option";try{const t=s.data||{};e=t.error||t.message||e}catch(a){}}}catch(r){}})(t,s.value)},className:"p-1.5 rounded transition-colors duration-200 "+(s.isProtected?"text-red-400 hover:text-red-600 hover:bg-red-50":"text-gray-400 hover:text-red-600 hover:bg-red-50"),title:s.isProtected?d("settings.protected_option_warning"):d("settings.delete_option"),type:"button",children:e.jsx(U,{className:"h-4 w-4"})})]})]})},t.id))})}):e.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(me,{className:"h-8 w-8 text-gray-400"})}),e.jsxs("h6",{className:"text-gray-600 font-medium mb-1",children:["No ",s.label," configured"]}),e.jsxs("p",{className:"text-sm text-gray-500 mb-3",children:["Start building your ",s.label.toLowerCase()," configuration"]}),e.jsxs("button",{onClick:()=>R(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors duration-200 font-medium text-sm",children:[e.jsx(O,{className:"h-4 w-4"}),"Add First ",s.label]})]})]},s.value))})})]})]})},{id:"departments",label:d("settings.departments"),icon:le,content:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(Ee,{variant:"elevated",className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gray-100 rounded-full -translate-y-16 translate-x-16"}),e.jsx(os,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-700 to-gray-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx(le,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx(is,{className:"text-2xl font-bold text-gray-900",children:d("settings.department_management")}),e.jsx(cs,{className:"text-gray-600 font-medium",children:d("settings.organizational_structure_desc")})]})]}),e.jsx(Re,{variant:"primary",size:"lg",onClick:()=>fe(),icon:e.jsx(O,{className:"h-5 w-5"}),iconPosition:"left",className:"px-6 py-3 font-semibold shadow-lg hover:shadow-lg",children:d("settings.add_new_department")})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(Ee,{variant:"outlined",className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-gray-100 rounded-full -translate-y-8 translate-x-8"}),e.jsx(os,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(le,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:d("settings.total_departments")}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:V.length})]})]})})]}),e.jsxs(Ee,{variant:"outlined",className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-slate-100 rounded-full -translate-y-8 translate-x-8"}),e.jsx(os,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx($,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:d("settings.active_teams")}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:V.filter(e=>["Conversion","Retention","Marketing","Research","Operation"].includes(e)).length})]})]})})]}),e.jsxs(Ee,{variant:"outlined",className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-slate-100 rounded-full -translate-y-8 translate-x-8"}),e.jsx(os,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(G,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:d("settings.support_functions")}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:V.filter(e=>["Management","Facility"].includes(e)).length})]})]})})]})]}),Q?e.jsx(Ee,{variant:"outlined",className:"p-8",children:e.jsxs(os,{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 font-medium",children:d("settings.loading_organizational_structure")}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:d("settings.please_wait_retrieve_department_config")})]})}):e.jsxs(Ee,{variant:"outlined",className:"overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-gray-50 to-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:d("settings.organizational_structure")}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-xs text-gray-500 bg-white px-2 py-1 rounded-full border border-gray-200",children:[V.length," ",d("settings.departments")]})})]})}),0===V.length?e.jsxs("div",{className:"text-center py-12 px-6",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(le,{className:"h-10 w-10 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:d("settings.no_departments_configured")}),e.jsx("p",{className:"text-gray-500 mb-6 max-w-md mx-auto text-sm",children:d("settings.start_building_organizational_structure")}),e.jsxs("button",{onClick:()=>fe(),className:"inline-flex items-center px-6 py-3 border border-transparent rounded-lg text-sm font-medium text-white bg-gradient-to-r from-gray-700 to-gray-600 hover:from-gray-800 hover:to-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors shadow-sm",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),d("settings.create_first_department")]})]}):e.jsx("div",{className:"divide-y divide-gray-100",children:V.map((s,t)=>e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-600 to-gray-600 rounded-lg flex items-center justify-center shadow-sm",children:e.jsx(le,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-bold text-gray-900",children:s}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[d("settings.department_id"),": ",t+1]}),["Conversion","Retention","Marketing","Research","Operation"].includes(s)&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:d("settings.core_team")}),["Management","Facility"].includes(s)&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:d("settings.support_function")})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>fe(s),className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 font-medium text-sm",title:d("settings.edit"),children:[e.jsx(L,{className:"h-4 w-4"}),d("settings.edit")]}),e.jsxs("button",{onClick:()=>(async e=>{if(confirm(`Are you sure you want to delete the department "${e}"? This action cannot be undone.`))try{const s=V.filter(s=>s!==e);X(s),localStorage.setItem("systemDepartments",JSON.stringify(s))}catch(s){}})(s),className:"inline-flex items-center gap-2 px-4 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors duration-200 font-medium text-sm",title:d("settings.delete"),children:[e.jsx(U,{className:"h-4 w-4"}),d("settings.delete")]})]})]})},t))})]})]})},{id:"notifications",label:d("settings.notifications"),icon:xe,content:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 border border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-700 rounded-lg flex items-center justify-center shadow-sm",children:e.jsx(xe,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:d("settings.notifications_title")}),e.jsx("p",{className:"text-sm text-gray-600",children:d("settings.configure_notifications")})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white rounded-lg p-5 border border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-gray-500 to-gray-600 rounded-lg flex items-center justify-center",children:e.jsx(te,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:d("settings.email_notifications_title")}),e.jsx("p",{className:"text-xs text-gray-500",children:d("settings.receive_important_updates")})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer"}),e.jsx("div",{className:"w-10 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-orange-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-gray-500"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg p-5 border border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-700 rounded-lg flex items-center justify-center",children:e.jsx(re,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:d("settings.sms_notifications_title")}),e.jsx("p",{className:"text-xs text-gray-500",children:d("settings.urgent_alerts_text")})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer"}),e.jsx("div",{className:"w-10 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-orange-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-gray-500"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg p-5 border border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-700 rounded-lg flex items-center justify-center",children:e.jsx(xe,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:d("settings.push_notifications_title")}),e.jsx("p",{className:"text-xs text-gray-500",children:d("settings.realtime_browser_notifications")})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer"}),e.jsx("div",{className:"w-10 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-orange-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-gray-500"})]})]})})]})]})})},{id:"integrations",label:d("settings.integrations"),icon:u,content:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-gray-50 rounded-xl p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-700 to-gray-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx(u,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:d("settings.system_integrations")}),e.jsx("p",{className:"text-gray-600 font-medium",children:d("settings.connect_external_services")})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-gray-50 to-gray-50",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:d("settings.api_integrations")}),e.jsx("p",{className:"text-sm text-gray-600",children:d("settings.connect_external_data_sources")})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(T,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 text-sm",children:d("settings.exchange_rate_apis")}),e.jsx("p",{className:"text-xs text-gray-500",children:d("settings.realtime_currency_conversion")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:d("settings.active")}),e.jsx("button",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 text-xs font-medium",children:d("settings.configure")})]})]})}),e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(le,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 text-sm",children:d("settings.banking_apis")}),e.jsx("p",{className:"text-xs text-gray-500",children:d("settings.account_balance_sync")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:d("settings.pending")}),e.jsx("button",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 text-xs font-medium",children:d("settings.setup")})]})]})}),e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(M,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 text-sm",children:d("settings.market_data_apis")}),e.jsx("p",{className:"text-xs text-gray-500",children:d("settings.stock_prices_analytics")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:d("settings.inactive")}),e.jsx("button",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 text-xs font-medium",children:d("settings.enable")})]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:d("settings.data_integrations")}),e.jsx("p",{className:"text-sm text-gray-600",children:d("settings.import_export_external_data")})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(i,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 text-sm",children:d("settings.excel_csv_import")}),e.jsx("p",{className:"text-xs text-gray-500",children:d("settings.bulk_transaction_import")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:d("settings.active")}),e.jsx("button",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 text-xs font-medium",children:d("settings.manage")})]})]})}),e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(r,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 text-sm",children:d("settings.database_sync")}),e.jsx("p",{className:"text-xs text-gray-500",children:d("settings.realtime_data_sync")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:d("settings.active")}),e.jsx("button",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 text-xs font-medium",children:d("settings.monitor")})]})]})}),e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx(F,{className:"h-5 w-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 text-sm",children:d("settings.report_export")}),e.jsx("p",{className:"text-xs text-gray-500",children:d("settings.automated_report_generation")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:d("settings.active")}),e.jsx("button",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 text-xs font-medium",children:d("settings.configure")})]})]})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:d("settings.integration_health_status")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg border border-slate-200",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(k,{className:"h-5 w-5 text-slate-700"})}),e.jsx("p",{className:"text-sm font-medium text-slate-700",children:d("settings.active")}),e.jsxs("p",{className:"text-xs text-slate-700",children:["4 ",d("settings.integrations")]})]}),e.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:[e.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(g,{className:"h-5 w-5 text-yellow-600"})}),e.jsx("p",{className:"text-sm font-medium text-yellow-800",children:d("settings.pending")}),e.jsxs("p",{className:"text-xs text-yellow-600",children:["1 ",d("settings.integrations")]})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(he,{className:"h-5 w-5 text-gray-600"})}),e.jsx("p",{className:"text-sm font-medium text-gray-800",children:d("settings.inactive")}),e.jsxs("p",{className:"text-xs text-gray-600",children:["1 ",d("settings.integrations")]})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(M,{className:"h-5 w-5 text-gray-600"})}),e.jsx("p",{className:"text-sm font-medium text-gray-800",children:d("settings.total")}),e.jsxs("p",{className:"text-xs text-gray-600",children:["6 ",d("settings.integrations")]})]})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-gray-50 rounded-xl p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:d("settings.need_more_integrations")}),e.jsx("p",{className:"text-sm text-gray-600",children:d("settings.contact_integration_team")})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 font-medium text-sm",children:d("settings.view_documentation")}),e.jsx("button",{className:"px-6 py-2 bg-gradient-to-r from-gray-700 to-gray-600 text-white rounded-lg hover:from-gray-800 hover:to-gray-700 transition-all duration-200 font-medium text-sm",children:d("settings.request_integration")})]})]})})]})}];return e.jsx(Ms,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx(ys,{title:d("settings.title"),description:d("settings.config"),icon:N,actions:e.jsxs(ms,{variant:"outline",size:"sm",onClick:()=>{"dropdowns"===l?ye():"departments"===l&&je()},className:"border-gray-300 hover:bg-gray-50",children:[e.jsx(r,{className:"h-4 w-4 mr-2"}),d("settings.refresh")]})})}),e.jsxs(xs,{value:l,onValueChange:c,className:"w-full",children:[e.jsxs(hs,{className:"grid w-full grid-cols-5 bg-gray-50/80 border border-gray-200/60 rounded-lg shadow-sm",children:[e.jsxs(gs,{value:"general",className:"flex items-center gap-2",children:[e.jsx(N,{className:"h-4 w-4"}),d("tabs.general")]}),e.jsxs(gs,{value:"dropdowns",className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4"}),d("tabs.dropdowns")]}),e.jsxs(gs,{value:"departments",className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4"}),d("tabs.departments")]}),e.jsxs(gs,{value:"notifications",className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4"}),d("tabs.notifications")]}),e.jsxs(gs,{value:"integrations",className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"}),d("tabs.integrations")]})]}),be.map(s=>e.jsx(us,{value:s.id,className:"mt-6",children:s.content},s.id))]}),A&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",onClick:()=>R(!1),children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full relative",onClick:e=>e.stopPropagation(),children:[e.jsx("div",{className:"p-5 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:d("settings.add_option")}),e.jsx(Re,{variant:"ghost",size:"sm",onClick:()=>R(!1),icon:e.jsx(D,{className:"h-4 w-4"}),children:d("common.close")})]})}),e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{className:"relative custom-dropdown-container",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:d("settings.field_type")}),e.jsxs("div",{className:"relative custom-dropdown-container",children:[e.jsxs("button",{type:"button",onClick:()=>j(!y),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 bg-white text-gray-900 cursor-pointer text-left flex items-center justify-between hover:border-gray-400 transition-colors",children:[e.jsx("span",{className:q.field_name?"text-gray-900":"text-gray-500",children:q.field_name?pe.find(e=>e.value===q.field_name)?.label:d("settings.select_field_type")}),e.jsx(P,{className:"h-4 w-4 text-gray-500 transition-transform "+(y?"rotate-180":"")})]}),y&&e.jsx("div",{className:"absolute z-[10001] w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-auto",children:e.jsx("div",{className:"py-1",children:pe.filter(e=>!e.isStatic).map(s=>e.jsxs("button",{type:"button",onClick:()=>{K(e=>({...e,field_name:s.value})),j(!1)},className:"w-full px-3 py-2 text-left hover:bg-gray-100 transition-colors flex items-center justify-between "+(q.field_name===s.value?"bg-gray-50 text-gray-900 font-medium":"text-gray-700"),children:[e.jsx("span",{children:s.label}),q.field_name===s.value&&e.jsx(ge,{className:"h-4 w-4 text-gray-600"})]},s.value))})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:d("settings.option_value")}),e.jsx(rs,{type:"text",value:q.value,onChange:e=>K(s=>({...s,value:e.target.value})),placeholder:d("settings.enter_option_value")})]}),pe.find(e=>e.value===q.field_name)?.requiresCommission&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:d("settings.commission_rate_required")}),e.jsx(rs,{type:"number",step:"0.01",min:"0",max:"100",value:q.commission_rate,onChange:e=>K(s=>({...s,commission_rate:e.target.value})),placeholder:d("settings.enter_commission_placeholder"),required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:d("settings.commission_help")})]}),pe.find(e=>e.value===q.field_name)?.isProtected&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[d("settings.security_code")," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(rs,{type:"password",value:W,onChange:e=>Y(e.target.value),placeholder:d("settings.enter_security_code"),required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:d("settings.security_code_required_info")})]})]}),e.jsxs("div",{className:"p-5 border-t border-gray-100 flex gap-3",children:[e.jsx(Re,{variant:"outline",onClick:()=>R(!1),className:"flex-1",children:d("common.cancel")}),e.jsx(Re,{variant:"primary",onClick:async()=>{if(!q.field_name)return;const e=pe.find(e=>e.value===q.field_name);if(e?.isProtected){if(!W.trim())return;if("4561"!==W.trim())return}if(!q.value.trim())return;if((v[q.field_name]||[]).find(e=>e.value===q.value.trim()))return;let s=null;if("psp"===q.field_name){if(!q.commission_rate||""===q.commission_rate.trim())return void alert("Commission rate is required for PSP options");let e=parseFloat(q.commission_rate);if(isNaN(e))return void alert("Commission rate must be a valid number");if(e>1&&(e/=100),e<0||e>1)return void alert("Commission rate must be between 0 and 100% (enter as decimal: 0.025 for 2.5% or as percentage: 2.5)");s=e.toString()}try{const e=await Pe.post("/transactions/dropdown-options",{field_name:q.field_name,value:q.value.trim(),commission_rate:s});if(e.ok||201===e.status)R(!1),K({field_name:"",value:"",commission_rate:""}),Y(""),await ye();else{let s=d("settings.failed_to_add_option");try{const t=e.data||{};s=t.error||t.message||s}catch(t){}alert(s)}}catch(a){}},disabled:!q.field_name||!q.value||pe.find(e=>e.value===q.field_name)?.requiresCommission&&!q.commission_rate||pe.find(e=>e.value===q.field_name)?.isProtected&&!W,className:"flex-1",children:d("settings.add_option")})]})]})}),z&&B&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",onClick:()=>I(!1),children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full relative",onClick:e=>e.stopPropagation(),children:[e.jsx("div",{className:"p-5 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:d("settings.edit_option")}),e.jsx(Re,{variant:"ghost",size:"sm",onClick:()=>I(!1),icon:e.jsx(D,{className:"h-4 w-4"}),children:d("common.close")})]})}),e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:d("settings.field_type")}),e.jsx(rs,{type:"text",value:pe.find(e=>e.value===q.field_name)?.label||q.field_name,className:"bg-gray-50",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:d("settings.option_value")}),e.jsx(rs,{type:"text",value:q.value,onChange:e=>K(s=>({...s,value:e.target.value})),placeholder:d("settings.enter_option_value")})]}),pe.find(e=>e.value===q.field_name)?.requiresCommission&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:d("settings.commission_rate_required")}),e.jsx(rs,{type:"number",step:"0.01",min:"0",max:"100",value:q.commission_rate,onChange:e=>K(s=>({...s,commission_rate:e.target.value})),placeholder:d("settings.enter_commission_placeholder"),required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:d("settings.commission_help")})]}),pe.find(e=>e.value===q.field_name)?.isProtected&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[d("settings.security_code")," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(rs,{type:"password",value:W,onChange:e=>Y(e.target.value),placeholder:d("settings.enter_security_code"),required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:d("settings.security_code_edit_info")})]})]}),e.jsxs("div",{className:"p-5 border-t border-gray-100 flex gap-3",children:[e.jsx(Re,{variant:"outline",onClick:()=>I(!1),className:"flex-1",children:d("common.cancel")}),e.jsx(Re,{variant:"primary",onClick:async()=>{if(!B)return;const e=pe.find(e=>e.value===q.field_name);if(e?.isProtected){if(!W.trim())return void alert(d("settings.security_code_required"));if("4561"!==W.trim())return void alert(d("settings.invalid_security_code"))}if((v[q.field_name]||[]).find(e=>e.value===q.value.trim()&&e.id!==B.id))return void alert(d("settings.option_value_exists").replace("{value}",q.value.trim()).replace("{field}",e?.label||q.field_name));if(!q.value.trim())return;let s=null;if("psp"===q.field_name){if(!q.commission_rate||""===q.commission_rate.trim())return void alert("Commission rate is required for PSP options");let e=parseFloat(q.commission_rate);if(isNaN(e))return void alert("Commission rate must be a valid number");if(e>1&&(e/=100),e<0||e>1)return void alert("Commission rate must be between 0 and 100% (enter as decimal: 0.025 for 2.5% or as percentage: 2.5)");s=e.toString()}try{const e=await Pe.put(`/transactions/dropdown-options/${B.id}`,{value:q.value.trim(),commission_rate:s});if(e.ok){try{await Pe.parseResponse(e)}catch(t){}I(!1),H(null),K({field_name:"",value:"",commission_rate:""}),Y("");try{C(!0);const e=await Pe.get("/transactions/dropdown-options");if(e.ok){const s=await Pe.parseResponse(e);w(s||{})}}catch(a){await ye()}finally{C(!1)}Pe.clearToken()}else{let s="Failed to update option";try{const t=e.data||{};s=t.error||t.message||s}catch(t){}}}catch(r){const e=r instanceof Error?r.message:"Failed to update option. Please try again.";alert(e)}},disabled:!q.value||pe.find(e=>e.value===q.field_name)?.requiresCommission&&!q.commission_rate||pe.find(e=>e.value===q.field_name)?.isProtected&&!W,className:"flex-1",children:d("settings.edit_option")})]})]})}),ee&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:()=>se(!1),children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",onClick:e=>e.stopPropagation(),children:[e.jsx("div",{className:"p-5 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:d(oe?"settings.edit_department":"settings.add_new_department")}),e.jsx(Re,{variant:"ghost",size:"sm",onClick:()=>se(!1),icon:e.jsx(D,{className:"h-4 w-4"}),children:d("settings.close")})]})}),e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:d("settings.department_name")}),e.jsx(rs,{type:"text",value:oe?ae:ie,onChange:e=>oe?ne(e.target.value):ce(e.target.value),placeholder:d("settings.enter_department_name"),autoFocus:!0})]}),e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-5 h-5 bg-gray-100 rounded-full flex items-center justify-center mt-0.5",children:e.jsx("span",{className:"text-gray-600 text-xs font-bold",children:"i"})}),e.jsxs("div",{className:"text-sm text-gray-800",children:[e.jsx("p",{className:"font-medium mb-1",children:d("settings.department_management")}),e.jsx("p",{className:"text-xs",children:d(oe?"settings.edit_department_info":"settings.add_department_info")})]})]})})]}),e.jsxs("div",{className:"p-5 border-t border-gray-100 flex gap-3",children:[e.jsx(Re,{variant:"outline",onClick:()=>se(!1),className:"flex-1",children:d("common.cancel")}),e.jsx(Re,{variant:"primary",onClick:oe?async()=>{if(ae.trim())try{const e=V.find(e=>e!==ae);if(!e)return void alert(d("settings.department_not_found"));if(V.includes(ae.trim())&&ae.trim()!==e)return void alert(d("settings.department_name_exists"));const s=V.map(s=>s===e?ae.trim():s);X(s),localStorage.setItem("systemDepartments",JSON.stringify(s)),ne(""),ue(!1),se(!1)}catch(e){}}:async()=>{if(ie.trim())try{if(V.includes(ie.trim()))return void alert(d("settings.department_exists"));const e=[...V,ie.trim()];X(e),localStorage.setItem("systemDepartments",JSON.stringify(e)),ce(""),se(!1)}catch(e){}},disabled:oe?!ae.trim():!ie.trim(),className:"flex-1",children:d(oe?"settings.update_department":"settings.add_department")})]})]})})]})})}},Symbol.toStringTag,{value:"Module"})),pt=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{t:t}=Ve();o();const[a,n]=s.useState([]),[l,i]=s.useState(!0),[c,d]=s.useState(""),[m,x]=s.useState(!1),[h,g]=s.useState(!1),[u,j]=s.useState(!1),[b,N]=s.useState(!1),[v,w]=s.useState(null),[_,S]=s.useState([]),[C,D]=s.useState(!1),[T,A]=s.useState({username:"",email:"",password:"",role:"user",admin_level:0,is_active:!0}),R=async()=>{i(!0);try{const e=await Pe.get("/api/v1/users/");e.data.success&&n(e.data.users)}catch(e){}finally{i(!1)}};s.useEffect(()=>{R()},[]);const P=a.filter(e=>e.username.toLowerCase().includes(c.toLowerCase())||e.email&&e.email.toLowerCase().includes(c.toLowerCase())),F=async e=>{w(e),j(!0),D(!0);try{const s=await Pe.get(`/api/v1/users/${e.id}/sessions`);s.data.success&&S(s.data.sessions)}catch(s){}finally{D(!1)}},z=e=>{switch(e.toLowerCase()){case"admin":return"bg-purple-100 text-purple-800";case"user":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},M=e=>e?new Date(e).toLocaleString():"Never";return e.jsx(Ms,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx(ys,{title:"User Management",description:"Manage system users, their accounts, and permissions",icon:$})}),e.jsxs("div",{className:"mb-6 flex items-center justify-between gap-4",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(rs,{type:"text",placeholder:"Search users by username or email...",value:c,onChange:e=>d(e.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ms,{onClick:R,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(r,{className:"h-4 w-4"}),"Refresh"]}),e.jsxs(ms,{onClick:()=>{A({username:"",email:"",password:"",role:"user",admin_level:0,is_active:!0}),x(!0)},className:"flex items-center gap-2 bg-slate-700 hover:bg-slate-800",children:[e.jsx(O,{className:"h-4 w-4"}),"Add User"]})]})]}),e.jsxs(fs,{children:[e.jsxs(ls,{children:[e.jsxs(is,{children:["Users (",P.length,")"]}),e.jsx(cs,{children:"All system users and their status"})]}),e.jsx(os,{children:l?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(r,{className:"h-6 w-6 animate-spin text-gray-400"})}):0===P.length?e.jsx("div",{className:"text-center py-12 text-gray-500",children:c?"No users found matching your search":"No users found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Username"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Email"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Role"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Last Login"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Sessions"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:P.map(s=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.username}),s.admin_level>0&&e.jsx(bs,{className:"bg-purple-100 text-purple-800 text-xs",children:s.admin_title})]})}),e.jsx("td",{className:"py-3 px-4 text-gray-600",children:s.email||e.jsx("span",{className:"text-gray-400",children:"No email"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx(bs,{className:z(s.role),children:s.role})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.is_active?e.jsxs(bs,{className:"bg-green-100 text-green-800 flex items-center gap-1",children:[e.jsx(k,{className:"h-3 w-3"}),"Active"]}):e.jsxs(bs,{className:"bg-red-100 text-red-800 flex items-center gap-1",children:[e.jsx(ue,{className:"h-3 w-3"}),"Inactive"]}),s.account_locked_until&&e.jsxs(bs,{className:"bg-orange-100 text-orange-800 flex items-center gap-1",children:[e.jsx(p,{className:"h-3 w-3"}),"Locked"]})]})}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:M(s.last_login)}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("button",{onClick:()=>F(s),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:[s.active_sessions_count||0," active"]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(ms,{variant:"ghost",size:"sm",onClick:()=>F(s),title:t("user_management.view_sessions"),children:e.jsx(f,{className:"h-4 w-4"})}),e.jsx(ms,{variant:"ghost",size:"sm",onClick:()=>(e=>{w(e),A({username:e.username,email:e.email||"",password:"",role:e.role,admin_level:e.admin_level,is_active:e.is_active}),g(!0)})(s),title:t("user_management.edit_user"),children:e.jsx(L,{className:"h-4 w-4"})}),e.jsx(ms,{variant:"ghost",size:"sm",onClick:()=>(e=>{w(e),A({...T,password:""}),N(!0)})(s),title:"Reset Password",children:e.jsx(pe,{className:"h-4 w-4"})}),s.account_locked_until&&e.jsx(ms,{variant:"ghost",size:"sm",onClick:()=>(async e=>{try{const s=await Pe.post(`/api/v1/users/${e.id}/unlock`);s.data.success?R():alert(s.data.error||"Failed to unlock user")}catch(s){alert(s.response?.data?.error||"Failed to unlock user")}})(s),title:"Unlock Account",className:"text-orange-600 hover:text-orange-800",children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx(ms,{variant:"ghost",size:"sm",onClick:()=>(async e=>{try{const s=await Pe.post(`/api/v1/users/${e.id}/toggle-active`);s.data.success?R():alert(s.data.error||t("user_management.failed_to_update_status"))}catch(s){alert(s.response?.data?.error||t("user_management.failed_to_update_status"))}})(s),title:s.is_active?"Deactivate":"Activate",className:s.is_active?"text-orange-600":"text-green-600",children:s.is_active?e.jsx(ue,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})}),e.jsx(ms,{variant:"ghost",size:"sm",onClick:()=>(async e=>{if(confirm(t("user_management.confirm_delete",{username:e.username})))try{const s=await Pe.delete(`/api/v1/users/${e.id}`);s.data.success?R():alert(s.data.error||t("user_management.failed_to_delete"))}catch(s){alert(s.response?.data?.error||t("user_management.failed_to_delete"))}})(s),title:t("user_management.delete_user"),className:"text-red-600 hover:text-red-800",children:e.jsx(U,{className:"h-4 w-4"})})]})})]},s.id))})]})})})]}),e.jsx(Ue,{isOpen:m,onClose:()=>x(!1),title:"Add New User",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Username ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(rs,{type:"text",value:T.username,onChange:e=>A({...T,username:e.target.value}),placeholder:"Enter username",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx(rs,{type:"email",value:T.email,onChange:e=>A({...T,email:e.target.value}),placeholder:"Enter email (optional)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(rs,{type:"password",value:T.password,onChange:e=>A({...T,password:e.target.value}),placeholder:"Enter password (min 6 characters)",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),e.jsxs("select",{value:T.role,onChange:e=>A({...T,role:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-slate-500",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"viewer",children:"Viewer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admin Level"}),e.jsxs("select",{value:T.admin_level,onChange:e=>A({...T,admin_level:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-slate-500",children:[e.jsx("option",{value:"0",children:"Regular User (0)"}),e.jsx("option",{value:"1",children:"Main Admin (1)"}),e.jsx("option",{value:"2",children:"Secondary Admin (2)"}),e.jsx("option",{value:"3",children:"Sub Admin (3)"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"is_active_add",checked:T.is_active,onChange:e=>A({...T,is_active:e.target.checked}),className:"rounded border-gray-300"}),e.jsx("label",{htmlFor:"is_active_add",className:"text-sm text-gray-700",children:"Active Account"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(ms,{variant:"outline",onClick:()=>x(!1),children:t("common.cancel")}),e.jsxs(ms,{onClick:async()=>{try{const e=await Pe.post("/api/v1/users/",T);e.data.success?(x(!1),A({username:"",email:"",password:"",role:"user",admin_level:0,is_active:!0}),R()):alert(e.data.error||t("user_management.failed_to_create"))}catch(e){alert(e.response?.data?.error||t("user_management.failed_to_create"))}},className:"bg-slate-700 hover:bg-slate-800",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),t("user_management.create_user")]})]})]})}),e.jsx(Ue,{isOpen:h,onClose:()=>g(!1),title:`${t("user_management.edit_user")}: ${v?.username}`,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Username ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(rs,{type:"text",value:T.username,onChange:e=>A({...T,username:e.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx(rs,{type:"email",value:T.email,onChange:e=>A({...T,email:e.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),e.jsxs("select",{value:T.role,onChange:e=>A({...T,role:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-slate-500",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"viewer",children:"Viewer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admin Level"}),e.jsxs("select",{value:T.admin_level,onChange:e=>A({...T,admin_level:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-slate-500",disabled:0===v?.admin_level,children:[e.jsx("option",{value:"0",children:"Regular User (0)"}),e.jsx("option",{value:"1",children:"Main Admin (1)"}),e.jsx("option",{value:"2",children:"Secondary Admin (2)"}),e.jsx("option",{value:"3",children:"Sub Admin (3)"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"is_active_edit",checked:T.is_active,onChange:e=>A({...T,is_active:e.target.checked}),className:"rounded border-gray-300",disabled:0===v?.admin_level}),e.jsx("label",{htmlFor:"is_active_edit",className:"text-sm text-gray-700",children:"Active Account"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(ms,{variant:"outline",onClick:()=>g(!1),children:t("common.cancel")}),e.jsxs(ms,{onClick:async()=>{if(v)try{const e={username:T.username,email:T.email,role:T.role,admin_level:T.admin_level,is_active:T.is_active},s=await Pe.put(`/api/v1/users/${v.id}`,e);s.data.success?(g(!1),w(null),R()):alert(s.data.error||t("user_management.failed_to_update"))}catch(e){alert(e.response?.data?.error||t("user_management.failed_to_update"))}},className:"bg-slate-700 hover:bg-slate-800",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),t("user_management.save_changes")]})]})]})}),e.jsx(Ue,{isOpen:b,onClose:()=>N(!1),title:t("user_management.reset_password_for",{username:v?.username||""}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:e.jsx("p",{className:"text-sm text-blue-800",children:t("user_management.enter_new_password")})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t("user_management.new_password")," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(rs,{type:"password",value:T.password,onChange:e=>A({...T,password:e.target.value}),placeholder:t("user_management.enter_new_password_placeholder"),required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(ms,{variant:"outline",onClick:()=>N(!1),children:t("common.cancel")}),e.jsxs(ms,{onClick:async()=>{if(v)if(!T.password||T.password.length<6)alert("Password must be at least 6 characters long");else try{const e=await Pe.post(`/api/v1/users/${v.id}/reset-password`,{password:T.password});e.data.success?(N(!1),A({...T,password:""}),alert("Password reset successfully")):alert(e.data.error||"Failed to reset password")}catch(e){alert(e.response?.data?.error||"Failed to reset password")}},className:"bg-slate-700 hover:bg-slate-800",children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),t("user_management.reset_password")]})]})]})}),e.jsx(Ue,{isOpen:u,onClose:()=>j(!1),title:t("user_management.sessions_for",{username:v?.username||""}),size:"large",children:e.jsxs("div",{className:"space-y-4",children:[C?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(r,{className:"h-6 w-6 animate-spin text-gray-400"})}):0===_.length?e.jsx("div",{className:"text-center py-12 text-gray-500",children:t("user_management.no_sessions_found")}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-2 px-4 font-medium text-gray-700",children:t("user_management.status")}),e.jsx("th",{className:"text-left py-2 px-4 font-medium text-gray-700",children:t("user_management.ip_address")}),e.jsx("th",{className:"text-left py-2 px-4 font-medium text-gray-700",children:t("user_management.user_agent")}),e.jsx("th",{className:"text-left py-2 px-4 font-medium text-gray-700",children:t("user_management.created")}),e.jsx("th",{className:"text-left py-2 px-4 font-medium text-gray-700",children:t("user_management.last_active")})]})}),e.jsx("tbody",{children:_.map(s=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("td",{className:"py-2 px-4",children:s.is_active?e.jsx(bs,{className:"bg-green-100 text-green-800",children:t("user_management.active")}):e.jsx(bs,{className:"bg-gray-100 text-gray-800",children:t("user_management.inactive")})}),e.jsx("td",{className:"py-2 px-4 text-sm text-gray-600",children:s.ip_address||"N/A"}),e.jsx("td",{className:"py-2 px-4 text-sm text-gray-600",children:s.user_agent?e.jsx("span",{className:"max-w-xs truncate block",title:s.user_agent,children:s.user_agent}):"N/A"}),e.jsx("td",{className:"py-2 px-4 text-sm text-gray-600",children:M(s.created_at)}),e.jsx("td",{className:"py-2 px-4 text-sm text-gray-600",children:M(s.last_active)})]},s.id))})]})}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(ms,{variant:"outline",onClick:()=>j(!1),children:t("common.close")})})]})})]})})}},Symbol.toStringTag,{value:"Module"})),yt=new class{baseUrl;constructor(){this.baseUrl=""}async makeRequest(e,s={}){const t=this.baseUrl?`${this.baseUrl}${e}`:e,a={headers:{"Content-Type":"application/json",...s.headers},credentials:"include"},r=await fetch(t,{...a,...s});if(!r.ok){if(401===r.status)throw new Error("Authentication required. Please log in.");if(404===r.status)throw new Error("Exchange rate not found.");if(r.status>=500)throw new Error("Server error. Please try again later.");const e=await r.json().catch(()=>({}));throw new Error(e.message||`HTTP ${r.status}: ${r.statusText}`)}return r.json()}async getStatus(){return this.makeRequest("/api/v1/exchange-rates/status")}async fetchRate(e){const s=await this.makeRequest("/api/v1/exchange-rates/current");return s.success&&s.rate?{status:"success",message:s.message||"Rate fetched successfully",rate:{...s.rate,currency_pair:e.currency_pair}}:{status:"error",message:s.message||"Failed to fetch rate"}}async getDailySummaryRates(e){const s=await this.makeRequest("/api/v1/exchange-rates/current");return s.success&&s.rate?{status:"success",message:s.message||"Rate fetched successfully",rates:{USDTRY:{...s.rate,currency_pair:"USDTRY"}}}:{status:"error",message:s.message||"Failed to fetch rates"}}async updateManualRate(e){return{status:"error",message:"Manual rate updates not currently supported"}}async refreshRates(e){const s=await this.makeRequest("/api/v1/exchange-rates/update",{method:"POST"});return s.success?{status:"success",message:s.message||"Rates refreshed successfully"}:{status:"error",message:s.message||"Failed to refresh rates"}}async getHistory(e){const s=new URLSearchParams({start_date:e.start_date,end_date:e.end_date});return e.currency_pair&&s.append("currency_pair",e.currency_pair),this.makeRequest(`/api/v1/exchange-rates/history?${s}`)}async getMissingRates(e){return{status:"success",message:"No missing rates detected",missing_dates:[]}}async getRate(e,s){try{return(await this.fetchRate({date:s,currency_pair:e})).rate||null}catch(t){return null}}async getRatesForDate(e){try{const s=await this.getDailySummaryRates({date:e});return s.rates&&"object"==typeof s.rates&&!Array.isArray(s.rates)?s.rates:{}}catch(s){return{}}}formatCurrencyPair(e){const[s,t]=e.split("/");return`${s} â†’ ${t}`}getSourceDisplayName(e){switch(e.toLowerCase()){case"yfinance":return"Yahoo Finance";case"manual":return"Manual Override";case"tcmb":return"TCMB";default:return e}}getQualityDisplayName(e){switch(e.toLowerCase()){case"closing_price":return"Closing Price";case"closest_available":return"Closest Available";case"manual":return"Manual";default:return e}}getQualityColor(e){switch(e.toLowerCase()){case"closing_price":return"text-green-600";case"closest_available":return"text-yellow-600";case"manual":return"text-blue-600";default:return"text-gray-600"}}getSourceIcon(e){switch(e.toLowerCase()){case"yfinance":return"ðŸ“Š";case"manual":return"âœï¸";case"tcmb":return"ðŸ›ï¸";default:return"ðŸ“ˆ"}}validateRate(e,s){const[t,a]={"USD/TRY":[1,100],"EUR/TRY":[1,150],"GBP/TRY":[1,200]}[s]||[.1,1e3];return e<=0?{isValid:!1,warning:"Rate must be positive"}:e<t||e>a?{isValid:!0,warning:`${s} rate (${e}) seems unusual (expected ${t}-${a})`}:{isValid:!0}}formatRate(e,s){const[t,a]=s.split("/");return"TRY"===a?`${e.toFixed(4)} ${a}`:`${e.toFixed(2)} ${a}`}calculateConvertedAmount(e,s){return e*s}getSupportedPairs(){return["USD/TRY","EUR/TRY","GBP/TRY"]}isSupportedPair(e){return this.getSupportedPairs().includes(e)}},jt=new class{isMonitoring=!1;checkInterval=null;lastHealthStatus=null;startMonitoring(e=3e4){this.isMonitoring||(this.isMonitoring=!0,this.performHealthCheck(),this.checkInterval=setInterval(()=>{this.performHealthCheck()},e))}stopMonitoring(){this.isMonitoring&&(this.isMonitoring=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null))}async performHealthCheck(){const e=[],s=[],t={backend:!1,frontend:!1,session:!1,csrf:!1,timestamp:(new Date).toISOString()};try{try{const a=await Pe.get("/health");t.backend=a.ok,a.ok||(e.push("Backend is not responding"),s.push("Check if the Flask server is running"))}catch(a){e.push("Cannot connect to backend"),s.push("Restart the Flask server")}try{const a=await fetch("/api/v1/health");t.frontend=a.ok,a.ok||(e.push("Frontend proxy is not working"),s.push("Check Vite configuration and restart frontend"))}catch(a){e.push("Frontend proxy connection failed"),s.push("Restart the frontend development server")}try{const a=await Pe.get("/auth/check");t.session=a.ok,a.ok||(e.push("Session is invalid or expired"),s.push("User should log in again"))}catch(a){e.push("Session check failed"),s.push("Clear browser cookies and log in again")}try{const a=await Pe.get("/auth/csrf-token");if(a.ok){const r=Pe.parseResponse(a);t.csrf=!!r.csrf_token,r.csrf_token||(e.push("CSRF token generation failed"),s.push("Refresh the page to get a new token"))}else e.push("CSRF token endpoint not responding"),s.push("Check backend CSRF configuration")}catch(a){e.push("CSRF token check failed"),s.push("Refresh the page and try again")}}catch(a){e.push("Health check process failed"),s.push("Check browser console for errors")}return this.logHealthStatus(t,e,s),this.lastHealthStatus=t,{status:t,issues:e,recommendations:s}}logHealthStatus(e,s,t){Object.values(e).every(Boolean)&&s.length}getLastHealthStatus(){return this.lastHealthStatus}isHealthy(){return!!this.lastHealthStatus&&Object.values(this.lastHealthStatus).every(Boolean)}async refreshSession(){try{return Pe.clearToken(),!!(await Pe.get("/api/v1/auth/csrf-token")).ok}catch(e){return!1}}async testTransactionCreation(){try{const e={client_name:"HEALTH CHECK TEST",amount:"1.00",currency:"TL",payment_method:"BANKA",category:"DEP",psp:"#61",iban:"IBAN",company_order:"TEST COMPANY",date:(new Date).toISOString().split("T")[0],notes:"Health check test transaction"},s=await Pe.post("/transactions",e);return!!s.ok&&!!Pe.parseResponse(s).success}catch(e){return!1}}};"undefined"!=typeof window&&setTimeout(()=>{jt.startMonitoring()},5e3);const ft=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{t:a}=Ve(),{isAuthenticated:l,isLoading:c}=Je(),d=o(),[m,x]=s.useState(!1),[h,g]=s.useState(!1),[p,j]=s.useState(null),[f,v]=s.useState(!1),[w,_]=s.useState({}),[S,A]=s.useState(!1),R={currency:[{id:1,value:"TL"},{id:2,value:"USD"},{id:3,value:"EUR"}],payment_method:[{id:1,value:"Bank"},{id:2,value:"Credit card"},{id:3,value:"Tether"}],psp:[],company:[]},[P,F]=s.useState({has_rates:!1}),[L,U]=s.useState(!1),[$,z]=s.useState(!1),[M,I]=s.useState(""),[B,H]=s.useState(""),[q,K]=s.useState("saved"),[V,J]=s.useState(!1),[X,Q]=s.useState(""),[Z,ee]=s.useState(""),[se,te]=s.useState(!1),[ae,re]=s.useState(""),[ne,ie]=s.useState({client_name:"",company:"",date:"",amount:"",payment_method:"",currency:"",category:"",psp:"",notes:"",eur_rate:"",usd_rate:""}),ce="addTransaction_autoSave";s.useEffect(()=>{const e=localStorage.getItem(ce);if(e)try{const s=JSON.parse(e);ie(s)}catch(s){localStorage.removeItem(ce)}},[]),s.useEffect(()=>{const e=setTimeout(()=>{if(ne.client_name||ne.amount||ne.date){K("saving");try{localStorage.setItem(ce,JSON.stringify(ne)),K("saved")}catch(e){K("error")}}},2e3);return()=>clearTimeout(e)},[ne]),s.useEffect(()=>{!l||c||S||(oe(),jt.performHealthCheck().then(e=>{e.issues.length}))},[l,c,S]),s.useEffect(()=>{if(l&&!c&&!S){const e=setTimeout(()=>{S||oe()},1e3);return()=>clearTimeout(e)}},[l,c,S]);const oe=async()=>{try{x(!0),j(null);const e=await Pe.get("/transactions/dropdown-options");if(e.ok&&e.data){const s=e.data;if(!s||"object"!=typeof s)throw new Error("Invalid data format received from API");_(s),A(!0)}else e.status,j(`Dropdown seÃ§enekleri yÃ¼klenemedi (Status: ${e.status}). LÃ¼tfen sayfayÄ± yenileyin.`)}catch(e){const s=e?.message||"Bilinmeyen hata",t=e?.status?` (Status: ${e.status})`:"";_(R),A(!0),j(`${a("transactions.add_transaction_form.errors.dropdown_load_failed")} (${s}${t})`),setTimeout(()=>{j(null)},5e3)}finally{x(!1)}},de=(e,s)=>{if(ie(t=>({...t,[e]:s})),"currency"===e&&"USD"===s&&z(!0),"currency"===e||"date"===e){const t={...ne,[e]:s};me(t.currency,t.date)}},me=async(e,s)=>{const t=e||ne.currency,a=s||ne.date;"EUR"!==t&&"USD"!==t||!a?U(!1):(U(!0),await xe(a,t))},xe=async(e,s)=>{try{if(I("Checking existing rates..."),"EUR"===s){const s=await yt.fetchRate({date:e,currency_pair:"EUR/TRY"});if("success"===s.status&&s.rate?.rate){const e=s.rate.rate;I(`âœ“ EUR/TRY rate fetched: ${e}`),F({has_rates:!0,eur_rate:e}),ie(s=>({...s,eur_rate:e.toString()}))}else I(`âš  EUR/TRY rate not found for ${e}.`),F({has_rates:!1}),ie(e=>({...e,eur_rate:"0.00"}))}if("USD"===s){const s=await yt.fetchRate({date:e,currency_pair:"USD/TRY"});if("success"===s.status&&s.rate?.rate){const e=s.rate.rate;I(`âœ“ USD/TRY rate fetched: ${e}`),ie(s=>({...s,usd_rate:e.toString()}))}else I(`âš  USD/TRY rate not found for ${e}.`),ie(e=>({...e,usd_rate:"0.00"}))}}catch(t){I(`âœ— Error: ${t}`)}},he=()=>{d("/clients")};return c||m?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsx(Ee,{className:"max-w-sm w-full text-center",variant:"elevated",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(r,{className:"h-8 w-8 text-blue-600 animate-spin"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:a("transactions.add_transaction_form.loading_form")}),e.jsx("p",{className:"text-gray-600",children:a("transactions.add_transaction_form.loading_message")})]})]})})}):f?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsx(Ee,{className:"max-w-md w-full text-center",variant:"elevated",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(k,{className:"h-10 w-10 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:a("transactions.add_transaction_form.success_title")}),e.jsx("p",{className:"text-gray-600",children:a("transactions.add_transaction_form.success_message")})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(Re,{variant:"primary",size:"lg",onClick:()=>d("/clients"),icon:e.jsx(i,{className:"h-4 w-4"}),className:"flex-1",children:a("transactions.add_transaction_form.view_clients")}),e.jsx(Re,{variant:"outline",size:"lg",onClick:()=>{ie({client_name:"",company:"",date:"",amount:"",payment_method:"",currency:"",category:"",psp:"",notes:"",eur_rate:"",usd_rate:""}),v(!1),j(null),A(!1),H(""),localStorage.removeItem(ce),K("saved")},icon:e.jsx(O,{className:"h-4 w-4"}),className:"flex-1",children:a("transactions.add_transaction_form.add_another")})]})]})})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"flex items-center justify-between h-16",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(Re,{variant:"ghost",size:"sm",onClick:he,icon:e.jsx(n,{className:"h-4 w-4"}),className:"text-gray-600 hover:text-gray-900",children:a("transactions.add_transaction_form.back_to_transactions")}),e.jsx("div",{className:"h-6 w-px bg-gray-300"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-700 rounded-lg flex items-center justify-center shadow-sm",children:e.jsx(i,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:a("transactions.add_transaction_form.title")}),e.jsx("p",{className:"text-sm text-gray-500",children:a("transactions.add_transaction_form.subtitle")})]})]})]})})})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"space-y-6",children:[p&&e.jsx(Ee,{variant:"outlined",className:"border-red-200 bg-red-50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(t,{className:"h-4 w-4 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-red-900",children:a("transactions.add_transaction_form.validation_error")}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:p})]})]})}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),ne.client_name.trim())if(!ne.amount||parseFloat(ne.amount)<=0)j(a("transactions.add_transaction_form.validation.amount_required"));else if(ne.date)if(ne.currency)if(ne.category)if(["WD","DEP"].includes(ne.category))if(["TL","USD","EUR"].includes(ne.currency))if("EUR"!==ne.currency||ne.eur_rate)if("USD"!==ne.currency||ne.usd_rate)try{if(g(!0),j(null),!(await Pe.get("/auth/check")).ok&&!(await Pe.refreshSession()))return j(a("transactions.add_transaction_form.errors.csrf_error")),void g(!1);let e=null;try{const s=await Pe.get("/auth/csrf-token");if(s.ok){const t=await Pe.parseResponse(s);t.csrf_token&&(e=t.csrf_token,localStorage.setItem("csrf_token",e))}}catch(s){await Pe.refreshSession()&&(e=localStorage.getItem("csrf_token"))}if(!e){if(!(await Pe.refreshSession()))return j(a("transactions.add_transaction_form.errors.csrf_error")),void g(!1);e=localStorage.getItem("csrf_token")}const l={...ne};"USD"===ne.currency&&ne.usd_rate&&(l.exchange_rate=ne.usd_rate),"EUR"===ne.currency&&ne.eur_rate&&(l.exchange_rate=ne.eur_rate),se&&Z&&parseFloat(Z)>0&&(l.manual_commission_rate=parseFloat(Z),l.use_manual_commission=!0);let i=null,c=0;const o=2;for(;c<=o;)try{if(c>0)try{const s=await Pe.get("/auth/csrf-token");if(s.ok){const t=await Pe.parseResponse(s);t.csrf_token&&(e=t.csrf_token,localStorage.setItem("csrf_token",e))}}catch(s){}if(i=await Pe.post("/transactions/",l),i&&i.ok)break;if(i&&!i.ok&&i.data){const e=i.data;if((403===i.status||400===i.status&&(e.csrf_error||"CSRF validation failed"===e.error||"Invalid CSRF token"===e.error||e.message?.includes("CSRF")||e.message?.includes("Security token")))&&(e.new_token&&localStorage.setItem("csrf_token",e.new_token),c<o))try{if(await Pe.refreshSession()){c++,await new Promise(e=>setTimeout(e,500));continue}}catch(t){}}if(i&&(401===i.status||400===i.status||403===i.status)&&c<o){try{await Pe.refreshSession()||await jt.refreshSession()}catch(t){if(c===o-1)return j("Session expired. Please refresh the page and try again."),void g(!1)}c++,await new Promise(e=>setTimeout(e,500));continue}break}catch(r){if(c<o){c++,await new Promise(e=>setTimeout(e,1e3));continue}throw r}if(!i)throw new Error("Failed to get response from server after all retry attempts");if(!i.ok){let e=a("transactions.add_transaction_form.errors.failed_to_add");try{const s=i.data;400!==i.status&&403!==i.status||!(s.csrf_error||"CSRF validation failed"===s.error||s.message?.includes("CSRF")||s.message?.includes("Security token"))?s?.error?.message?e=s.error.message:s?.error?e="string"==typeof s.error?s.error:JSON.stringify(s.error):s?.message?e=s.message:"string"==typeof s&&(e=s):e=s.message||a("transactions.add_transaction_form.errors.csrf_error")}catch(n){}throw new Error(`Server error (${i.status}): ${e}`)}const d=Pe.parseResponse(i);if(i.ok&&(d&&"object"==typeof d&&"success"in d&&d.success||d&&"object"==typeof d&&"id"in d||d&&"object"==typeof d&&"transaction"in d)){v(!0),localStorage.removeItem(ce),K("saved");const e=d?.transaction?.id||d?.id||d?.data?.id;setTimeout(()=>{window.dispatchEvent(new CustomEvent("transactionsUpdated",{detail:{action:"create",transactionId:e}}))},500),ie({client_name:"",company:"",date:"",amount:"",payment_method:"",currency:"",category:"",psp:"",notes:"",eur_rate:"",usd_rate:""}),H("")}else{const e=d?.error?.message||d?.error||d?.message||a("transactions.add_transaction_form.errors.failed_to_add");j(e)}}catch(r){if(r instanceof Error){const e=r.message;e.includes("CSRF")||e.includes("Security token")?j(a("transactions.add_transaction_form.errors.csrf_error")):e.includes("Authentication")||e.includes("login")?j(a("transactions.add_transaction_form.errors.session_expired")):e.includes("401")||e.includes("unauthorized")?j(a("transactions.add_transaction_form.errors.authentication_required")):e.includes("308")||e.includes("redirect")?j(a("transactions.add_transaction_form.errors.url_redirect")):e.includes("404")?j(a("transactions.add_transaction_form.errors.endpoint_not_found")):e.includes("500")?j(a("transactions.add_transaction_form.errors.server_error")):e.includes("403")?j(a("transactions.add_transaction_form.errors.access_denied")):j(`${a("transactions.add_transaction_form.errors.failed_to_add")}: ${e}`)}else j(a("transactions.add_transaction_form.errors.failed_to_add_retry"))}finally{g(!1)}else j(a("transactions.add_transaction_form.validation.usd_rate_required"));else j(a("transactions.add_transaction_form.validation.eur_rate_required"));else j(a("transactions.add_transaction_form.validation.currency_invalid"));else j(a("transactions.add_transaction_form.validation.category_invalid"));else j(a("transactions.add_transaction_form.validation.category_required"));else j(a("transactions.add_transaction_form.validation.currency_required"));else j(a("transactions.add_transaction_form.validation.date_required"));else j(a("transactions.add_transaction_form.validation.client_name_required"))},className:"space-y-6",children:[e.jsx(Ee,{header:{title:a("transactions.add_transaction_form.basic_information"),description:a("transactions.add_transaction_form.basic_information_desc")},children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[a("transactions.add_transaction_form.client_name")," *"]}),e.jsxs("div",{className:"relative",children:[e.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",value:ne.client_name,onChange:e=>de("client_name",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white",placeholder:a("transactions.add_transaction_form.client_name_placeholder"),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[a("transactions.add_transaction_form.transaction_date")," *"]}),e.jsxs("div",{className:"relative",children:[e.jsx(W,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"date",value:ne.date,onChange:e=>de("date",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[a("transactions.add_transaction_form.amount")," *"]}),e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"0.01",value:ne.amount,onChange:e=>de("amount",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white",placeholder:a("transactions.add_transaction_form.amount_placeholder"),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[a("transactions.add_transaction_form.currency")," *"]}),e.jsxs("div",{className:"relative",children:[e.jsx(u,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none z-10"}),e.jsxs("select",{value:ne.currency,onChange:e=>de("currency",e.target.value),className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white appearance-none cursor-pointer",required:!0,disabled:!S,children:[e.jsx("option",{value:"",children:a(S?"transactions.add_transaction_form.select_currency":"transactions.add_transaction_form.loading")}),w.currency&&w.currency.length>0?w.currency.map(s=>e.jsx("option",{value:s.value,children:s.value},s.id)):S?[e.jsx("option",{value:"TL",children:"TL"},"TL"),e.jsx("option",{value:"USD",children:"USD"},"USD"),e.jsx("option",{value:"EUR",children:"EUR"},"EUR")]:null]}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})]})}),e.jsx(Ee,{header:{title:a("transactions.add_transaction_form.payment_information"),description:a("transactions.add_transaction_form.payment_information_desc")},children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[a("transactions.add_transaction_form.payment_method")," *"]}),e.jsxs("div",{className:"relative",children:[e.jsx(Y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none z-10"}),e.jsxs("select",{value:ne.payment_method,onChange:e=>de("payment_method",e.target.value),className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white appearance-none cursor-pointer",required:!0,disabled:!S,children:[e.jsx("option",{value:"",children:a(S?"transactions.add_transaction_form.select_payment_method":"transactions.add_transaction_form.loading")}),w.payment_method&&w.payment_method.length>0?w.payment_method.map(s=>e.jsx("option",{value:s.value,children:s.value},s.id)):S?[e.jsx("option",{value:"Bank",children:"Bank"},"Bank"),e.jsx("option",{value:"Credit card",children:"Credit card"},"CreditCard"),e.jsx("option",{value:"Tether",children:"Tether"},"Tether")]:null]}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[a("transactions.add_transaction_form.transaction_category")," *"]}),e.jsxs("div",{className:"relative",children:[e.jsx(fe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none z-10"}),e.jsxs("select",{value:ne.category,onChange:e=>de("category",e.target.value),className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white appearance-none cursor-pointer",required:!0,children:[e.jsx("option",{value:"",children:a("transactions.add_transaction_form.select_category")}),e.jsx("option",{value:"WD",children:a("transactions.add_transaction_form.category_wd")}),e.jsx("option",{value:"DEP",children:a("transactions.add_transaction_form.category_dep")})]}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 bg-blue-50 p-2 rounded-lg",children:[e.jsx(b,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{children:a("transactions.add_transaction_form.category_info")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a("transactions.add_transaction_form.psp_kasa")}),e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none z-10"}),e.jsxs("select",{value:ne.psp,onChange:e=>de("psp",e.target.value),className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white appearance-none cursor-pointer",disabled:!S,children:[e.jsx("option",{value:"",children:a(S?"transactions.add_transaction_form.select_psp_kasa":"transactions.add_transaction_form.loading")}),w.psp&&w.psp.length>0?w.psp.map(s=>e.jsx("option",{value:s.value,children:s.value},s.id)):null]}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})]})}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:a("transactions.add_transaction_form.manual_commission")}),se&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-green-700 bg-green-100 rounded-full",children:[e.jsx(k,{className:"h-3 w-3"}),a("transactions.add_transaction_form.active")]})]}),se?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",step:"0.01",value:Z,onChange:e=>ee(e.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:a("transactions.add_transaction_form.commission_percent")}),e.jsx("button",{type:"button",onClick:()=>{te(!1),J(!1),Q(""),ee(""),re("")},className:"px-3 py-2 text-sm font-medium text-gray-600 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:a("transactions.add_transaction_form.disable")})]}),e.jsx("p",{className:"text-xs text-gray-500",children:a("transactions.add_transaction_form.commission_override_info")})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"password",value:X,onChange:e=>Q(e.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:a("transactions.add_transaction_form.security_code")}),e.jsx("button",{type:"button",onClick:()=>{"4561"===X?(te(!0),re(""),J(!0)):(re(a("transactions.add_transaction_form.invalid_security_code")),te(!1))},className:"px-3 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:ring-1 focus:ring-blue-500",children:a("transactions.add_transaction_form.enable")})]}),ae&&e.jsx("p",{className:"text-xs text-red-600",children:ae})]})]}),e.jsx(Ee,{header:{title:a("transactions.add_transaction_form.company_information"),description:a("transactions.add_transaction_form.company_information_desc")},children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a("transactions.add_transaction_form.company")}),e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none z-10"}),e.jsxs("select",{value:ne.company,onChange:e=>de("company",e.target.value),className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white appearance-none cursor-pointer",disabled:!S,children:[e.jsx("option",{value:"",children:a(S?"transactions.add_transaction_form.select_company":"transactions.add_transaction_form.loading")}),w.company&&w.company.length>0?w.company.map(s=>e.jsx("option",{value:s.value,children:s.value},s.id)):null]}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})}),e.jsx(Ee,{header:{title:a("transactions.add_transaction_form.additional_information"),description:a("transactions.add_transaction_form.additional_information_desc")},children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a("transactions.add_transaction_form.transaction_notes")}),e.jsxs("div",{className:"relative",children:[e.jsx(be,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx("textarea",{value:ne.notes,onChange:e=>de("notes",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white resize-none",placeholder:a("transactions.add_transaction_form.notes_placeholder"),rows:4})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 bg-gray-50 p-2 rounded-lg",children:[e.jsx(b,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:a("transactions.add_transaction_form.notes_info")})]})]})}),L&&e.jsx(Ee,{variant:"outlined",className:"border-amber-200 bg-amber-50",header:{title:a("transactions.add_transaction_form.exchange_rates_required"),description:a("transactions.add_transaction_form.exchange_rates_desc")},children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-amber-100 border border-amber-200 rounded-lg",children:[e.jsx(t,{className:"h-5 w-5 text-amber-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-800 font-medium",children:a("transactions.add_transaction_form.exchange_rates_warning")}),e.jsx("p",{className:"text-amber-700 text-sm mt-1",children:a("transactions.add_transaction_form.exchange_rates_warning_desc")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:["EUR"===ne.currency&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a("transactions.add_transaction_form.eur_to_tl_rate")}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"0.0001",min:"0",value:ne.eur_rate,onChange:e=>de("eur_rate",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white",placeholder:a("transactions.add_transaction_form.rate_placeholder"),required:"EUR"===ne.currency})]}),e.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-2 rounded-lg",children:a("transactions.add_transaction_form.rate_auto_fetch_info")})]}),"USD"===ne.currency&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a("transactions.add_transaction_form.usd_to_tl_rate")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"0.0001",min:"0",value:ne.usd_rate,onChange:e=>de("usd_rate",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white",placeholder:a("transactions.add_transaction_form.rate_placeholder")})]}),e.jsx(Re,{type:"button",variant:"success",size:"sm",onClick:()=>z(!0),icon:e.jsx(C,{className:"h-4 w-4"}),children:a("transactions.add_transaction_form.get_rate")}),e.jsx(Re,{type:"button",variant:"outline",size:"sm",onClick:()=>{const e=parseFloat(ne.amount||"0"),s=parseFloat(ne.usd_rate||"0");!isNaN(e)&&!isNaN(s)&&s>0?H((e*s).toFixed(2)):H("")},icon:e.jsx(r,{className:"h-4 w-4"}),children:a("transactions.add_transaction_form.apply")})]}),B&&e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-green-800",children:[e.jsxs("strong",{children:[a("transactions.add_transaction_form.converted_tl_amount"),":"]})," ",B]})}),e.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-2 rounded-lg",children:a("transactions.add_transaction_form.rate_auto_fetch_info")})]})]}),M&&e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(b,{className:"h-5 w-5 text-blue-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-800 font-medium",children:a("transactions.add_transaction_form.rate_validation")}),e.jsx("p",{className:"text-blue-700 text-sm",children:M})]})]})})]})}),e.jsx(Ee,{className:"bg-gray-50",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(Re,{type:"button",variant:"outline",size:"lg",onClick:he,className:"flex-1",icon:e.jsx(D,{className:"h-4 w-4"}),children:a("transactions.add_transaction_form.cancel")}),e.jsx(Re,{type:"submit",variant:"primary",size:"lg",disabled:h,loading:h,className:"flex-1",icon:e.jsx(E,{className:"h-4 w-4"}),children:a(h?"transactions.add_transaction_form.adding_transaction":"transactions.add_transaction_form.add_transaction")})]})})]}),e.jsx(Ee,{header:{title:a("transactions.add_transaction_form.dropdown_management"),description:a("transactions.add_transaction_form.dropdown_management_desc")},children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(Re,{variant:"success",size:"lg",onClick:()=>d("/settings?tab=dropdowns"),icon:e.jsx(N,{className:"h-4 w-4"}),className:"mx-auto",children:a("transactions.add_transaction_form.manage_dropdown_options")}),e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3 text-left",children:[e.jsx(b,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-blue-900 mb-1",children:a("transactions.add_transaction_form.customize_dropdown_title")}),e.jsx("p",{className:"text-blue-800",children:a("transactions.add_transaction_form.customize_dropdown_desc")})]})]})})]})})]})}),e.jsx(Js,{isOpen:$,onClose:()=>z(!1),onRateSelect:e=>{ie(s=>({...s,usd_rate:e.toString()})),z(!1)},currentAmount:parseFloat(ne.amount)||0,transactionDate:ne.date})]})}},Symbol.toStringTag,{value:"Module"})),bt=Object.freeze(Object.defineProperty({__proto__:null,default:function(){return e.jsx("div",{className:"p-6",children:e.jsx(Be,{theme:"slate-blue",minHeightScreen:!0,children:e.jsx(zs,{})})})}},Symbol.toStringTag,{value:"Module"})),Nt=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{Ve();const[t,a]=s.useState(!1);return s.useEffect(()=>{window.scrollTo({top:0,behavior:"instant"})},[]),e.jsxs("div",{className:"p-6 animate-in fade-in duration-300",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(Ne,{className:"h-8 w-8 text-gray-600"}),"AI Assistant"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Ask questions and get intelligent insights about your business"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-semibold "+(t?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"),children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full "+(t?"bg-yellow-500":"bg-green-500 animate-pulse")}),t?"Paused":"Active"]}),e.jsx(ms,{variant:"outline",size:"sm",onClick:()=>{a(!t)},className:"h-8 w-8 p-0",title:t?"Resume":"Pause","aria-label":t?"Resume AI assistant":"Pause AI assistant",children:t?e.jsx(ve,{className:"w-4 h-4","aria-hidden":"true"}):e.jsx(we,{className:"w-4 h-4","aria-hidden":"true"})}),e.jsx(ms,{variant:"outline",size:"sm",onClick:()=>{a(!1)},className:"h-8 w-8 p-0",title:"Reset","aria-label":"Reset AI assistant",children:e.jsx(_e,{className:"w-4 h-4","aria-hidden":"true"})})]})]})}),e.jsx("div",{className:"rounded-lg overflow-hidden min-h-[calc(100vh-200px)]",children:e.jsx(He,{apiKey:qe.API_KEY,className:"future-chat-interface h-full"})})]})}},Symbol.toStringTag,{value:"Module"})),vt=s.lazy(()=>Ke(()=>import("./pages-systemmonitor-R69PhKQe.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])).catch(s=>({default:()=>e.jsx("div",{className:"p-6 text-red-600",children:"Failed to load System Monitor component"})}))),wt=s.lazy(()=>Ke(()=>import("./DatabaseManagement-D8EMyVTh.js"),__vite__mapDeps([8,1,3,2,7,4,5,6])).catch(s=>({default:()=>e.jsx("div",{className:"p-6 text-red-600",children:"Failed to load Database Management component"})}))),_t=s.lazy(()=>Ke(()=>import("./SecurityManagement-EA-kHYha.js"),__vite__mapDeps([9,1,3,2,7,4,5,6])).catch(s=>({default:()=>e.jsx("div",{className:"p-6 text-red-600",children:"Failed to load Security Management component"})}))),kt=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{t:t}=Ve(),a=o(),[n,l]=S(),[i,c]=s.useState("home");s.useEffect(()=>{const e=n.get("view");c("monitor"===e||"database"===e||"security"===e?e:"home")},[n]);const d=e=>{const s=new URLSearchParams(n);"home"===e?s.delete("view"):s.set("view",e),l(s,{replace:!0})};return e.jsx(Ms,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx(ys,{title:t("settings.admin"),description:t("settings.system_administration"),icon:_})}),"home"===i&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-all duration-200 hover:border-gray-300 hover:shadow-sm",onClick:()=>a("/admin/organizations"),children:[e.jsx(G,{className:"h-7 w-7 text-blue-600 mb-2"}),e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:"Organizations"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Manage organizations and subscriptions"})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-all duration-200 hover:border-gray-300 hover:shadow-sm",onClick:()=>a("/admin/users"),children:[e.jsx($,{className:"h-7 w-7 text-green-600 mb-2"}),e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:"Users"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Manage user accounts and permissions"})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-all duration-200 hover:border-gray-300 hover:shadow-sm",onClick:()=>a("/admin/permissions"),children:[e.jsx(_,{className:"h-7 w-7 text-gray-600 mb-2"}),e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:t("settings.permissions")}),e.jsx("p",{className:"text-xs text-gray-500",children:t("settings.configure_access_controls")})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-all duration-200 hover:border-gray-300 hover:shadow-sm",onClick:()=>d("monitor"),children:[e.jsx(ke,{className:"h-7 w-7 text-gray-600 mb-2"}),e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:t("settings.system_monitor")}),e.jsx("p",{className:"text-xs text-gray-500",children:t("settings.realtime_system_monitoring")})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-all duration-200 hover:border-gray-300 hover:shadow-sm",onClick:()=>d("database"),children:[e.jsx(Se,{className:"h-7 w-7 text-gray-600 mb-2"}),e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:t("settings.database")}),e.jsx("p",{className:"text-xs text-gray-500",children:t("settings.database_management")})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-all duration-200 hover:border-gray-300 hover:shadow-sm",onClick:()=>d("security"),children:[e.jsx(_,{className:"h-7 w-7 text-gray-600 mb-2"}),e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:t("settings.security")}),e.jsx("p",{className:"text-xs text-gray-500",children:t("settings.security_config")})]})]}),"home"!==i&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>d("home"),className:"inline-flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:[e.jsx("span",{children:"â†"}),"Back"]}),e.jsx("div",{className:"h-6 w-px bg-gray-300"}),e.jsxs("div",{className:"flex items-center gap-2",children:["monitor"===i&&e.jsx(ke,{className:"h-5 w-5 text-slate-700"}),"database"===i&&e.jsx(Se,{className:"h-5 w-5 text-slate-700"}),"security"===i&&e.jsx(_,{className:"h-5 w-5 text-slate-700"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"monitor"===i?"System Monitor":"database"===i?"Database Management":"Security Management"})]})]}),e.jsx("div",{className:"database"===i?"bg-white rounded-lg border border-gray-200 overflow-hidden p-6":"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsx(Ms,{children:e.jsxs(s.Suspense,{fallback:"database"===i?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(r,{className:"h-8 w-8 animate-spin text-slate-700"})}):e.jsx(Os,{}),children:["monitor"===i&&e.jsx(vt,{}),"database"===i&&e.jsx(wt,{}),"security"===i&&e.jsx(_t,{})]})})})]})]})})}},Symbol.toStringTag,{value:"Module"})),St=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const[t,a]=s.useState([]),[r,n]=s.useState(!0),[l,i]=s.useState(!1),[c,o]=s.useState(""),[d,m]=s.useState(!1),[x,h]=s.useState(null),[g,u]=s.useState({name:"",slug:"",subscription_tier:"free",max_users:1,max_transactions_per_month:100,max_psp_connections:1,contact_email:""});s.useEffect(()=>{p()},[]);const p=async()=>{try{n(!0);const e=await We.get("/organizations"),s=e.data?.organizations||[];a(s)}catch(e){alert(`Failed to fetch organizations: ${e.data?.error||e.message||"Unknown error"}`)}finally{n(!1)}},y=()=>{m(!1),h(null),u({name:"",slug:"",subscription_tier:"free",max_users:1,max_transactions_per_month:100,max_psp_connections:1,contact_email:""})},j=t.filter(e=>e.name.toLowerCase().includes(c.toLowerCase())||e.slug.toLowerCase().includes(c.toLowerCase()));return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto space-y-6",children:[e.jsx(ys,{title:"Organizations",description:"Manage organizations and their subscriptions",icon:G,actions:!d&&e.jsx(Re,{onClick:()=>{h(null),u({name:"",slug:"",subscription_tier:"free",max_users:1,max_transactions_per_month:100,max_psp_connections:1,contact_email:""}),m(!0)},icon:e.jsx(O,{className:"w-4 h-4"}),children:"Create Organization"}),showDivider:!0}),!d&&e.jsx("div",{className:"max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx(rs,{type:"text",placeholder:"Search organizations...",value:c,onChange:e=>o(e.target.value),className:"pl-10"})]})}),d&&e.jsxs(Ee,{variant:"outlined",className:"border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:x?"Edit Organization":"Create New Organization"}),e.jsx("button",{onClick:y,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",title:"Close",children:e.jsx(D,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{let e;i(!0),e=x?await We.put(`/organizations/${x.id}`,g):await We.post("/organizations",g),e.data?.success&&alert(`Organization ${x?"updated":"created"} successfully!`),m(!1),h(null),u({name:"",slug:"",subscription_tier:"free",max_users:1,max_transactions_per_month:100,max_psp_connections:1,contact_email:""}),await p()}catch(s){const e=s.data?.error||s.response?.data?.error||s.message||"Failed to save organization",t=s.status||s.response?.status||"Unknown";alert(`Error: ${e}\n\nStatus: ${t}\n\nPlease check:\n1. You are logged in as a Super Admin (admin_level 0 or 1)\n2. The organization name and slug are valid\n3. The slug is unique\n4. Check browser console for more details`)}finally{i(!1)}},className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Organization Name *"}),e.jsx(rs,{type:"text",value:g.name,onChange:e=>u({...g,name:e.target.value}),placeholder:"Company ABC",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Slug (URL-friendly) *"}),e.jsx(rs,{type:"text",value:g.slug,onChange:e=>u({...g,slug:e.target.value.toLowerCase().replace(/[^a-z0-9-]/g,"")}),placeholder:"company-abc",required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Lowercase letters, numbers, and hyphens only"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subscription Tier"}),e.jsxs(Ge,{value:g.subscription_tier,onChange:e=>u({...g,subscription_tier:e.target.value}),children:[e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"starter",children:"Starter"}),e.jsx("option",{value:"pro",children:"Pro"}),e.jsx("option",{value:"enterprise",children:"Enterprise"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Email"}),e.jsx(rs,{type:"email",value:g.contact_email,onChange:e=>u({...g,contact_email:e.target.value}),placeholder:"contact@company.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Users"}),e.jsx(rs,{type:"number",value:g.max_users,onChange:e=>u({...g,max_users:parseInt(e.target.value)||1}),min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Transactions/Month"}),e.jsx(rs,{type:"number",value:g.max_transactions_per_month,onChange:e=>u({...g,max_transactions_per_month:parseInt(e.target.value)||100}),min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max PSP Connections"}),e.jsx(rs,{type:"number",value:g.max_psp_connections,onChange:e=>u({...g,max_psp_connections:parseInt(e.target.value)||1}),min:"1"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(Re,{type:"button",variant:"secondary",onClick:y,disabled:l,children:"Cancel"}),e.jsx(Re,{type:"submit",disabled:l,loading:l,icon:l?e.jsx(Ce,{className:"w-4 h-4 animate-spin"}):e.jsx(E,{className:"w-4 h-4"}),children:x?"Update Organization":"Create Organization"})]})]})]}),!d&&e.jsx(e.Fragment,{children:r?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Ce,{className:"w-6 h-6 animate-spin text-gray-400"}),e.jsx("span",{className:"ml-2 text-gray-500",children:"Loading organizations..."})]}):0===j.length?e.jsxs(Ee,{variant:"outlined",className:"text-center py-12",children:[e.jsx(G,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 mb-2",children:c?"No organizations found matching your search.":"No organizations yet."}),!c&&e.jsx(Re,{variant:"outline",onClick:()=>m(!0),className:"mt-4",children:"Create Your First Organization"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:j.map(s=>{return e.jsxs(Ee,{variant:"outlined",className:"hover:shadow-md transition-all duration-200 border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(G,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.name}),e.jsx("code",{className:"text-xs text-gray-500 bg-gray-50 px-2 py-0.5 rounded mt-1 block",children:s.slug})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>(e=>{h(e),u({name:e.name,slug:e.slug,subscription_tier:e.subscription_tier,max_users:e.max_users,max_transactions_per_month:e.max_transactions_per_month,max_psp_connections:e.max_psp_connections,contact_email:e.contact_email||""}),m(!0)})(s),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Edit",children:e.jsx(De,{className:"w-4 h-4"})}),1!==s.id&&e.jsx("button",{onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this organization? This action cannot be undone."))try{await We.delete(`/organizations/${e}`),p()}catch(s){alert(s.response?.data?.error||"Failed to delete organization")}})(s.id),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete",children:e.jsx(U,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Tier:"}),(a=s.subscription_tier,e.jsx(Fe,{variant:{free:"secondary",starter:"outline",pro:"default",enterprise:"default"}[a]||"secondary",size:"sm",children:a.toUpperCase()}))]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Status:"}),(t=s.subscription_status,e.jsx(Fe,{variant:{active:"success",suspended:"warning",cancelled:"destructive"}[t]||"secondary",size:"sm",children:t}))]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx($,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{children:["Max ",s.max_users," users"]})]}),s.contact_email&&e.jsx("div",{className:"text-xs text-gray-500 pt-2 border-t border-gray-100",children:s.contact_email}),e.jsxs("div",{className:"text-xs text-gray-400 pt-2 border-t border-gray-100",children:["Created ",new Date(s.created_at).toLocaleDateString()]})]})]},s.id);var t,a})})})]})}},Symbol.toStringTag,{value:"Module"})),Ct=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const[t,a]=s.useState([]),[r,n]=s.useState([]),[l,i]=s.useState(!0),[c,o]=s.useState(!1),[d,m]=s.useState(""),[x,h]=s.useState("all"),[g,u]=s.useState("all"),[p,y]=s.useState(!1),[j,f]=s.useState(null),[b,N]=s.useState({username:"",email:"",password:"",organization_id:"",admin_level:3,role:"user",is_active:!0});s.useEffect(()=>{v(),w()},[]);const v=async()=>{try{i(!0);const e=await We.get("/users");a(e.users||[])}catch(e){}finally{i(!1)}},w=async()=>{try{const e=await We.get("/organizations"),s=e.data?.organizations||[];n(s)}catch(e){}},k=()=>{y(!1),f(null),N({username:"",email:"",password:"",organization_id:"",admin_level:3,role:"user",is_active:!0})},S=t.filter(e=>{const s=e.username.toLowerCase().includes(d.toLowerCase())||e.email?.toLowerCase().includes(d.toLowerCase())||e.organization_name?.toLowerCase().includes(d.toLowerCase()),t="all"===x||e.organization_id?.toString()===x,a="all"===g||"active"===g&&e.is_active||"inactive"===g&&!e.is_active;return s&&t&&a}),C=[{key:"user",label:"User",render:(s,t)=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.username}),t.email&&e.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1 mt-1",children:[e.jsx(te,{className:"w-3 h-3"}),t.email]})]})},{key:"organization",label:"Organization",render:(s,t)=>t.organization_name?e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-900",children:[e.jsx(G,{className:"w-4 h-4 text-gray-400"}),t.organization_name]}):e.jsx("span",{className:"text-sm text-gray-400",children:"No org"})},{key:"admin_level",label:"Admin Level",render:(s,t)=>{return(a=t.admin_level)<=1?e.jsx(Fe,{variant:"destructive",size:"sm",children:"Super Admin"}):2===a?e.jsx(Fe,{variant:"info",size:"sm",children:"Org Admin"}):e.jsx(Fe,{variant:"secondary",size:"sm",children:"User"});var a}},{key:"status",label:"Status",render:(s,t)=>t.is_active?e.jsxs(Fe,{variant:"success",size:"sm",className:"flex items-center gap-1 w-fit",children:[e.jsx(je,{className:"w-3 h-3"}),"Active"]}):e.jsxs(Fe,{variant:"destructive",size:"sm",className:"flex items-center gap-1 w-fit",children:[e.jsx(ue,{className:"w-3 h-3"}),"Inactive"]})},{key:"created",label:"Created",render:(s,t)=>e.jsx("span",{className:"text-sm text-gray-500",children:new Date(t.created_at).toLocaleDateString()})},{key:"actions",label:"Actions",render:(s,t)=>e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>(e=>{f(e),N({username:e.username,email:e.email||"",password:"",organization_id:e.organization_id?.toString()||"",admin_level:e.admin_level,role:e.role,is_active:e.is_active}),y(!0)})(t),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Edit",children:e.jsx(De,{className:"w-4 h-4"})}),t.is_active?e.jsx("button",{onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this user? This action cannot be undone."))try{await We.delete(`/users/${e}`),v()}catch(s){alert(s.response?.data?.error||"Failed to delete user")}})(t.id),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete",children:e.jsx(U,{className:"w-4 h-4"})}):e.jsx("button",{onClick:()=>(async e=>{try{await We.post(`/users/${e}/activate`),v()}catch(s){alert(s.response?.data?.error||"Failed to activate user")}})(t.id),className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors",title:"Activate",children:e.jsx(je,{className:"w-4 h-4"})})]})}];return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto space-y-6",children:[e.jsx(ys,{title:"Users",description:"Manage user accounts and permissions",icon:_,actions:!p&&e.jsx(Re,{onClick:()=>{f(null),N({username:"",email:"",password:"",organization_id:"",admin_level:3,role:"user",is_active:!0}),y(!0)},icon:e.jsx(O,{className:"w-4 h-4"}),children:"Create User"}),showDivider:!0}),!p&&e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx(rs,{type:"text",placeholder:"Search users...",value:d,onChange:e=>m(e.target.value),className:"pl-10"})]})}),e.jsxs(Ge,{value:x,onChange:e=>h(e.target.value),className:"w-full md:w-48",children:[e.jsx("option",{value:"all",children:"All Organizations"}),r.map(s=>e.jsx("option",{value:s.id.toString(),children:s.name},s.id))]}),e.jsxs(Ge,{value:g,onChange:e=>u(e.target.value),className:"w-full md:w-40",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),p&&e.jsxs(Ee,{variant:"outlined",className:"border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:j?"Edit User":"Create New User"}),e.jsx("button",{onClick:k,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",title:"Close",children:e.jsx(D,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{o(!0);const e={...b,organization_id:b.organization_id?parseInt(b.organization_id):null};if(j)e.password||delete e.password,await We.put(`/users/${j.id}`,e);else{if(!e.password)return void alert("Password is required for new users");await We.post("/users",e)}k(),v()}catch(s){alert(s.response?.data?.error||"Failed to save user")}finally{o(!1)}},className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username *"}),e.jsx(rs,{type:"text",value:b.username,onChange:e=>N({...b,username:e.target.value}),placeholder:"john.doe",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx(rs,{type:"email",value:b.email,onChange:e=>N({...b,email:e.target.value}),placeholder:"john@company.com"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Password ",j?"(leave blank to keep current)":"*"]}),e.jsx(rs,{type:"password",value:b.password,onChange:e=>N({...b,password:e.target.value}),placeholder:j?"Leave blank to keep current":"Enter password",required:!j})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Organization"}),e.jsxs(Ge,{value:b.organization_id,onChange:e=>N({...b,organization_id:e.target.value}),children:[e.jsx("option",{value:"",children:"No Organization"}),r.map(s=>e.jsx("option",{value:s.id.toString(),children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Level"}),e.jsxs(Ge,{value:b.admin_level.toString(),onChange:e=>N({...b,admin_level:parseInt(e.target.value)}),children:[e.jsx("option",{value:"0",children:"Super Admin (Level 0)"}),e.jsx("option",{value:"1",children:"Main Admin (Level 1)"}),e.jsx("option",{value:"2",children:"Org Admin (Level 2)"}),e.jsx("option",{value:"3",children:"Regular User (Level 3)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),e.jsxs(Ge,{value:b.role,onChange:e=>N({...b,role:e.target.value}),children:[e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"viewer",children:"Viewer"})]})]}),e.jsx("div",{className:"col-span-2",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:b.is_active,onChange:e=>N({...b,is_active:e.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Active"})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(Re,{type:"button",variant:"secondary",onClick:k,disabled:c,children:"Cancel"}),e.jsx(Re,{type:"submit",disabled:c,loading:c,icon:c?e.jsx(Ce,{className:"w-4 h-4 animate-spin"}):e.jsx(E,{className:"w-4 h-4"}),children:j?"Update User":"Create User"})]})]})]}),!p&&e.jsx(e.Fragment,{children:l?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Ce,{className:"w-6 h-6 animate-spin text-gray-400"}),e.jsx("span",{className:"ml-2 text-gray-500",children:"Loading users..."})]}):0===S.length?e.jsxs(Ee,{variant:"outlined",className:"text-center py-12",children:[e.jsx(_,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 mb-2",children:d||"all"!==x||"all"!==g?"No users found matching your filters.":"No users yet."}),!d&&"all"===x&&"all"===g&&e.jsx(Re,{variant:"outline",onClick:()=>y(!0),className:"mt-4",children:"Create Your First User"})]}):e.jsx(Ee,{variant:"outlined",className:"border-gray-200 overflow-hidden",children:e.jsx(Ye,{data:S,columns:C,striped:!0,hover:!0,size:"md"})})})]})}},Symbol.toStringTag,{value:"Module"}));export{Hs as A,it as C,Ms as E,Nt as F,Os as L,Bs as M,St as O,ut as S,bt as T,pt as U,qs as a,ct as b,mt as c,gt as d,ft as e,kt as f,Ct as g,Ks as u};
