import{r as e,j as t,S as s,X as a,C as r,A as n,F as i,U as l,B as o,D as c,u as d,M as m,a as h,I as u,T as x,b as g,c as p,d as f,e as y,L as b,f as j,g as v,H as w,h as N,R as _,O as k,i as C,k as S,l as T,m as D,n as E,o as L,p as A,q as M,s as R,t as P,w as O,v as $,E as z,x as F,y as U,z as I,G as B,J as G,K as W,N as Y,P as H,Q as q,V as Z}from"./vendor-react-BhTnfaj4.js";import{u as V,a as X,b as J}from"./contexts-BJ30luUC.js";import{I as K,B as Q,C as ee,a as te,b as se,M as ae,c as re,T as ne,d as ie,S as le,D as oe,e as ce,f as de}from"./components-ui-DqTPGewb.js";import{c as me}from"./vendor-utils-CtF19A-_.js";import{R as he,P as ue,a as xe,C as ge,T as pe,L as fe,b as ye,X as be,Y as je,c as ve,B as we,d as Ne,A as _e,e as ke}from"./vendor-charts-recharts-B9ou1qfH.js";const Ce={},Se=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),r=s?.nonce||s?.getAttribute("nonce");a=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in Ce)return;Ce[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${s}`))return;const a=document.createElement("link");return a.rel=t?"stylesheet":"modulepreload",t||(a.as="script"),a.crossOrigin="",a.href=e,r&&a.setAttribute("nonce",r),document.head.appendChild(a),t?new Promise((t,s)=>{a.addEventListener("load",t),a.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return a.then(t=>{for(const e of t||[])"rejected"===e.status&&r(e.reason);return e().catch(r)})},Te=new class{isDevelopment=!1;isProduction=!0;shouldLog(e){return!this.isProduction||"error"===e||"warn"===e}debug(...e){this.shouldLog("debug")}info(...e){this.shouldLog("info")}warn(...e){this.shouldLog("warn")}error(...e){this.shouldLog("error")}dashboard(e,t){this.isDevelopment}api(e,t,s){this.isDevelopment}performance(e,t,s="ms"){this.isDevelopment}clients(e,t){this.isDevelopment}transaction(e,t){this.isDevelopment}health(e,t){this.isDevelopment}},De=new class{baseUrl;defaultOptions;cache=new Map;onUnauthorizedCallback=null;unauthorizedAttempts=new Map;MAX_UNAUTHORIZED_ATTEMPTS=2;constructor(e="/api/v1",t={}){this.baseUrl=e,this.defaultOptions={timeout:15e3,retries:3,retryDelay:1e3,retryOn:[408,429,500,502,503,504],...t}}setOnUnauthorized(e){this.onUnauthorizedCallback=e}async retry(e,t,s=0){try{return await e()}catch(a){if(s<t.retries&&(t.retryOn.includes(a.status)||"AbortError"===a.name||"NetworkError"===a.name)){const r=t.retryDelay*Math.pow(2,s);return Te.warn(`Retry attempt ${s+1}/${t.retries} after ${r}ms`,a),await new Promise(e=>setTimeout(e,r)),this.retry(e,t,s+1)}throw a}}createTimeoutController(e){const t=new AbortController;return setTimeout(()=>t.abort(),e),t}handleUnauthorized(e,t){const s=this.unauthorizedAttempts.get(e)||0;s<this.MAX_UNAUTHORIZED_ATTEMPTS?(this.unauthorizedAttempts.set(e,s+1),Te.warn(`Unauthorized response (${t}) from ${e} - attempt ${s+1}/${this.MAX_UNAUTHORIZED_ATTEMPTS}. May be temporary.`),setTimeout(()=>{this.unauthorizedAttempts.delete(e)},1e4)):(Te.error(`Multiple unauthorized responses (${t}) from ${e}, redirecting to login`),this.unauthorizedAttempts.delete(e),this.onUnauthorizedCallback?this.onUnauthorizedCallback():"undefined"!=typeof window&&"/login"!==window.location.pathname&&(window.location.href="/login"))}handleError(e,t){return"AbortError"===e.name?new Error(`Request timeout: ${t}`):e.message?.includes("Failed to fetch")||e.message?.includes("NetworkError")?new Error("Bağlantı hatası. Lütfen internet bağlantınızı kontrol edin."):401===e.status||403===e.status?(this.handleUnauthorized(t,e.status),new Error("Yetki hatası. Lütfen tekrar giriş yapın.")):e.status>=500?new Error("Sunucu hatası. Lütfen daha sonra tekrar deneyin."):404===e.status?new Error("İstenen kaynak bulunamadı."):e instanceof Error?e:new Error(e.message||"Bilinmeyen bir hata oluştu.")}async get(e,t={}){const s={...this.defaultOptions,...t},a=`${this.baseUrl}${e}`;return this.retry(async()=>{const e=this.createTimeoutController(s.timeout);try{const s=await fetch(a,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"},signal:e.signal});if(!s.ok){401!==s.status&&403!==s.status||this.handleUnauthorized(a,s.status);const e=new Error(`HTTP error! status: ${s.status}`);throw e.status=s.status,e}this.unauthorizedAttempts.delete(a);const r=await s.text();if(!r||""===r.trim())throw Te.warn(`Empty response from ${a}`),new Error("Empty response from server");let n;try{n=JSON.parse(r)}catch(t){throw Te.error(`Failed to parse JSON from ${a}:`,t),new Error("Invalid JSON response from server")}return{data:n,status:s.status,headers:s.headers,ok:s.ok}}catch(r){throw this.handleError(r,a)}},s)}async post(e,t,s={}){const a={...this.defaultOptions,...s},r=`${this.baseUrl}${e}`;return this.retry(async()=>{const e=this.createTimeoutController(a.timeout);try{const a=localStorage.getItem("csrf_token"),n=await fetch(r,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...a?{"X-CSRFToken":a}:{}},body:JSON.stringify(t),signal:e.signal}),i=await n.text();let l;if(i&&""!==i.trim())try{l=JSON.parse(i)}catch(s){Te.error(`Failed to parse JSON from ${r}:`,s),l={error:i}}else l={};return n.ok?(this.unauthorizedAttempts.delete(r),{data:l,status:n.status,headers:n.headers,ok:!0}):(401!==n.status&&403!==n.status||this.handleUnauthorized(r,n.status),{data:l,status:n.status,headers:n.headers,ok:!1})}catch(n){throw this.handleError(n,r)}},a)}async put(e,t,s={}){const a={...this.defaultOptions,...s},r=`${this.baseUrl}${e}`;return this.retry(async()=>{const e=this.createTimeoutController(a.timeout);try{const a=localStorage.getItem("csrf_token"),n=await fetch(r,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json",...a?{"X-CSRFToken":a}:{}},body:JSON.stringify(t),signal:e.signal});if(!n.ok){401!==n.status&&403!==n.status||this.handleUnauthorized(r,n.status);const e=new Error(`HTTP error! status: ${n.status}`);throw e.status=n.status,e}this.unauthorizedAttempts.delete(r);const i=await n.text();if(!i||""===i.trim())throw Te.warn(`Empty response from ${r}`),new Error("Empty response from server");let l;try{l=JSON.parse(i)}catch(s){throw Te.error(`Failed to parse JSON from ${r}:`,s),new Error("Invalid JSON response from server")}return{data:l,status:n.status,headers:n.headers,ok:n.ok}}catch(n){throw this.handleError(n,r)}},a)}async delete(e,t={}){const s={...this.defaultOptions,...t},a=`${this.baseUrl}${e}`;return this.retry(async()=>{const e=this.createTimeoutController(s.timeout);try{const t=localStorage.getItem("csrf_token"),s=await fetch(a,{method:"DELETE",credentials:"include",headers:{"Content-Type":"application/json",...t?{"X-CSRFToken":t}:{}},signal:e.signal});if(!s.ok){401!==s.status&&403!==s.status||this.handleUnauthorized(a,s.status);const e=new Error(`HTTP error! status: ${s.status}`);throw e.status=s.status,e}this.unauthorizedAttempts.delete(a);const r=await s.text();return r&&""!==r.trim()?{data:JSON.parse(r),status:s.status,headers:s.headers,ok:s.ok}:{data:{},status:s.status,headers:s.headers,ok:s.ok}}catch(t){throw this.handleError(t,a)}},s)}parseResponse(e){const t=e.data;if(t&&"object"==typeof t&&("data"in t||"error"in t||"meta"in t)){if(t.error){const e=new Error(t.error.message||"API error");throw e.code=t.error.code,e.details=t.error.details,e}return void 0!==t.data?t.data:t}return e.data}clearToken(){try{localStorage.removeItem("auth_token"),localStorage.removeItem("csrf_token"),localStorage.removeItem("session_token"),Te.info("Authentication tokens cleared")}catch(e){Te.error("Error clearing tokens:",e)}}clearCache(){try{this.cache.clear(),Object.keys(localStorage).forEach(e=>{e.startsWith("api_cache_")&&localStorage.removeItem(e)}),Te.info("Cache cleared")}catch(e){Te.error("Error clearing cache:",e)}}clearCacheForUrl(e){try{const t=[];this.cache.forEach((s,a)=>{a.includes(e)&&t.push(a)}),t.forEach(e=>this.cache.delete(e)),Object.keys(localStorage).forEach(t=>{t.startsWith("api_cache_")&&t.includes(e)&&localStorage.removeItem(t)}),Te.info(`Cache cleared for URL pattern: ${e}`)}catch(t){Te.error("Error clearing cache for URL:",t)}}async refreshSession(){try{Te.info("Refreshing session...");const e=await this.get("/auth/csrf-token"),t=this.parseResponse(e);return t.csrf_token?(localStorage.setItem("csrf_token",t.csrf_token),Te.info("Session refreshed successfully"),!0):(Te.warn("Session refresh returned no CSRF token"),!1)}catch(e){return Te.error("Error refreshing session:",e),!1}}},Ee=De,Le=({onResultClick:d})=>{const[m,h]=e.useState(!1),[u,x]=e.useState(""),[g,p]=e.useState([]),[f,y]=e.useState(!1),b=[{id:"1",type:"transaction",title:"TXN-001 - Acme Corp",description:"Payment processing transaction",value:"$12,500",date:"2024-01-15",status:"completed"},{id:"2",type:"client",title:"Acme Corporation",description:"Enterprise client with 45 transactions",value:"$125,000",date:"2024-01-10"},{id:"3",type:"transaction",title:"TXN-002 - Tech Solutions",description:"Monthly subscription payment",value:"$8,500",date:"2024-01-14",status:"pending"},{id:"4",type:"client",title:"Tech Solutions Inc",description:"SME client with 12 transactions",value:"$45,000",date:"2024-01-08"},{id:"5",type:"report",title:"Monthly Revenue Report",description:"January 2024 revenue analysis",value:"$456,730",date:"2024-01-01"}];e.useEffect(()=>{u.length>2?(y(!0),setTimeout(()=>{const e=b.filter(e=>e.title.toLowerCase().includes(u.toLowerCase())||e.description.toLowerCase().includes(u.toLowerCase()));p(e),y(!1)},300)):p([])},[u]),e.useEffect(()=>{const e=e=>{m&&!e.target.closest(".search-container")&&h(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[m]);const j=e=>{switch(e){case"transaction":return t.jsx(c,{className:"w-4 h-4"});case"client":return t.jsx(o,{className:"w-4 h-4"});case"user":return t.jsx(l,{className:"w-4 h-4"});default:return t.jsx(i,{className:"w-4 h-4"})}},v=e=>{if(!e)return null;const s={completed:{variant:"default",color:"bg-green-100 text-green-800"},pending:{variant:"secondary",color:"bg-yellow-100 text-yellow-800"},processing:{variant:"outline",color:"bg-gray-100 text-gray-800"}},a=s[e]||s.pending;return t.jsx(se,{variant:a.variant,className:a.color,children:e})};return t.jsxs("div",{className:"relative search-container",children:[t.jsxs("div",{className:"relative",children:[t.jsx(s,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),t.jsx(K,{type:"text",placeholder:"Search transactions, clients, reports...",value:u,onChange:e=>x(e.target.value),onFocus:()=>h(!0),className:"pl-10 pr-10 w-80"}),u&&t.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>{x(""),h(!1)},className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0",children:t.jsx(a,{className:"w-4 h-4"})})]}),m&&(u.length>2||g.length>0)&&t.jsx(ee,{className:"absolute top-full left-0 right-0 mt-2 z-50 max-h-96 overflow-y-auto",children:t.jsx(te,{className:"p-0",children:f?t.jsxs("div",{className:"p-4 text-center text-muted-foreground",children:[t.jsx("div",{className:"w-4 h-4 border-2 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-2"}),"Searching..."]}):g.length>0?t.jsx("div",{className:"py-2",children:g.map(e=>t.jsxs("div",{onClick:()=>(e=>{d?.(e),h(!1),x("")})(e),className:"flex items-center gap-3 p-3 hover:bg-muted/50 cursor-pointer border-b border-border last:border-b-0",children:[t.jsx("div",{className:"flex-shrink-0",children:j(e.type)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:e.title}),e.value&&t.jsx("span",{className:"text-sm font-medium text-foreground",children:e.value})]}),t.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:e.description}),t.jsxs("div",{className:"flex items-center gap-2",children:[e.date&&t.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[t.jsx(r,{className:"w-3 h-3"}),new Date(e.date).toLocaleDateString()]}),v(e.status)]})]}),t.jsx(n,{className:"w-4 h-4 text-muted-foreground"})]},e.id))}):u.length>2?t.jsxs("div",{className:"p-4 text-center text-muted-foreground",children:[t.jsx(s,{className:"w-8 h-8 mx-auto mb-2 text-muted-foreground/50"}),t.jsxs("p",{children:['No results found for "',u,'"']}),t.jsx("p",{className:"text-xs mt-1",children:"Try different keywords"})]}):null})})]})},Ae=Object.freeze(Object.defineProperty({__proto__:null,GlobalSearch:Le,default:Le},Symbol.toStringTag,{value:"Module"})),Me=()=>{const[t,s]=e.useState([]),[a,r]=e.useState(!0),[n,i]=e.useState(null),l=e.useCallback(async()=>{r(!0),i(null);try{const e=await De.get("/notifications",{timeout:5e3,retries:1});s(e.data.notifications||[])}catch(e){if(e.message?.includes("404")||e.message?.includes("bulunamadı"))return s([]),void i(null);Te.warn("Failed to load notifications from API, using fallback",e),s([]),i(null)}finally{r(!1)}},[]),o=e.useCallback(async e=>{try{await De.post(`/notifications/${e}/read`,{}),s(t=>t.map(t=>t.id===e?{...t,read:!0}:t))}catch(t){Te.error("Failed to mark notification as read",t),s(t=>t.map(t=>t.id===e?{...t,read:!0}:t))}},[]),c=e.useCallback(async()=>{try{await De.post("/notifications/read-all",{}),s(e=>e.map(e=>({...e,read:!0})))}catch(e){Te.error("Failed to mark all notifications as read",e),s(e=>e.map(e=>({...e,read:!0})))}},[]);e.useEffect(()=>{l();const e=setInterval(()=>{l()},3e4);return()=>clearInterval(e)},[l]);const d=t.filter(e=>!e.read).length;return{notifications:t,unreadCount:d,markAsRead:o,markAllAsRead:c,refresh:l,loading:a,error:n}},Re=({onMenuClick:s,onLogout:r})=>{const n=d(),{user:i}=V(),[l,o]=e.useState(!1),[c,j]=e.useState(!1),{notifications:v,unreadCount:w}=Me(),N=()=>w;return t.jsxs("header",{style:{height:"4rem",borderBottom:"1px solid #e5e7eb",backgroundColor:"#ffffff",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 1.5rem"},className:"h-16 border-b border-gray-200 bg-white flex items-center justify-between px-6",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(Q,{variant:"ghost",size:"sm",onClick:s,className:"lg:hidden text-gray-600 hover:text-gray-900 hover:bg-gray-100",children:t.jsx(m,{className:"w-5 h-5"})}),t.jsx("div",{className:"hidden lg:flex items-center",children:t.jsx(Le,{onResultClick:e=>{"transaction"===e.type?n(`/transactions?highlight=${e.id}`):"client"===e.type&&n(`/clients?highlight=${e.id}`)}})})]}),t.jsx("div",{className:"hidden lg:flex items-center"}),t.jsxs("div",{className:"flex items-center gap-2",children:[!1,t.jsxs("div",{className:"relative",children:[t.jsxs(Q,{variant:"ghost",size:"sm",onClick:()=>o(!l),className:"relative text-gray-600 hover:text-gray-900 hover:bg-gray-100",children:[t.jsx(h,{className:"w-5 h-5"}),N()>0&&t.jsx(se,{variant:"destructive",className:"absolute -top-1 -right-1 w-5 h-5 p-0 flex items-center justify-center text-xs bg-red-600",children:N()})]}),l&&t.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-md z-50",children:[t.jsx("div",{className:"p-4 border-b border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Notifications"}),t.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>o(!1),className:"text-gray-500 hover:text-gray-700",children:t.jsx(a,{className:"w-4 h-4"})})]})}),t.jsx("div",{className:"max-h-96 overflow-y-auto",children:0===v.length?t.jsxs("div",{className:"p-6 text-center text-gray-500",children:[t.jsx(h,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),t.jsx("p",{className:"text-sm",children:"No notifications"})]}):v.map(e=>t.jsx("div",{className:"p-4 border-b border-gray-200 last:border-b-0 hover:bg-gray-50 cursor-pointer transition-colors "+(e.read?"":"bg-gray-50"),children:t.jsxs("div",{className:"flex items-start gap-3",children:["info"===e.type&&t.jsx(u,{className:"w-4 h-4 text-gray-500 mt-0.5"}),"warning"===e.type&&t.jsx(x,{className:"w-4 h-4 text-amber-500 mt-0.5"}),"success"===e.type&&t.jsx(g,{className:"w-4 h-4 text-green-500 mt-0.5"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("h4",{className:"text-sm font-medium text-gray-900",children:e.title}),t.jsx("span",{className:"text-xs text-gray-500",children:e.time})]}),t.jsx("p",{className:"text-sm text-gray-600",children:e.message}),!e.read&&t.jsx(se,{variant:"outline",className:"mt-2 text-xs border-gray-200 text-gray-700",children:"New"})]})]})},e.id))})]})]}),t.jsxs("div",{className:"relative",children:[t.jsxs(Q,{variant:"ghost",onClick:()=>j(!c),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100",children:[t.jsx("div",{className:"w-8 h-8 bg-gray-700 rounded-lg flex items-center justify-center",children:t.jsx(p,{className:"w-4 h-4 text-white"})}),t.jsx("span",{className:"hidden md:block text-sm font-medium",children:i?.username||"User"}),t.jsx(f,{className:"w-4 h-4"})]}),c&&t.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-md z-50",children:t.jsxs("div",{className:"p-2",children:[t.jsxs(Q,{variant:"ghost",className:"w-full justify-start text-gray-700 hover:text-gray-900 hover:bg-gray-50",onClick:()=>{j(!1),n("/settings?tab=profile")},children:[t.jsx(p,{className:"w-4 h-4 mr-2"}),"Profile"]}),t.jsxs(Q,{variant:"ghost",className:"w-full justify-start text-gray-700 hover:text-gray-900 hover:bg-gray-50",onClick:()=>{j(!1),n("/settings")},children:[t.jsx(y,{className:"w-4 h-4 mr-2"}),"Settings"]}),t.jsx("div",{className:"border-t border-gray-200 my-1"}),t.jsxs(Q,{variant:"ghost",className:"w-full justify-start text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>{j(!1),r()},children:[t.jsx(b,{className:"w-4 h-4 mr-2"}),"Sign out"]})]})})]})]})]})},Pe=Object.freeze(Object.defineProperty({__proto__:null,ModernHeader:Re},Symbol.toStringTag,{value:"Module"})),Oe=({className:e="",variant:s="button"})=>{const{currentLanguage:a,setLanguage:r,supportedLanguages:n}=X(),i=Object.entries(n).map(([e,t])=>({code:e,name:t.name})),l=async e=>{try{await r(e)}catch(t){}};return"button"===s?t.jsx("div",{className:`flex items-center gap-2 ${e}`,children:i.map(e=>t.jsx("button",{onClick:()=>l(e.code),className:`\n              px-3 py-1.5 rounded-md text-sm font-medium transition-all\n              ${a===e.code?"bg-blue-600 text-white shadow-sm":"bg-gray-100 text-gray-700 hover:bg-gray-200"}\n            `,title:e.name,children:e.code.toUpperCase()},e.code))}):t.jsxs("div",{className:`relative inline-block ${e}`,children:[t.jsx("select",{value:a,onChange:e=>l(e.target.value),className:"\n          appearance-none bg-white border border-gray-300 rounded-md \n          px-4 py-2 pr-8 text-sm font-medium text-gray-700\n          hover:border-gray-400 focus:outline-none focus:ring-2 \n          focus:ring-blue-500 focus:border-transparent\n          cursor-pointer transition-all\n        ",children:i.map(e=>t.jsx("option",{value:e.code,children:e.name},e.code))}),t.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:t.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:t.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]})},$e=({variant:s,className:n=""})=>{const{state:i,navigationItems:l,isActive:o,navigateTo:c,getMobileNavigation:d}=J(),{user:m,logout:h}=V(),{t:u}=X(),[x,g]=e.useState(new Date),[y,v]=e.useState(!1),[w,N]=e.useState(new Set);e.useEffect(()=>{const e=setInterval(()=>{g(new Date)},1e3);return()=>clearInterval(e)},[]),e.useEffect(()=>{const e=e=>{y&&(e.target.closest("[data-user-menu]")||v(!1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[y]);const _=e=>{if(e.children){const t=new Set(w);t.has(e.id)?t.delete(e.id):t.add(e.id),N(t)}else c(e.href)},k=async()=>{try{await h()}catch(e){}};if("sidebar"===s)return t.jsxs("div",{className:me("flex flex-col h-full bg-white border-r border-gray-200",n),children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("img",{src:"/plogo.png",alt:"PipLinePro",className:"w-8 h-8 rounded-lg"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:u("common.app_name")}),t.jsx("p",{className:"text-xs text-gray-500",children:u("common.financial_management")})]})]})}),t.jsx("nav",{className:"flex-1 px-4 py-6 space-y-2",children:l.map(e=>{const s=e.icon,a=o(e.href),r=e.children&&e.children.length>0,n=w.has(e.id);return t.jsxs("div",{children:[t.jsxs("button",{onClick:()=>_(e),className:me("w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200",e.special?a?"bg-gradient-to-r from-purple-500 to-blue-500 text-white shadow-lg":"text-purple-600 hover:bg-purple-50 hover:text-purple-700":a?"bg-gray-100 text-gray-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(s,{className:me("w-5 h-5",e.special&&a&&"animate-pulse")}),t.jsx("span",{children:e.name}),e.badge&&t.jsx(se,{variant:e.special?"default":"secondary",className:me("text-xs",e.special&&"bg-white/20 text-white"),children:e.badge})]}),r&&t.jsx(f,{className:me("w-4 h-4 transition-transform",n&&"rotate-180")})]}),r&&n&&t.jsx("div",{className:"ml-8 mt-2 space-y-1",children:e.children.map(e=>{const s=e.icon,a=o(e.href);return t.jsxs("button",{onClick:()=>c(e.href),className:me("w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-colors",a?"bg-gray-100 text-gray-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:[t.jsx(s,{className:"w-4 h-4"}),t.jsx("span",{children:e.name})]},e.id)})})]},e.id)})}),t.jsxs("div",{className:"p-4 border-t border-gray-200",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center",children:t.jsx(p,{className:"w-4 h-4 text-gray-600"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:m?.username||"User"}),t.jsx("p",{className:"text-xs text-gray-500",children:m?.role||"User"})]}),t.jsxs("div",{className:"relative","data-user-menu":!0,children:[t.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>v(!y),className:"w-8 h-8 p-0",children:t.jsx(f,{className:"w-4 h-4"})}),y&&t.jsx("div",{className:"absolute right-0 bottom-full mb-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:t.jsxs("button",{onClick:k,className:"w-full flex items-center gap-2 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[t.jsx(b,{className:"w-4 h-4"}),u("common.sign_out")]})})]})]}),t.jsx("div",{className:"mb-3",children:t.jsx(Oe,{variant:"button",className:"w-full justify-center"})}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[t.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),t.jsx("span",{children:u("common.system_online")}),t.jsx(r,{className:"w-3 h-3 ml-auto"}),t.jsx("span",{children:x.toLocaleTimeString()})]})]})]});if("mobile-bottom"===s){const e=d();return t.jsx("div",{className:me("lg:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg z-50",n),children:t.jsxs("div",{className:"flex items-center justify-around px-2 py-2",children:[e.map(e=>{const s=e.icon,a=o(e.href);return t.jsxs("button",{onClick:()=>c(e.href),className:me("flex flex-col items-center justify-center p-2 rounded-lg transition-all duration-200 min-w-[60px] min-h-[60px] relative",e.special?a?"bg-gradient-to-r from-purple-500 to-blue-500 text-white":"text-purple-600":a?"text-gray-900 bg-gray-100":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),children:[e.special&&a&&t.jsxs("div",{className:"absolute inset-0 rounded-lg overflow-hidden",children:[t.jsx("div",{className:"absolute top-1 right-1 w-1 h-1 bg-white rounded-full animate-ping"}),t.jsx("div",{className:"absolute bottom-1 left-1 w-0.5 h-0.5 bg-white rounded-full animate-ping",style:{animationDelay:"1s"}})]}),t.jsxs("div",{className:"relative z-10",children:[t.jsx(s,{className:me("transition-all duration-200",e.special?me("h-6 w-6",a&&"animate-pulse drop-shadow-sm"):me("h-5 w-5",a&&"scale-105"))}),e.badge&&t.jsx(se,{className:me("absolute -top-2 -right-2 h-4 w-4 text-xs p-0 flex items-center justify-center",e.special?"bg-white/20 text-white":"bg-red-500 text-white"),children:e.badge})]}),t.jsx("span",{className:me("text-xs font-medium mt-1 text-center z-10",e.special&&a&&"text-white drop-shadow-sm"),children:e.name})]},e.id)}),t.jsxs("button",{className:"flex flex-col items-center justify-center p-2 rounded-lg transition-all duration-200 min-w-[60px] min-h-[60px] text-gray-600 hover:text-gray-900 hover:bg-gray-50",children:[t.jsx("div",{className:"relative",children:t.jsx(j,{className:"h-5 w-5 transition-transform duration-200 hover:scale-105"})}),t.jsx("span",{className:"text-xs font-medium mt-1 text-center",children:"More"})]})]})})}return"mobile-drawer"===s?t.jsxs("div",{className:me("lg:hidden fixed inset-0 bg-white z-50 transform transition-transform duration-300 ease-in-out",i.mobileMenuOpen?"translate-x-0":"-translate-x-full",n),children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("img",{src:"/plogo.png",alt:"PipLinePro",className:"w-8 h-8 rounded-lg"}),t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Menu"})]}),t.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>c("/"),className:"w-8 h-8 p-0",children:t.jsx(a,{className:"w-5 h-5"})})]}),t.jsx("nav",{className:"flex-1 px-4 py-6 space-y-2",children:l.map(e=>{const s=e.icon,a=o(e.href),r=e.children&&e.children.length>0,n=w.has(e.id);return t.jsxs("div",{children:[t.jsxs("button",{onClick:()=>_(e),className:me("w-full flex items-center justify-between px-3 py-3 rounded-lg text-sm font-medium transition-all duration-200",e.special?a?"bg-gradient-to-r from-purple-500 to-blue-500 text-white":"text-purple-600 hover:bg-purple-50":a?"bg-gray-100 text-gray-900":"text-gray-600 hover:bg-gray-50"),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(s,{className:"w-5 h-5"}),t.jsx("span",{children:e.name}),e.badge&&t.jsx(se,{variant:"secondary",className:"text-xs",children:e.badge})]}),r&&t.jsx(f,{className:me("w-4 h-4 transition-transform",n&&"rotate-180")})]}),r&&n&&t.jsx("div",{className:"ml-8 mt-2 space-y-1",children:e.children.map(e=>{const s=e.icon,a=o(e.href);return t.jsxs("button",{onClick:()=>c(e.href),className:me("w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-colors",a?"bg-gray-100 text-gray-900":"text-gray-600 hover:bg-gray-50"),children:[t.jsx(s,{className:"w-4 h-4"}),t.jsx("span",{children:e.name})]},e.id)})})]},e.id)})}),t.jsxs("div",{className:"p-4 border-t border-gray-200",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center",children:t.jsx(p,{className:"w-5 h-5 text-gray-600"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:m?.username||"User"}),t.jsx("p",{className:"text-xs text-gray-500",children:m?.role||"User"})]})]}),t.jsxs(Q,{onClick:k,variant:"outline",className:"w-full",children:[t.jsx(b,{className:"w-4 h-4 mr-2"}),"Sign out"]})]})]}):null},ze=({className:e="",showHome:s=!0})=>{const{state:a}=J(),{breadcrumbs:r}=a;return r.length<=1?null:t.jsxs("nav",{className:me("flex items-center space-x-1 text-sm text-gray-500",e),"aria-label":"Breadcrumb",children:[s&&t.jsxs(t.Fragment,{children:[t.jsx(v,{to:"/dashboard",className:"flex items-center hover:text-gray-700 transition-colors","aria-label":"Go to dashboard",children:t.jsx(w,{className:"w-4 h-4"})}),t.jsx(N,{className:"w-4 h-4 mx-1"})]}),r.map((e,s)=>t.jsxs(_.Fragment,{children:[e.current?t.jsx("span",{className:"font-medium text-gray-900","aria-current":"page",children:e.label}):t.jsx(v,{to:e.href,className:"hover:text-gray-700 transition-colors",children:e.label}),s<r.length-1&&t.jsx(N,{className:"w-4 h-4 mx-1"})]},e.href))]})},Fe=({children:e})=>{const s=d(),{logout:a}=V(),{state:r,setMobileMenuOpen:n}=J();return t.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f9fafb"},className:"min-h-screen bg-gray-50",children:[r.mobileMenuOpen&&t.jsx("div",{className:"fixed inset-0 z-40 lg:hidden",onClick:()=>n(!1),children:t.jsx("div",{className:"fixed inset-0 bg-black/50"})}),t.jsx($e,{variant:"mobile-drawer"}),t.jsx("div",{className:"hidden lg:fixed lg:inset-y-0 lg:flex lg:w-64 lg:flex-col",children:t.jsx($e,{variant:"sidebar"})}),t.jsxs("div",{className:"lg:pl-64",children:[t.jsx(Re,{onMenuClick:()=>n(!0),onLogout:async()=>{try{await a()}catch(e){s("/login")}}}),t.jsx("div",{className:"px-6 py-3 bg-white border-b border-gray-200",children:t.jsx(ze,{})}),t.jsx("main",{className:"min-h-[calc(100vh-7rem)] bg-gray-50",children:e||t.jsx(k,{})})]}),t.jsx($e,{variant:"mobile-bottom"})]})},Ue=Object.freeze(Object.defineProperty({__proto__:null,default:Fe},Symbol.toStringTag,{value:"Module"})),Ie=()=>t.jsx("div",{className:"dashboard-grid",children:[...Array(4)].map((e,s)=>t.jsxs("div",{className:"dashboard-card metric-card border-0 shadow-lg p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("div",{className:"w-12 h-12 bg-slate-200 rounded-xl animate-pulse"}),t.jsx("div",{className:"w-16 h-4 bg-slate-200 rounded animate-pulse"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"h-8 bg-slate-200 rounded animate-pulse w-3/4"}),t.jsx("div",{className:"h-4 bg-slate-200 rounded animate-pulse w-1/2"})]})]},s))}),Be=()=>t.jsxs("div",{className:"dashboard-card dashboard-glass border-0 shadow-lg",children:[t.jsx("div",{className:"p-6 pb-4",children:t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"space-y-2 flex-1",children:[t.jsx("div",{className:"h-6 bg-slate-200 rounded animate-pulse w-1/3"}),t.jsx("div",{className:"h-4 bg-slate-200 rounded animate-pulse w-1/2"})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-32 h-8 bg-slate-200 rounded animate-pulse"}),t.jsx("div",{className:"w-32 h-8 bg-slate-200 rounded animate-pulse"}),t.jsx("div",{className:"w-20 h-6 bg-slate-200 rounded-full animate-pulse"})]})]})}),t.jsx("div",{className:"px-6 pb-6",children:t.jsxs("div",{className:"h-96 bg-slate-100 rounded-lg animate-pulse relative overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 -translate-x-full animate-shimmer bg-gradient-to-r from-transparent via-white/20 to-transparent"}),t.jsx("div",{className:"flex items-end justify-around h-full p-8 gap-2",children:[...Array(12)].map((e,s)=>t.jsx("div",{className:"bg-slate-200 rounded-t w-full",style:{height:60*Math.random()+40+"%"}},s))})]})})]}),Ge=({title:e="Performance"})=>t.jsxs("div",{className:"dashboard-card dashboard-glass border-0 shadow-lg",children:[t.jsx("div",{className:"p-6 pb-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-slate-200 rounded-xl animate-pulse"}),t.jsx("div",{className:"h-5 bg-slate-200 rounded animate-pulse w-32"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 bg-slate-200 rounded-full animate-pulse"}),t.jsx("div",{className:"w-12 h-3 bg-slate-200 rounded animate-pulse"})]})]})}),t.jsxs("div",{className:"px-6 pb-6",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"space-y-2",children:[...Array(4)].map((e,s)=>t.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-slate-50 rounded border",children:[t.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[t.jsx("div",{className:"w-4 h-4 bg-slate-200 rounded animate-pulse"}),t.jsx("div",{className:"h-3 bg-slate-200 rounded animate-pulse w-24"})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx("div",{className:"h-4 bg-slate-200 rounded animate-pulse w-20 ml-auto"}),t.jsx("div",{className:"h-3 bg-slate-200 rounded animate-pulse w-16 ml-auto"})]})]},s))}),t.jsx("div",{className:"space-y-2 pt-2 border-t-2 border-slate-300",children:[...Array(3)].map((e,s)=>t.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-slate-50 rounded border",children:[t.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[t.jsx("div",{className:"w-4 h-4 bg-slate-200 rounded animate-pulse"}),t.jsx("div",{className:"h-3 bg-slate-200 rounded animate-pulse w-20"})]}),t.jsx("div",{className:"h-4 bg-slate-200 rounded animate-pulse w-24 ml-auto"})]},s))})]}),t.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200",children:t.jsxs("div",{className:"flex items-center justify-center gap-3",children:[t.jsx("div",{className:"h-8 w-8 bg-slate-200 rounded animate-pulse"}),t.jsx("div",{className:"h-4 bg-slate-200 rounded animate-pulse flex-1 max-w-md"}),t.jsx("div",{className:"h-8 w-8 bg-slate-200 rounded animate-pulse"})]})})]})]}),We=()=>t.jsx("main",{className:"flex-1 bg-gradient-to-br from-slate-50 via-white to-slate-100 min-h-screen",children:t.jsx("div",{className:"px-8 py-8",children:t.jsxs("div",{className:"space-y-8",children:[t.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"h-10 bg-slate-200 rounded animate-pulse w-64"}),t.jsx("div",{className:"h-5 bg-slate-200 rounded animate-pulse w-96"})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-32 h-10 bg-slate-200 rounded-lg animate-pulse"}),t.jsx("div",{className:"w-24 h-10 bg-slate-200 rounded-lg animate-pulse"}),t.jsx("div",{className:"w-24 h-10 bg-slate-200 rounded-lg animate-pulse"}),t.jsx("div",{className:"w-24 h-10 bg-slate-200 rounded-lg animate-pulse"})]})]}),t.jsx(Ie,{}),t.jsxs("div",{className:"space-y-8",children:[t.jsx(Be,{}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsx(Ge,{title:"Daily"}),t.jsx(Ge,{title:"Monthly"}),t.jsx(Ge,{title:"Total"})]})]})]})})}),Ye=[{name:"Stripe",value:45,color:"#3b82f6"},{name:"PayPal",value:30,color:"#059669"},{name:"Square",value:15,color:"#d97706"},{name:"Other",value:10,color:"#64748b"}],He=({data:e=[],type:s="area",height:a=300})=>{const r=e&&e.length>0?e.map(t=>{let s=null,a="Unknown";return t.date?s=new Date(t.date):t.created_at?s=new Date(t.created_at):t.transaction_date&&(s=new Date(t.transaction_date)),s&&!isNaN(s.getTime())?(e.length>30||e.length,a=s.toLocaleDateString("en-US",{month:"short",day:"numeric"})):t.month&&(a=t.month),{month:a,revenue:t.amount||t.revenue||t.total_amount||0,amount:t.amount||t.revenue||t.total_amount||0,deposits:t.deposits||0,withdrawals:t.withdrawals||0,transactions:t.transactions||t.transaction_count||0,transaction_count:t.transaction_count||t.transactions||0,clients:t.clients||0,date:s}}).sort((e,t)=>e.date&&t.date?e.date.getTime()-t.date.getTime():0):[];Te.debug("RevenueChart data",{rawLength:e?.length||0,chartLength:r.length,dateRange:r.length>0?{first:r[0]?.month,last:r[r.length-1]?.month}:null});const n=e=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),i=({active:e,payload:s,label:a})=>{if(e&&s&&s.length){const e=s[0].payload,r=e.amount||e.revenue||0,i=0===r;return t.jsx("div",{className:"bg-white border border-gray-200 rounded-lg shadow-lg p-4 min-w-[200px]",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full "+(i?"bg-gray-400":"bg-blue-500")}),t.jsx("span",{className:"font-semibold text-gray-900",children:a}),i&&t.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:"No Activity"})]}),t.jsxs("div",{className:"border-t border-gray-100 pt-2 space-y-1",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-600",children:"Net Revenue:"}),t.jsx("span",{className:"font-semibold "+(i?"text-gray-500":r>=0?"text-green-600":"text-red-600"),children:i?"₺0":n(r)})]}),void 0!==e.deposits&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-600",children:"Deposits:"}),t.jsxs("span",{className:"text-sm font-medium "+(i?"text-gray-500":"text-green-600"),children:["+",n(e.deposits)]})]}),void 0!==e.withdrawals&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-600",children:"Withdrawals:"}),t.jsxs("span",{className:"text-sm font-medium "+(i?"text-gray-500":"text-red-600"),children:["-",n(e.withdrawals)]})]}),void 0!==e.transaction_count&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-600",children:"Transactions:"}),t.jsx("span",{className:"text-sm font-medium "+(i?"text-gray-500":"text-gray-700"),children:e.transaction_count})]}),void 0!==e.clients&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-600",children:"Clients:"}),t.jsx("span",{className:"text-sm font-medium "+(i?"text-gray-500":"text-gray-700"),children:e.clients})]})]})]})})}return null};return"pie"===s?t.jsx(he,{width:"100%",height:a,children:t.jsxs(ue,{children:[t.jsx(xe,{data:Ye,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:5,dataKey:"value",children:Ye.map((e,s)=>t.jsx(ge,{fill:e.color},`cell-${s}`))}),t.jsx(pe,{formatter:e=>`${e}%`})]})}):r&&0!==r.length?t.jsx(he,{width:"100%",height:a,children:"line"===s?t.jsxs(fe,{data:r,margin:{top:5,right:30,left:20,bottom:5},children:[t.jsx(ye,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),t.jsx(be,{dataKey:"month",stroke:"#64748b",fontSize:12}),t.jsx(je,{stroke:"#64748b",fontSize:12,tickFormatter:n}),t.jsx(pe,{content:t.jsx(i,{})}),t.jsx(ve,{type:"natural",dataKey:"amount",stroke:"#3b82f6",strokeWidth:3,dot:{fill:"#3b82f6",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#3b82f6",strokeWidth:2},animationDuration:800,animationEasing:"ease-in-out"})]}):"bar"===s?t.jsxs(we,{data:r,margin:{top:20,right:30,left:20,bottom:20},children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"revenueBarGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"0%",stopColor:"#3B82F6",stopOpacity:1}),t.jsx("stop",{offset:"25%",stopColor:"#60A5FA",stopOpacity:.95}),t.jsx("stop",{offset:"50%",stopColor:"#93C5FD",stopOpacity:.9}),t.jsx("stop",{offset:"75%",stopColor:"#BFDBFE",stopOpacity:.85}),t.jsx("stop",{offset:"100%",stopColor:"#E0F2FE",stopOpacity:.8})]}),t.jsxs("linearGradient",{id:"depositsBarGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"0%",stopColor:"#10B981",stopOpacity:1}),t.jsx("stop",{offset:"25%",stopColor:"#34D399",stopOpacity:.95}),t.jsx("stop",{offset:"50%",stopColor:"#6EE7B7",stopOpacity:.9}),t.jsx("stop",{offset:"75%",stopColor:"#A7F3D0",stopOpacity:.85}),t.jsx("stop",{offset:"100%",stopColor:"#D1FAE5",stopOpacity:.8})]}),t.jsxs("linearGradient",{id:"withdrawalsBarGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"0%",stopColor:"#EF4444",stopOpacity:1}),t.jsx("stop",{offset:"25%",stopColor:"#F87171",stopOpacity:.95}),t.jsx("stop",{offset:"50%",stopColor:"#FCA5A5",stopOpacity:.9}),t.jsx("stop",{offset:"75%",stopColor:"#FECACA",stopOpacity:.85}),t.jsx("stop",{offset:"100%",stopColor:"#FEE2E2",stopOpacity:.8})]}),t.jsx("filter",{id:"barShadow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:t.jsx("feDropShadow",{dx:"0",dy:"4",stdDeviation:"6",floodColor:"#3B82F6",floodOpacity:"0.15"})}),t.jsxs("filter",{id:"barGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),t.jsx(ye,{strokeDasharray:"1 3",stroke:"#f1f5f9",strokeWidth:1,vertical:!1,opacity:.8}),t.jsx(be,{dataKey:"date",stroke:"#475569",fontSize:12,fontWeight:600,tickLine:!1,axisLine:{stroke:"#e2e8f0",strokeWidth:1},tick:{fill:"#475569"},interval:"preserveStartEnd",tickFormatter:e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),t.jsx(je,{stroke:"#475569",fontSize:12,fontWeight:600,tickFormatter:n,tickLine:!1,axisLine:{stroke:"#e2e8f0",strokeWidth:1},tick:{fill:"#475569"},width:80}),t.jsx(pe,{content:({active:e,payload:s,label:a})=>{if(e&&s&&s.length){const e=s[0].payload,a=e.date,r=new Date(a+"T00:00:00");return t.jsx("div",{className:"bg-white border border-gray-200 rounded-xl shadow-lg p-4 min-w-[200px] backdrop-blur-sm",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(C,{className:"h-4 w-4 text-gray-500"}),t.jsx("span",{className:"font-semibold text-gray-900",children:r.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),t.jsxs("div",{className:"border-t border-gray-100 pt-2 space-y-1",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-600",children:"Net Cash:"}),t.jsx("span",{className:"font-semibold text-blue-600",children:n(e.amount||0)})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-600",children:"Transactions:"}),t.jsx("span",{className:"text-sm font-medium text-gray-700",children:e.transaction_count||0})]})]})]})})}return null},cursor:{fill:"rgba(59, 130, 246, 0.05)"}}),t.jsx(Ne,{dataKey:"amount",fill:"url(#revenueBarGradient)",radius:[6,6,0,0],stroke:"none",filter:"url(#barShadow)",style:{filter:"drop-shadow(0 4px 8px rgba(59, 130, 246, 0.15))"}})]}):t.jsxs(_e,{data:r,margin:{top:5,right:30,left:20,bottom:5},children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"colorRevenue",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),t.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]}),t.jsxs("linearGradient",{id:"colorRevenueZero",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"5%",stopColor:"#94a3b8",stopOpacity:.2}),t.jsx("stop",{offset:"95%",stopColor:"#94a3b8",stopOpacity:0})]})]}),t.jsx(ye,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),t.jsx(be,{dataKey:"month",stroke:"#64748b",fontSize:12,interval:"preserveStartEnd",tick:{fontSize:11}}),t.jsx(je,{stroke:"#64748b",fontSize:12,tickFormatter:n,domain:["dataMin - 100000","dataMax + 100000"]}),t.jsx(pe,{content:t.jsx(i,{})}),t.jsx(ke,{type:"natural",dataKey:"amount",stroke:"#3b82f6",strokeWidth:3,fill:"url(#colorRevenue)",dot:!1,animationDuration:800,animationEasing:"ease-in-out"})]})}):t.jsx("div",{className:"flex items-center justify-center",style:{height:`${a}px`},children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"No revenue data available"}),t.jsx("p",{className:"text-xs mt-1",children:"Data will appear when transactions are available"})]})})},qe=Object.freeze(Object.defineProperty({__proto__:null,RevenueChart:He,default:He},Symbol.toStringTag,{value:"Module"})),Ze=({label:e,value:s,icon:a,change:r,trend:n="up",loading:i=!1,sparklineData:l,showGlass:o=!1})=>{if(i)return t.jsx(ae,{});const c=(e=>{if("number"==typeof e)return{prefix:"",suffix:"",numeric:e};const t=e.toString(),s=t.includes("%");let a="",r="";if(/[₺$₽€£]/.test(t)){const e=t.match(/[₺$₽€£]/);e&&(a=e[0])}s&&(r="%");const n=(e=>{if("number"==typeof e)return e;const t=e.toString().replace(/[₺$,₽€£\s,.]/g,"").trim(),s=e.toString().trim().startsWith("-"),a=parseFloat(s?`-${t}`:t);return isNaN(a)?null:a})(e);return{prefix:a,suffix:r,numeric:n}})(s),d="up"===n?S:T,m=o?"glass-card-strong glass-hover":"";return t.jsxs(ee,{className:`dashboard-card metric-card group border-0 shadow-premium card-hover-subtle overflow-hidden relative ${m}`,children:[t.jsxs(te,{className:"p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-slate-100 to-slate-50 rounded-xl flex items-center justify-center group-hover:from-slate-200 group-hover:to-slate-100 transition-all duration-300 floating",children:t.jsx(a,{className:"w-6 h-6 text-slate-700"})}),r&&t.jsxs("div",{className:"flex items-center gap-1 px-2.5 py-1 rounded-full transition-all duration-200 "+("up"===n?"bg-green-50 text-green-700 group-hover:bg-green-100":"bg-red-50 text-red-700 group-hover:bg-red-100"),children:[t.jsx(d,{className:"w-3.5 h-3.5"}),t.jsx("span",{className:"text-sm font-semibold",children:r})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("p",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:null!==c.numeric?t.jsx(re,{end:c.numeric,duration:1500,decimals:"%"===c.suffix?1:0,prefix:c.prefix,suffix:c.suffix,separator:","}):s}),t.jsx("p",{className:"text-sm text-slate-600 font-medium",children:e}),l&&l.length>0&&t.jsx("div",{className:"pt-2 mt-2 border-t border-slate-100",children:t.jsx(ne,{data:l,width:200,height:32,showArea:!0,showTooltip:!0})})]})]}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/0 to-slate-50/0 group-hover:from-white/30 group-hover:to-slate-50/30 pointer-events-none transition-all duration-300"})]})},Ve=({className:e})=>t.jsx("div",{className:`animate-pulse rounded-md bg-muted ${e}`}),Xe=()=>t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Ve,{className:"h-8 w-64"}),t.jsx(Ve,{className:"h-4 w-96"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Ve,{className:"h-9 w-20"}),t.jsx(Ve,{className:"h-9 w-20"})]})]}),t.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6",children:Array.from({length:4}).map((e,s)=>t.jsx(ee,{children:t.jsxs(te,{className:"p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx(Ve,{className:"h-8 w-8 rounded-md"}),t.jsx(Ve,{className:"h-4 w-16"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Ve,{className:"h-4 w-24"}),t.jsx(Ve,{className:"h-6 w-32"})]})]})},s))}),t.jsxs(ee,{children:[t.jsx(ie,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Ve,{className:"h-6 w-48"}),t.jsx(Ve,{className:"h-4 w-64"})]}),t.jsx(Ve,{className:"h-8 w-24"})]})}),t.jsx(te,{children:t.jsx(Ve,{className:"h-64 w-full"})})]}),t.jsxs(ee,{children:[t.jsx(ie,{children:t.jsxs("div",{className:"space-y-2",children:[t.jsx(Ve,{className:"h-6 w-32"}),t.jsx(Ve,{className:"h-4 w-48"})]})}),t.jsx(te,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsx(Ve,{className:"h-10 w-full"}),Array.from({length:5}).map((e,s)=>t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx(Ve,{className:"h-4 w-4"}),t.jsx(Ve,{className:"h-4 w-24"}),t.jsx(Ve,{className:"h-4 w-32"}),t.jsx(Ve,{className:"h-4 w-20"}),t.jsx(Ve,{className:"h-4 w-16"})]},s))]})})]})]}),Je=Object.freeze(Object.defineProperty({__proto__:null,CardSkeleton:()=>t.jsxs(ee,{children:[t.jsx(ie,{children:t.jsx(Ve,{className:"h-6 w-32"})}),t.jsx(te,{children:t.jsxs("div",{className:"space-y-2",children:[t.jsx(Ve,{className:"h-4 w-full"}),t.jsx(Ve,{className:"h-4 w-3/4"}),t.jsx(Ve,{className:"h-4 w-1/2"})]})})]}),Skeleton:Ve,SkeletonLoader:Xe,TableSkeleton:({rows:e=5,columns:s=4})=>t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"flex items-center space-x-4",children:Array.from({length:s}).map((e,s)=>t.jsx(Ve,{className:"h-4 w-24"},s))}),Array.from({length:e}).map((e,a)=>t.jsx("div",{className:"flex items-center space-x-4",children:Array.from({length:s}).map((e,s)=>t.jsx(Ve,{className:"h-4 w-24"},s))},a))]})},Symbol.toStringTag,{value:"Module"})),Ke=({stats:e,loading:s=!1,onStatClick:a})=>s?t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(4)].map((e,s)=>t.jsx(Xe,{className:"h-32"},s))}):t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:e.map((e,s)=>t.jsx("div",{onClick:()=>a&&a(s),className:a?"cursor-pointer":"",children:t.jsx(Ze,{label:e.label,value:e.value,icon:e.icon,change:e.change,trend:e.trend,loading:!1})},s))}),Qe=({onExport:e,onFilter:s,onRefresh:a,onSettings:r,refreshing:n=!1,isGeneratingReport:i=!1})=>{const{t:l}=X();return t.jsxs("div",{className:"flex items-center gap-2",children:[s&&t.jsxs(Q,{variant:"outline",size:"sm",onClick:s,className:"h-9 px-3 bg-white border-gray-200 text-gray-700 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-900 transition-all duration-200",children:[t.jsx(D,{className:"w-4 h-4 mr-2"}),l("common.filter")||"Filter"]}),e&&t.jsxs(Q,{variant:"outline",size:"sm",onClick:e,disabled:i,className:"h-9 px-3 bg-white border-gray-200 text-gray-700 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-900 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx(E,{className:"w-4 h-4 mr-2 "+(i?"animate-pulse":"")}),i?l("common.loading")||"Generating...":l("clients.export")||"Export"]}),a&&t.jsxs(Q,{variant:"outline",size:"sm",onClick:a,disabled:n,className:"h-9 px-3 bg-white border-gray-200 text-gray-700 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-900 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx(L,{className:"w-4 h-4 mr-2 "+(n?"animate-spin":"")}),l("common.refresh")||"Refresh"]}),r&&t.jsxs(Q,{variant:"outline",size:"sm",onClick:r,className:"h-9 px-3 bg-white border-gray-200 text-gray-700 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-900 transition-all duration-200",children:[t.jsx(y,{className:"w-4 h-4 mr-2"}),l("common.settings")||"Settings"]})]})},et=({timeRange:e,viewType:s,refreshing:a,isGeneratingReport:r,lastUpdated:n,onTimeRangeChange:i,onViewTypeChange:l,onRefresh:o,onExport:c})=>{const{t:d}=X();return t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[t.jsx(A,{className:"w-6 h-6 text-gray-700"}),d("dashboard.title")||"Dashboard"]}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:d("dashboard.description")||"Overview of your business performance"})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(le,{status:a?"syncing":"online",showLabel:!1,pulse:!a,size:"sm"}),n&&t.jsx(oe,{lastUpdated:n})]}),t.jsxs("select",{value:e,onChange:e=>i(e.target.value),className:"px-3 py-2 bg-white border border-gray-200 rounded-lg text-sm text-gray-700 font-medium hover:border-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-300 transition-all duration-200",children:[t.jsx("option",{value:"all",children:"All Time"}),t.jsx("option",{value:"7d",children:"Last 7 days"}),t.jsx("option",{value:"30d",children:"Last 30 days"}),t.jsx("option",{value:"90d",children:"Last 90 days"}),t.jsx("option",{value:"6m",children:"Last 6 months"}),t.jsx("option",{value:"1y",children:"Last year"})]}),t.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1",children:[t.jsx("button",{onClick:()=>l("net"),className:"px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200 "+("net"===s?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900 hover:bg-white/50"),children:d("dashboard.net_revenue")||"Net"}),t.jsx("button",{onClick:()=>l("gross"),className:"px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200 "+("gross"===s?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900 hover:bg-white/50"),children:d("ledger.gross_amount")||"Gross"})]}),t.jsx(Qe,{onExport:c,onRefresh:o,refreshing:a,isGeneratingReport:r})]})]})},tt=({title:e,icon:s,period:a,data:r,breakdown:n,loading:i,selectedDate:l,isCurrentPeriod:m,onPrevious:h,onNext:u,onToday:x,formatDate:g,navigatePath:p})=>{d(),X();const f=n.filter(e=>e.timePeriod===a&&["Total Bank","CC (Credit Card)","Tether","Conv"].includes(e.metric)),y=n.filter(e=>e.timePeriod===a&&["Tot Dep","Tot WD","Net Cash"].includes(e.metric)),b=r&&"object"==typeof r&&Object.keys(r).length>0,v=n&&n.length>0&&(f.length>0||y.length>0),w=b||v,_=b;return t.jsxs(ee,{className:"bg-white border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200 group",children:[t.jsx(ie,{className:"pb-4",children:t.jsx(ce,{title:e,icon:s,size:"md",badge:t.jsx(le,{status:"online",label:"Live",pulse:!0,size:"sm"})})}),t.jsx(te,{children:i?t.jsx(Ge,{}):w?0===f.length&&0===y.length?t.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500",children:[t.jsx(s,{className:"w-12 h-12 mb-3 opacity-50"}),t.jsx("p",{className:"text-sm font-medium",children:"No data for this period"}),t.jsxs("p",{className:"text-xs mt-1",children:["for ",g(l)]})]}):_&&r?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-gray-50 rounded border border-gray-100 hover:bg-gray-100 hover:border-gray-200 hover:shadow-sm transition-all duration-200 group",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(o,{className:"w-4 h-4 text-blue-600 group-hover:scale-110 transition-transform duration-200"}),t.jsx("span",{className:"text-sm font-medium text-gray-700 group-hover:text-gray-900 transition-colors duration-200",children:"Total Bank"})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"text-sm font-semibold text-gray-900 group-hover:text-gray-950 transition-colors duration-200",children:["₺",Math.abs(r.total_bank_tl||0).toLocaleString("tr-TR",{maximumFractionDigits:0})]}),r.bank_count>0&&t.jsxs("div",{className:"text-xs text-gray-500",children:[r.bank_count," txns"]})]})]}),t.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-gray-50 rounded border border-gray-100 hover:bg-gray-100 hover:border-gray-200 hover:shadow-sm transition-all duration-200 group",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(M,{className:"w-4 h-4 text-purple-600 group-hover:scale-110 transition-transform duration-200"}),t.jsx("span",{className:"text-sm font-medium text-gray-700 group-hover:text-gray-900 transition-colors duration-200",children:"CC (Credit Card)"})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"text-sm font-semibold text-gray-900 group-hover:text-gray-950 transition-colors duration-200",children:["₺",Math.abs(r.total_cc_tl||0).toLocaleString("tr-TR",{maximumFractionDigits:0})]}),r.cc_count>0&&t.jsxs("div",{className:"text-xs text-gray-500",children:[r.cc_count," txns"]})]})]}),t.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-gray-50 rounded border border-gray-100 hover:bg-gray-100 hover:border-gray-200 hover:shadow-sm transition-all duration-200 group",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(c,{className:"w-4 h-4 text-green-600 group-hover:scale-110 transition-transform duration-200"}),t.jsx("span",{className:"text-sm font-medium text-gray-700 group-hover:text-gray-900 transition-colors duration-200",children:"Tether"})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"text-sm font-semibold text-gray-900 group-hover:text-gray-950 transition-colors duration-200",children:["$",Math.abs(r.total_tether_usd||0).toLocaleString("tr-TR",{maximumFractionDigits:0})]}),r.tether_count>0&&t.jsxs("div",{className:"text-xs text-gray-500",children:[r.tether_count," txns"]})]})]}),t.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-gray-50 rounded border border-gray-100 hover:bg-gray-100 hover:border-gray-200 hover:shadow-sm transition-all duration-200 group",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(j,{className:"w-4 h-4 text-blue-600 group-hover:scale-110 transition-transform duration-200"}),t.jsx("span",{className:"text-sm font-medium text-gray-700 group-hover:text-gray-900 transition-colors duration-200",children:"Conv"})]}),t.jsx("div",{className:"text-right",children:t.jsxs("div",{className:"text-sm font-semibold text-gray-900 group-hover:text-gray-950 transition-colors duration-200",children:["$",Math.abs(r.conv_usd||0).toLocaleString("tr-TR",{maximumFractionDigits:0})]})})]})]}),t.jsxs("div",{className:"space-y-2 pt-2 border-t-2 border-gray-300",children:[t.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-gray-50 rounded border border-gray-100 hover:bg-gray-100 hover:border-gray-200 hover:shadow-sm transition-all duration-200 group",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(S,{className:"w-4 h-4 text-green-600 group-hover:scale-110 transition-transform duration-200"}),t.jsx("span",{className:"text-sm font-medium text-gray-700 group-hover:text-gray-900 transition-colors duration-200",children:"Tot Dep"})]}),t.jsx("div",{className:"text-right",children:t.jsxs("div",{className:"text-sm font-semibold text-gray-900 group-hover:text-gray-950 transition-colors duration-200",children:["₺",Math.abs(r.total_deposits_tl||0).toLocaleString("tr-TR",{maximumFractionDigits:0})]})})]}),t.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-gray-50 rounded border border-gray-100 hover:bg-gray-100 hover:border-gray-200 hover:shadow-sm transition-all duration-200 group",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(T,{className:"w-4 h-4 text-red-600 group-hover:scale-110 transition-transform duration-200"}),t.jsx("span",{className:"text-sm font-medium text-gray-700 group-hover:text-gray-900 transition-colors duration-200",children:"Tot WD"})]}),t.jsx("div",{className:"text-right",children:t.jsxs("div",{className:"text-sm font-semibold text-gray-900 group-hover:text-gray-950 transition-colors duration-200",children:["₺",Math.abs(r.total_withdrawals_tl||0).toLocaleString("tr-TR",{maximumFractionDigits:0})]})})]}),t.jsxs("div",{className:"flex items-center justify-between py-3 px-4 rounded border border-gray-100 hover:border-gray-200 hover:shadow-sm transition-all duration-200 group "+((r.net_cash_tl||0)>=0?"bg-green-50":"bg-red-50"),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(c,{className:"w-4 h-4 group-hover:scale-110 transition-transform duration-200 "+((r.net_cash_tl||0)>=0?"text-green-600":"text-red-600")}),t.jsx("span",{className:"text-sm font-medium text-gray-700 group-hover:text-gray-900 transition-colors duration-200",children:"Net Cash"})]}),t.jsx("div",{className:"text-right",children:t.jsxs("div",{className:"text-sm font-semibold group-hover:text-gray-950 transition-colors duration-200 "+((r.net_cash_tl||0)>=0?"text-green-700":"text-red-700"),children:["₺",Math.abs(r.net_cash_tl||0).toLocaleString("tr-TR",{maximumFractionDigits:0})]})})]})]})]}),"Total"!==a&&t.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-center w-full",children:[t.jsxs("div",{className:"flex items-center gap-3 w-full max-w-md",children:[t.jsx(Q,{variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),h()},className:"h-8 w-8 p-0 hover:bg-blue-50 hover:border-blue-300",children:t.jsx(R,{className:"w-4 h-4"})}),t.jsx("span",{className:"text-sm font-medium text-gray-700 flex-1 text-center",children:g(l)}),t.jsx(Q,{variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),u()},disabled:m,className:"h-8 w-8 p-0 hover:bg-blue-50 hover:border-blue-300 disabled:opacity-50 disabled:cursor-not-allowed",children:t.jsx(N,{className:"w-4 h-4"})})]}),!m&&x&&t.jsx(Q,{variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),x()},className:"h-8 px-3 text-xs hover:bg-blue-50 hover:border-blue-300 ml-4",children:"Daily"===a?"Today":"Current Month"})]})})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"space-y-2",children:f.map((e,s)=>t.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-gray-50 rounded border border-gray-100 hover:bg-gray-100 hover:border-gray-200 hover:shadow-sm transition-all duration-200 group",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(e.icon,{className:`w-4 h-4 ${e.iconColor} group-hover:scale-110 transition-transform duration-200`}),t.jsx("span",{className:"text-sm font-medium text-gray-700 group-hover:text-gray-900 transition-colors duration-200",children:e.metric})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-sm font-semibold text-gray-900 group-hover:text-gray-950 transition-colors duration-200",children:("Tether"===e.metric||"Conv"===e.metric?"$":"₺")+(e.amount||0).toLocaleString("tr-TR",{maximumFractionDigits:0})}),e.count>0&&t.jsxs("div",{className:"text-xs text-gray-500",children:[e.count," txns"]})]})]},s))}),t.jsx("div",{className:"space-y-2 pt-2 border-t-2 border-gray-300",children:y.map((e,s)=>t.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-gray-50 rounded border border-gray-100 hover:bg-gray-100 hover:border-gray-200 hover:shadow-sm transition-all duration-200 group",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(e.icon,{className:`w-4 h-4 ${e.iconColor} group-hover:scale-110 transition-transform duration-200`}),t.jsx("span",{className:"text-sm font-medium text-gray-700 group-hover:text-gray-900 transition-colors duration-200",children:e.metric})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"text-sm font-semibold text-gray-900 group-hover:text-gray-950 transition-colors duration-200",children:["₺",(e.amount||0).toLocaleString("tr-TR",{maximumFractionDigits:0})]}),e.count>0&&t.jsxs("div",{className:"text-xs text-gray-500",children:[e.count," txns"]})]})]},s))})]}),"Total"!==a&&t.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-center w-full",children:[t.jsxs("div",{className:"flex items-center gap-3 w-full max-w-md",children:[t.jsx(Q,{variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),h()},className:"h-8 w-8 p-0 hover:bg-blue-50 hover:border-blue-300",children:t.jsx(R,{className:"w-4 h-4"})}),t.jsx("span",{className:"text-sm font-medium text-gray-700 flex-1 text-center",children:g(l)}),t.jsx(Q,{variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),u()},disabled:m,className:"h-8 w-8 p-0 hover:bg-blue-50 hover:border-blue-300 disabled:opacity-50 disabled:cursor-not-allowed",children:t.jsx(N,{className:"w-4 h-4"})})]}),!m&&x&&t.jsx(Q,{variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),x()},className:"h-8 px-3 text-xs hover:bg-blue-50 hover:border-blue-300 ml-4",children:"Daily"===a?"Today":"Current Month"})]})})]}):t.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500",children:[t.jsx(s,{className:"w-12 h-12 mb-3 opacity-50"}),t.jsx("p",{className:"text-sm font-medium",children:"No data available"}),t.jsxs("p",{className:"text-xs mt-1",children:["for ",g(l)]})]})})]})},st=new class{baseUrl="/api/v1";cache=new Map;CACHE_DURATION=3e4;pendingRequests=new Map;isCacheValid(e){const t=this.cache.get(e);return!!t&&Date.now()-t.timestamp<this.CACHE_DURATION}async getCachedOrFetch(e,t,s=!1){if(!s&&this.isCacheValid(e))return Te.debug(`Using cached data for ${e}`),this.cache.get(e).data;if(this.pendingRequests.has(e))return Te.debug(`Waiting for pending request for ${e}`),this.pendingRequests.get(e);Te.debug(`Fetching fresh data for ${e} ${s?"(cache bypassed)":""}`);const a=t().then(t=>(this.cache.set(e,{data:t,timestamp:Date.now()}),this.pendingRequests.delete(e),t)).catch(t=>{throw this.pendingRequests.delete(e),t});return this.pendingRequests.set(e,a),a}clearCache(e){e?(this.cache.delete(e),this.pendingRequests.delete(e),Te.debug(`Cleared cache for ${e}`)):(this.cache.clear(),this.pendingRequests.clear(),Te.debug("Cleared all cache and pending requests"))}async getDashboardStats(e="all"){const t=`dashboard-stats-${e}`;return this.getCachedOrFetch(t,async()=>(await De.get(`/dashboard/consolidated?range=${e}`,{timeout:1e4,retries:2})).data)}async getSystemPerformance(){return(await De.get("/analytics/system/performance",{timeout:1e4,retries:2})).data}async getDataQuality(){return(await De.get("/analytics/data/quality",{timeout:1e4,retries:2})).data}async getSecurityMetrics(){return(await De.get("/analytics/security/metrics",{timeout:1e4,retries:2})).data}async getConsolidatedDashboard(e="all",t=!1){const s=`consolidated-dashboard-${e}`;return this.getCachedOrFetch(s,async()=>{const s=t?`&_t=${Date.now()}`:"",a=(await De.get(`/dashboard/consolidated?range=${e}${s}`,{timeout:15e3,retries:3})).data;if(!a)throw new Error("Empty response from consolidated dashboard endpoint");return a},t)}async getRevenueTrends(e="all"){return(await De.get(`/analytics/revenue/trends?range=${e}`,{timeout:1e4,retries:2})).data}async getTopPerformers(e="all"){return(await De.get(`/analytics/top-performers?range=${e}`,{timeout:1e4,retries:2})).data}async getCommissionAnalytics(e="all"){const t=`commission-analytics-${e}`;return this.getCachedOrFetch(t,async()=>(await De.get(`/analytics/commission/analytics?range=${e}`,{timeout:1e4,retries:2})).data)}async getExchangeRates(){return this.getCachedOrFetch("exchange-rates",async()=>(await De.get("/exchange-rates/rates",{timeout:1e4,retries:2})).data)}async getTransactionVolumeAnalysis(e="all"){return(await De.get(`/analytics/transactions/volume-analysis?range=${e}`,{timeout:1e4,retries:2})).data}async getClientAnalytics(e="all"){return(await De.get(`/analytics/clients/analytics?range=${e}`,{timeout:1e4,retries:2})).data.data}async getPspRolloverSummary(){return(await De.get("/analytics/psp-rollover-summary",{timeout:1e4,retries:2})).data}async getFinancialPerformance(e="all",t="net"){const s=`financial-performance-${e}-${t}`;return this.getCachedOrFetch(s,async()=>{try{const s=(await De.get(`/financial-performance?range=${e}&view=${t}`,{timeout:6e4,retries:2})).data;if(!s)throw new Error("Empty response from backend");if(s&&s.data&&(s.data.daily||s.data.monthly||s.data.annual))return s;throw new Error("Invalid data structure in response")}catch(s){throw s.message?.includes("timeout")||s.message?.includes("Timeout")||Te.error("Error loading financial performance:",s),s}})}async refreshDashboard(e="all"){return this.clearCache(),this.getDashboardStats(e)}},at=(e,t,s=0)=>{const a=e?.[t];return"number"!=typeof a||isNaN(a)?s:a},rt=(e,t,s)=>{const{daily:a,monthly:r,annual:n}=e,i=[],l=(e,t,s,a,r,n)=>{const i="Net Cash"===t,l="Tot Dep"===t,o="Tot WD"===t;let c=0,d=0,m=0,h=0;"Total Bank"===t?(c=s.total_bank_tl||0,d=s.total_bank_usd||0,m=s.total_bank_tl||0,h=s.bank_count||0):"CC (Credit Card)"===t?(c=s.total_cc_tl||0,d=s.total_cc_usd||0,m=s.total_cc_tl||0,h=s.cc_count||0):"Tether"===t?(c=s.total_tether_usd||0,d=s.total_tether_usd||0,m=s.total_tether_tl||0,h=s.tether_count||0):"Conv"===t?(c=s.conv_usd||0,d=s.conv_usd||0,m=0,h=0):l?(c=at(s,"total_deposits_tl"),d=at(s,"total_deposits_usd"),m=at(s,"total_deposits_tl"),h=0):o?(c=at(s,"total_withdrawals_tl"),d=at(s,"total_withdrawals_usd"),m=at(s,"total_withdrawals_tl"),h=0):i&&(c=at(s,"net_cash_tl"),d=at(s,"net_cash_usd"),m=at(s,"net_cash_tl"),h=0);const u=i?c:0,x=u>=0?"text-green-600":"text-red-600",g=i?u>=0?"bg-green-50":"bg-red-50":n,p=i?u>=0?"green":"red":r;return{timePeriod:e,metric:t,amount:c,usdAmount:d,tlAmount:m,count:h,trend:0,icon:a,description:`${e.toLowerCase()} ${t.toLowerCase()}`,color:p,bgColor:g,iconColor:"text-gray-800",trendColor:x}};return i.push(l("Daily","Total Bank",a,o,"blue","bg-blue-50")),i.push(l("Daily","CC (Credit Card)",a,M,"purple","bg-purple-50")),i.push(l("Daily","Tether",a,c,"green","bg-green-50")),i.push(l("Daily","Conv",a,j,"blue","bg-blue-50")),i.push(l("Daily","Tot Dep",a,S,"green","bg-green-50")),i.push(l("Daily","Tot WD",a,T,"red","bg-red-50")),i.push(l("Daily","Net Cash",a,c,"green","bg-green-50")),i.push(l("Monthly","Total Bank",r,o,"blue","bg-blue-50")),i.push(l("Monthly","CC (Credit Card)",r,M,"purple","bg-purple-50")),i.push(l("Monthly","Tether",r,c,"green","bg-green-50")),i.push(l("Monthly","Conv",r,j,"blue","bg-blue-50")),i.push(l("Monthly","Tot Dep",r,S,"green","bg-green-50")),i.push(l("Monthly","Tot WD",r,T,"red","bg-red-50")),i.push(l("Monthly","Net Cash",r,c,"green","bg-green-50")),i.push(l("Total","Total Bank",n,o,"blue","bg-blue-50")),i.push(l("Total","CC (Credit Card)",n,M,"purple","bg-purple-50")),i.push(l("Total","Tether",n,c,"green","bg-green-50")),i.push(l("Total","Conv",n,j,"blue","bg-blue-50")),i.push(l("Total","Tot Dep",n,S,"green","bg-green-50")),i.push(l("Total","Tot WD",n,T,"red","bg-red-50")),i.push(l("Total","Net Cash",n,c,"green","bg-green-50")),i};class nt{static async generateComprehensiveReport(e="all"){try{const[t,s,a,r,n,i]=await Promise.all([st.getDashboardStats(e),st.getSystemPerformance(),st.getDataQuality(),st.getSecurityMetrics(),st.getCommissionAnalytics(e),st.getExchangeRates()]),l=P.book_new();this.addDashboardOverviewSheet(l,t),this.addTransactionsSheet(l,t?.recent_transactions||[]),this.addAnalyticsSheet(l,t),this.addSystemPerformanceSheet(l,s),this.addExchangeRatesSheet(l,i),this.addCommissionAnalyticsSheet(l,n),this.addDataQualitySheet(l,a),this.addSecurityMetricsSheet(l,r);const o=(new Date).toISOString().slice(0,19).replace(/:/g,"-");O(l,`PipLinePro_Report_${e}_${o}.xlsx`)}catch(t){throw t}}static addDashboardOverviewSheet(e,t){const s=[["PipLinePro Dashboard Overview"],["Generated:",(new Date).toLocaleString()],[""],["Key Metrics"],["Total Revenue",t?.total_revenue||0],["Total Transactions",t?.total_transactions||0],["Active Clients",t?.active_clients||0],["Average Transaction",t?.average_transaction||0],[""],["Revenue Breakdown"],["Deposits",t?.total_deposits||0],["Withdrawals",t?.total_withdrawals||0],["Net Revenue",t?.net_revenue||0],[""],["Performance Metrics"],["Success Rate",t?.success_rate||0],["Growth Rate",t?.growth_rate||0],["Client Satisfaction",t?.client_satisfaction||0]],a=P.aoa_to_sheet(s);this.formatWorksheet(a,"A1:B20"),P.book_append_sheet(e,a,"Dashboard Overview")}static addTransactionsSheet(e,t){if(!t||0===t.length){const t=[["No transaction data available"]],s=P.aoa_to_sheet(t);return void P.book_append_sheet(e,s,"Transactions")}const s=[["Transaction ID","Client Name","Amount","Currency","Status","Date","PSP","Category"]];t.forEach(e=>{s.push([e.id||"",e.client_name||"",e.amount||0,e.currency||"TL",e.status||"",e.date?new Date(e.date).toLocaleDateString():"",e.psp||"",e.category||""])});const a=P.aoa_to_sheet(s);this.formatWorksheet(a,"A1:H"+(t.length+1)),P.book_append_sheet(e,a,"Transactions")}static addAnalyticsSheet(e,t){const s=[["Analytics Summary"],["Generated:",(new Date).toLocaleString()],[""],["Revenue Analytics"],["Total Revenue",t?.total_revenue||0],["Monthly Growth",t?.monthly_growth||0],["Yearly Growth",t?.yearly_growth||0],[""],["Transaction Analytics"],["Total Transactions",t?.total_transactions||0],["Successful Transactions",t?.successful_transactions||0],["Failed Transactions",t?.failed_transactions||0],["Success Rate",t?.success_rate||0],[""],["Client Analytics"],["Total Clients",t?.total_clients||0],["Active Clients",t?.active_clients||0],["New Clients (30d)",t?.new_clients_30d||0],["Client Retention Rate",t?.client_retention_rate||0]],a=P.aoa_to_sheet(s);this.formatWorksheet(a,"A1:B20"),P.book_append_sheet(e,a,"Analytics")}static addSystemPerformanceSheet(e,t){const s=[["System Performance Metrics"],["Generated:",(new Date).toLocaleString()],[""],["CPU Usage",t?.cpu_usage||0,"%"],["Memory Usage",t?.memory_usage||0,"%"],["Disk Usage",t?.disk_usage||0,"%"],["Network Latency",t?.network_latency||0,"ms"],[""],["Database Performance"],["Query Response Time",t?.db_query_time||0,"ms"],["Connection Pool",t?.db_connections||0,"connections"],["Cache Hit Rate",t?.cache_hit_rate||0,"%"],[""],["Application Metrics"],["Response Time",t?.response_time||0,"ms"],["Throughput",t?.throughput||0,"requests/min"],["Error Rate",t?.error_rate||0,"%"],["Uptime",t?.uptime||0,"%"]],a=P.aoa_to_sheet(s);this.formatWorksheet(a,"A1:C20"),P.book_append_sheet(e,a,"System Performance")}static addExchangeRatesSheet(e,t){const s=[["Exchange Rates"],["Generated:",(new Date).toLocaleString()],[""],["Currency Pair","Rate","Last Updated","Age (minutes)","Status"]];t?.success&&t.rates?Object.entries(t.rates).forEach(([e,t])=>{s.push([t.currency_pair||e,t.rate||0,t.last_updated||"",t.age_minutes||0,t.is_stale?"Stale":"Fresh"])}):s.push(["No exchange rate data available","","","",""]);const a=P.aoa_to_sheet(s);this.formatWorksheet(a,"A1:E10"),P.book_append_sheet(e,a,"Exchange Rates")}static addCommissionAnalyticsSheet(e,t){const s=[["Commission Analytics"],["Generated:",(new Date).toLocaleString()],[""],["PSP","Total Volume","Total Commission","Commission Rate","Transaction Count"]];t?.success&&t.data?.psp_commission?t.data.psp_commission.forEach(e=>{s.push([e.psp||"Unknown",e.total_volume||0,e.total_commission||0,e.commission_rate||0,e.transaction_count||0])}):s.push(["No commission data available","","","",""]);const a=P.aoa_to_sheet(s);this.formatWorksheet(a,"A1:E20"),P.book_append_sheet(e,a,"Commission Analytics")}static addDataQualitySheet(e,t){const s=[["Data Quality Metrics"],["Generated:",(new Date).toLocaleString()],[""],["Metric","Value","Status"],["Data Completeness",t?.completeness||0,"%"],["Data Accuracy",t?.accuracy||0,"%"],["Data Consistency",t?.consistency||0,"%"],["Data Timeliness",t?.timeliness||0,"%"],[""],["Quality Issues"],["Missing Values",t?.missing_values||0],["Duplicate Records",t?.duplicates||0],["Invalid Formats",t?.invalid_formats||0],["Data Conflicts",t?.conflicts||0]],a=P.aoa_to_sheet(s);this.formatWorksheet(a,"A1:C15"),P.book_append_sheet(e,a,"Data Quality")}static addSecurityMetricsSheet(e,t){const s=[["Security Metrics"],["Generated:",(new Date).toLocaleString()],[""],["Metric","Today","This Week","This Month"],["Failed Logins",t?.failed_logins?.today||0,t?.failed_logins?.week||0,t?.failed_logins?.month||0],["Blocked IPs",t?.blocked_ips?.today||0,t?.blocked_ips?.week||0,t?.blocked_ips?.month||0],["Security Alerts",t?.security_alerts?.today||0,t?.security_alerts?.week||0,t?.security_alerts?.month||0],[""],["Access Control"],["Active Sessions",t?.active_sessions||0],["Admin Users",t?.admin_users||0],["Regular Users",t?.regular_users||0],["Locked Accounts",t?.locked_accounts||0]],a=P.aoa_to_sheet(s);this.formatWorksheet(a,"A1:D15"),P.book_append_sheet(e,a,"Security Metrics")}static formatWorksheet(e,t){e["!cols"]=[{wch:20},{wch:15},{wch:15},{wch:15},{wch:15}];const s=P.decode_range(t);for(let a=s.s.r;a<=s.e.r;++a)for(let t=s.s.c;t<=s.e.c;++t){const s=P.encode_cell({r:a,c:t});e[s]&&(e[s].s={border:{top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},alignment:{horizontal:"center",vertical:"center"}})}}static async exportSpecificData(e,t="all"){switch(e){case"all":await this.generateComprehensiveReport(t);break;case"transactions":await this.exportTransactions(t);break;case"clients":await this.exportClients(t);break;case"analytics":await this.exportAnalytics(t);break;default:throw new Error("Invalid export type")}}static async exportTransactions(e){const t=await st.getDashboardStats(e),s=P.book_new();this.addTransactionsSheet(s,t?.recent_transactions||[]);const a=(new Date).toISOString().slice(0,19).replace(/:/g,"-");O(s,`Transactions_${e}_${a}.xlsx`)}static async exportClients(e){}static async exportAnalytics(e){const t=await st.getDashboardStats(e),s=P.book_new();this.addAnalyticsSheet(s,t);const a=(new Date).toISOString().slice(0,19).replace(/:/g,"-");O(s,`Analytics_${e}_${a}.xlsx`)}}const it=e.lazy(()=>Se(()=>Promise.resolve().then(()=>yt),void 0).then(e=>({default:e.RecentActivityFeed}))),lt=_.memo(({user:s})=>{const a=d(),{t:r}=X(),[n,i]=e.useState(null);e.useEffect(()=>(Te.dashboard("ModernDashboard mounted"),()=>{Te.dashboard("ModernDashboard unmounted")}),[]),e.useEffect(()=>{const e=e=>{Te.error("Dashboard runtime error:",e.error),i(e.error)},t=e=>{Te.error("Dashboard unhandled promise rejection:",e.reason),i(e.reason instanceof Error?e.reason:new Error(String(e.reason)))};return window.addEventListener("error",e),window.addEventListener("unhandledrejection",t),()=>{window.removeEventListener("error",e),window.removeEventListener("unhandledrejection",t)}},[]);const[o,m]=e.useState("all"),[h,u]=e.useState("net"),[x,p]=e.useState("monthly"),[f,y]=e.useState(!0),[b,v]=e.useState(!1),[w,N]=e.useState(new Date),[_,k]=e.useState(new Date),[T,D]=e.useState(null),[E,L]=e.useState(null),[M,R]=e.useState(!1),[P,O]=e.useState(!1),{data:z,loading:F,error:U,refresh:I,lastUpdated:B}=(({timeRange:t,viewType:s,enabled:a=!0})=>{const[r,n]=e.useState(null),[i,l]=e.useState(!0),[o,c]=e.useState(null),[d,m]=e.useState(null),h=e.useRef(null),u=e.useRef(!0),x=e.useCallback(async()=>{if(a){h.current&&h.current.abort(),h.current=new AbortController,l(!0),c(null);try{Te.dashboard("Loading dashboard data",{timeRange:t,viewType:s});const e=await st.getConsolidatedDashboard(t,!0);if(!u.current||h.current.signal.aborted)return;const a=(e,t=0)=>{if(!e)return t;const s=String(e).replace(/[₺,%,]/g,""),a=parseFloat(s);return isNaN(a)?t:a},r=(e,t=0)=>{if(!e)return t;const s=String(e).replace(/[,]/g,""),a=parseInt(s);return isNaN(a)?t:a};let i=e?.chart_data||{daily_revenue:[],client_distribution:[]};i.daily_revenue&&Array.isArray(i.daily_revenue)||(i={...i,daily_revenue:[]});const l={stats:e?.stats||{total_revenue:{value:"0",change:"0%",changeType:"positive"},total_transactions:{value:"0",change:"0%",changeType:"positive"},active_clients:{value:"0",change:"0%",changeType:"positive"},growth_rate:{value:"0%",change:"0%",changeType:"positive"}},chart_data:i,recent_transactions:e?.recent_transactions||[],summary:{total_revenue:a(e?.stats?.total_revenue?.value),total_commission:e?.commission_analytics?.total_commission||0,total_net:a(e?.stats?.total_revenue?.value)-(e?.commission_analytics?.total_commission||0),transaction_count:r(e?.stats?.total_transactions?.value),active_clients:r(e?.stats?.active_clients?.value),growth_rate:a(e?.stats?.growth_rate?.value),net_cash:(()=>{const t=e?.summary?.net_cash;if(null!=t){const e="number"==typeof t?t:parseFloat(String(t));return isNaN(e)?0:e}const s=e?.financial_performance?.annual?.net_cash_tl;if(null!=s){const e="number"==typeof s?s:parseFloat(String(s));return isNaN(e)?0:e}return 0})()},exchange_rates:e?.exchange_rates||{USD_TRY:48},financial_performance:e?.financial_performance||null};n(l),m(new Date),Te.dashboard("Dashboard data loaded successfully")}catch(e){if(!u.current||h.current.signal.aborted)return;const t=e.message?.includes("Failed to fetch")||e.message?.includes("NetworkError")?"Bağlantı hatası. Lütfen internet bağlantınızı kontrol edin.":e.message?.includes("401")||e.message?.includes("403")?"Yetki hatası. Lütfen tekrar giriş yapın.":e.message?.includes("500")?"Sunucu hatası. Lütfen daha sonra tekrar deneyin.":"Dashboard verisi yüklenemedi. Lütfen tekrar deneyin.";Te.error("Error loading dashboard data:",e),c(t),n({stats:{total_revenue:{value:"0",change:"0%",changeType:"positive"},total_transactions:{value:"0",change:"0%",changeType:"positive"},active_clients:{value:"0",change:"0%",changeType:"positive"},growth_rate:{value:"0%",change:"0%",changeType:"positive"}},chart_data:{daily_revenue:[],client_distribution:[]},recent_transactions:[],summary:{total_revenue:0,total_commission:0,total_net:0,transaction_count:0,active_clients:0,growth_rate:0}})}finally{u.current&&l(!1)}}},[t,s,a]),g=e.useCallback(async()=>{st.clearCache(),await x()},[x]);return e.useEffect(()=>(u.current=!0,x(),()=>{u.current=!1,h.current&&h.current.abort()}),[x]),{data:r,loading:i,error:o,refresh:g,lastUpdated:d}})({timeRange:o,viewType:h}),{data:G,loading:W,error:Y,refresh:H,getDayData:q,getMonthData:Z}=(({timeRange:t,viewType:s,enabled:a=!0})=>{const[r,n]=e.useState(null),[i,l]=e.useState(!0),[o,c]=e.useState(null),d=e.useRef(null),m=e.useRef(!0),h=e.useCallback(async()=>{if(a){d.current&&d.current.abort(),d.current=new AbortController,l(!0),c(null);try{Te.dashboard("Loading financial performance data",{timeRange:t,viewType:s});const e=await st.getFinancialPerformance(t,s);if(!m.current||d.current.signal.aborted)return;n(e),Te.dashboard("Financial performance data loaded successfully")}catch(e){if(!m.current||d.current.signal.aborted)return;const t=e.message?.includes("Failed to fetch")||e.message?.includes("NetworkError")?"Bağlantı hatası. Lütfen internet bağlantınızı kontrol edin.":e.message?.includes("401")||e.message?.includes("403")?"Yetki hatası. Lütfen tekrar giriş yapın.":e.message?.includes("500")?"Sunucu hatası. Lütfen daha sonra tekrar deneyin.":"Finansal performans verisi yüklenemedi. Lütfen tekrar deneyin.";Te.error("Error loading financial performance:",e),c(t);const s={total_bank_usd:0,total_bank_tl:0,total_cc_usd:0,total_cc_tl:0,total_tether_usd:0,total_tether_tl:0,conv_usd:0,conv_tl:0,total_transactions:0,bank_count:0,cc_count:0,tether_count:0};n({success:!0,data:{daily:s,monthly:s,annual:s,exchange_rate:48}})}finally{m.current&&l(!1)}}},[t,s,a]),u=e.useCallback(async()=>{st.clearCache(),await h()},[h]),x=e.useCallback(async e=>{try{const t=e.toISOString().split("T")[0],s=(await De.get(`/financial-performance/daily?date=${t}`,{timeout:3e4,retries:1})).data;return s&&s.success&&s.data?s.data:(Te.warn("Day data response missing data:",s),null)}catch(t){return t.message?.includes("timeout")||t.message?.includes("Timeout")?Te.warn("Day data request timeout - backend may be slow"):t.message?.includes("ERR_EMPTY_RESPONSE")||t.message?.includes("Failed to fetch")?Te.warn("Backend not responding for day data (non-critical)"):Te.error("Error fetching day data:",t),null}},[]),g=e.useCallback(async e=>{try{const t=e.getFullYear(),a=e.getMonth()+1,r=(await De.get(`/financial-performance/monthly?year=${t}&month=${a}&view=${s}`,{timeout:3e4,retries:1})).data;return r&&r.success&&r.data?r.data:(Te.warn("Month data response missing data:",r),null)}catch(t){return t.message?.includes("timeout")||t.message?.includes("Timeout")?Te.warn("Month data request timeout - backend may be slow"):Te.error("Error fetching month data:",t),null}},[s]);return e.useEffect(()=>(m.current=!0,h(),()=>{m.current=!1,d.current&&d.current.abort()}),[h]),{data:r,loading:i,error:o,refresh:u,getDayData:x,getMonthData:g}})({timeRange:o,viewType:h});e.useEffect(()=>{(()=>{if("undefined"!=typeof document&&!document.getElementById("shimmer-styles")){const e=document.createElement("style");e.id="shimmer-styles",e.textContent="\n@keyframes shimmer {\n  0% {\n    transform: translateX(-100%);\n  }\n  100% {\n    transform: translateX(100%);\n  }\n}\n\n.animate-shimmer {\n  animation: shimmer 2s infinite;\n}\n",document.head.appendChild(e)}})()},[]);const V=e.useCallback(()=>{const e=new Date(w);e.setMonth(e.getMonth()-1),N(e)},[w]),J=e.useCallback(()=>{const e=new Date(w);e.setMonth(e.getMonth()+1),N(e)},[w]),K=e.useCallback(()=>{const e=new Date;return w.getMonth()===e.getMonth()&&w.getFullYear()===e.getFullYear()},[w]),se=e.useCallback(()=>{const e=new Date(_);e.setDate(e.getDate()-1),k(e)},[_]),ae=e.useCallback(()=>{const e=new Date(_);e.setDate(e.getDate()+1),k(e)},[_]),re=e.useCallback(()=>{const e=new Date;return _.getDate()===e.getDate()&&_.getMonth()===e.getMonth()&&_.getFullYear()===e.getFullYear()},[_]),ne=e.useCallback(e=>e.toLocaleDateString("en-US",{month:"long",year:"numeric"}),[]),oe=e.useCallback(e=>e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),[]);e.useEffect(()=>{(async()=>{R(!0);try{if(re()&&G?.data)D(G.data.daily);else{const e=await q(_);D(e||(G?.data?.daily?G.data.daily:null))}}catch(e){e?.message?.includes("ERR_EMPTY_RESPONSE")||e?.message?.includes("Failed to fetch")?(Te.warn("Backend not responding for day data (non-critical)"),D(G?.data?.daily?G.data.daily:null)):(Te.error("Error loading day data:",e),D(null))}finally{R(!1)}})()},[_,G,re,q]),e.useEffect(()=>{(async()=>{O(!0);try{if(K()&&G?.data)L(G.data.monthly);else{const e=await Z(w);L(e||(G?.data?.monthly?G.data.monthly:null))}}catch(e){e?.message?.includes("ERR_EMPTY_RESPONSE")||e?.message?.includes("Failed to fetch")?(Te.warn("Backend not responding for month data (non-critical)"),L(G?.data?.monthly?G.data.monthly:null)):(Te.error("Error loading month data:",e),L(null))}finally{O(!1)}})()},[w,G,K,Z,h]);const de=e.useMemo(()=>{try{return((e,t,s)=>{if(!e)return[{label:s("dashboard.net_cash"),value:"₺0",icon:c,change:"0%",trend:"up"},{label:s("dashboard.active_clients"),value:"0",icon:l,change:"0%",trend:"up"},{label:s("dashboard.total_transactions"),value:"0",icon:j,change:"0%",trend:"up"},{label:s("dashboard.growth_rate"),value:"0%",icon:g,change:"0%",trend:"up"}];let a=0;const r=e?.summary?e.summary.net_cash:void 0;if(null==r||isNaN(Number(r))){const s=e?.financial_performance?.annual?.net_cash_tl;if(null==s||isNaN(Number(s))){const e=t?.annual?.net_cash_tl;null==e||isNaN(Number(e))||(a=Number(e))}else a=Number(s)}else a=Number(r);const n=e?.stats?.active_clients?.value||"0",i="string"==typeof n?parseInt(n.replace(/[,]/g,""))||0:n,o=e?.stats?.total_transactions?.value||"0",d="string"==typeof o?parseInt(o.replace(/[,]/g,""))||0:o,m=e?.stats?.growth_rate?.value||"0%",h="string"==typeof m?parseFloat(m.replace(/[%,]/g,""))||0:m,u=e?.stats?.net_cash?.change||e?.stats?.total_revenue?.change||"0%",x=e?.stats?.active_clients?.change||"0%",p=e?.stats?.total_transactions?.change||"0%",f=e?.stats?.growth_rate?.change||"0%",y=e=>(parseFloat(e.replace(/[+%]/g,""))||0)>=0?"up":"down";return[{label:s("dashboard.net_cash"),value:`₺${a.toLocaleString("tr-TR",{maximumFractionDigits:0})}`,icon:c,change:u,trend:y(u)},{label:s("dashboard.active_clients"),value:i.toLocaleString("tr-TR"),icon:l,change:x,trend:y(x)},{label:s("dashboard.total_transactions"),value:d.toLocaleString("tr-TR"),icon:j,change:p,trend:y(p)},{label:s("dashboard.growth_rate"),value:`${h.toFixed(1)}%`,icon:g,change:f,trend:y(f)}]})(z,G?.data||null,r)}catch(e){return Te.error("Error calculating quick stats:",e),[]}},[z,G,r]),me=e.useMemo(()=>{if(T&&Object.keys(T).length>0)return T;const e=z?.financial_performance?.daily;return e&&Object.keys(e).length>0?e:G?.data?.daily||null},[T,z,G]),he=e.useMemo(()=>{if(E&&Object.keys(E).length>0)return E;const e=z?.financial_performance?.monthly;return e&&Object.keys(e).length>0?e:G?.data?.monthly||null},[E,z,G]),ue=e.useMemo(()=>{const e=z?.financial_performance?.annual;return e&&Object.keys(e).length>0?e:G?.data?.annual||null},[z,G]);Te.debug("[DIRECT DATA CHECK]",{selectedDay:_?.toDateString(),selectedMonth:w?.toLocaleDateString("en-US",{month:"long",year:"numeric"}),directDailyData:me?{total_bank_tl:me.total_bank_tl,total_cc_tl:me.total_cc_tl,total_tether_usd:me.total_tether_usd,conv_usd:me.conv_usd,total_deposits_tl:me.total_deposits_tl,total_withdrawals_tl:me.total_withdrawals_tl,net_cash_tl:me.net_cash_tl,bank_count:me.bank_count,cc_count:me.cc_count,tether_count:me.tether_count}:"NULL",directMonthlyData:he?{total_bank_tl:he.total_bank_tl,total_cc_tl:he.total_cc_tl,total_tether_usd:he.total_tether_usd,conv_usd:he.conv_usd,total_deposits_tl:he.total_deposits_tl,total_withdrawals_tl:he.total_withdrawals_tl,net_cash_tl:he.net_cash_tl,bank_count:he.bank_count,cc_count:he.cc_count,tether_count:he.tether_count}:"NULL",directAnnualData:ue?{total_bank_tl:ue.total_bank_tl,total_cc_tl:ue.total_cc_tl,total_tether_usd:ue.total_tether_usd,conv_usd:ue.conv_usd,total_deposits_tl:ue.total_deposits_tl,total_withdrawals_tl:ue.total_withdrawals_tl,net_cash_tl:ue.net_cash_tl,bank_count:ue.bank_count,cc_count:ue.cc_count,tether_count:ue.tether_count}:"NULL"});const xe=e.useMemo(()=>{try{const e=z?.financial_performance,t=G?.data||null,s=z?.exchange_rates?.USD_TRY||t?.exchange_rate||48;let a=null;e&&Object.keys(e).length>0?a={daily:e.daily||{},monthly:e.monthly||{},annual:e.annual||{},exchange_rate:s}:t&&(a={...t,exchange_rate:s});const r=((e,t,s)=>{const a={total_bank_usd:0,total_bank_tl:0,total_cc_usd:0,total_cc_tl:0,total_tether_usd:0,total_tether_tl:0,conv_usd:0,conv_tl:0,total_transactions:0,bank_count:0,cc_count:0,tether_count:0,total_deposits_usd:0,total_deposits_tl:0,total_withdrawals_usd:0,total_withdrawals_tl:0,net_cash_usd:0,net_cash_tl:0};if(!e)return rt({daily:a,monthly:a,annual:a});const r=e,n=(e,t)=>t&&0!==Object.keys(t).length?{...e,net_cash_tl:void 0!==e.net_cash_tl&&null!==e.net_cash_tl?e.net_cash_tl:t.net_cash_tl??0,net_cash_usd:void 0!==e.net_cash_usd&&null!==e.net_cash_usd?e.net_cash_usd:t.net_cash_usd??0,total_deposits_tl:void 0!==e.total_deposits_tl&&null!==e.total_deposits_tl?e.total_deposits_tl:t.total_deposits_tl??0,total_deposits_usd:void 0!==e.total_deposits_usd&&null!==e.total_deposits_usd?e.total_deposits_usd:t.total_deposits_usd??0,total_withdrawals_tl:void 0!==e.total_withdrawals_tl&&null!==e.total_withdrawals_tl?e.total_withdrawals_tl:t.total_withdrawals_tl??0,total_withdrawals_usd:void 0!==e.total_withdrawals_usd&&null!==e.total_withdrawals_usd?e.total_withdrawals_usd:t.total_withdrawals_usd??0,total_bank_usd:void 0!==e.total_bank_usd&&null!==e.total_bank_usd?e.total_bank_usd:t.total_bank_usd??0,total_bank_tl:void 0!==e.total_bank_tl&&null!==e.total_bank_tl?e.total_bank_tl:t.total_bank_tl??0,total_cc_usd:void 0!==e.total_cc_usd&&null!==e.total_cc_usd?e.total_cc_usd:t.total_cc_usd??0,total_cc_tl:void 0!==e.total_cc_tl&&null!==e.total_cc_tl?e.total_cc_tl:t.total_cc_tl??0,total_tether_usd:void 0!==e.total_tether_usd&&null!==e.total_tether_usd?e.total_tether_usd:t.total_tether_usd??0,total_tether_tl:void 0!==e.total_tether_tl&&null!==e.total_tether_tl?e.total_tether_tl:t.total_tether_tl??0,conv_usd:void 0!==e.conv_usd&&null!==e.conv_usd?e.conv_usd:t.conv_usd??0,conv_tl:void 0!==e.conv_tl&&null!==e.conv_tl?e.conv_tl:t.conv_tl??0,bank_count:void 0!==e.bank_count&&null!==e.bank_count?e.bank_count:t.bank_count??0,cc_count:void 0!==e.cc_count&&null!==e.cc_count?e.cc_count:t.cc_count??0,tether_count:void 0!==e.tether_count&&null!==e.tether_count?e.tether_count:t.tether_count??0,total_transactions:void 0!==e.total_transactions&&null!==e.total_transactions?e.total_transactions:t.total_transactions??0}:e;let i,l;i=t&&Object.keys(t).length>0?t:r.daily&&Object.keys(r.daily).length>0?n(a,r.daily):a,l=s&&Object.keys(s).length>0?s:r.monthly&&Object.keys(r.monthly).length>0?n(a,r.monthly):a;const o=r.annual&&Object.keys(r.annual).length>0?n(a,r.annual):a;return rt({daily:i,monthly:l,annual:o})})(a,T,E);return r}catch(e){return Te.error("Error generating financial breakdown:",e),[]}},[G,z,T,E]),ge=e.useMemo(()=>{try{if(!z?.chart_data?.daily_revenue)return Te.warn("No chart data available in dashboardData"),[];const e=((e,t,s=!0)=>{if(!e||0===e.length)return[];let a=s?e:e.filter(e=>0!==(e.net_cash||e.amount));if("daily"===t)return a;if("monthly"===t){const e=new Map;return a.forEach(t=>{const s=new Date(t.date),a=`${s.getFullYear()}-${(s.getMonth()+1).toString().padStart(2,"0")}`;e.has(a)?e.get(a).amount+=t.amount:e.set(a,{date:a,amount:t.amount})}),Array.from(e.values()).sort((e,t)=>e.date.localeCompare(t.date))}if("annual"===t){const e=new Map;return a.forEach(t=>{const s=new Date(t.date).getFullYear().toString();e.has(s)?e.get(s).amount+=t.amount:e.set(s,{date:s,amount:t.amount})}),Array.from(e.values()).sort((e,t)=>e.date.localeCompare(t.date))}return a})(z.chart_data.daily_revenue,x,f);return 0===e.length&&Te.warn("Transformed chart data is empty"),e}catch(e){return Te.error("Error transforming chart data:",e),[]}},[z,x,f]),pe=e.useCallback(async()=>{try{i(null),await Promise.all([I(),H()])}catch(e){Te.error("Error refreshing dashboard:",e),i(e instanceof Error?e:new Error("Refresh failed"))}},[I,H]),fe=e.useCallback(async()=>{if(z){v(!0);try{await nt.generateComprehensiveReport(o),Te.info("Report generated successfully")}catch(e){Te.error("Error generating report:",e)}finally{v(!1)}}},[z,o]),ye=F||W,be=U||Y||(n?n.message:null)||null;return n?t.jsx("main",{className:"flex-1 bg-gradient-to-br from-slate-50 via-white to-slate-100 min-h-screen",children:t.jsx("div",{className:"px-6 py-8",children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx(ee,{className:"w-full max-w-md border-0 shadow-2xl bg-white/80 backdrop-blur-sm",children:t.jsxs(te,{className:"p-8 text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:t.jsx("span",{className:"text-2xl",children:"⚠️"})}),t.jsx("h2",{className:"text-2xl font-semibold text-slate-900 mb-3",children:"Component Error"}),t.jsx("p",{className:"text-slate-600 mb-4",children:n.message}),t.jsx(Q,{onClick:()=>{i(null),window.location.reload()},className:"bg-slate-900 hover:bg-slate-800 text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 hover:scale-105",children:"Reload Page"})]})})})})}):(e.useEffect(()=>{},[ye,F,W,z,G,T,E,be,n]),!ye||z||G?!be||z||G?t.jsx("main",{style:{flex:1,backgroundColor:"#f9fafb",minHeight:"100vh"},className:"flex-1 bg-gray-50 min-h-screen",children:t.jsx("div",{style:{padding:"1.5rem 2rem"},className:"px-6 lg:px-8 py-6 lg:py-8",children:t.jsxs("div",{className:"space-y-6",children:[t.jsx(et,{timeRange:o,viewType:h,refreshing:ye,isGeneratingReport:b,lastUpdated:B,onTimeRangeChange:m,onViewTypeChange:u,onRefresh:pe,onExport:fe}),de.length>0&&t.jsx(Ke,{stats:de,loading:ye&&!z,onStatClick:e=>{if(de[e]){const t=de[e];t.label.includes("Cash")?a("/analytics/revenue"):t.label.includes("Clients")?a("/clients"):t.label.includes("Transactions")&&a("/transactions")}}}),t.jsxs(ee,{className:"bg-white border border-gray-200 shadow-sm hover:shadow-md transition-shadow duration-200",children:[t.jsx(ie,{className:"pb-6",children:t.jsx(ce,{title:r("transactions.title"),description:r("dashboard.revenue_trend"),icon:$,size:"md",badge:t.jsx(le,{status:"online",label:"Live Data",pulse:!0,size:"sm"}),actions:t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1",children:["daily","monthly","annual"].map(e=>t.jsx("button",{onClick:()=>p(e),className:"px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200 "+(x===e?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900 hover:bg-white/50"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),t.jsx("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1",children:t.jsx("button",{onClick:()=>y(!f),className:"px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200 flex items-center gap-2 "+(f?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900 hover:bg-white/50"),title:f?"Hide days with zero values":"Show all days including zeros",children:t.jsx("span",{children:f?"With Zeros":"Without Zeros"})})})]})})}),t.jsx(te,{children:t.jsx("div",{className:"h-96 chart-container",children:ge.length>0?t.jsx(He,{data:ge,type:"bar",height:350}):t.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:t.jsx("p",{children:"Chart verisi yükleniyor..."})})})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsx(tt,{title:r("dashboard.daily_revenue"),icon:C,period:"Daily",data:me,breakdown:xe,loading:M||ye,selectedDate:_,isCurrentPeriod:re(),onPrevious:se,onNext:ae,onToday:()=>k(new Date),formatDate:oe,navigatePath:"/analytics/revenue?period=daily"}),t.jsx(tt,{title:r("dashboard.monthly_revenue"),icon:A,period:"Monthly",data:he,breakdown:xe,loading:P||ye,selectedDate:w,isCurrentPeriod:K(),onPrevious:V,onNext:J,onToday:()=>N(new Date),formatDate:ne,navigatePath:"/analytics/revenue?period=monthly"}),t.jsx(tt,{title:r("dashboard.performance"),icon:S,period:"Total",data:ue,breakdown:xe,loading:ye,selectedDate:new Date,isCurrentPeriod:!0,onPrevious:()=>{},onNext:()=>{},formatDate:()=>"All Time",navigatePath:"/analytics/revenue?period=annual"})]}),t.jsx(e.Suspense,{fallback:t.jsxs(ee,{className:"bg-white border border-gray-200 shadow-sm",children:[t.jsx(ie,{className:"pb-4",children:t.jsx("div",{className:"h-6 bg-gray-200 rounded w-32 animate-pulse"})}),t.jsx(te,{children:t.jsx("div",{className:"space-y-2",children:[...Array(3)].map((e,s)=>t.jsx("div",{className:"h-16 bg-gray-100 rounded-lg animate-pulse"},s))})})]}),children:t.jsx(it,{limit:5,onClickTransaction:e=>{a(`/transactions?highlight=${e}`)}})})]})})}):t.jsx("main",{className:"flex-1 bg-gradient-to-br from-slate-50 via-white to-slate-100 min-h-screen",children:t.jsx("div",{className:"px-6 py-8",children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx(ee,{className:"w-full max-w-md border-0 shadow-2xl bg-white/80 backdrop-blur-sm",children:t.jsxs(te,{className:"p-8 text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:t.jsx("span",{className:"text-2xl",children:"⚠️"})}),t.jsx("h2",{className:"text-2xl font-semibold text-slate-900 mb-3",children:"Error Loading Dashboard"}),t.jsx("p",{className:"text-slate-600 mb-6",children:be}),t.jsx(Q,{onClick:pe,disabled:ye,className:"bg-slate-900 hover:bg-slate-800 text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 hover:scale-105",children:"Try Again"})]})})})})}):t.jsx(We,{}))}),ot=Object.freeze(Object.defineProperty({__proto__:null,default:lt},Symbol.toStringTag,{value:"Module"})),ct=({data:a,columns:r,searchable:n=!0,sortable:i=!0,pagination:l=!0,pageSize:o=10,onEdit:c,onDelete:d,onView:m,title:h,description:u})=>{const[x,g]=e.useState(""),[p,y]=e.useState(null),[b,j]=e.useState(1),v=e.useMemo(()=>x?a.filter(e=>r.some(t=>{const s=e[t.key];return s&&s.toString().toLowerCase().includes(x.toLowerCase())})):a,[a,x,r]),w=e.useMemo(()=>p?[...v].sort((e,t)=>{const s=e[p.key],a=t[p.key];return s<a?"asc"===p.direction?-1:1:s>a?"asc"===p.direction?1:-1:0}):v,[v,p]),N=e.useMemo(()=>{if(!l)return w;const e=(b-1)*o;return w.slice(e,e+o)},[w,b,o,l]),_=Math.ceil(v.length/o);return t.jsxs(ee,{children:[(h||u)&&t.jsxs(ie,{children:[h&&t.jsx(de,{children:h}),u&&t.jsx("p",{className:"text-sm text-muted-foreground",children:u})]}),t.jsxs(te,{children:[n&&t.jsx("div",{className:"mb-4",children:t.jsxs("div",{className:"relative",children:[t.jsx(s,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),t.jsx(K,{placeholder:"Search...",value:x,onChange:e=>g(e.target.value),className:"pl-10"})]})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-border",children:[r.map(e=>{return t.jsx("th",{className:"text-left py-3 px-4 font-medium text-sm text-muted-foreground "+(e.sortable?"cursor-pointer hover:text-foreground":""),onClick:()=>{return e.sortable&&(t=e.key,void(i&&y(e=>({key:t,direction:e?.key===t&&"asc"===e.direction?"desc":"asc"}))));var t},children:t.jsxs("div",{className:"flex items-center gap-2",children:[e.label,e.sortable&&(s=e.key,p&&p.key===s?"asc"===p.direction?t.jsx(I,{className:"w-4 h-4"}):t.jsx(f,{className:"w-4 h-4"}):t.jsx(I,{className:"w-4 h-4 opacity-50"}))]})},e.key);var s}),(c||d||m)&&t.jsx("th",{className:"text-right py-3 px-4 font-medium text-sm text-muted-foreground",children:"Actions"})]})}),t.jsx("tbody",{children:N.map((e,s)=>t.jsxs("tr",{className:"border-b border-border hover:bg-muted/50",children:[r.map(s=>t.jsx("td",{className:"py-3 px-4 text-sm",children:s.render?s.render(e[s.key],e):e[s.key]},s.key)),(c||d||m)&&t.jsx("td",{className:"py-3 px-4 text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[m&&t.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>m(e),children:t.jsx(z,{className:"w-4 h-4"})}),c&&t.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>c(e),children:t.jsx(F,{className:"w-4 h-4"})}),d&&t.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>d(e),className:"text-destructive hover:text-destructive",children:t.jsx(U,{className:"w-4 h-4"})})]})})]},s))})]})}),l&&_>1&&t.jsxs("div",{className:"flex items-center justify-between mt-4",children:[t.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(b-1)*o+1," to ",Math.min(b*o,v.length)," of ",v.length," entries"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Q,{variant:"outline",size:"sm",onClick:()=>j(e=>Math.max(e-1,1)),disabled:1===b,children:"Previous"}),t.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:_},(e,t)=>t+1).map(e=>t.jsx(Q,{variant:b===e?"default":"outline",size:"sm",onClick:()=>j(e),className:"w-8 h-8 p-0",children:e},e))}),t.jsx(Q,{variant:"outline",size:"sm",onClick:()=>j(e=>Math.min(e+1,_)),disabled:b===_,children:"Next"})]})]})]})]})},dt=Object.freeze(Object.defineProperty({__proto__:null,DataTable:ct,default:ct},Symbol.toStringTag,{value:"Module"})),mt=Object.freeze(Object.defineProperty({__proto__:null,NotificationSystem:({notifications:s=[],onMarkAsRead:n,onMarkAllAsRead:i,onDelete:l,onClearAll:o})=>{const[c,d]=e.useState(!1),[m,p]=e.useState(s);e.useEffect(()=>{0===s.length&&p([{id:"1",type:"success",title:"Payment Processed",message:"Transaction TXN-001 has been successfully processed for $12,500",timestamp:new Date(Date.now()-12e4),read:!1,priority:"medium",action:{label:"View Transaction",onClick:()=>{}}},{id:"2",type:"warning",title:"High Transaction Volume",message:"Unusual activity detected. 15 transactions processed in the last hour.",timestamp:new Date(Date.now()-9e5),read:!1,priority:"high",action:{label:"Review Activity",onClick:()=>{}}},{id:"3",type:"info",title:"System Update",message:"New features have been added to the dashboard. Check out the analytics tab.",timestamp:new Date(Date.now()-18e5),read:!0,priority:"low"},{id:"4",type:"error",title:"API Error",message:"Failed to sync with external payment processor. Retrying...",timestamp:new Date(Date.now()-27e5),read:!0,priority:"high",action:{label:"Check Status",onClick:()=>{}}}])},[s]);const f=m.filter(e=>!e.read).length,y=e=>{switch(e){case"success":return t.jsx(g,{className:"w-4 h-4 text-green-500"});case"warning":return t.jsx(x,{className:"w-4 h-4 text-yellow-500"});case"error":return t.jsx(x,{className:"w-4 h-4 text-red-500"});case"info":return t.jsx(u,{className:"w-4 h-4 text-blue-500"});default:return t.jsx(u,{className:"w-4 h-4 text-gray-500"})}},b=e=>{switch(e){case"high":return"border-l-red-500";case"medium":return"border-l-yellow-500";case"low":return"border-l-blue-500";default:return"border-l-gray-500"}},j=e=>{const t=(new Date).getTime()-e.getTime(),s=Math.floor(t/6e4),a=Math.floor(t/36e5),r=Math.floor(t/864e5);return s<1?"Just now":s<60?`${s}m ago`:a<24?`${a}h ago`:`${r}d ago`};return t.jsxs("div",{className:"relative",children:[t.jsxs(Q,{variant:"ghost",size:"sm",onClick:()=>d(!c),className:"relative",children:[t.jsx(h,{className:"w-5 h-5"}),f>0&&t.jsx(se,{variant:"destructive",className:"absolute -top-1 -right-1 w-5 h-5 p-0 flex items-center justify-center text-xs",children:f})]}),c&&t.jsxs(ee,{className:"absolute right-0 mt-2 w-96 z-50 max-h-96 overflow-hidden",children:[t.jsx(ie,{className:"pb-3",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(de,{className:"text-lg",children:"Notifications"}),t.jsxs("div",{className:"flex items-center gap-2",children:[f>0&&t.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>{p(e=>e.map(e=>({...e,read:!0}))),i?.()},className:"text-xs",children:"Mark all read"}),t.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>d(!1),children:t.jsx(a,{className:"w-4 h-4"})})]})]})}),t.jsx(te,{className:"p-0 max-h-80 overflow-y-auto",children:0===m.length?t.jsxs("div",{className:"p-6 text-center text-muted-foreground",children:[t.jsx(h,{className:"w-8 h-8 mx-auto mb-2 text-muted-foreground/50"}),t.jsx("p",{children:"No notifications"})]}):t.jsx("div",{className:"divide-y divide-border",children:m.map(e=>t.jsx("div",{className:`p-4 hover:bg-muted/50 cursor-pointer border-l-4 ${b(e.priority)} ${e.read?"":"bg-muted/30"}`,onClick:()=>{return!e.read&&(t=e.id,p(e=>e.map(e=>e.id===t?{...e,read:!0}:e)),void n?.(t));var t},children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"flex-shrink-0 mt-0.5",children:y(e.type)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("h4",{className:"text-sm font-medium text-foreground",children:e.title}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[t.jsx(r,{className:"w-3 h-3"}),j(e.timestamp)]}),t.jsx(Q,{variant:"ghost",size:"sm",onClick:t=>{var s;t.stopPropagation(),s=e.id,p(e=>e.filter(e=>e.id!==s)),l?.(s)},className:"h-6 w-6 p-0 text-muted-foreground hover:text-destructive",children:t.jsx(U,{className:"w-3 h-3"})})]})]}),t.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:e.message}),e.action&&t.jsx(Q,{variant:"outline",size:"sm",onClick:t=>{t.stopPropagation(),e.action?.onClick()},className:"text-xs",children:e.action.label}),!e.read&&t.jsx("div",{className:"mt-2",children:t.jsx(se,{variant:"outline",className:"text-xs",children:"New"})})]})]})},e.id))})}),m.length>0&&t.jsx("div",{className:"p-3 border-t border-border bg-muted/30",children:t.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>{p([]),o?.()},className:"w-full text-destructive hover:text-destructive",children:"Clear all notifications"})})]})]})}},Symbol.toStringTag,{value:"Module"})),ht=Object.freeze(Object.defineProperty({__proto__:null,CircularProgress:({value:e,max:s=100,size:a=120,strokeWidth:r=8,showValue:n=!0,label:i,className:l=""})=>{const o=(a-r)/2,c=2*o*Math.PI,d=e/s*c,m=Math.round(e/s*100);return t.jsxs("div",{className:`flex flex-col items-center ${l}`,children:[t.jsxs("div",{className:"relative",style:{width:a,height:a},children:[t.jsxs("svg",{width:a,height:a,className:"transform -rotate-90",children:[t.jsx("circle",{cx:a/2,cy:a/2,r:o,stroke:"hsl(var(--muted))",strokeWidth:r,fill:"none"}),t.jsx("circle",{cx:a/2,cy:a/2,r:o,stroke:"hsl(var(--primary))",strokeWidth:r,fill:"none",strokeDasharray:c,strokeDashoffset:c-d,strokeLinecap:"round",className:"transition-all duration-300 ease-in-out"})]}),n&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsxs("span",{className:"text-2xl font-bold text-foreground",children:[m,"%"]})})]}),i&&t.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:i})]})},ProgressIndicator:({steps:e,orientation:s="horizontal",showTimestamps:a=!1,className:i=""})=>{const l=e=>{switch(e){case"completed":return t.jsx(g,{className:"w-5 h-5 text-green-500"});case"current":return t.jsx(r,{className:"w-5 h-5 text-gray-500"});case"error":return t.jsx(B,{className:"w-5 h-5 text-red-500"});default:return t.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-muted-foreground"})}},o=e=>{switch(e){case"completed":return"text-green-600 bg-green-50 border-green-200";case"current":return"text-gray-600 bg-gray-50 border-gray-200";case"error":return"text-red-600 bg-red-50 border-red-200";default:return"text-muted-foreground bg-muted border-border"}},c=(e,t)=>"completed"===e?"bg-green-500":"current"===e?"bg-gray-500":"error"===e?"bg-red-500":"bg-muted-foreground";return"vertical"===s?t.jsx("div",{className:`space-y-4 ${i}`,children:e.map((s,r)=>t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("div",{className:`p-2 rounded-full border ${o(s.status)}`,children:l(s.status)}),r<e.length-1&&t.jsx("div",{className:`w-0.5 h-8 mt-2 ${c(s.status)}`})]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h4",{className:"font-medium "+("upcoming"===s.status?"text-muted-foreground":"text-foreground"),children:s.title}),"current"===s.status&&t.jsx(se,{variant:"outline",className:"text-gray-600 border-gray-200",children:"In Progress"}),"error"===s.status&&t.jsx(se,{variant:"destructive",children:"Error"})]}),s.description&&t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.description}),a&&s.timestamp&&t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s.timestamp.toLocaleString()})]})]},s.id))}):t.jsx(ee,{className:i,children:t.jsx(te,{className:"p-6",children:t.jsx("div",{className:"flex items-center justify-between",children:e.map((s,r)=>t.jsxs(_.Fragment,{children:[t.jsxs("div",{className:"flex flex-col items-center text-center",children:[t.jsx("div",{className:`p-3 rounded-full border ${o(s.status)} mb-2`,children:l(s.status)}),t.jsx("h4",{className:"text-sm font-medium "+("upcoming"===s.status?"text-muted-foreground":"text-foreground"),children:s.title}),s.description&&t.jsx("p",{className:"text-xs text-muted-foreground mt-1 max-w-24",children:s.description}),a&&s.timestamp&&t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s.timestamp.toLocaleDateString()})]}),r<e.length-1&&t.jsxs("div",{className:"flex-1 flex items-center justify-center mx-4",children:[t.jsx("div",{className:`h-0.5 w-full ${c(s.status)}`}),t.jsx(n,{className:"w-4 h-4 text-muted-foreground mx-2"})]})]},s.id))})})})}},Symbol.toStringTag,{value:"Module"})),ut=[{id:"gpt-3.5-turbo",name:"AI Standard",description:"Fast and efficient for most tasks",cost:"Budget",maxTokens:4096,pricePer1kTokens:.0015},{id:"gpt-4o-mini",name:"AI Balanced",description:"Balanced performance and cost",cost:"Economy",maxTokens:128e3,pricePer1kTokens:15e-5},{id:"gpt-4",name:"AI Professional",description:"High-quality reasoning and analysis",cost:"Premium",maxTokens:8192,pricePer1kTokens:.03},{id:"gpt-4o",name:"AI Advanced",description:"Latest model with enhanced capabilities",cost:"Premium+",maxTokens:128e3,pricePer1kTokens:.005},{id:"gpt-4-turbo",name:"AI Enterprise",description:"Enhanced model with larger context",cost:"Enterprise",maxTokens:128e3,pricePer1kTokens:.01}],xt={API_KEY:null,API_URL:"/api/v1/ai-assistant/chat",ENABLED:!0};function gt(){return t.jsxs("div",{className:"relative w-96 h-96 flex items-center justify-center",style:{perspective:1e3,transformStyle:"preserve-3d"},children:[[0,1,2,3,4,5,6,7].map(e=>{const s=70+22*e,a=4+.6*e,r=60+15*e%60,n=45*e;return t.jsxs("div",{children:[t.jsx(G.div,{className:"absolute",style:{width:2*s,height:2*s,left:"50%",top:"50%",marginLeft:-s,marginTop:-s,transformStyle:"preserve-3d"},animate:{rotateX:[r,r],rotateY:[n,n],rotateZ:[0,360]},transition:{rotateZ:{duration:a,repeat:1/0,ease:"linear"}},children:t.jsx("div",{className:"w-full h-full rounded-full border-2 border-purple-500/25",style:{boxShadow:"0 0 15px rgba(168, 85, 247, 0.15)"}})}),[...Array(1)].map((i,l)=>{const o=360*l+30*e,c=1.8+.2*e;return t.jsx(G.div,{className:"absolute",style:{width:2*s,height:2*s,left:"50%",top:"50%",marginLeft:-s,marginTop:-s,transformStyle:"preserve-3d"},animate:{rotateX:[r,r],rotateY:[n,n],rotateZ:[o,o+360]},transition:{rotateZ:{duration:a,repeat:1/0,ease:"linear"}},children:t.jsx(G.div,{className:"absolute w-2.5 h-2.5 rounded-full bg-gradient-to-br from-purple-400 to-pink-500",style:{top:"50%",left:"100%",marginTop:-5,marginLeft:-5,boxShadow:"0 0 10px rgba(236, 72, 153, 0.9), 0 0 5px rgba(168, 85, 247, 0.7)"},animate:{scale:[1,1.3,1],boxShadow:["0 0 10px rgba(236, 72, 153, 0.9), 0 0 5px rgba(168, 85, 247, 0.7)","0 0 15px rgba(236, 72, 153, 1), 0 0 8px rgba(168, 85, 247, 0.9)","0 0 10px rgba(236, 72, 153, 0.9), 0 0 5px rgba(168, 85, 247, 0.7)"]},transition:{duration:c,repeat:1/0,ease:"easeInOut"}})},`electron-${e}-${l}`)})]},`orbit-${e}`)}),t.jsx(G.div,{className:"relative z-10",style:{perspective:1200,transformStyle:"preserve-3d"},animate:{rotateY:[0,360],rotateX:[0,15,0,-15,0]},transition:{rotateY:{duration:4,repeat:1/0,ease:"linear"},rotateX:{duration:6,repeat:1/0,ease:"easeInOut"}},children:t.jsxs("svg",{width:"140",height:"140",viewBox:"0 0 140 140",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{filter:"drop-shadow(0 0 60px rgba(168, 85, 247, 0.9)) drop-shadow(0 0 30px rgba(236, 72, 153, 0.6))"},children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"spark1",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"#c084fc"}),t.jsx("stop",{offset:"50%",stopColor:"#f472b6"}),t.jsx("stop",{offset:"100%",stopColor:"#818cf8"})]}),t.jsxs("linearGradient",{id:"spark2",x1:"100%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"#a855f7"}),t.jsx("stop",{offset:"50%",stopColor:"#ec4899"}),t.jsx("stop",{offset:"100%",stopColor:"#6366f1"})]}),t.jsxs("linearGradient",{id:"sparkHighlight",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"#ffffff",stopOpacity:"0.9"}),t.jsx("stop",{offset:"100%",stopColor:"#ffffff",stopOpacity:"0"})]}),t.jsxs("radialGradient",{id:"glow1",children:[t.jsx("stop",{offset:"0%",stopColor:"#ffffff",stopOpacity:"1"}),t.jsx("stop",{offset:"30%",stopColor:"#fbbf24",stopOpacity:"0.8"}),t.jsx("stop",{offset:"60%",stopColor:"#f472b6",stopOpacity:"0.4"}),t.jsx("stop",{offset:"100%",stopColor:"#a855f7",stopOpacity:"0"})]}),t.jsxs("radialGradient",{id:"centerGlow",children:[t.jsx("stop",{offset:"0%",stopColor:"#ffffff",stopOpacity:"1"}),t.jsx("stop",{offset:"100%",stopColor:"#fbbf24",stopOpacity:"0.8"})]}),t.jsxs("filter",{id:"innerGlow",children:[t.jsx("feGaussianBlur",{stdDeviation:"2",result:"blur"}),t.jsx("feComposite",{in:"blur",in2:"SourceGraphic",operator:"atop"})]})]}),t.jsxs("g",{transform:"translate(70, 70)",children:[t.jsx("path",{d:"M 0,-50 L 6,-12 L 6,12 L 0,50 L -6,12 L -6,-12 Z",fill:"url(#spark1)"}),t.jsx("path",{d:"M 0,-50 L 3,-12 L 3,12 L 0,50 L -3,12 L -3,-12 Z",fill:"url(#sparkHighlight)",opacity:"0.6"}),t.jsx("path",{d:"M -50,0 L -12,-6 L 12,-6 L 50,0 L 12,6 L -12,6 Z",fill:"url(#spark2)"}),t.jsx("path",{d:"M -50,0 L -12,-3 L 12,-3 L 50,0 L 12,3 L -12,3 Z",fill:"url(#sparkHighlight)",opacity:"0.6"}),t.jsx("path",{d:"M -35,-35 L -10,-8 L -8,-10 L -35,-35 M 35,35 L 10,8 L 8,10 L 35,35 Z",fill:"url(#spark1)",opacity:"0.9"}),t.jsx("path",{d:"M 35,-35 L 8,-10 L 10,-8 L 35,-35 M -35,35 L -8,10 L -10,8 L -35,35 Z",fill:"url(#spark2)",opacity:"0.9"}),t.jsx("path",{d:"M 0,-30 L 2,-10 L 2,10 L 0,30 L -2,10 L -2,-10 Z",fill:"url(#sparkHighlight)",opacity:"0.4",transform:"rotate(22.5)"}),t.jsx("path",{d:"M -30,0 L -10,-2 L 10,-2 L 30,0 L 10,2 L -10,2 Z",fill:"url(#sparkHighlight)",opacity:"0.4",transform:"rotate(22.5)"})]})]})}),[...Array(8)].map((e,s)=>{const a=45*s*(Math.PI/180),r=100+s%2*30,n=Math.cos(a)*r,i=Math.sin(a)*r,l=.5*s;return t.jsx(G.div,{className:"absolute w-1 h-1 rounded-full",style:{left:"50%",top:"50%",background:"linear-gradient(135deg, #a855f7, #ec4899)",boxShadow:"0 0 8px rgba(168, 85, 247, 0.8)"},animate:{x:[0,n,0],y:[0,i,0],z:[0,50*Math.random()-25,0],scale:[0,1.5,0],opacity:[0,1,0]},transition:{duration:4,repeat:1/0,delay:l,ease:"easeOut"}},`particle-${s}`)})]})}const pt=({apiKey:s,className:a=""})=>{X();const[r,n]=e.useState([]),[i,l]=e.useState(""),[o,c]=e.useState(!1),[d,m]=e.useState(null),[h,u]=e.useState("gpt-4o-mini"),[x,g]=e.useState(!1),[f,b]=e.useState({}),j=e.useRef(null),v=xt.ENABLED;e.useEffect(()=>{(async()=>{try{const e=await fetch("/api/v1/ai-assistant/sections");if(e.ok){const t=await e.json();b(t.sections||{})}}catch(e){}})()},[v]),e.useEffect(()=>{},[v,d,r.length]),e.useEffect(()=>{j.current?.scrollIntoView({behavior:"smooth"})},[r]);const w=async()=>{if(!i.trim()||o)return;const e={id:Date.now().toString(),role:"user",content:i.trim(),timestamp:new Date};n(t=>[...t,e]),l(""),c(!0),m(null);try{const t=await fetch(xt.API_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:h,use_enhanced:x,messages:[{role:"system",content:"You are an intelligent AI assistant integrated into PipLinePro, a comprehensive financial management system. \n\nYour role is to:\n- Provide clear, concise, and accurate responses\n- Help users understand their financial data and business insights\n- Assist with data analysis and interpretation\n- Answer general business and technical questions\n- Maintain a professional and helpful tone\n\nFocus areas:\n- Financial data analysis and insights\n- Business intelligence and reporting\n- Transaction processing and PSP management\n- Client relationship management\n- System usage and troubleshooting\n\nAlways be helpful, accurate, and maintain user privacy and data security."},...r.map(e=>({role:e.role,content:e.content})),{role:"user",content:e.content}]})});if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.message||`API Error: ${t.status} ${t.statusText}`)}const s=await t.json(),a={id:(Date.now()+1).toString(),role:"assistant",content:s.response||"Sorry, I could not generate a response.",timestamp:new Date,model:s.model||h,enhanced:s.enhanced||!1};n(e=>[...e,a])}catch(t){m(t instanceof Error?t.message:"Failed to send message")}finally{c(!1)}};return t.jsxs(ee,{className:`h-full flex flex-col ${a}`,children:[t.jsx(ie,{className:"pb-3",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 bg-gray-800 rounded-lg flex items-center justify-center",children:t.jsx(W,{className:"w-4 h-4 text-white"})}),t.jsxs("div",{children:[t.jsx(de,{className:"text-lg font-semibold text-slate-900",children:"AI Assistant"}),t.jsx("p",{className:"text-sm text-slate-600",children:"Intelligent Analysis & Insights"})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs("label",{className:"flex items-center gap-1 text-xs text-slate-600",children:[t.jsx("input",{type:"checkbox",checked:x,onChange:e=>g(e.target.checked),className:"rounded border-slate-300 text-purple-600 focus:ring-purple-500",disabled:o}),t.jsx(W,{className:"w-3 h-3"}),"Enhanced"]})}),t.jsx("div",{className:"relative",children:t.jsx("select",{value:h,onChange:e=>(e=>{if(e!==h&&r.length>0){const t={id:Date.now().toString(),role:"assistant",content:`Switched to ${ut.find(t=>t.id===e)?.name||e} model.`,timestamp:new Date,model:e};n(e=>[...e,t])}u(e)})(e.target.value),className:"text-xs border border-slate-300 rounded px-2 py-1 bg-white text-slate-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent cursor-pointer",disabled:o,title:"Select AI model - cheaper models are faster, expensive models are more capable",children:ut.map(e=>t.jsxs("option",{value:e.id,title:`${e.description} - Cost: ${e.cost}`,children:[e.name," (",e.cost,")"]},e.id))})}),t.jsx(Q,{variant:"outline",size:"sm",onClick:()=>{n([]),m(null)},className:"text-slate-600 hover:text-red-600",children:t.jsx(U,{className:"w-4 h-4"})}),t.jsx(Q,{variant:"outline",size:"sm",className:"text-slate-600",children:t.jsx(y,{className:"w-4 h-4"})})]})]})}),t.jsxs(te,{className:"flex-1 flex flex-col p-0",children:[t.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 min-h-[400px] max-h-[500px]",children:[0===r.length?t.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[t.jsx("div",{className:"relative scale-50 origin-center",children:t.jsx(gt,{})}),x&&Object.keys(f).length>0&&t.jsx("div",{className:"mt-6 max-w-md",children:t.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(W,{className:"w-4 h-4 text-purple-600"}),t.jsx("h4",{className:"text-sm font-medium text-purple-900",children:"Enhanced Mode Active"})]}),t.jsx("p",{className:"text-xs text-purple-700 mb-3",children:"I have read-only access to your PipLinePro data including:"}),t.jsx("div",{className:"grid grid-cols-2 gap-1 text-xs text-purple-600",children:Object.entries(f).slice(0,8).map(([e,s])=>t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-1 h-1 bg-purple-400 rounded-full"}),s.name]},e))}),t.jsx("p",{className:"text-xs text-purple-600 mt-2",children:"Ask me about transactions, analytics, reports, or any business data!"}),t.jsx("div",{className:"mt-3 pt-3 border-t border-purple-200",children:t.jsxs("p",{className:"text-xs text-purple-500 flex items-center gap-1",children:[t.jsx(Y,{className:"w-3 h-3"}),"Read-only access: I can view and analyze data but cannot modify anything."]})})]})})]}):r.map(e=>t.jsxs("div",{className:"flex gap-3 "+("user"===e.role?"justify-end":"justify-start"),children:["assistant"===e.role&&t.jsx("div",{className:"w-8 h-8 bg-gray-800 rounded-full flex items-center justify-center flex-shrink-0",children:t.jsx(H,{className:"w-4 h-4 text-white"})}),t.jsxs("div",{className:"max-w-[80%] rounded-lg px-4 py-3 "+("user"===e.role?"bg-blue-600 text-white":"bg-slate-100 text-slate-900"),children:[t.jsx("p",{className:"text-sm whitespace-pre-wrap",children:e.content}),t.jsxs("div",{className:"text-xs mt-2 "+("user"===e.role?"text-blue-100":"text-slate-500"),children:[t.jsx("p",{children:e.timestamp.toLocaleTimeString()}),"assistant"===e.role&&t.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.model&&t.jsx("p",{className:"text-slate-400",children:ut.find(t=>t.id===e.model)?.name||e.model}),e.enhanced&&t.jsxs("div",{className:"flex items-center gap-1 text-purple-600",children:[t.jsx(W,{className:"w-3 h-3"}),t.jsx("span",{children:"Enhanced"})]})]})]})]}),"user"===e.role&&t.jsx("div",{className:"w-8 h-8 bg-gray-800 rounded-full flex items-center justify-center flex-shrink-0",children:t.jsx(p,{className:"w-4 h-4 text-white"})})]},e.id)),o&&t.jsxs("div",{className:"flex gap-3 justify-start",children:[t.jsx("div",{className:"w-8 h-8 bg-gray-800 rounded-full flex items-center justify-center flex-shrink-0",children:t.jsx(H,{className:"w-4 h-4 text-white"})}),t.jsx("div",{className:"bg-slate-100 rounded-lg px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(q,{className:"w-4 h-4 animate-spin text-purple-600"}),t.jsx("span",{className:"text-sm text-slate-600",children:"AI is thinking..."})]})})]}),d&&v&&t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:t.jsxs("p",{className:"text-sm text-red-600",children:[t.jsx("strong",{children:"Error:"})," ",d]})}),t.jsx("div",{ref:j})]}),t.jsxs("div",{className:"border-t border-slate-200 p-4",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx("textarea",{value:i,onChange:e=>l(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),w())},placeholder:"Ask me anything about your business or data...",className:"flex-1 resize-none border rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:border-transparent border-slate-300 focus:ring-purple-500",rows:2,disabled:o||!v}),t.jsx(Q,{onClick:w,disabled:!i.trim()||o||!v,className:"px-4 py-2 rounded-lg transition-all duration-200 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white",children:o?t.jsx(q,{className:"w-4 h-4 animate-spin"}):t.jsx(Z,{className:"w-4 h-4"})})]}),t.jsx("p",{className:"text-xs mt-2 text-slate-500",children:"Press Enter to send, Shift+Enter for new line"})]})]})]})},ft=({limit:s=5,onClickTransaction:a})=>{const{t:r}=X(),i=d(),[l,o]=e.useState([]),[c,m]=e.useState(!0),[h,u]=e.useState(null),[x,g]=e.useState(!1),p=e.useCallback(async(e=!1)=>{try{e?g(!0):m(!0),u(null),e&&Ee.clearCacheForUrl("transactions");try{const e=await Ee.get(`/transactions/?per_page=${s}&sort_by=created_at&sort_order=desc`);if(e.ok){const t=await Ee.parseResponse(e);let a=[];if(t&&"object"==typeof t){const e=t;Array.isArray(e.transactions)?a=e.transactions:Array.isArray(e.data)?a=e.data:Array.isArray(e)&&(a=e)}else Array.isArray(t)&&(a=t);o(a.slice(0,s))}else o([]),u(null)}catch(t){o([]),u(null)}}catch(a){o([]),u(null)}finally{m(!1),g(!1)}},[s]);e.useEffect(()=>{p()},[p]),e.useEffect(()=>{const e=e=>{"created"!==e.detail?.action&&"updated"!==e.detail?.action||p(!0)};return window.addEventListener("transactionsUpdated",e),()=>{window.removeEventListener("transactionsUpdated",e)}},[p]);const f=e.useCallback((e,t="TRY")=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"USD"===t?"USD":"TRY",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),[]),y=e.useCallback(e=>{const t=new Date(e),s=new Date,a=Math.floor((s.getTime()-t.getTime())/1e3);return a<60?`${a}s ago`:a<3600?`${Math.floor(a/60)}m ago`:a<86400?`${Math.floor(a/3600)}h ago`:`${Math.floor(a/86400)}d ago`},[]),b=e.useCallback(e=>{a?a(e):i(`/transactions?highlight=${e}`)},[a,i]),v=e.useCallback(()=>{i("/clients?tab=transactions")},[i]),w=e.useCallback(()=>{p(!0)},[p]),N=e.useMemo(()=>l.map(e=>({...e,formattedAmount:f(Math.abs(e.amount),e.currency),formattedTime:y(e.created_at||e.date),isDeposit:"DEP"===e.category||"DEPOSIT"===e.category})),[l,f,y]);return c?t.jsxs(ee,{className:"border border-gray-200 shadow-sm hover:shadow-md transition-shadow duration-200",children:[t.jsx(ie,{className:"pb-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs(de,{className:"text-base font-semibold text-gray-900 flex items-center gap-2",children:[t.jsx(j,{className:"w-4 h-4 text-gray-600"}),r("dashboard.recent_activity")||"Recent Activity"]}),t.jsx(le,{status:"syncing",size:"sm",showLabel:!1})]})}),t.jsx(te,{children:t.jsx("div",{className:"space-y-3",children:[...Array(s)].map((e,s)=>t.jsx("div",{className:"animate-pulse",children:t.jsx("div",{className:"h-16 bg-gray-100 rounded-lg"})},s))})})]}):h?t.jsxs(ee,{className:"border border-gray-200 shadow-sm",children:[t.jsx(ie,{className:"pb-4",children:t.jsxs(de,{className:"text-base font-semibold text-gray-900 flex items-center gap-2",children:[t.jsx(j,{className:"w-4 h-4 text-gray-600"}),r("dashboard.recent_activity")||"Recent Activity"]})}),t.jsx(te,{children:t.jsx("p",{className:"text-sm text-gray-500",children:h})})]}):t.jsxs(ee,{className:"border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200 group",children:[t.jsx(ie,{className:"pb-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs(de,{className:"text-base font-semibold text-gray-900 flex items-center gap-2",children:[t.jsx(j,{className:"w-4 h-4 text-gray-600 group-hover:text-gray-900 transition-colors"}),r("dashboard.recent_activity")||"Recent Activity"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:w,disabled:x,className:"p-1.5 rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50",title:"Refresh",children:t.jsx(L,{className:"w-4 h-4 text-gray-600 "+(x?"animate-spin":"")})}),t.jsx(le,{status:x?"syncing":"online",size:"sm",showLabel:!1,pulse:!x})]})]})}),t.jsx(te,{children:0===l.length?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(j,{className:"w-8 h-8 text-gray-300 mx-auto mb-2"}),t.jsx("p",{className:"text-sm text-gray-500",children:"No recent activity"})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"space-y-2",children:N.map(e=>{const s=e.isDeposit?S:T;return t.jsxs("div",{onClick:()=>b(e.id),className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-100 hover:bg-gray-100 hover:border-gray-200 cursor-pointer transition-all duration-200 group/item",children:[t.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[t.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center flex-shrink-0 transition-colors "+(e.isDeposit?"bg-green-100 group-hover/item:bg-green-200":"bg-red-100 group-hover/item:bg-red-200"),children:t.jsx(s,{className:"w-4 h-4 "+(e.isDeposit?"text-green-700":"text-red-700")})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900 truncate group-hover/item:text-gray-950",children:e.client_name||"Unknown Client"}),t.jsx("div",{className:"flex items-center gap-2 mt-0.5",children:t.jsxs("p",{className:"text-xs text-gray-500 truncate",children:[e.psp&&`${e.psp} • `,e.formattedTime]})})]})]}),t.jsxs("div",{className:"flex items-center gap-3 ml-3",children:[t.jsx("div",{className:"text-right",children:t.jsxs("p",{className:"text-sm font-semibold "+(e.isDeposit?"text-green-700":"text-red-700"),children:[e.isDeposit?"+":"-",e.formattedAmount]})}),t.jsx(n,{className:"w-4 h-4 text-gray-400 group-hover/item:text-gray-600 transition-colors opacity-0 group-hover/item:opacity-100"})]})]},e.id)})}),t.jsxs("button",{onClick:v,className:"mt-4 w-full text-sm font-medium text-gray-600 hover:text-gray-900 py-2 rounded-lg hover:bg-gray-50 transition-colors duration-200 flex items-center justify-center gap-1",children:["View all transactions",t.jsx(n,{className:"w-3 h-3"})]})]})})]})},yt=Object.freeze(Object.defineProperty({__proto__:null,RecentActivityFeed:ft,default:ft},Symbol.toStringTag,{value:"Module"}));export{pt as C,dt as D,Ae as G,lt as M,mt as N,ht as P,qe as R,Je as S,Se as _,Ee as a,xt as b,Fe as c,Pe as d,Ue as e,ot as f,Te as l,Me as u};
