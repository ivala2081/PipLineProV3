const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/pages-systemmonitor-Bslpk-F-.js","js/vendor-react-BhTnfaj4.js","js/contexts-BJ30luUC.js","js/components-modern-tUvpuNx5.js","js/components-ui-DqTPGewb.js","js/vendor-utils-CtF19A-_.js","js/components-trust-Cyz_q_DS.js","js/vendor-charts-recharts-B9ou1qfH.js","js/vendor-i18n-DHLiip7K.js","js/DatabaseManagement-BUxk6TQV.js","js/SecurityManagement-DQ4bj87W.js"])))=>i.map(i=>d[i]);
import{j as e,R as s,T as t,aL as a,r,p as n,Y as l,o as i,F as c,k as o,U as d,aM as m,aN as x,aO as h,aP as u,aQ as g,b as p,B as j,D as y,f as b,u as f,aG as N,ad as v,ac as w,aR as _,C as k,N as S,aS as C,c as D,aT as T,E as F,I as E,e as A,aU as R,aV as $,X as P,aW as L,q as U,i as M,a1 as I,m as O,d as z,n as B,x as K,y as Y,aX as W,Z as H,v as V,l as q,aY as J,aZ as G,a_ as X,a$ as Q,t as Z,w as ee,S as se,b0 as te,b1 as ae,b2 as re,b3 as ne,W as le,h as ie,s as ce,b4 as oe,a4 as de,a as me,b5 as xe,ab as he,b6 as ue,$ as ge,b7 as pe,b8 as je,b9 as ye,aJ as be,ba as fe,G as Ne,bb as ve,bc as we,P as _e,bd as ke,be as Se,a7 as Ce}from"./vendor-react-BhTnfaj4.js";import{M as De,l as Te,a as Fe,_ as Ee,u as Ae,C as Re,b as $e}from"./components-modern-tUvpuNx5.js";import{a as Pe,u as Le}from"./contexts-BJ30luUC.js";import{u as Ue,a as Me,Q as Ie,q as Oe,r as ze,s as Be,t as Ke,d as Ye,f as We,g as He,v as Ve,l as qe,m as Je,n as Ge,o as Xe,p as Qe,A as Ze,w as es,L as ss,I as ts,x as as,F as rs,B as ns,C as ls,b as is}from"./components-ui-DqTPGewb.js";import{U as cs,a as os,b as ds,T as ms,d as xs,e as hs}from"./components-trust-Cyz_q_DS.js";import{R as us,L as gs,b as ps,X as js,Y as ys,T as bs,c as fs,P as Ns,a as vs,C as ws,f as _s,B as ks,d as Ss,A as Cs,e as Ds,S as Ts,g as Fs}from"./vendor-charts-recharts-B9ou1qfH.js";const Es=({size:s="md",variant:t="default",message:a="Loading...",className:r="",fullScreen:n=!1,showDots:l=!1,showBar:i=!1,indeterminate:c=!1})=>{const o=n?"business-loading-overlay":"flex items-center justify-center";return e.jsx("div",{className:`${o} ${r}`,role:"status","aria-live":"polite","aria-label":a,children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[l?e.jsxs("div",{className:"business-loading-dots business-loading-dots-primary",children:[e.jsx("div",{className:"business-loading-dots-dot"}),e.jsx("div",{className:"business-loading-dots-dot"}),e.jsx("div",{className:"business-loading-dots-dot"})]}):i?e.jsx("div",{className:"business-loading-bar",children:e.jsx("div",{className:"business-loading-bar-progress"})}):e.jsx("div",{className:l?`business-loading-dots business-loading-dots-${t}`:i?`business-loading-bar business-loading-bar-${c?"indeterminate":t}`:`${{sm:"business-loading-spinner-sm",md:"business-loading-spinner-md",lg:"business-loading-spinner-lg",xl:"business-loading-spinner-xl"}[s]} ${{default:"business-loading-spinner",primary:"business-loading-spinner-primary",success:"business-loading-spinner-success",warning:"business-loading-spinner-warning",error:"business-loading-spinner-error",neutral:"business-loading-spinner-neutral"}[t]}`,"aria-hidden":"true"}),a&&e.jsx("p",{className:"text-sm text-gray-600 font-medium","aria-live":"polite",children:a})]})})};class As extends s.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,s){Te.error("ModernDashboard Error:",e,s)}render(){return this.state.hasError&&this.state.error?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-2xl w-full bg-white shadow-lg rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(t,{className:"w-6 h-6 text-red-500"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Dashboard Error"})]}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Failed to load Modern Dashboard:"}),e.jsxs("pre",{className:"bg-gray-100 p-4 rounded text-sm overflow-auto max-h-96 whitespace-pre-wrap",children:[this.state.error.message,"\n\n",this.state.error.stack]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700",children:"Reload Page"})]})}):this.props.children}}const Rs=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{Pe();const{user:s}=Le();return e.jsx(As,{children:e.jsx(De,{user:s||void 0})})}},Symbol.toStringTag,{value:"Module"}));function $s(e){const[s,t]=a(),[n,l]=r.useState(s.get("tab")||e);return[n,r.useCallback(e=>{const a=e;l(a);const r=new URLSearchParams(s);r.set("tab",a),t(r,{replace:!0})},[s,t])]}const Ps=({className:s="",width:t,height:a,rounded:r="md",animate:n="shimmer",delay:l=0})=>e.jsx("div",{className:`bg-gray-200 ${{none:"",sm:"rounded-sm",md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl","2xl":"rounded-2xl",full:"rounded-full"}[r]} ${{pulse:"animate-pulse",wave:"animate-pulse",shimmer:"skeleton-shimmer"}[n]} ${s}`,style:{width:t,height:a,animationDelay:`${l}ms`}}),Ls=({variant:s="default",delay:t=0})=>{const a=t;return"compact"===s?e.jsx("div",{className:"bg-white rounded-md border border-gray-200 p-2.5 animate-pulse",style:{animationDelay:`${a}ms`},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ps,{className:"w-6 h-6",rounded:"md",delay:a+100}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(Ps,{className:"h-3 w-20 mb-1",delay:a+200}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Ps,{className:"h-4 w-16",delay:a+300}),e.jsx(Ps,{className:"h-3 w-8",delay:a+400})]})]})]})}):"minimal"===s?e.jsx("div",{className:"bg-white rounded-md border border-gray-200 p-3 animate-pulse",style:{animationDelay:`${a}ms`},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ps,{className:"w-6 h-6",rounded:"md",delay:a+100}),e.jsxs("div",{children:[e.jsx(Ps,{className:"h-3 w-20 mb-1",delay:a+200}),e.jsx(Ps,{className:"h-4 w-24",delay:a+300})]})]}),e.jsx(Ps,{className:"h-3 w-12",delay:a+400})]})}):"gradient"===s?e.jsxs("div",{className:"bg-gradient-to-br from-gray-100 to-gray-200 rounded-lg shadow-sm p-4 animate-pulse",style:{animationDelay:`${a}ms`},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(Ps,{className:"w-8 h-8 bg-white/20",rounded:"lg",delay:a+100}),e.jsx(Ps,{className:"h-4 w-16 bg-white/20",rounded:"full",delay:a+200})]}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(Ps,{className:"h-3 w-24 bg-white/20",delay:a+300}),e.jsx(Ps,{className:"h-5 w-32 bg-white/20",delay:a+400}),e.jsx(Ps,{className:"h-3 w-20 bg-white/20",delay:a+500})]})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 animate-pulse",style:{animationDelay:`${a}ms`},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(Ps,{className:"w-8 h-8",rounded:"lg",delay:a+100}),e.jsx(Ps,{className:"h-4 w-16",rounded:"full",delay:a+200})]}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(Ps,{className:"h-3 w-24",delay:a+300}),e.jsx(Ps,{className:"h-5 w-32",delay:a+400}),e.jsx(Ps,{className:"h-3 w-20",delay:a+500})]})]})},Us=({rows:s=5,columns:t=5,showHeader:a=!0,delay:r=0})=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden animate-pulse",style:{animationDelay:`${r}ms`},children:[a&&e.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:e.jsx("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${t}, 1fr)`},children:[...Array(t)].map((s,t)=>e.jsx(Ps,{className:"h-4 w-20",delay:r+50*t},t))})}),e.jsx("div",{className:"divide-y divide-gray-200",children:[...Array(s)].map((s,a)=>e.jsx("div",{className:"px-6 py-4",children:e.jsx("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${t}, 1fr)`},children:[...Array(t)].map((s,t)=>e.jsx("div",{className:"flex items-center",children:0===t?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ps,{className:"w-8 h-8",rounded:"full",delay:r+100*a+50*t}),e.jsx(Ps,{className:"h-4 w-24",delay:r+100*a+50*t+25})]}):e.jsx(Ps,{className:"h-4 w-16",delay:r+100*a+50*t})},t))})},a))})]}),Ms=({type:s="line",showLegend:t=!0,delay:a=0})=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6 animate-pulse",style:{animationDelay:`${a}ms`},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx(Ps,{className:"h-6 w-32 mb-2",delay:a+100}),e.jsx(Ps,{className:"h-4 w-48",delay:a+200})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ps,{className:"h-8 w-20",rounded:"lg",delay:a+300}),e.jsx(Ps,{className:"h-8 w-8",rounded:"lg",delay:a+350})]})]}),e.jsxs("div",{className:"h-80 bg-gray-50 rounded-lg p-4 relative overflow-hidden",children:["pie"===s?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(Ps,{className:"w-48 h-48",rounded:"full",delay:a+400})}):e.jsx("div",{className:"h-full flex items-end justify-between gap-2",children:[...Array(12)].map((s,t)=>e.jsx("div",{className:"flex-1 flex flex-col justify-end",children:e.jsx(Ps,{className:"w-full",height:60*Math.random()+20+"%",delay:a+400+50*t})},t))}),"pie"!==s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute bottom-4 left-4 right-4 h-px bg-gray-300"}),e.jsx("div",{className:"absolute bottom-4 left-4 top-4 w-px bg-gray-300"})]})]}),t&&e.jsx("div",{className:"mt-4 flex flex-wrap gap-4",children:[...Array("pie"===s?5:3)].map((s,t)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ps,{className:"w-3 h-3",rounded:"full",delay:a+600+50*t}),e.jsx(Ps,{className:"h-4 w-16",delay:a+625+50*t})]},t))})]}),Is=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((s,t)=>e.jsx(Ls,{delay:100*t},t))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx(Ms,{type:"pie",delay:200}),e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((s,t)=>e.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200 animate-pulse",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ps,{className:"w-10 h-10",rounded:"full",delay:300+50*t}),e.jsxs("div",{children:[e.jsx(Ps,{className:"h-4 w-24 mb-1",delay:325+50*t}),e.jsx(Ps,{className:"h-3 w-16",delay:350+50*t})]})]}),e.jsx(Ps,{className:"h-6 w-20",delay:375+50*t})]})},t))})]}),e.jsx(Us,{rows:8,columns:7,delay:500})]}),Os=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((s,t)=>e.jsx(Ls,{delay:100*t},t))}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((s,t)=>e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-200 animate-pulse",style:{animationDelay:200+100*t+"ms"},children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Ps,{className:"w-14 h-14",rounded:"2xl",delay:250+100*t}),e.jsxs("div",{children:[e.jsx(Ps,{className:"h-6 w-20 mb-2",delay:275+100*t}),e.jsx(Ps,{className:"h-4 w-32",delay:300+100*t})]})]})}),e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((s,a)=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-xl",children:[e.jsx(Ps,{className:"h-4 w-24",delay:325+100*t+25*a}),e.jsx(Ps,{className:"h-4 w-16",delay:350+100*t+25*a})]},a))})]},t))})]}),zs=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((s,t)=>e.jsx(Ls,{delay:100*t},t))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx(Ms,{type:"pie",showLegend:!0,delay:200}),e.jsx(Ms,{type:"bar",showLegend:!0,delay:300})]}),e.jsx("div",{className:"grid grid-cols-1 gap-8",children:e.jsx(Ms,{type:"area",showLegend:!0,delay:400})})]}),Bs=(e,s={})=>{const{duration:t=400,easing:a="easeOut",decimals:n=0,prefix:l="",suffix:i="",separator:c=","}=s,[o,d]=r.useState(0),[m,x]=r.useState(!1),h=r.useRef(),u=r.useRef(),g=r.useRef(0),p={linear:e=>e,easeOut:e=>1-Math.pow(1-e,5),easeIn:e=>Math.pow(e,3),easeInOut:e=>e<.5?4*Math.pow(e,3):1-Math.pow(-2*e+2,3)/2},j=s=>{u.current||(u.current=s);const r=s-u.current,n=Math.min(r/t,1),l=p[a](n),i=g.current+(e-g.current)*l,c=Math.abs(i)>1e3?Math.round(i):i;d(c),n<1?h.current=requestAnimationFrame(j):(d(e),x(!1),h.current=void 0,u.current=void 0)};return r.useEffect(()=>{if(h.current&&cancelAnimationFrame(h.current),e!==o&&0!==e)return x(!0),g.current=o,u.current=void 0,h.current=requestAnimationFrame(j),()=>{h.current&&cancelAnimationFrame(h.current)};d(e)},[e]),r.useEffect(()=>()=>{h.current&&cancelAnimationFrame(h.current)},[]),{displayValue:(e=>{const s=e.toFixed(n).split(".");s[0]=s[0].replace(/\B(?=(\d{3})+(?!\d))/g,c);const t=s.join(".");return`${l}${t}${i}`})(o),rawValue:o,isAnimating:m,targetValue:e}},Ks=({value:s,className:t="",duration:a=500,animated:r=!0})=>{const n="string"==typeof s?parseFloat(s.replace(/[^\d.-]/g,""))||0:s,l="string"==typeof s&&s.includes("$")?"$":"string"==typeof s&&s.includes("₺")?"₺":"",i="string"==typeof s&&s.includes("%")?"%":"",c=Bs(n,{duration:a,easing:"easeOut",decimals:0,prefix:l,suffix:i}),o=r&&!isNaN(n)?c.displayValue:s;return e.jsx("span",{className:t,style:{fontVariantNumeric:"tabular-nums",willChange:r?"contents":"auto"},children:o})},Ys=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{t:s}=Pe(),[t,a]=r.useState(null),[f,N]=r.useState(!0),[v,w]=r.useState(null),_=()=>{alert(s("analytics.export_coming_soon"))},[k,S]=$s("overview"),[C,D]=r.useState(!1);r.useEffect(()=>{T()},[]),Ue([{...Ve.REFRESH,action:()=>T()},{key:"e",ctrlKey:!0,action:()=>_()}]);const T=async()=>{try{N(!0),D(!0),w(null);const e=await fetch("/api/analytics/overview",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(e.ok){const s=await e.json();a(s)}else 401===e.status?w("Authentication required. Please log in."):w("Failed to fetch analytics data")}catch(e){w("Failed to connect to server")}finally{N(!1),D(!1)}},F=e=>`$${e.toLocaleString()}`,E=(e,s)=>0===s?"0%":`${(e/s*100).toFixed(1)}%`;if(f)return e.jsx(zs,{});if(v)return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(n,{className:"h-8 w-8 text-gray-600"}),s("analytics.title")]}),e.jsx("p",{className:"text-gray-600",children:s("analytics.description")})]})})})}),e.jsx("div",{className:"p-6",children:e.jsx(cs,{variant:"elevated",children:e.jsxs(Me,{className:"p-12 text-center",children:[e.jsx("div",{className:"text-red-500 mb-6",children:e.jsx(l,{className:"h-16 w-16 mx-auto"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Error Loading Analytics"}),e.jsx("p",{className:"text-gray-600 mb-6",children:v}),e.jsx(os,{variant:"primary",onClick:T,icon:e.jsx(i,{className:"h-4 w-4"}),iconPosition:"left",children:"Try Again"})]})})})]});if(!t)return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(n,{className:"h-8 w-8 text-gray-600"}),s("analytics.title")]}),e.jsx("p",{className:"text-gray-600",children:s("analytics.description")})]})})})}),e.jsx("div",{className:"p-6",children:e.jsx(cs,{variant:"elevated",children:e.jsxs(Me,{className:"p-12 text-center",children:[e.jsx("div",{className:"text-gray-400 mb-6",children:e.jsx(n,{className:"h-16 w-16 mx-auto"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"No Analytics Data"}),e.jsx("p",{className:"text-gray-600",children:"No analytics data is currently available."})]})})})]});const A=t.psp_summary.reduce((e,s)=>e+s.total_amount,0),R=t.psp_summary.reduce((e,s)=>e+s.total_commission,0);return e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(n,{className:"h-8 w-8 text-gray-600"}),s("analytics.title")]}),e.jsx("p",{className:"text-gray-600",children:s("analytics.description")})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(Ie,{actions:[{id:"refresh",label:C?"Refreshing...":"Refresh Data",icon:e.jsx(i,{className:"h-4 w-4 "+(C?"animate-spin":"")}),action:()=>T(),variant:"outline"},{id:"export",label:"Export Data",icon:e.jsx(c,{className:"h-4 w-4"}),action:()=>_(),variant:"outline"}]})})]})}),e.jsxs(Oe,{value:k,onValueChange:S,className:"w-full",children:[e.jsxs(ze,{className:"grid w-full grid-cols-4 bg-gray-50/80 border border-gray-200/60 rounded-lg shadow-sm",children:[e.jsxs(Be,{value:"overview",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg data-[state=active]:border data-[state=active]:border-gray-200",children:[e.jsx(n,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-blue-600"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:s("tabs.overview")})]}),e.jsxs(Be,{value:"performance",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg data-[state=active]:border data-[state=active]:border-gray-200",children:[e.jsx(o,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-blue-600"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:s("tabs.performance")})]}),e.jsxs(Be,{value:"clients",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg data-[state=active]:border data-[state=active]:border-gray-200",children:[e.jsx(d,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-blue-600"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:s("navigation.clients")})]}),e.jsxs(Be,{value:"insights",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg data-[state=active]:border data-[state=active]:border-gray-200",children:[e.jsx(m,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-blue-600"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:s("tabs.insights")})]})]}),e.jsxs(Ke,{value:"overview",className:"mt-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:(()=>{if(!t)return[];const e=t.psp_summary.reduce((e,s)=>e+s.total_amount,0),s=t.psp_summary.reduce((e,s)=>e+s.total_commission,0),a=t.psp_summary.reduce((e,s)=>e+s.transaction_count,0),r=t.client_summary.length;return[{label:"Total Revenue",value:F(e),change:"+12.5%",trend:"up",icon:y,color:"text-green-600",bgColor:"bg-green-50"},{label:"Total Commission",value:F(s),change:"+8.2%",trend:"up",icon:o,color:"text-gray-600",bgColor:"bg-gray-50"},{label:"Active Clients",value:r.toString(),change:"+15.3%",trend:"up",icon:d,color:"text-purple-600",bgColor:"bg-purple-50"},{label:"Total Transactions",value:a.toString(),change:"+5.7%",trend:"up",icon:b,color:"text-orange-600",bgColor:"bg-orange-50"}]})().map((s,t)=>e.jsxs(cs,{variant:"elevated",showGlass:t<2,className:"relative overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 ${s.bgColor} rounded-full -translate-y-16 translate-x-16`}),e.jsxs(Me,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:`w-12 h-12 ${s.bgColor} rounded-xl flex items-center justify-center shadow-lg`,children:e.jsx(s.icon,{className:`h-6 w-6 ${s.color}`})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm font-medium ${s.color}`,children:s.change}),"up"===s.trend?e.jsx(x,{className:"h-4 w-4 text-green-500"}):e.jsx(h,{className:"h-4 w-4 text-red-500"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s.label}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:e.jsx(Ks,{value:s.value,animated:!0,duration:500})})]})]})]},t))}),e.jsx(cs,{variant:"outlined",children:e.jsx(Me,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(u,{className:"h-4 w-4 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Data Period"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.date_range.start_date," to ",t.date_range.end_date]})]})]})})})]}),e.jsxs(Ke,{value:"performance",className:"mt-6",children:[e.jsxs(cs,{variant:"elevated",showGlass:!0,children:[e.jsxs(Ye,{children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5"}),"PSP Performance"]}),e.jsx(He,{children:"Revenue by Payment Service Provider"})]}),e.jsx(Me,{children:t.psp_summary.length>0?e.jsx("div",{className:"space-y-4",children:t.psp_summary.map(s=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.psp}),e.jsx("span",{className:"text-sm text-gray-500",children:F(s.total_amount)})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-gray-500 to-gray-600 h-2 rounded-full",style:{width:`${E(s.total_amount,A)}`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:[s.transaction_count," transactions"]}),e.jsx("span",{children:E(s.total_amount,A)})]})]},s.psp))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(g,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No PSP data available"})]})})]}),e.jsxs(cs,{variant:"elevated",children:[e.jsxs(Ye,{children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(n,{className:"h-5 w-5"}),"Category Breakdown"]}),e.jsx(He,{children:"Revenue by transaction category"})]}),e.jsx(Me,{children:t.category_summary.length>0?e.jsx("div",{className:"space-y-4",children:t.category_summary.map(s=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ds,{variant:"WD"===s.category?"destructive":"success",size:"sm",children:s.category}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.category})]}),e.jsx("span",{className:"text-sm text-gray-500",children:F(s.total_amount)})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"h-2 rounded-full "+("WD"===s.category?"bg-gradient-to-r from-red-500 to-red-600":"bg-gradient-to-r from-green-500 to-green-600"),style:{width:`${E(s.total_amount,A)}`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:[s.transaction_count," transactions"]}),e.jsx("span",{children:E(s.total_amount,A)})]})]},s.category))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(n,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No category data available"})]})})]})]}),e.jsx(Ke,{value:"clients",className:"mt-6",children:e.jsxs(cs,{variant:"elevated",children:[e.jsxs(Ye,{children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(d,{className:"h-5 w-5"}),"Top Clients"]}),e.jsx(He,{children:"Clients with highest transaction volume"})]}),e.jsx(Me,{className:"p-0",children:t.client_summary.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Commission"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Transactions"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avg Transaction"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.client_summary.slice(0,10).map((s,t)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-gray-500 to-gray-600 rounded-full flex items-center justify-center mr-3",children:e.jsxs("span",{className:"text-sm font-medium text-white",children:["#",t+1]})}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.client_name})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:F(s.total_amount)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:F(s.total_commission)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.transaction_count}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:F(s.total_amount/s.transaction_count)})]},s.client_name))})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(d,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No client data available"})]})})]})}),e.jsx(Ke,{value:"insights",className:"mt-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(cs,{variant:"elevated",children:[e.jsxs(Ye,{children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(m,{className:"h-5 w-5"}),"Key Insights"]}),e.jsx(He,{children:"Important findings from your data"})]}),e.jsx(Me,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(p,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-900",children:"Top Performer"})]}),e.jsxs("p",{className:"text-sm text-green-700",children:[t.psp_summary[0]?.psp||"N/A"," is your top performing PSP with ",F(t.psp_summary[0]?.total_amount||0)," in revenue."]})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(j,{className:"h-5 w-5 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Client Growth"})]}),e.jsxs("p",{className:"text-sm text-gray-700",children:["You have ",t.client_summary.length," active clients contributing to your business."]})]})]})})]}),e.jsxs(cs,{variant:"elevated",children:[e.jsxs(Ye,{children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(c,{className:"h-5 w-5"}),"Summary Report"]}),e.jsx(He,{children:"Quick overview of your analytics"})]}),e.jsx(Me,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:s("common.total_revenue")}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:e.jsx(Ks,{value:F(A),animated:!0,duration:500})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:s("common.total_commission")}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:e.jsx(Ks,{value:F(R),animated:!0,duration:500})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Active Clients"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:t.client_summary.length})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:s("common.total_transactions")}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:t.psp_summary.reduce((e,s)=>e+s.transaction_count,0)})]})]})})]})]})})]})]})}},Symbol.toStringTag,{value:"Module"})),Ws=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const[s,a]=r.useState(""),[n,l]=r.useState(""),[i,c]=r.useState(!1),[o,d]=r.useState(!1),[m,x]=r.useState(!1),[h,g]=r.useState({}),[j,y]=r.useState(0),[b,P]=r.useState(!1),[L,U]=r.useState(null),[M,I]=r.useState(0),[O,z]=r.useState(!1),[B,K]=r.useState(0),[Y,W]=r.useState(navigator.onLine),[H,V]=r.useState(new Date),[q,J]=r.useState(!1),[G,X]=r.useState(new Date),[Q,Z]=r.useState("operational"),ee=r.useRef(null),se=r.useRef(null),te=r.useRef([]),{login:ae,isAuthenticated:re}=Le(),{t:ne,currentLanguage:le,setLanguage:ie}=Pe(),ce=f(),oe=N();return r.useEffect(()=>{if(re){const e=oe.state?.from?.pathname||"/dashboard";ce(e,{replace:!0})}},[re,ce,oe]),r.useEffect(()=>{const e=localStorage.getItem("pipeline_remember_user");e&&(a(e),d(!0))},[]),r.useEffect(()=>{if(!b||!L)return;const e=setInterval(()=>{const e=Date.now(),s=Math.max(0,Math.ceil((L.getTime()-e)/1e3));I(s),s<=0&&(P(!1),U(null),y(0))},1e3);return()=>clearInterval(e)},[b,L,ne]),r.useEffect(()=>{const e=setInterval(()=>{X(new Date),V(new Date)},1e3);return()=>clearInterval(e)},[]),r.useEffect(()=>{const e=()=>W(!0),s=()=>W(!1);return window.addEventListener("online",e),window.addEventListener("offline",s),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}},[]),r.useEffect(()=>{ee.current&&ee.current.focus()},[]),e.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f9fafb",padding:"1rem",position:"relative"},className:"min-h-screen flex items-center justify-center bg-gray-50 p-4 relative",children:[e.jsxs("div",{className:"absolute top-4 right-4 flex items-center gap-2 bg-card border rounded-lg px-3 py-2 shadow-sm",children:[Y?e.jsx(v,{className:"w-4 h-4 text-green-500"}):e.jsx(w,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:ne(Y?"login.online":"login.offline")})]}),e.jsxs("div",{className:"absolute top-4 left-4 flex items-center gap-2 bg-card border rounded-lg px-3 py-2 shadow-sm",children:[e.jsx(_,{className:"w-4 h-4 "+("operational"===Q?"text-green-500":"maintenance"===Q?"text-yellow-500":"text-red-500")}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["operational"===Q&&ne("login.systemOperational"),"maintenance"===Q&&ne("login.systemMaintenance"),"issues"===Q&&ne("login.systemIssues")]})]}),e.jsxs("div",{className:"w-full max-w-md space-y-6 relative z-10",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center",children:e.jsx("img",{src:"/plogo.png",alt:"PipLinePro Logo",className:"w-24 h-24 object-contain"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-3xl font-semibold tracking-tight",children:"PipLinePro"}),e.jsx("p",{className:"text-muted-foreground",children:ne("login.systemTitle")})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(k,{className:"w-4 h-4"}),e.jsx("span",{children:G.toLocaleTimeString("tr"===le?"tr-TR":"en-US")})]}),e.jsx("div",{className:"w-px h-4 bg-border"}),e.jsx("span",{children:G.toLocaleDateString("tr"===le?"tr-TR":"en-US")})]})]}),e.jsx("div",{className:"flex items-center justify-center gap-2",children:e.jsxs(qe,{value:le,onValueChange:ie,children:[e.jsxs(Je,{className:"w-auto border-0 bg-transparent hover:bg-muted/50 transition-colors",children:[e.jsx(u,{className:"w-4 h-4 mr-1"}),e.jsx(Ge,{})]}),e.jsxs(Xe,{children:[e.jsx(Qe,{value:"en",children:"English"}),e.jsx(Qe,{value:"tr",children:"Türkçe"})]})]})}),e.jsxs(Ze,{className:"border-amber-200 bg-amber-50",children:[e.jsx(S,{className:"h-4 w-4 text-amber-600"}),e.jsx(es,{className:"text-amber-800",children:ne("login.securityNotice")})]}),b&&e.jsxs(Ze,{variant:"destructive",children:[e.jsx(C,{className:"h-4 w-4"}),e.jsx(es,{children:ne("login.accountLockedMessage",{minutes:Math.ceil(M/60),seconds:M%60})})]}),!Y&&e.jsxs(Ze,{className:"border-orange-200 bg-orange-50",children:[e.jsx(w,{className:"h-4 w-4 text-orange-600"}),e.jsx(es,{className:"text-orange-800",children:ne("login.offlineMode")})]}),e.jsx(cs,{variant:"elevated",size:"md",padding:"lg",className:"shadow-md bg-white",header:{title:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5"}),ne("login.signIn")]}),description:ne("login.signInDescription")},children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return s.trim()?s.length<3&&(e.username=ne("login.usernameMinLength")):e.username=ne("login.usernameRequired"),n?n.length<5&&(e.password=ne("login.passwordMinLength")):e.password=ne("login.passwordRequired"),g(e),0===Object.keys(e).length})()){g({}),x(!0);try{const e=await ae(s,n,o),t={timestamp:new Date,success:e.success,ip:"192.168.1.100"};if(te.current.push(t),!e.success)throw new Error(e.message||ne("login.invalidCredentials"));{o?localStorage.setItem("pipeline_remember_user",s):localStorage.removeItem("pipeline_remember_user"),y(0);const e=oe.state?.from?.pathname||"/dashboard";ce(e,{replace:!0})}}catch(t){y(j+1);{const e=t instanceof Error?t.message:ne("login.loginFailed");g({general:e})}}finally{x(!1)}}},className:"space-y-4",children:[h.general&&e.jsxs(Ze,{variant:"destructive",children:[e.jsx(t,{className:"h-4 w-4"}),e.jsx(es,{children:h.general})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ss,{htmlFor:"username",className:"flex items-center gap-1",children:[e.jsx(D,{className:"w-4 h-4"}),ne("login.username"),e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ts,{ref:ee,id:"username",type:"text",placeholder:ne("login.usernamePlaceholder"),value:s,onChange:e=>a(e.target.value),disabled:m||b,className:"bg-input-background transition-all "+(h.username?"border-destructive focus-visible:ring-destructive":""),autoComplete:"username",onKeyDown:e=>{"Enter"===e.key&&se.current&&se.current.focus()}}),h.username&&e.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[e.jsx(t,{className:"w-3 h-3"}),h.username]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ss,{htmlFor:"password",className:"flex items-center gap-1",children:[e.jsx(C,{className:"w-4 h-4"}),ne("login.password"),e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ts,{ref:se,id:"password",type:i?"text":"password",placeholder:ne("login.passwordPlaceholder"),value:n,onChange:e=>{return s=e.target.value,l(s),void K((e=>{let s=0;return e.length>=6&&(s+=25),/[A-Z]/.test(e)&&(s+=25),/[0-9]/.test(e)&&(s+=25),/[^A-Za-z0-9]/.test(e)&&(s+=25),s})(s));var s},onKeyDown:e=>{if(e.getModifierState){const s=e.getModifierState("CapsLock");z(s)}},onKeyPress:e=>{const s=e.getModifierState&&e.getModifierState("CapsLock");z(s)},disabled:m||b,className:"bg-input-background pr-10 transition-all "+(h.password?"border-destructive focus-visible:ring-destructive":""),autoComplete:"current-password"}),e.jsx(os,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>c(!i),disabled:m||b,children:i?e.jsx(T,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(F,{className:"h-4 w-4 text-muted-foreground"})})]}),n&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:ne("login.passwordStrength")}),e.jsx("span",{className:"text-xs text-muted-foreground",children:(de=B,ne(de<25?"login.passwordWeak":de<50?"login.passwordFair":de<75?"login.passwordGood":"login.passwordStrong"))})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-1.5",children:e.jsx("div",{className:`h-1.5 rounded-full transition-all duration-300 ${(e=>e<25?"bg-red-500":e<50?"bg-orange-500":e<75?"bg-yellow-500":"bg-green-500")(B)}`,style:{width:`${B}%`}})})]}),h.password&&e.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[e.jsx(t,{className:"w-3 h-3"}),h.password]}),O&&e.jsxs("p",{className:"text-sm text-orange-600 flex items-center gap-1",children:[e.jsx(E,{className:"w-3 h-3"}),ne("login.capsLockOn")]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(as,{id:"remember",checked:o,onCheckedChange:e=>d(!0===e),disabled:m||b}),e.jsx(ss,{htmlFor:"remember",className:"text-sm cursor-pointer text-muted-foreground",children:ne("login.rememberMe")})]}),j>0&&e.jsx("span",{className:"text-xs text-orange-600",children:ne("login.failedAttempts",{count:j})})]}),e.jsx(os,{type:"button",variant:"ghost",size:"sm",onClick:()=>J(!q),className:"w-full text-muted-foreground hover:text-foreground",icon:e.jsx(A,{className:"w-4 h-4"}),iconPosition:"left",children:ne(q?"login.hideAdvanced":"login.showAdvanced")}),q&&e.jsxs("div",{className:"p-3 bg-muted/30 rounded-lg space-y-3 border",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:ne("login.advancedOptions")}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:ne("login.twoFactorAuth")})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:ne("login.notConfigured")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:ne("login.sessionDuration")})]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["8 ",ne("login.hours")]})]})]}),e.jsx(os,{type:"submit",variant:"primary",size:"lg",className:"w-full",disabled:m||b||!s||!n||!Y,loading:m,icon:m?void 0:e.jsx($,{className:"w-4 h-4"}),iconPosition:"left",children:ne(m?"login.signingIn":"login.signIn")})]}),te.current.length>0&&e.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg border border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(S,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:ne("login.recentActivity")})]}),e.jsx("div",{className:"space-y-1",children:te.current.slice(-3).map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.success?e.jsx(p,{className:"w-3 h-3 text-green-500"}):e.jsx(t,{className:"w-3 h-3 text-red-500"}),e.jsx("span",{className:"text-muted-foreground",children:s.timestamp.toLocaleTimeString()})]}),e.jsx("span",{className:s.success?"text-green-600":"text-red-600",children:s.success?ne("login.success"):ne("login.failed")})]},a))})]})]})}),e.jsxs("div",{className:"text-center space-y-2 text-xs text-muted-foreground",children:[e.jsxs("p",{children:["© 2024 PipLinePro ",ne("login.allRightsReserved")]}),e.jsx("p",{children:ne("login.secureTreasuryManagement")}),e.jsxs("p",{className:"flex items-center justify-center gap-1",children:[e.jsx(S,{className:"w-3 h-3"}),ne("login.encryptedConnection")]})]})]})]});var de}},Symbol.toStringTag,{value:"Module"}));class Hs extends Error{code;status;context;constructor(e,s,t,a){super(e),this.name="PipLineError",this.code=s,this.status=t,this.context=a}}class Vs{static instance;errorLog=[];maxLogSize=100;constructor(){}static getInstance(){return Vs.instance||(Vs.instance=new Vs),Vs.instance}handleApiError(e,s){let t="An unexpected error occurred",a="UNKNOWN_ERROR",r=500;if(e instanceof Hs)return e;if(e.response){const s=e.response.data||{};t=s.message||s.error||"API request failed",a=s.code||`HTTP_${e.response.status}`,r=e.response.status}else e.request?(t="Network error - please check your connection",a="NETWORK_ERROR",r=0):e.message&&(t=e.message,a="GENERIC_ERROR");const n=new Hs(t,a,r,{originalError:e,context:s,timestamp:(new Date).toISOString()});return this.logError(n),n}handleComponentError(e,s,t){const a=new Hs(e.message,"COMPONENT_ERROR",0,{componentName:t,errorInfo:s,stack:e.stack,timestamp:(new Date).toISOString()});this.logError(a)}handleValidationError(e,s){const t=new Hs(e,"VALIDATION_ERROR",400,{field:s,timestamp:(new Date).toISOString()});return this.logError(t),t}handleAuthError(e="Authentication required"){const s=new Hs(e,"AUTH_ERROR",401,{timestamp:(new Date).toISOString()});return this.logError(s),s}handlePermissionError(e="Insufficient permissions"){const s=new Hs(e,"PERMISSION_ERROR",403,{timestamp:(new Date).toISOString()});return this.logError(s),s}logError(e){const s={message:e.message,code:e.code,status:e.status,timestamp:(new Date).toISOString(),context:e.context};this.errorLog.unshift(s),this.errorLog.length>this.maxLogSize&&(this.errorLog=this.errorLog.slice(0,this.maxLogSize))}getErrorLog(){return[...this.errorLog]}clearErrorLog(){this.errorLog=[]}getUserFriendlyMessage(e){switch(e.code){case"NETWORK_ERROR":return"Please check your internet connection and try again.";case"AUTH_ERROR":return"Please log in to continue.";case"PERMISSION_ERROR":return"You do not have permission to perform this action.";case"VALIDATION_ERROR":return e.message;case"COMPONENT_ERROR":return"Something went wrong. Please refresh the page.";default:return e.message||"An unexpected error occurred. Please try again."}}isRetryable(e){return"NETWORK_ERROR"===e.code||e.status&&e.status>=500||0===e.status}getRetryDelay(e){return Math.min(1e3*Math.pow(2,e),1e4)}}const qs=Vs.getInstance(),Js=(e,s="₺",t="en-US")=>{if(isNaN(e)||null==e)return`${s}0`;const a={"₺":"TRY",$:"USD","€":"EUR","£":"GBP",TL:"TRY",TRY:"TRY",USD:"USD",EUR:"EUR",GBP:"GBP"}[s]||s;try{return new Intl.NumberFormat(t,{style:"currency",currency:a,minimumFractionDigits:0,maximumFractionDigits:2}).format(e)}catch(r){return`${s}${e.toLocaleString()}`}},Gs=(e,s="₺",t="en-US")=>{const a=Math.abs(e);return Js(a,s,t)},Xs=({isOpen:s,onClose:t,title:a,children:n,size:l="md",showCloseButton:i=!0,subtitle:c,footer:o,closeOnBackdropClick:d=!0,closeOnEscape:m=!0,className:x=""})=>{const h=r.useRef(null);return r.useEffect(()=>{const e=e=>{"Escape"===e.key&&m&&t()};return s&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[s,t,m]),s?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",onClick:e=>{d&&e.target===e.currentTarget&&t()},children:e.jsxs("div",{ref:h,className:`w-full ${{sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-7xl"}[l]} bg-white rounded-lg shadow-xl ${x}`,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title","aria-describedby":c?"modal-subtitle":void 0,children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx("h2",{id:"modal-title",className:"text-lg font-semibold text-gray-900",children:a}),c&&e.jsx("p",{id:"modal-subtitle",className:"text-sm text-gray-600 mt-1",children:c})]}),i&&e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close modal",children:e.jsx(P,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"p-6",children:n}),o&&e.jsx("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-gray-200 bg-gray-50 rounded-b-lg",children:o})]})}):null},Qs=({transaction:s})=>{const t=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch{return"Invalid Date"}};return e.jsxs("div",{className:"max-h-[70vh] overflow-y-auto pr-2 space-y-6 business-scrollbar",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-gray-100 p-2 rounded-lg",children:e.jsx(y,{className:"h-6 w-6 text-gray-600"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Transaction #",s.id]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Created on ",t(s.created_at)]})]})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Client Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Client Name"}),e.jsx("p",{className:"text-sm text-gray-900 font-medium",children:s.client_name})]}),s.company&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Company"}),e.jsxs("p",{className:"text-sm text-gray-900 flex items-center",children:[e.jsx(L,{className:"h-4 w-4 mr-2 text-gray-400"}),s.company]})]}),s.iban&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"IBAN"}),e.jsx("p",{className:"text-sm text-gray-900 font-mono",children:s.iban})]}),s.payment_method&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Payment Method"}),e.jsxs("p",{className:"text-sm text-gray-900 flex items-center",children:[e.jsx(U,{className:"h-4 w-4 mr-2 text-gray-400"}),s.payment_method]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Transaction Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Category"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.category})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"PSP"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.psp||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Transaction Date"}),e.jsxs("p",{className:"text-sm text-gray-900 flex items-center",children:[e.jsx(M,{className:"h-4 w-4 mr-2 text-gray-400"}),t(s.date)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Currency"}),e.jsx("p",{className:"text-sm text-gray-900 font-medium",children:s.currency||"TL"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Financial Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("label",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:"Amount"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:Gs(s.amount,s.currency)}),s.amount_tl&&e.jsxs("p",{className:"text-xs text-gray-600",children:["(",Gs(s.amount_tl,"₺"),")"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("label",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:"Commission"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:Js(s.commission,s.currency||"₺")}),s.commission_tl&&e.jsxs("p",{className:"text-xs text-gray-600",children:["(",Js(s.commission_tl,"₺"),")"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("label",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:"Net Amount"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:Gs(s.net_amount,s.currency||"₺")}),s.net_amount_tl&&e.jsxs("p",{className:"text-xs text-gray-600",children:["(",Gs(s.net_amount_tl,"₺"),")"]})]})]}),s.exchange_rate&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[e.jsx("label",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:"Exchange Rate"}),e.jsxs("p",{className:"text-sm text-gray-900",children:["1 ",s.currency," = ",s.exchange_rate.toFixed(4)," TL"]})]})]}),s.notes&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center",children:[e.jsx(c,{className:"h-4 w-4 mr-2"}),"Notes"]}),e.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap",children:s.notes})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Timestamps"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Created"}),e.jsx("p",{className:"text-gray-900",children:t(s.created_at)})]}),s.updated_at&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Last Updated"}),e.jsx("p",{className:"text-gray-900",children:t(s.updated_at)})]})]})]})]})},Zs=({isOpen:s,onClose:t,onRateSelect:a,currentAmount:n,transactionDate:l})=>{const[i,c]=r.useState(null),[d,m]=r.useState(""),[x,h]=r.useState(!1),[u,g]=r.useState(null),[j,b]=r.useState("");r.useEffect(()=>{s&&(async()=>{try{h(!0),g(null);const e=await Fe.get("/exchange-rates/current"),s=await Fe.parseResponse(e);if(e.ok&&s.success&&s.rate){const e={rate:s.rate.rate,timestamp:s.rate.created_at,source:s.rate.source,change_24h:s.rate.change_24h,volume:s.rate.volume};c(e),m(s.rate.rate.toFixed(4)),b(new Date(s.rate.created_at).toLocaleString())}else g(`Failed to fetch current exchange rate: ${s.message||"Unknown error"}`)}catch(e){g(`Unable to fetch current exchange rate: ${e instanceof Error?e.message:"Network error"}`)}finally{h(!1)}})()},[s]);const f=e=>(n*e).toFixed(2);return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl border border-gray-200 max-w-md w-full max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 bg-gradient-to-r from-gray-50 to-indigo-50 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center mr-3",children:e.jsx(y,{className:"h-4 w-4 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Currency Conversion"}),e.jsx("p",{className:"text-sm text-gray-600",children:"USD to TRY Exchange Rate"})]})]}),e.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-all duration-200",children:e.jsx(P,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:e.jsxs("div",{className:"p-6 space-y-6",children:[u&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-red-700",children:u})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Transaction Details"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Amount (USD):"}),e.jsxs("span",{className:"font-medium text-gray-900",children:["$",n.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Date:"}),e.jsx("span",{className:"font-medium text-gray-900",children:l})]})]})]}),x?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Fetching current rate..."})]}):i?e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Current Market Rate"}),e.jsxs("div",{className:"flex items-center text-xs text-gray-700",children:[e.jsx(k,{className:"h-3 w-3 mr-1"}),"Updated: ",j]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["1 USD = ₺",i.rate.toFixed(4)]}),(s=>{if(!s)return null;const t=s>0;return e.jsxs("div",{className:"flex items-center text-sm "+(t?"text-green-600":"text-red-600"),children:[e.jsx(o,{className:"h-3 w-3 mr-1 "+(t?"":"rotate-180")}),t?"+":"",s.toFixed(4)," (24h)"]})})(i.change_24h)]}),e.jsxs("div",{className:"text-sm text-gray-700",children:[e.jsxs("span",{className:"font-medium",children:["$",n.toFixed(2)," USD"]}),e.jsx("span",{className:"mx-2",children:"→"}),e.jsxs("span",{className:"font-bold",children:["₺",f(i.rate)]})]})]}),e.jsxs("button",{onClick:()=>{i&&(a(i.rate),t())},className:"w-full mt-4 bg-gray-600 text-white py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors duration-200 flex items-center justify-center",children:[e.jsx(p,{className:"h-4 w-4 mr-2"}),"Use Current Rate"]})]}):null,e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Custom Exchange Rate"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Manual Rate (1 USD = ? TRY)"}),e.jsx("input",{type:"number",step:"0.0001",min:"0",value:d,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-gray-500",placeholder:"Enter exchange rate..."})]}),d&&parseFloat(d)>0&&e.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:e.jsxs("div",{className:"text-sm text-gray-700",children:[e.jsxs("span",{className:"font-medium",children:["$",n.toFixed(2)," USD"]}),e.jsx("span",{className:"mx-2",children:"→"}),e.jsxs("span",{className:"font-bold text-gray-900",children:["₺",f(parseFloat(d))]})]})}),e.jsxs("button",{onClick:()=>{const e=parseFloat(d);e>0&&(a(e),t())},disabled:!d||parseFloat(d)<=0,className:"w-full bg-gray-600 text-white py-2 px-4 rounded-lg hover:bg-gray-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors duration-200 flex items-center justify-center",children:[e.jsx(p,{className:"h-4 w-4 mr-2"}),"Apply Custom Rate"]})]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-yellow-800",children:["💡 ",e.jsx("strong",{children:"Tip:"})," For historical transactions, you may want to use the exchange rate that was applicable on the transaction date rather than the current rate."]})})]})}),e.jsx("div",{className:"border-t border-gray-200 px-6 py-4 bg-gray-50 flex-shrink-0",children:e.jsx("div",{className:"flex justify-end space-x-3",children:e.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors duration-200",children:"Cancel"})})})]})}):null},et=({transaction:s,onSave:t,onCancel:a,dropdownOptions:n={categories:[],psps:[],payment_methods:[],companies:[],currencies:[]}})=>{const[i,c]=r.useState({client_name:s.client_name||"",company:s.company||s.company_order||"",iban:s.iban||"",payment_method:s.payment_method||"",category:s.category||"",amount:s.amount?.toString()||"",currency:s.currency||"TL",psp:s.psp||"",notes:s.notes||"",date:s.date?s.date.split("T")[0]:(new Date).toISOString().split("T")[0]}),[o,d]=r.useState(!1),[m,x]=r.useState(""),[h,u]=r.useState(""),[g,j]=r.useState(!1),[b,f]=r.useState("");r.useEffect(()=>{c({client_name:s.client_name||"",company:s.company||s.company_order||"",iban:s.iban||"",payment_method:s.payment_method||"",category:s.category||"",amount:s.amount?.toString()||"",currency:s.currency||"TL",psp:s.psp||"",notes:s.notes||"",date:s.date?s.date.split("T")[0]:(new Date).toISOString().split("T")[0]})},[s]);const N={...n,payment_methods:[...new Set([...n.payment_methods||[],...s.payment_method?[s.payment_method]:[]])],categories:[...new Set([...n.categories||[],...s.category?[s.category]:[]])],psps:[...new Set([...n.psps||[],...s.psp?[s.psp]:[]])],companies:[...new Set([...n.companies||[],...s.company?[s.company]:[],...s.company_order?[s.company_order]:[]])],currencies:[...new Set([...n.currencies||[],...s.currency?[s.currency]:[]])]},[v,w]=r.useState(!1),[_,k]=r.useState(null),[S,C]=r.useState(!1),[D,T]=r.useState(!1),[F,E]=r.useState(s.exchange_rate?.toString()||""),[A,R]=r.useState(s.exchange_rate?.toString()||""),[$,L]=r.useState(null),[U,M]=r.useState(!1);r.useEffect(()=>{"EUR"!==i.currency&&"USD"!==i.currency||!i.date?C(!1):C(!0)},[i.currency,i.date]);const O=(e,s)=>{c(t=>({...t,[e]:s})),k(null),"amount"!==e&&"currency"!==e||(L(null),M(!1)),"currency"===e&&"USD"===s&&T(!0)};return e.jsxs("div",{className:"max-h-[80vh] overflow-y-auto overflow-x-hidden pr-2 edit-form-scroll",children:[e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),i.client_name.trim()?!i.amount||parseFloat(i.amount)<=0?(k("Amount must be a positive number."),0):"EUR"!==i.currency||F?"USD"!==i.currency||A||(k("Please enter the USD exchange rate."),0):(k("Please enter the EUR exchange rate."),0):(k("Client name is required."),0)){w(!0),k(null);try{const e={...i,company_order:i.company,amount:parseFloat(i.amount),eur_rate:"EUR"===i.currency?parseFloat(F):void 0,usd_rate:"USD"===i.currency?parseFloat(A):void 0,...g&&h&&parseFloat(h)>0&&{manual_commission_rate:parseFloat(h),use_manual_commission:!0}},a=await Fe.put(`/transactions/${s.id}`,e);if(a.ok&&a.data){const e=a.data;e.transaction?t(e.transaction):"success"===e.status?e.id?t(e):k("Transaction update succeeded but data format is unexpected."):k(e.message||e.error||"Failed to update transaction.")}else{const e=a.data||{};k(e.message||e.error||`Failed to update transaction. Status: ${a.status}`)}}catch(a){k(a?.message||a?.data?.message||a?.data?.error||"An error occurred while updating the transaction.")}finally{w(!1)}}},className:"space-y-6",children:[_&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(l,{className:"h-5 w-5 text-red-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:_})]})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-4",children:"Client Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Client Name *"}),e.jsx("input",{type:"text",value:i.client_name,onChange:e=>O("client_name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company"}),e.jsxs("select",{value:i.company,onChange:e=>O("company",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",children:[e.jsx("option",{value:"",children:"Select Company"}),N?.companies?.map(s=>e.jsx("option",{value:s,children:s},s))||[]]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"IBAN"}),e.jsx("input",{type:"text",value:i.iban,onChange:e=>O("iban",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",placeholder:"Enter IBAN"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Method"}),e.jsxs("select",{value:i.payment_method,onChange:e=>O("payment_method",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",children:[e.jsx("option",{value:"",children:"Select Payment Method"}),N?.payment_methods?.map(s=>e.jsx("option",{value:s,children:s},s))||[]]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-4",children:"Transaction Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category *"}),e.jsxs("select",{value:i.category,onChange:e=>O("category",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",required:!0,children:[e.jsx("option",{value:"",children:"Select Category"}),N?.categories?.map(s=>e.jsx("option",{value:s,children:s},s))||[]]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"PSP"}),e.jsxs("select",{value:i.psp,onChange:e=>O("psp",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",children:[e.jsx("option",{value:"",children:"Select PSP"}),N?.psps?.map(s=>e.jsx("option",{value:s,children:s},s))||[]]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount *"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:i.amount,onChange:e=>O("amount",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Currency"}),e.jsxs("select",{value:i.currency,onChange:e=>O("currency",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",children:[e.jsx("option",{value:"TL",children:"TL"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"EUR",children:"EUR"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transaction Date"}),e.jsx("input",{type:"date",value:i.date,onChange:e=>O("date",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500"})]})]})]}),S&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-4",children:"Exchange Rate"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:["EUR"===i.currency&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"EUR Rate (1 EUR = ? TL)"}),e.jsx("input",{type:"number",step:"0.0001",min:"0",value:F,onChange:e=>{E(e.target.value),L(null),M(!1)},className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",required:!0})]}),"USD"===i.currency&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"USD Rate (1 USD = ? TL)"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[e.jsx("input",{type:"number",step:"0.0001",min:"0",value:A,onChange:e=>{R(e.target.value),L(null),M(!1)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500 min-w-0",required:!0}),e.jsxs("button",{type:"button",onClick:()=>T(!0),className:"px-4 py-2 bg-gray-100 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200 flex items-center justify-center space-x-2 whitespace-nowrap",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Get Rate"})]})]}),A&&e.jsxs("p",{className:"text-xs text-gray-600 mt-1 break-words",children:["$",i.amount||0," USD = ₺",((parseFloat(i.amount)||0)*(parseFloat(A)||0)).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{const e=parseFloat(i.amount)||0;let s=0;if("USD"===i.currency?s=parseFloat(A)||0:"EUR"===i.currency&&(s=parseFloat(F)||0),s>0&&e>0){const t=e*s,a=0;L({amount_try:t,commission_try:a,net_amount_try:t-a}),M(!0),k(null)}else k("Please enter valid amount and exchange rate.")},disabled:!i.amount||"USD"===i.currency&&!A||"EUR"===i.currency&&!F,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2 whitespace-nowrap",children:e.jsx("span",{children:"Apply Exchange Rate"})}),U&&e.jsx("span",{className:"text-sm text-green-600 font-medium text-center sm:text-right",children:"✓ Rate applied successfully"})]}),$&&e.jsxs("div",{className:"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg overflow-hidden",children:[e.jsx("h5",{className:"text-sm font-medium text-green-800 mb-3",children:"Converted Amounts (Turkish Lira)"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1 sm:gap-2",children:[e.jsx("span",{className:"text-green-700 text-sm",children:"Amount:"}),e.jsxs("span",{className:"font-medium text-green-900 text-sm break-all",children:["₺",$.amount_try.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1 sm:gap-2",children:[e.jsx("span",{className:"text-green-700 text-sm",children:"Commission:"}),e.jsxs("span",{className:"font-medium text-green-900 text-sm break-all",children:["₺",$.commission_try.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1 sm:gap-2",children:[e.jsx("span",{className:"text-green-700 text-sm",children:"Net Amount:"}),e.jsxs("span",{className:"font-medium text-green-900 text-sm break-all",children:["₺",$.net_amount_try.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),e.jsx("div",{className:"mt-3 pt-2 border-t border-green-200",children:e.jsxs("div",{className:"text-xs text-green-600 break-words",children:["Exchange Rate: 1 ",i.currency," = ₺","USD"===i.currency?A:F]})})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Manual Commission"}),g&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-green-700 bg-green-100 rounded-full",children:[e.jsx(p,{className:"h-3 w-3"}),"Active"]})]}),g?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",step:"0.01",value:h,onChange:e=>u(e.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Commission %"}),e.jsx("button",{type:"button",onClick:()=>{j(!1),d(!1),x(""),u(""),f("")},className:"px-3 py-2 text-sm font-medium text-gray-600 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:"Disable"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Overrides automatic PSP commission rate"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"password",value:m,onChange:e=>x(e.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Security code"}),e.jsx("button",{type:"button",onClick:()=>{"4561"===m?(j(!0),f(""),d(!0)):(f("Invalid security code. Please try again."),j(!1))},className:"px-3 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:ring-1 focus:ring-blue-500",children:"Enable"})]}),b&&e.jsx("p",{className:"text-xs text-red-600",children:b})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-4",children:"Additional Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx("textarea",{value:i.notes,onChange:e=>O("notes",e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500",placeholder:"Enter transaction notes..."})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[e.jsxs("button",{type:"button",onClick:a,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:[e.jsx(P,{className:"h-4 w-4 mr-2 inline"}),"Cancel"]}),e.jsx("button",{type:"submit",disabled:v,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 disabled:opacity-50 disabled:cursor-not-allowed",children:v?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"h-4 w-4 mr-2 inline"}),"Save Changes"]})})]})]}),e.jsx(Zs,{isOpen:D,onClose:()=>T(!1),onRateSelect:e=>{R(e.toString()),T(!1),L(null),M(!1)},currentAmount:parseFloat(i.amount)||0,transactionDate:i.date})]})};function st({filters:s,dropdownOptions:t,expandedFilterSections:a,displayLimit:r,transactionsLength:n,exporting:l,onFilterChange:c,onToggleFilterSection:o,onClearAllFilters:d,onApplyFilters:m,onExportDisplayed:x,onExportAll:h,onApplyQuickFilter:u}){const{t:g}=Pe(),p=Object.values(s).filter(e=>e&&"created_at"!==e&&"desc"!==e&&"all"!==e).length;return e.jsxs(cs,{variant:"outlined",className:"overflow-hidden border-slate-300 bg-white",children:[e.jsx(Ye,{className:"bg-white border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-slate-100 rounded-lg",children:e.jsx(O,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx(We,{className:"text-lg font-semibold text-slate-900",children:"Transaction Filters"}),e.jsxs(He,{className:"text-slate-600",children:["Filter and search transactions",p>0&&e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-slate-900 text-white text-xs font-medium rounded",children:p})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[p>0&&e.jsx(os,{variant:"outline",size:"sm",onClick:d,icon:e.jsx(P,{className:"h-4 w-4"}),className:"text-slate-700 hover:bg-slate-100 border-slate-300",children:"Clear All"}),e.jsx(os,{variant:"ghost",size:"sm",onClick:()=>{},icon:e.jsx(P,{className:"h-4 w-4"}),className:"text-slate-600 hover:bg-slate-100",children:"Close"})]})]})}),e.jsx(Me,{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Quick Filters"})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(os,{variant:"outline",size:"sm",onClick:()=>u("today"),className:"bg-white hover:bg-slate-100 border-slate-300 text-slate-700",children:"Today"}),e.jsx(os,{variant:"outline",size:"sm",onClick:()=>u("thisWeek"),className:"bg-white hover:bg-slate-100 border-slate-300 text-slate-700",children:"This Week"}),e.jsx(os,{variant:"outline",size:"sm",onClick:()=>u("deposits"),className:"bg-white hover:bg-slate-100 border-slate-300 text-slate-700",children:"Deposits"}),e.jsx(os,{variant:"outline",size:"sm",onClick:()=>u("withdrawals"),className:"bg-white hover:bg-slate-100 border-slate-300 text-slate-700",children:"Withdrawals"}),e.jsx(os,{variant:"outline",size:"sm",onClick:()=>u("highValue"),className:"bg-white hover:bg-slate-100 border-slate-300 text-slate-700",children:"High Value (₺10K+)"})]})]}),e.jsxs("div",{className:"border border-slate-200 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"flex items-center justify-between cursor-pointer bg-slate-50 p-3 hover:bg-slate-100 transition-colors",onClick:()=>o("basic"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"transition-transform duration-200 "+(a.basic?"rotate-180":""),children:e.jsx(z,{className:"h-4 w-4 text-slate-600"})}),e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Basic Filters"}),(s.search||s.category&&"all"!==s.category||s.status&&"all"!==s.status)&&e.jsx(ds,{variant:"secondary",size:"sm",className:"bg-slate-900 text-white",children:(s.search?1:0)+(s.category&&"all"!==s.category?1:0)+(s.status&&"all"!==s.status?1:0)})]})}),a.basic&&e.jsx("div",{className:"p-4 bg-white border-t border-slate-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(rs,{label:"Search",children:e.jsx(ts,{placeholder:"Search transactions...",variant:"default",size:"default",value:s.search,onChange:e=>c("search",e.target.value)})}),e.jsx(rs,{label:"Category",children:e.jsxs(qe,{value:s.category,onValueChange:e=>c("category",e),children:[e.jsx(Je,{variant:"default",size:"default",children:e.jsx(Ge,{placeholder:"All Categories"})}),e.jsxs(Xe,{children:[e.jsx(Qe,{value:"all",children:"All Categories"}),e.jsx(Qe,{value:"DEP",children:"Deposit (DEP)"}),e.jsx(Qe,{value:"WD",children:"Withdrawal (WD)"})]})]})}),e.jsx(rs,{label:"Status",children:e.jsxs(qe,{value:s.status,onValueChange:e=>c("status",e),children:[e.jsx(Je,{variant:"default",size:"default",children:e.jsx(Ge,{placeholder:"All Status"})}),e.jsxs(Xe,{children:[e.jsx(Qe,{value:"all",children:"All Status"}),e.jsx(Qe,{value:"completed",children:"Completed"}),e.jsx(Qe,{value:"pending",children:"Pending"}),e.jsx(Qe,{value:"failed",children:"Failed"})]})]})})]})})]}),e.jsxs("div",{className:"border border-slate-200 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"flex items-center justify-between cursor-pointer bg-slate-50 p-3 hover:bg-slate-100 transition-colors",onClick:()=>o("advanced"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"transition-transform duration-200 "+(a.advanced?"rotate-180":""),children:e.jsx(z,{className:"h-4 w-4 text-slate-600"})}),e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Advanced Filters"}),(s.psp&&"all"!==s.psp||s.company&&"all"!==s.company||s.payment_method&&"all"!==s.payment_method||s.currency&&"all"!==s.currency)&&e.jsx(ds,{variant:"secondary",size:"sm",className:"bg-slate-900 text-white",children:(s.psp&&"all"!==s.psp?1:0)+(s.company&&"all"!==s.company?1:0)+(s.payment_method&&"all"!==s.payment_method?1:0)+(s.currency&&"all"!==s.currency?1:0)})]})}),a.advanced&&e.jsx("div",{className:"p-4 bg-white border-t border-slate-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(rs,{label:"PSP",children:e.jsxs(qe,{value:s.psp,onValueChange:e=>c("psp",e),children:[e.jsx(Je,{variant:"default",size:"default",children:e.jsx(Ge,{placeholder:"All PSPs"})}),e.jsxs(Xe,{children:[e.jsx(Qe,{value:"all",children:"All PSPs"}),t.psps.map(s=>e.jsx(Qe,{value:s,children:s},s))]})]})}),e.jsx(rs,{label:"Company",children:e.jsxs(qe,{value:s.company,onValueChange:e=>c("company",e),children:[e.jsx(Je,{variant:"default",size:"default",children:e.jsx(Ge,{placeholder:"All Companies"})}),e.jsxs(Xe,{children:[e.jsx(Qe,{value:"all",children:"All Companies"}),t.companies.map(s=>e.jsx(Qe,{value:s,children:s},s))]})]})}),e.jsx(rs,{label:"Payment Method",children:e.jsxs(qe,{value:s.payment_method,onValueChange:e=>c("payment_method",e),children:[e.jsx(Je,{variant:"default",size:"default",children:e.jsx(Ge,{placeholder:"All Methods"})}),e.jsxs(Xe,{children:[e.jsx(Qe,{value:"all",children:"All Methods"}),t.payment_methods.map(s=>e.jsx(Qe,{value:s,children:s},s))]})]})}),e.jsx(rs,{label:"Currency",children:e.jsxs(qe,{value:s.currency,onValueChange:e=>c("currency",e),children:[e.jsx(Je,{variant:"default",size:"default",children:e.jsx(Ge,{placeholder:"All Currencies"})}),e.jsxs(Xe,{children:[e.jsx(Qe,{value:"all",children:"All Currencies"}),t.currencies.map(s=>e.jsx(Qe,{value:s,children:s},s))]})]})})]})})]}),e.jsxs("div",{className:"border border-slate-200 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"flex items-center justify-between cursor-pointer bg-slate-50 p-3 hover:bg-slate-100 transition-colors",onClick:()=>o("amounts"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"transition-transform duration-200 "+(a.amounts?"rotate-180":""),children:e.jsx(z,{className:"h-4 w-4 text-slate-600"})}),e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Amount Filters"}),(s.amount_min||s.amount_max||s.commission_min||s.commission_max)&&e.jsx(ds,{variant:"secondary",size:"sm",className:"bg-slate-900 text-white",children:(s.amount_min?1:0)+(s.amount_max?1:0)+(s.commission_min?1:0)+(s.commission_max?1:0)})]})}),a.amounts&&e.jsx("div",{className:"p-4 bg-white border-t border-slate-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:g("clients.min_amount")}),e.jsx(ts,{type:"number",placeholder:"0.00",value:s.amount_min,onChange:e=>c("amount_min",e.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:g("clients.max_amount")}),e.jsx(ts,{type:"number",placeholder:"1000000.00",value:s.amount_max,onChange:e=>c("amount_max",e.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:g("clients.min_commission")}),e.jsx(ts,{type:"number",placeholder:"0.00",value:s.commission_min,onChange:e=>c("commission_min",e.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:g("clients.max_commission")}),e.jsx(ts,{type:"number",placeholder:"10000.00",value:s.commission_max,onChange:e=>c("commission_max",e.target.value)})]})]})})]}),e.jsxs("div",{className:"border border-slate-200 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"flex items-center justify-between cursor-pointer bg-slate-50 p-3 hover:bg-slate-100 transition-colors",onClick:()=>o("dates"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"transition-transform duration-200 "+(a.dates?"rotate-180":""),children:e.jsx(z,{className:"h-4 w-4 text-slate-600"})}),e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Date & Sorting"}),(s.date_from||s.date_to||"date"!==s.sort_by||"desc"!==s.sort_order)&&e.jsx(ds,{variant:"secondary",size:"sm",className:"bg-slate-900 text-white",children:(s.date_from?1:0)+(s.date_to?1:0)+("date"!==s.sort_by?1:0)+("desc"!==s.sort_order?1:0)})]})}),a.dates&&e.jsx("div",{className:"p-4 bg-white border-t border-slate-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(rs,{label:"From Date",children:e.jsx(ts,{type:"date",variant:"default",size:"default",value:s.date_from,onChange:e=>c("date_from",e.target.value)})}),e.jsx(rs,{label:"To Date",children:e.jsx(ts,{type:"date",variant:"default",size:"default",value:s.date_to,onChange:e=>c("date_to",e.target.value)})}),e.jsx(rs,{label:"Sort By",children:e.jsxs(qe,{value:s.sort_by,onValueChange:e=>c("sort_by",e),children:[e.jsx(Je,{variant:"default",size:"default",children:e.jsx(Ge,{placeholder:"Sort By"})}),e.jsxs(Xe,{children:[e.jsx(Qe,{value:"created_at",children:"Date Created"}),e.jsx(Qe,{value:"amount",children:"Amount"}),e.jsx(Qe,{value:"commission",children:"Commission"}),e.jsx(Qe,{value:"client_name",children:"Client Name"}),e.jsx(Qe,{value:"psp",children:"PSP"})]})]})}),e.jsx(rs,{label:"Sort Order",children:e.jsxs(qe,{value:s.sort_order,onValueChange:e=>c("sort_order",e),children:[e.jsx(Je,{variant:"default",size:"default",children:e.jsx(Ge,{placeholder:"Sort Order"})}),e.jsxs(Xe,{children:[e.jsx(Qe,{value:"desc",children:"Descending"}),e.jsx(Qe,{value:"asc",children:"Ascending"})]})]})})]})})]}),p>0&&e.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Active Filters"}),e.jsx(ds,{variant:"secondary",size:"sm",className:"bg-slate-900 text-white",children:p})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.search&&e.jsxs(ds,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:['Search: "',s.search,'"']}),s.category&&"all"!==s.category&&e.jsxs(ds,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:["Category: ",s.category]}),s.psp&&"all"!==s.psp&&e.jsxs(ds,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:["PSP: ",s.psp]}),s.company&&"all"!==s.company&&e.jsxs(ds,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:["Company: ",s.company]}),s.payment_method&&"all"!==s.payment_method&&e.jsxs(ds,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:["Method: ",s.payment_method]}),s.currency&&"all"!==s.currency&&e.jsxs(ds,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:["Currency: ",s.currency]}),s.status&&"all"!==s.status&&e.jsxs(ds,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:["Status: ",s.status]}),s.date_from&&e.jsxs(ds,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:["From: ",s.date_from]}),s.date_to&&e.jsxs(ds,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:["To: ",s.date_to]}),s.amount_min&&e.jsxs(ds,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:["Min: ₺",s.amount_min]}),s.amount_max&&e.jsxs(ds,{variant:"secondary",size:"sm",className:"bg-white border border-slate-300 text-slate-700",children:["Max: ₺",s.amount_max]})]})]}),e.jsx("div",{className:"border-t border-slate-200 pt-4 mt-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-slate-600",children:p>0?e.jsxs("span",{children:[p," filter",1!==p?"s":""," applied · Showing ",Math.min(r,n)," of ",n," transactions"]}):e.jsxs("span",{children:["No filters applied · Showing ",Math.min(r,n)," transactions"]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(os,{variant:"outline",size:"sm",onClick:x,disabled:0===n,icon:e.jsx(B,{className:"h-4 w-4"}),iconPosition:"left",children:["Export Displayed (",Math.min(r,n),")"]}),e.jsx(os,{variant:"outline",size:"sm",onClick:h,disabled:l,icon:l?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-slate-600"}):e.jsx(B,{className:"h-4 w-4"}),iconPosition:"left",children:l?"Exporting...":"Export All"}),e.jsx(os,{variant:"outline",size:"sm",onClick:d,disabled:0===p,icon:e.jsx(P,{className:"h-4 w-4"}),children:"Clear All"}),e.jsx(os,{variant:"primary",size:"sm",onClick:m,icon:e.jsx(i,{className:"h-4 w-4"}),iconPosition:"left",children:"Apply Filters"})]})]})})]})})]})}function tt({transaction:s,onView:t,onEdit:a,onDelete:r,normalizePaymentMethodName:n=e=>e}){return e.jsxs("tr",{className:"hover:scale-[1.02] transition-all duration-300 ease-in-out cursor-pointer "+("WD"===s.category?"bg-gray-100 hover:bg-gray-200":"bg-white hover:bg-gray-50"),children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center mr-3 "+("WD"===s.category?"bg-gray-300":"bg-gray-100"),children:e.jsx(D,{className:"h-4 w-4 "+("WD"===s.category?"text-gray-700":"text-gray-600")})}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.client_name||"Unknown"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 border-b border-gray-100",children:s.company||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 border-b border-gray-100",children:n(s.payment_method||"N/A")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 border-b border-gray-100",children:s.category||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900 text-right border-b border-gray-100",children:Gs(s.amount||0,s.currency)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-green-600 text-right border-b border-gray-100",children:Gs(s.commission||0,s.currency)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-600 text-right border-b border-gray-100",children:Gs(s.net_amount||0,s.currency)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 border-b border-gray-100",children:s.currency||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 border-b border-gray-100",children:s.psp||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(ns,{onClick:()=>t(s),variant:"ghost",size:"icon-sm",className:"text-gray-600 hover:text-gray-900",title:"View Details",children:e.jsx(F,{className:"h-3 w-3"})}),e.jsx(ns,{onClick:()=>a(s),variant:"ghost",size:"icon-sm",className:"text-green-600 hover:text-green-900",title:"Edit Transaction",children:e.jsx(K,{className:"h-3 w-3"})}),e.jsx(ns,{onClick:()=>r(s),variant:"ghost",size:"icon-sm",className:"text-red-600 hover:text-red-900",title:"Delete Transaction",children:e.jsx(Y,{className:"h-3 w-3"})})]})})]},s.id)}const at={gray:{text:"text-gray-600",bg:"bg-gray-50",iconBg:"bg-gray-100"},green:{text:"text-green-600",bg:"bg-green-50",iconBg:"bg-green-100"},purple:{text:"text-purple-600",bg:"bg-purple-50",iconBg:"bg-purple-100"},orange:{text:"text-orange-600",bg:"bg-orange-50",iconBg:"bg-orange-100"},red:{text:"text-red-600",bg:"bg-red-50",iconBg:"bg-red-100"},teal:{text:"text-teal-600",bg:"bg-teal-50",iconBg:"bg-teal-100"},indigo:{text:"text-indigo-600",bg:"bg-indigo-50",iconBg:"bg-indigo-100"},pink:{text:"text-pink-600",bg:"bg-pink-50",iconBg:"bg-pink-100"}},rt=({title:s,value:t,icon:a,color:r,subtitle:n,className:l="",animated:i=!1,animationDuration:c=400,showGlass:o=!1})=>{const d=at[r],m="string"==typeof t?parseFloat(t.replace(/[^\d.-]/g,""))||0:t,x=Bs(m,{duration:c,easing:"easeOut",decimals:0,prefix:"string"==typeof t&&t.includes("₺")?"₺":"",suffix:"string"==typeof t&&t.includes("%")?"%":""}),h=i&&!isNaN(m)?x.displayValue:t,u=o?"glass-card card-hover-subtle":"";return e.jsxs(cs,{variant:"elevated",className:`relative overflow-hidden shadow-premium ${u} ${l}`,children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 ${d.bg} rounded-full -translate-y-16 translate-x-16`}),e.jsxs(Me,{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:`w-12 h-12 ${d.bg} rounded-xl flex items-center justify-center shadow-lg`,children:e.jsx(a,{className:`h-6 w-6 ${d.text}`})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:s}),e.jsx("p",{className:"text-lg font-bold text-gray-900 transition-all duration-75 ease-out",style:{fontVariantNumeric:"tabular-nums",willChange:i?"contents":"auto"},children:h}),n&&e.jsx("p",{className:"text-xs text-gray-500",children:n})]})]})]})},nt=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{t:t}=Pe(),{isAuthenticated:a,isLoading:m}=Le(),x=f(),{refreshPSPDataSilent:h}=(()=>{const e=r.useCallback(async()=>{try{Fe.clearCacheForUrl("psp_summary_stats");const e=await Fe.get("/transactions/psp_summary_stats");if(200===e.status)return Fe.parseResponse(e);throw new Error("Failed to fetch PSP data")}catch(I){throw I}},[]),s=r.useCallback(async()=>{try{await e()}catch(I){}},[e]);return{refreshPSPData:e,refreshPSPDataSilent:s}})(),v=r.useRef(!1),w=r.useRef(!1),_=r.useRef(0);r.useEffect(()=>{try{localStorage.removeItem("pipeline_clients_data"),localStorage.removeItem("pipeline_transactions_data"),localStorage.removeItem("pipeline_dashboard_cache")}catch(e){}},[]);const[k,S]=r.useState([]),[C,T]=r.useState([]),[A,R]=r.useState(null),[$,L]=r.useState(!1),[I,z]=r.useState(null),[se,te]=r.useState(null),[ae,re]=r.useState({clients:!1,transactions:!1,analytics:!1,dropdowns:!1,allLoaded:!1}),[ne,le]=r.useState(null);r.useState([]);const[ie,ce]=r.useState(!1),[oe,de]=r.useState(!1),[me,xe]=r.useState(!1);r.useState(!1);const[he,ue]=r.useState(""),[ge,pe]=r.useState(!1);r.useState(new Set);const[je,ye]=r.useState({});r.useState({});const[be,fe]=r.useState(!1),[Ne,ve]=r.useState(null),[we,_e]=r.useState(!1),[ke,Se]=r.useState(""),[Ce,De]=r.useState({}),[Te,Ee]=r.useState(!1),[Ae,Re]=r.useState(""),[$e,Ue]=r.useState(""),[Ie,Ve]=r.useState(!1),[qe,Je]=r.useState(!1),[Ge,Xe]=r.useState(""),[Qe,Ze]=r.useState(48.9);r.useEffect(()=>{(async()=>{try{const e=await Fe.get("/exchange-rates/current");if(e.ok){const s=await Fe.parseResponse(e);s&&s.rates&&s.rates.USD_TRY&&Ze(s.rates.USD_TRY.rate)}}catch(e){}})()},[]);const[es,ss]=r.useState({psps:[],categories:[],payment_methods:[],currencies:[],companies:[]}),[as,rs]=r.useState({search:"",category:"all",psp:"all",company:"all",payment_method:"all",currency:"all",status:"all",date_from:"",date_to:"",amount_min:"",amount_max:"",commission_min:"",commission_max:"",client_name:"",sort_by:"date",sort_order:"desc"}),[ls,is]=r.useState(!1),[ms,xs]=r.useState({basic:!0,advanced:!1,amounts:!1,dates:!1}),[hs,Cs]=r.useState({currentOffset:0,itemsPerLoad:100,total:0,hasMore:!0,loading:!1,oldestDate:null}),[Ds,Ts]=r.useState(100),[Fs,Es]=r.useState(!1),As=N(),[Rs,Ps]=$s("overview"),[Ls,Us]=r.useState(!1),[Ms,Os]=r.useState(!1),[zs,Bs]=r.useState(null),[Ks,Ys]=r.useState(!1),[Ws,Hs]=r.useState(!1),[Vs,Gs]=r.useState(!1),[Zs,at]=r.useState(!1),[nt,lt]=r.useState(!1),[it,ct]=r.useState(null),[ot,dt]=r.useState(!1),[mt,xt]=r.useState(!1),[ht,ut]=r.useState(!1),[gt,pt]=r.useState([]),[jt,yt]=r.useState([]),[bt,ft]=r.useState(!1),[Nt,vt]=r.useState(""),wt=r.useCallback(async()=>{if(!w.current&&!v.current&&a&&!m){w.current=!0,L(!0),z(null);try{const[e,s,t]=await Promise.allSettled([kt(),St(),Ct()]);re(a=>({...a,clients:"fulfilled"===e.status,dropdowns:"fulfilled"===s.status,transactions:"fulfilled"===t.status,allLoaded:!0})),"fulfilled"===e.status&&te(null),"fulfilled"===t.status&&z(null),v.current=!0}catch(e){z("Failed to load data. Please try again.")}finally{w.current=!1,L(!1)}}},[a,m]);r.useEffect(()=>{const e=e=>{const s=e;s?.detail?.skipCurrentPage||a&&!m&&("create"===s?.detail?.action&&Cs(e=>({...e,currentOffset:0,hasMore:!0,oldestDate:null})),Ct(!0),kt())};return window.addEventListener("transactionsUpdated",e),()=>{window.removeEventListener("transactionsUpdated",e)}},[a,m]),r.useEffect(()=>()=>{zs&&clearTimeout(zs)},[zs]);const _t=r.useCallback(async()=>{if(!$)try{L(!0),z(null),Cs(e=>({...e,currentOffset:0,hasMore:!0,oldestDate:null})),await Ct(!0,!1)}catch(e){const s=(e=>qs.handleApiError(e,"fetchTransactions"))(e);z((e=>qs.getUserFriendlyMessage(e))(s))}finally{L(!1),Os(!1),zs&&(clearTimeout(zs),Bs(null))}},[as,hs.itemsPerLoad,$]);r.useEffect(()=>{Ls||"/transactions"===As.pathname&&(Ps("transactions"),a&&!m&&0===C.length&&wt())},[As.pathname,a,m,Ls,wt]),r.useEffect(()=>{if(a&&!m)0===k.length&&0===C.length&&wt();else if(!a&&!m&&(k.length>0||C.length>0)){S([]),T([]),z(null);try{localStorage.removeItem("pipeline_clients_data"),localStorage.removeItem("pipeline_transactions_data")}catch(e){}}},[a,m,wt]),r.useEffect(()=>{},[Rs]),r.useEffect(()=>{"transactions"!==Rs||!a||m||0!==C.length||$||Ct()},[Rs,a,m]),r.useEffect(()=>{try{const e=localStorage.getItem("clients_transactions_display_limit");if(e&&"transactions"===Rs){const s=parseInt(e,10);!isNaN(s)&&s>=100?Ts(s):Ts(100)}else Ts(100)}catch(e){Ts(100)}},[As.pathname,Rs]),r.useEffect(()=>{if("transactions"===Rs&&Ds>0)try{localStorage.setItem("clients_transactions_display_limit",Ds.toString())}catch(e){}},[Ds,Rs]);const kt=async()=>{try{if(Date.now()-_.current<5e3)return[];if(te(null),!a)return te("Authentication required"),[];const e=await Fe.get(`/transactions/clients?_t=${Date.now()}&_refresh=${Math.random()}`);if(401===e.status)return[];if(e.ok){const s=await Fe.parseResponse(e);let t,a=null;s&&"object"==typeof s&&"clients"in s?(t=s.clients||[],a=s.summary||null):t=Array.isArray(s)?s:[];const r=t.map(e=>({client_name:e.client_name||"Unknown",company_name:e.company_name||null,payment_method:e.payment_method||null,category:e.category||null,total_amount:e.total_amount||0,total_commission:e.total_commission||0,total_net:e.total_net||0,transaction_count:e.transaction_count||0,first_transaction:e.first_transaction||"",last_transaction:e.last_transaction||"",currencies:e.currencies||[],psps:e.psps||[],avg_transaction:e.avg_transaction||0}));return S(r),R(a),te(null),r}return te("Failed to load clients data"),S([]),[]}catch(e){return te("Failed to load clients data. Please try again."),S([]),[]}},St=async()=>{try{const e=await Fe.get("/transactions/dropdown-options");if(e.ok){const s=await Fe.parseResponse(e);return s&&ss({currencies:(s.currencies||s.currency||[]).map(e=>e.value),payment_methods:(s.payment_method||[]).map(e=>e.value),categories:(s.category||[]).map(e=>e.value),psps:(s.psp||[]).map(e=>e.value),companies:(s.company||[]).map(e=>e.value)}),s}return{}}catch(e){return{}}},Ct=async(e=!1,s=!1)=>{try{const r=Date.now();if(!e&&!s&&r-_.current<5e3)return[];if(_.current=r,!a)return[];if($&&!e)return[];const n=new URLSearchParams;if(n.append("page","1"),n.append("per_page",hs.itemsPerLoad.toString()),as.search&&""!==as.search.trim()&&n.append("search",as.search),as.category&&""!==as.category.trim()&&"all"!==as.category&&n.append("category",as.category),as.psp&&""!==as.psp.trim()&&"all"!==as.psp&&n.append("psp",as.psp),as.company&&""!==as.company.trim()&&"all"!==as.company&&n.append("company",as.company),as.payment_method&&""!==as.payment_method.trim()&&"all"!==as.payment_method&&n.append("payment_method",as.payment_method),as.currency&&""!==as.currency.trim()&&"all"!==as.currency&&n.append("currency",as.currency),as.status&&""!==as.status.trim()&&"all"!==as.status&&n.append("status",as.status),as.date_from&&""!==as.date_from.trim()&&n.append("date_from",as.date_from),s&&hs.oldestDate){const e=new Date(hs.oldestDate);e.setDate(e.getDate()-1),n.append("date_to",e.toISOString().split("T")[0])}else as.date_to&&""!==as.date_to.trim()&&n.append("date_to",as.date_to);as.amount_min&&""!==as.amount_min.trim()&&n.append("amount_min",as.amount_min),as.amount_max&&""!==as.amount_max.trim()&&n.append("amount_max",as.amount_max),as.commission_min&&""!==as.commission_min.trim()&&n.append("commission_min",as.commission_min),as.commission_max&&""!==as.commission_max.trim()&&n.append("commission_max",as.commission_max),as.client_name&&""!==as.client_name.trim()&&n.append("client",as.client_name),as.sort_by&&""!==as.sort_by.trim()&&n.append("sort_by",as.sort_by),as.sort_order&&""!==as.sort_order.trim()&&n.append("sort_order",as.sort_order);const l=await Fe.get(`/transactions/?${n.toString()}`);if(401===l.status)return T([]),z("Authentication required. Please log in again."),[];if(!l.ok){try{const e=await Fe.parseResponse(l),s=e?.message||e?.error||`Failed to fetch transactions: ${l.status} ${l.statusText}`;z(s)}catch(t){z(`Failed to fetch transactions: ${l.status} ${l.statusText}`)}return[]}const i=l.data;if(l.ok){const e=await Fe.parseResponse(l);let t=[];Array.isArray(e)?t=e:i?.data&&Array.isArray(i.data)?t=i.data:Array.isArray(e?.transactions)?t=e.transactions:Array.isArray(e?.meta?.transactions)&&(t=e.meta.transactions);const a=i?.meta?.pagination?.total||i?.meta?.total||e?.pagination?.total||e?.meta?.pagination?.total||0;if(t.length,t.length>0){const e=t.map(e=>e.date).filter(Boolean);e.length>0&&Math.min(...e.map(e=>new Date(e).getTime())),e.length>0&&Math.max(...e.map(e=>new Date(e).getTime()))}T(s?e=>{const s=new Set(e.map(e=>e.id)),a=t.filter(e=>!s.has(e.id)&&!(hs.oldestDate&&e.date&&new Date(e.date).toISOString().split("T")[0]>=new Date(hs.oldestDate).toISOString().split("T")[0]));return[...e,...a]}:t);let r=hs.oldestDate;if(t.length>0){const e=t.map(e=>e.date||e.created_at).filter(e=>null!=e).sort();if(e.length>0){const s=e[0];(!r||s<r)&&(r=s)}}const n=a||0,c=s?hs.currentOffset+t.length:t.length,o=t.length===hs.itemsPerLoad,d=s?hs.currentOffset+t.length:t.length,m=o||n>0&&!(n>0&&d>=n);return Cs(e=>({...e,currentOffset:c,total:n,hasMore:m,oldestDate:r})),Rt(t),t}return[]}catch(r){return z(`Failed to load transactions: ${r instanceof Error?r.message:"Unknown error"}`),[]}},Dt=async()=>{L(!0),await kt(),L(!1)},Tt=()=>Object.values(as).filter(e=>e&&"created_at"!==e&&"desc"!==e).length,Ft=(e,s)=>Js(e,s||"USD"),Et=e=>{if(!e)return"N/A";const s=new Date(e),t=new Date,a=new Date(t);return a.setDate(a.getDate()-1),s.toDateString()===t.toDateString()?"Today":s.toDateString()===a.toDateString()?"Yesterday":s.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},At=e=>{const s=e.reduce((e,s)=>{const t=s.date||"Unknown";return e[t]||(e[t]=[]),e[t].push(s),e},{}),t=Object.entries(s).sort(([e],[s])=>s.localeCompare(e)).map(([e,s])=>({dateKey:e,date:e,transactions:s.sort((e,s)=>{const t=e.date?new Date(e.date).getTime():0;return(s.date?new Date(s.date).getTime():0)-t}),grossBalance:Ce[e]||null}));return t.slice(0,3).forEach((e,s)=>{}),t},Rt=async e=>{const s=[...new Set(e.map(e=>e.date).filter(Boolean))],t={};if(0!==s.length){try{const e=s.join(","),r=await fetch(`/api/summary/batch?dates=${encodeURIComponent(e)}`,{credentials:"include",headers:{Accept:"application/json"}});if(r.ok){const e=await r.json();e&&e.success&&e.summaries&&Object.entries(e.summaries).forEach(([e,s])=>{if(s&&void 0!==s.gross_balance_tl){let a=Number(s.exchange_rate)||0;0!==a&&s.exchange_rate||(a=Qe||48),t[e]={tl:Number(s.gross_balance_tl)||0,usd:Number(s.gross_balance_usd)||0,rate:a}}})}else try{await r.json()}catch(a){}}catch(r){r instanceof Error&&r.message}De(t)}else De(t)},$t=(e,s)=>{const t=e.map(e=>{const s=e=>{if(null==e)return"";const s=String(e);return s.includes(",")||s.includes('"')||s.includes("\n")?`"${s.replace(/"/g,'""')}"`:s},t=e.amount&&e.amount>0?((e.commission||0)/e.amount*100).toFixed(2):0;return[s(e.id),s(e.date),s(e.client_name||"Unknown"),s(e.payment_method||"-"),s(e.psp||"-"),s(e.amount_tl||e.amount||0),s(e.amount_usd||0),s(e.currency||"TRY"),s(e.transaction_type||e.category||"deposit"),s(t+"%"),s(e.commission_tl||e.commission||0),s(e.net_amount_tl||e.net_amount||0),s(e.notes||""),s(e.created_at)]}),a=[["ID","Date","Client Name","Payment Method","PSP","Amount (TRY)","Amount (USD)","Currency","Transaction Type","Commission Rate","Commission Amount","Net Amount","Description","Created At"].join(","),...t.map(e=>e.join(","))].join("\n"),r=new Blob(["\ufeff"+a],{type:"text/csv;charset=utf-8;"}),n=window.URL.createObjectURL(r),l=document.createElement("a");l.href=n,l.download=s,l.click(),window.URL.revokeObjectURL(n)},Pt=async()=>{Es(!0);try{const e=[],s=500;let t=1,a=!0,r=1;const n=new URLSearchParams;for(as.search&&""!==as.search.trim()&&n.append("search",as.search),as.client_name&&""!==as.client_name.trim()&&"all"!==as.client_name&&n.append("client_name",as.client_name),as.payment_method&&""!==as.payment_method.trim()&&"all"!==as.payment_method&&n.append("payment_method",as.payment_method),as.psp&&""!==as.psp.trim()&&"all"!==as.psp&&n.append("psp",as.psp),as.date_from&&""!==as.date_from.trim()&&n.append("date_from",as.date_from),as.date_to&&""!==as.date_to.trim()&&n.append("date_to",as.date_to),as.amount_min&&""!==as.amount_min.trim()&&n.append("amount_min",as.amount_min),as.amount_max&&""!==as.amount_max.trim()&&n.append("amount_max",as.amount_max);a&&t<=r;){const l=new URLSearchParams(n);l.append("per_page",s.toString()),l.append("page",t.toString());const i=await Fe.get(`/transactions/?${l.toString()}`),c=await Fe.parseResponse(i),o=c.transactions||[];if(e.push(...o),c.pagination?(r=c.pagination.pages||1,a=t<r&&o.length===s):a=o.length===s,t++,t>100)break}const l=(new Date).toISOString().split("T")[0],i=`transactions_all_${e.length}_${l}.csv`;$t(e,i)}catch(e){alert(t("transactions.export_failed"))}finally{Es(!1)}},Lt=async e=>{const s=e.target,t=s.files?.[0];if(!t)return;const a=t.name.split(".").pop()?.toLowerCase();if("xlsx"===a||"xls"===a){dt(!0);try{const e=new FormData;e.append("file",t);const s=["HAZIRAN","TEMMUZ","AĞUSTOS","EKİM","KASIM"];e.append("sheets",JSON.stringify(s));const a=await fetch("/api/v1/transactions/import-excel",{method:"POST",body:e,credentials:"include"});if(!a.ok){const e=await a.json();throw new Error(e.message||"Import failed")}const r=await a.json();let n="Excel Import Completed!\n\n";n+=`✅ Imported: ${r.data.imported_count} transactions\n`,n+=`⚠️ Skipped: ${r.data.skipped_count} rows\n`,n+=`📄 Sheets processed: ${r.data.sheets_processed}\n`,r.data.warnings&&r.data.warnings.length>0&&(n+=`\n⚠️ Warnings (${r.data.warnings.length}):\n`,r.data.warnings.slice(0,5).forEach(e=>n+=`• ${e}\n`),r.data.warnings.length>5&&(n+=`• ... and ${r.data.warnings.length-5} more\n`)),r.data.errors&&r.data.errors.length>0&&(n+=`\n❌ Errors (${r.data.errors.length}):\n`,r.data.errors.slice(0,5).forEach(e=>n+=`• ${e}\n`)),alert(n),"transactions"===Rs&&await _t(),await Dt(),await Qt()}catch(r){alert(`Import Error: ${r.message}\n\nPlease check the file format and try again.`)}finally{dt(!1)}}else alert("Please upload an Excel file (.xlsx or .xls)")},Ut=e=>{ct(e),at(!0)},Mt=async e=>{try{await St();const s=await Fe.get(`/transactions/${e.id}`);if(s.ok){const e=await Fe.parseResponse(s);ct(e.transaction||e),lt(!0)}else ct(e),lt(!0)}catch(s){ct(e),lt(!0)}},It=async e=>{if(confirm(`${t("transactions.confirm_delete_transaction")}\n\n${t("transactions.client_name")}: ${e.client_name}\n${t("common.amount")}: ${Ft(e.amount,e.currency)}`))try{const a=await Fe.delete(`/transactions/${e.id}`);if(a.ok){const r=await Fe.parseResponse(a);if(r?.success){T(s=>s.filter(s=>s.id!==e.id)),Cs(e=>({...e,total:e.total>0?e.total-1:0}));try{await h()}catch(s){}window.dispatchEvent(new CustomEvent("transactionsUpdated",{detail:{action:"delete",transactionId:e.id}})),alert(t("transactions.transaction_deleted_success"))}else alert(r?.message||t("transactions.failed_delete_transaction"))}else{const e=await Fe.parseResponse(a);alert(e?.message||t("transactions.failed_delete_transaction"))}}catch(a){const e=a instanceof Error?a.message:"Unknown error";alert(`${t("transactions.delete_transaction_error")}: ${e}`)}},Ot=()=>{Ys(!1),Hs(!1),ce(!1),xe(!1),le(null)},zt=Array.isArray(k)?k.filter(e=>{const s=!as.search||e.client_name.toLowerCase().includes(as.search.toLowerCase())||e.company_name&&e.company_name.toLowerCase().includes(as.search.toLowerCase()),t=!as.client_name||e.client_name.toLowerCase().includes(as.client_name.toLowerCase()),a=!as.payment_method||"all"===as.payment_method||e.payment_method&&e.payment_method.toLowerCase().includes(as.payment_method.toLowerCase()),r=!as.category||"all"===as.category||e.category&&e.category.toLowerCase().includes(as.category.toLowerCase()),n=!as.psp||"all"===as.psp||Array.isArray(e.psps)&&e.psps.some(e=>e.toLowerCase().includes(as.psp.toLowerCase())),l=!as.currency||"all"===as.currency||Array.isArray(e.currencies)&&e.currencies.some(e=>e.toLowerCase().includes(as.currency.toLowerCase()));return s&&t&&a&&r&&n&&l}):[],Bt=Array.isArray(zt)&&zt.length>0?zt.reduce((e,s)=>e+s.total_amount,0):Array.isArray(k)&&k.length>0?k.reduce((e,s)=>e+s.total_amount,0):0,Kt=Array.isArray(zt)&&zt.length>0?zt.reduce((e,s)=>e+s.total_commission,0):Array.isArray(k)&&k.length>0?k.reduce((e,s)=>e+s.total_commission,0):0,[Yt,Wt]=(Array.isArray(zt)&&zt.length>0?zt.reduce((e,s)=>e+s.transaction_count,0):Array.isArray(k)&&k.length>0&&k.reduce((e,s)=>e+s.transaction_count,0),r.useState(null)),[Ht,Vt]=r.useState(null),[qt,Jt]=r.useState(0),Gt=r.useCallback(async()=>{try{const e=await Fe.get("/analytics/dashboard/stats?range=all");if(e.ok){const s=await Fe.parseResponse(e);Wt({total_revenue:s.summary?.total_revenue||0,total_commission:s.summary?.total_commission||0,net_cash:s.summary?.net_cash||0,total_deposits:s.summary?.total_deposits||0,total_withdrawals:s.summary?.total_withdrawals||0})}}catch(e){}},[]),Xt=e=>{const s={KK:"Credit Card",BANKA:"Bank",Banka:"Bank",BANK:"Bank",CC:"Credit Card",CARD:"Credit Card","CREDIT CARD":"Credit Card",CASH:"Cash",WIRE:"Wire Transfer",TRANSFER:"Transfer",PAYPAL:"PayPal",STRIPE:"Stripe",SQUARE:"Square",TETHER:"Tether",USDT:"Tether",UNKNOWN:"Unknown"};if(s[e])return s[e];const t=e.toUpperCase();return s[t]?s[t]:t.includes("CREDIT")&&t.includes("CARD")?"Credit Card":t.includes("BANK")?"Bank":t.includes("TETHER")||t.includes("USDT")?"Tether":e},Qt=r.useCallback(async()=>{try{const e=await Fe.get("/transactions/?per_page=500&page=1");if(200===e.status){const s=Fe.parseResponse(e),t=s&&s.transactions&&Array.isArray(s.transactions)?s.transactions:[],a={};t.forEach(e=>{const s=e.payment_method||"Unknown",t=Xt(s);a[t]||(a[t]={deposits:0,withdrawals:0,total:0,count:0});const r=s.toLowerCase().includes("tether")||"TETHER"===s?e.amount||0:null!==e.amount_tl&&void 0!==e.amount_tl?e.amount_tl:e.amount||0;a[t].count+=1,"DEP"===e.category||"Deposit"===e.category||"Investment"===e.category?(a[t].deposits+=r,a[t].total+=r):"WD"!==e.category&&"Withdraw"!==e.category&&"Withdrawal"!==e.category||(a[t].withdrawals+=r,a[t].total-=r)}),Vt(a),Jt(t.length)}}catch(e){}},[]);r.useEffect(()=>{a&&!m&&(Gt(),Qt())},[a,m]);const Zt=r.useMemo(()=>{if(Yt)return{totalDeposits:Yt.total_deposits,totalWithdrawals:Yt.total_withdrawals};if(!Array.isArray(C))return{totalDeposits:0,totalWithdrawals:0};const e=C.filter(e=>"DEP"===e.category||"Deposit"===e.category||"Investment"===e.category),s=C.filter(e=>"WD"===e.category||"Withdraw"===e.category||"Withdrawal"===e.category);return{totalDeposits:e.reduce((e,s)=>e+(null!==s.amount_tl&&void 0!==s.amount_tl?s.amount_tl:s.amount||0),0),totalWithdrawals:s.reduce((e,s)=>e+(null!==s.amount_tl&&void 0!==s.amount_tl?s.amount_tl:s.amount||0),0)}},[Yt,C]),{totalDeposits:ea,totalWithdrawals:sa}=Zt;r.useMemo(()=>{if(Ht&&Object.keys(Ht).length>0)return Ht;if(!Array.isArray(C))return{};const e={};return C.forEach(s=>{const t=s.payment_method||"Unknown",a=Xt(t);e[a]||(e[a]={deposits:0,withdrawals:0,total:0,count:0});const r=t.toLowerCase().includes("tether")||"TETHER"===t?s.amount||0:null!==s.amount_tl&&void 0!==s.amount_tl?s.amount_tl:s.amount||0;e[a].count+=1,"DEP"===s.category||"Deposit"===s.category||"Investment"===s.category?(e[a].deposits+=r,e[a].total+=r):"WD"!==s.category&&"Withdraw"!==s.category&&"Withdrawal"!==s.category||(e[a].withdrawals+=r,e[a].total-=r)}),e},[Ht,C]);const ta=()=>{Ee(!1),Re(""),Ue("")},aa=async e=>{try{_e(!0),Se(e);const t=await Fe.get(`/api/summary/${e}`);if(t.ok){const e=await Fe.parseResponse(t),s={...e,usd_rate:null!==e.usd_rate&&void 0!==e.usd_rate?"number"==typeof e.usd_rate?e.usd_rate:Number(e.usd_rate):null,gross_balance_tl:void 0!==e.gross_balance_tl?Number(e.gross_balance_tl):void 0,gross_balance_usd:void 0!==e.gross_balance_usd?Number(e.gross_balance_usd):void 0,total_deposits_tl:void 0!==e.total_deposits_tl?Number(e.total_deposits_tl):0,total_deposits_usd:void 0!==e.total_deposits_usd?Number(e.total_deposits_usd):0,total_withdrawals_tl:void 0!==e.total_withdrawals_tl?Number(e.total_withdrawals_tl):0,total_withdrawals_usd:void 0!==e.total_withdrawals_usd?Number(e.total_withdrawals_usd):0};ve(s),fe(!0)}else{try{await Fe.parseResponse(t)}catch(s){}const a={date:e,date_str:new Date(e).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),usd_rate:null,total_amount_tl:0,total_amount_usd:0,total_commission_tl:0,total_commission_usd:0,total_net_tl:0,total_net_usd:0,transaction_count:0,unique_clients:0,psp_summary:[],category_summary:[],payment_method_summary:[],transactions:[]};ve(a),fe(!0)}}catch(t){t instanceof Error&&t.message;const s={date:e,date_str:new Date(e).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),usd_rate:null,total_amount_tl:0,total_amount_usd:0,total_commission_tl:0,total_commission_usd:0,total_net_tl:0,total_net_usd:0,transaction_count:0,unique_clients:0,psp_summary:[],category_summary:[],payment_method_summary:[],transactions:[]};ve(s),fe(!0)}finally{_e(!1)}},ra=()=>{const e=C.reduce((e,s)=>{const t=s.payment_method||"Unknown",a=Xt(t);return e[a]||(e[a]={method:a,volume:0,count:0}),e[a].volume+=Math.abs(s.amount),e[a].count+=1,e},{});return Object.values(e).sort((e,s)=>s.volume-e.volume).slice(0,5)},na=["#3b82f6","#8b5cf6","#10b981","#f59e0b","#ef4444","#06b6d4"];if(m)return e.jsx(Is,{});if(I&&!se)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 mb-4",children:e.jsx(l,{className:"h-16 w-16 mx-auto"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Application Error"}),e.jsx("p",{className:"text-gray-600 mb-6",children:I}),e.jsxs(ns,{variant:"default",onClick:()=>window.location.reload(),className:"inline-flex items-center gap-2",children:[e.jsx(i,{className:"h-4 w-4"}),"Reload Page"]})]})});const la=(e,s)=>{if("essential"===e)if("csv"===s){const e=new Blob(["Client,Company,Payment Method,Category,Amount,Currency,PSP,Date\nJohn Doe,ABC Corporation,Credit Card,DEP,1000.50,USD,Stripe,2025-08-18\nJane Smith,XYZ Ltd,Bank Transfer,WIT,2500.00,EUR,PayPal,2025-08-19\nMike Johnson,Global Inc,TR1122334455,Wire Transfer,DEP,5000.00,GBP,Bank of America,2025-08-20"],{type:"text/csv"}),s=window.URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="essential_transaction_template.csv",t.click(),window.URL.revokeObjectURL(s)}else{const e=[["Client","Company","Payment Method","Category","Amount","Currency","PSP","Date"],["John Doe","ABC Corporation","Credit Card","DEP",1000.5,"USD","Stripe","2025-08-18"],["Jane Smith","XYZ Ltd","Bank Transfer","WIT",2500,"EUR","PayPal","2025-08-19"],["Mike Johnson","Global Inc","TR1122334455","Wire Transfer","DEP",5e3,"GBP","Bank of America","2025-08-20"]],s=Z.aoa_to_sheet(e),t=Z.book_new();Z.book_append_sheet(t,s,"Transactions"),ee(t,"essential_transaction_template.xlsx")}else if("csv"===s){const e=new Blob(["Client,Company,Payment Method,Category,Amount,Commission,Net Amount,Currency,PSP,Date,Notes\nJohn Doe,ABC Corporation,Credit Card,DEP,1000.50,25.00,975.50,USD,Stripe,2025-08-18,Monthly payment\nJane Smith,XYZ Ltd,Bank Transfer,WIT,2500.00,50.00,2450.00,EUR,PayPal,2025-08-19,Quarterly transfer\nMike Johnson,Global Inc,TR1122334455,Wire Transfer,DEP,5000.00,100.00,4900.00,GBP,Bank of America,2025-08-20,Annual deposit"],{type:"text/csv"}),s=window.URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="full_transaction_template.csv",t.click(),window.URL.revokeObjectURL(s)}else{const e=[["Client","Company","Payment Method","Category","Amount","Commission","Net Amount","Currency","PSP","Date","Notes"],["John Doe","ABC Corporation","Credit Card","DEP",1000.5,25,975.5,"USD","Stripe","2025-08-18","Monthly payment"],["Jane Smith","XYZ Ltd","Bank Transfer","WIT",2500,50,2450,"EUR","PayPal","2025-08-19","Quarterly transfer"],["Mike Johnson","Global Inc","TR1122334455","Wire Transfer","DEP",5e3,100,4900,"GBP","Bank of America","2025-08-20","Annual deposit"]],s=Z.aoa_to_sheet(e),t=Z.book_new();Z.book_append_sheet(t,s,"Transactions"),ee(t,"full_transaction_template.xlsx")}};return $?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading clients..."})]})}):e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(d,{className:"h-8 w-8 text-gray-600"}),t("clients.title")]}),e.jsx("p",{className:"text-gray-600",children:t("clients.description")})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(os,{variant:"outline",size:"sm",onClick:Pt,disabled:Fs,icon:Fs?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}):e.jsx(B,{className:"h-4 w-4"}),iconPosition:"left",className:"bg-blue-50 border-blue-300 text-blue-700 hover:bg-blue-100",children:t(Fs?"common.loading":"clients.export_all_transactions")}),e.jsx(os,{variant:"outline",size:"sm",onClick:()=>{const e=document.createElement("input");e.type="file",e.accept=".xlsx,.xls",e.onchange=Lt,e.click()},disabled:ot,icon:e.jsx(W,{className:"h-4 w-4"}),iconPosition:"left",className:"bg-green-50 border-green-300 text-green-700 hover:bg-green-100",children:t(ot?"common.loading":"clients.import")}),e.jsx(os,{variant:"outline",size:"sm",onClick:()=>ft(!0),disabled:ot,icon:e.jsx(c,{className:"h-4 w-4"}),iconPosition:"left",className:"bg-purple-50 border-purple-300 text-purple-700 hover:bg-purple-100",children:"Paste & Import"}),e.jsx(os,{variant:"outline",size:"sm",onClick:()=>xt(!0),icon:e.jsx(E,{className:"h-4 w-4"}),iconPosition:"left",className:"bg-gray-50 border-gray-300 text-gray-700 hover:bg-gray-100",children:t("clients.guide")}),e.jsx(os,{variant:"outline",size:"sm",onClick:()=>xe(!0),icon:e.jsx(Y,{className:"h-4 w-4"}),iconPosition:"left",className:"bg-red-50 border-red-300 text-red-700 hover:bg-red-100",children:t("clients.bulk")}),e.jsx(os,{variant:"outline",size:"sm",onClick:()=>{},icon:e.jsx(o,{className:"h-4 w-4"}),iconPosition:"left",className:"bg-gray-50 border-gray-300 text-gray-500 cursor-not-allowed opacity-60",disabled:!0,children:t("clients.brate")}),e.jsx(os,{variant:"outline",size:"sm",onClick:async()=>{try{await Dt(),await _t(),await(async()=>{try{Fe.clearCacheForUrl("psp_summary_stats");const e=await Fe.get("/transactions/psp_summary_stats");if(200===e.status)return Fe.parseResponse(e);throw new Error("Failed to fetch PSP data")}catch(e){throw e}})(),alert(t("transactions.data_refreshed"))}catch(e){const s=e instanceof Error?e.message:"Unknown error";alert(`${t("transactions.error_refreshing_data")}: ${s}`)}},icon:e.jsx(i,{className:"h-4 w-4"}),iconPosition:"left",className:"bg-gray-50 border-gray-300 text-gray-700 hover:bg-gray-100",children:t("clients.fetch")}),e.jsx(os,{variant:"primary",size:"sm",onClick:()=>x("/transactions/add"),icon:e.jsx(H,{className:"h-4 w-4"}),iconPosition:"left",children:t("clients.add_transaction")})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gray-50/50 border border-gray-200/60 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("span",{className:"font-medium",children:[t("dashboard.active_clients"),": ",k.length]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),e.jsxs("span",{className:"font-medium",children:[t("clients.total_volume"),": ",Ft(Bt,"₺")]})]})]})}),e.jsxs(Oe,{value:Rs,onValueChange:e=>{const s=e;Ps(e),"transactions"===Rs&&"transactions"!==s&&Ts(100)},className:"w-full",children:[e.jsxs(ze,{className:"grid w-full grid-cols-4 bg-gray-50/80 border border-gray-200/60 rounded-lg shadow-sm",children:[e.jsxs(Be,{value:"overview",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg data-[state=active]:border data-[state=active]:border-gray-200",children:[e.jsx(n,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-blue-600"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:t("tabs.overview")})]}),e.jsxs(Be,{value:"clients",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg data-[state=active]:border data-[state=active]:border-gray-200",children:[e.jsx(d,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-blue-600"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:t("navigation.clients")})]}),e.jsxs(Be,{value:"transactions",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg data-[state=active]:border data-[state=active]:border-gray-200",children:[e.jsx(c,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-blue-600"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:t("navigation.transactions")})]}),e.jsxs(Be,{value:"analytics",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg data-[state=active]:border data-[state=active]:border-gray-200",children:[e.jsx(V,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-blue-600"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:t("tabs.analytics")})]})]}),e.jsxs(Ke,{value:"overview",className:"mt-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(n,{className:"h-5 w-5 text-gray-600"}),t("clients.financial_overview")]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t("clients.key_financial_metrics")})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(rt,{title:t("ledger.total_deposits"),value:Ft(Yt?.total_deposits||ea,"₺"),subtitle:t("clients.all_dep_transactions"),icon:o,color:"green",animated:!0,animationDuration:500,showGlass:!0}),e.jsx(rt,{title:t("ledger.total_withdrawals"),value:Ft(Math.abs(Yt?.total_withdrawals||sa),"₺"),subtitle:t("clients.all_wd_transactions"),icon:q,color:"red",animated:!0,animationDuration:500,showGlass:!0}),e.jsx(rt,{title:t("dashboard.net_cash"),value:Ft((Yt?.total_deposits||ea)-(Yt?.total_withdrawals||sa),"₺"),subtitle:t("clients.all_transactions_net"),icon:y,color:(Yt?.total_deposits||ea)-(Yt?.total_withdrawals||sa)>=0?"gray":"red",animated:!0,animationDuration:500}),e.jsx(rt,{title:t("dashboard.total_commissions"),value:Ft(Yt?.total_commission||Kt,"₺"),subtitle:t("clients.all_transactions_commission"),icon:c,color:"purple",animated:!0,animationDuration:500})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(d,{className:"h-5 w-5 text-gray-600"}),t("clients.client_insights")]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t("clients.distribution_top_performers")})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(cs,{variant:"elevated",className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-4 right-4 w-20 h-20 bg-gray-100 rounded-full opacity-20"}),e.jsx(Me,{className:"p-6 relative",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"bg-gray-100 p-3 rounded-lg",children:e.jsx(d,{className:"h-6 w-6 text-gray-700"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Client Distribution"}),e.jsx("div",{className:"text-4xl font-bold text-gray-900 mb-2",children:A?.total_clients||k.length}),e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:[A?.multi_currency_count||k.filter(e=>Array.isArray(e.currencies)&&e.currencies.length>1).length," multi-currency"]}),e.jsxs("div",{className:"space-y-2 pt-3 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-gray-600 flex items-center gap-1",children:[e.jsx(o,{className:"h-3 w-3"}),"New This Month"]}),e.jsxs("span",{className:"text-sm font-semibold text-emerald-600",children:["+",A?.new_clients_this_month||0]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-gray-600 flex items-center gap-1",children:[e.jsx(y,{className:"h-3 w-3"}),"Avg Transaction"]}),e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:Ft(A?.avg_transaction_value||0,"₺")})]})]})]})]})})]}),e.jsxs(cs,{variant:"elevated",className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-4 right-4 w-20 h-20 bg-purple-100 rounded-full opacity-20"}),e.jsx(Me,{className:"p-6 relative",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"bg-purple-100 p-3 rounded-lg",children:e.jsx(J,{className:"h-6 w-6 text-purple-700"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Top Performers"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 mb-1 truncate",children:A?.most_active?.client_name||(k.length>0?k.reduce((e,s)=>s.transaction_count>e.transaction_count?s:e).client_name:"N/A")}),e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Most transactions: ",A?.most_active?.transaction_count||(k.length>0?k.reduce((e,s)=>s.transaction_count>e.transaction_count?s:e).transaction_count:0)," txns"]}),e.jsxs("div",{className:"space-y-2 pt-3 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-xs text-gray-600 flex items-center gap-1",children:[e.jsx(o,{className:"h-3 w-3"}),"Top by Volume"]}),e.jsx("span",{className:"text-xs font-medium text-gray-800 mt-0.5 truncate max-w-[120px]",children:A?.top_by_volume?.client_name||"N/A"})]}),e.jsx("span",{className:"text-sm font-semibold text-emerald-600",children:Ft(A?.top_by_volume?.total_amount||0,"₺")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-xs text-gray-600 flex items-center gap-1",children:[e.jsx(G,{className:"h-3 w-3"}),"Highest Commission"]}),e.jsx("span",{className:"text-xs font-medium text-gray-800 mt-0.5 truncate max-w-[120px]",children:A?.top_by_commission?.client_name||"N/A"})]}),e.jsx("span",{className:"text-sm font-semibold text-purple-600",children:Ft(A?.top_by_commission?.total_commission||0,"₺")})]})]})]})]})})]})]})]})]}),e.jsx(Ke,{value:"transactions",className:"mt-6",children:e.jsxs(cs,{children:[e.jsx(Ye,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsxs(We,{className:"flex items-center gap-3",children:["Transaction Management",e.jsx(ds,{variant:"secondary",size:"sm",className:"bg-gray-100 text-gray-800",children:"Enhanced Filters Available"})]}),e.jsx(He,{children:"All transaction records"})]})}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(os,{variant:ls?"primary":"outline",onClick:()=>is(!ls),icon:e.jsx(O,{className:"h-4 w-4"}),className:"transition-all duration-200 "+(ls?"bg-gray-600 hover:bg-gray-700 text-white shadow-lg":"border-gray-300 text-gray-600 hover:bg-gray-50 hover:border-gray-400"),children:ls?"Hide Filters":"Show Filters"+(Tt()>0?` (${Tt()})`:"")})})]})}),e.jsxs(Me,{children:[ls&&e.jsx("div",{className:"mb-6 animate-in slide-in-from-top-4 duration-300",children:e.jsx(st,{filters:as,dropdownOptions:es,expandedFilterSections:ms,displayLimit:Ds,transactionsLength:C.length,exporting:Fs,onFilterChange:(e,s)=>{rs(t=>({...t,[e]:s}))},onToggleFilterSection:e=>{xs(s=>({...s,[e]:!s[e]}))},onClearAllFilters:()=>{rs({search:"",category:"",psp:"",company:"",payment_method:"",currency:"",status:"",date_from:"",date_to:"",amount_min:"",amount_max:"",commission_min:"",commission_max:"",client_name:"",sort_by:"date",sort_order:"desc"}),Cs(e=>({...e,currentOffset:0,hasMore:!0,oldestDate:null}))},onApplyFilters:()=>{Cs(e=>({...e,currentOffset:0,hasMore:!0,oldestDate:null})),_t()},onExportDisplayed:()=>{const e=C.slice(0,Ds),s=(new Date).toISOString().split("T")[0],t=`transactions_displayed_${e.length}_${s}.csv`;$t(e,t)},onExportAll:Pt,onApplyQuickFilter:e=>{switch(e){case"today":const e=(new Date).toISOString().split("T")[0];rs(s=>({...s,date_from:e,date_to:e}));break;case"thisWeek":const s=new Date;s.setDate(s.getDate()-s.getDay());const t=new Date;t.setDate(t.getDate()+(6-t.getDay())),rs(e=>({...e,date_from:s.toISOString().split("T")[0],date_to:t.toISOString().split("T")[0]}));break;case"deposits":rs(e=>({...e,category:"DEP"}));break;case"withdrawals":rs(e=>({...e,category:"WD"}));break;case"highValue":rs(e=>({...e,amount_min:"10000"}))}Cs(e=>({...e,currentOffset:0,hasMore:!0,oldestDate:null})),setTimeout(()=>{_t()},100)}})}),$?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Loading transactions..."})]}):I?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"text-red-500 mb-4",children:e.jsx(l,{className:"h-16 w-16 mx-auto"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Transactions"}),e.jsx("p",{className:"text-gray-600 mb-6",children:I}),e.jsx(ns,{variant:"default",onClick:_t,className:"flex items-center gap-2",children:"Try Again"})]}):0===C.length?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"text-gray-400 mb-4",children:e.jsx(c,{className:"h-16 w-16 mx-auto"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Transactions Found"}),e.jsx("p",{className:"text-gray-600",children:"No transactions are currently available."})]}):e.jsxs("div",{className:"overflow-x-auto",children:[(()=>{const s=At(C);let t=[];s.forEach(e=>{t=[...t,...e.transactions]});const a=t.slice(0,Ds),r=At(a);return 0===r.length?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"No transactions to group by date"}):r.map((s,t)=>e.jsxs("div",{className:"border-b border-gray-100 last:border-b-0",children:[e.jsx("div",{className:"px-6 py-3 bg-slate-100 border-b border-slate-300",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-700 rounded-lg flex items-center justify-center",children:e.jsx(M,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"text-lg font-semibold text-slate-900 tracking-tight",children:Et(s.date)}),e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 text-xs font-medium text-slate-700 bg-slate-200 rounded",children:new Date(s.date).toLocaleDateString("en-US",{weekday:"short"})})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm tabular-nums",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-slate-700",children:[e.jsx("span",{className:"font-medium",children:s.transactions.length}),e.jsxs("span",{className:"text-slate-600",children:["transaction",1!==s.transactions.length?"s":""]})]}),e.jsx("span",{className:"text-slate-400",children:"|"}),e.jsx("div",{className:"flex items-center gap-2 text-slate-700",children:s.grossBalance&&void 0!==s.grossBalance.tl?e.jsxs("div",{className:"flex items-center gap-3 tabular-nums",children:[e.jsx("span",{className:"font-medium text-slate-900",children:Ft(s.grossBalance.tl,"₺")}),e.jsx("span",{className:"text-slate-400",children:"|"}),e.jsx("span",{className:"font-medium text-slate-900",children:Ft(s.grossBalance.usd,"$")}),s.grossBalance.rate>0&&e.jsxs("span",{className:"text-xs text-slate-600",children:["@",s.grossBalance.rate.toFixed(2)]}),e.jsx("span",{className:"text-slate-600 text-xs",children:"gross"})]}):(()=>{let t=0,a=0;s.transactions.forEach(e=>{const r=e.amount||0,n=e.category&&"WD"===e.category.toUpperCase()?-Math.abs(r):r;s.dateKey.includes("2025-09-30"),"TRY"===e.currency||"TL"===e.currency?t+=n:"USD"===e.currency&&(a+=n)});const r=t/Qe+a,n=r*Qe;return s.dateKey.includes("2025-09-30"),e.jsxs("div",{className:"flex items-center gap-3 tabular-nums",children:[e.jsx("span",{className:"font-medium text-slate-900",children:Ft(n,"₺")}),e.jsx("span",{className:"text-slate-400",children:"|"}),e.jsx("span",{className:"font-medium text-slate-900",children:Ft(r,"$")}),e.jsxs("span",{className:"text-xs text-slate-600",children:["@",Qe.toFixed(2)]}),e.jsx("span",{className:"text-slate-600 text-xs",children:"calc"})]})})()})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ns,{onClick:()=>aa(s.date),disabled:we,variant:"outline",size:"sm",className:"inline-flex items-center gap-1.5",children:[e.jsx(X,{className:"h-3.5 w-3.5"}),we&&ke===s.date?"Loading...":"Summary"]}),s.grossBalance&&s.grossBalance.rate>0||s.transactions&&s.transactions.length>0&&s.transactions.some(e=>"USD"===e.currency||"EUR"===e.currency)?e.jsxs(ns,{onClick:()=>{return e=s.date,t=s.grossBalance?.rate||Qe||48,Re(e),Ue(t.toString()),void Ee(!0);var e,t},variant:"outline",size:"sm",className:"inline-flex items-center gap-1.5",title:`Edit exchange rate for ${s.date}`,children:[e.jsx(K,{className:"h-3.5 w-3.5"}),"Edit Rate"]}):null]})]})}),e.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg bg-white shadow-sm",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",style:{borderCollapse:"separate",borderSpacing:0},children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10 shadow-sm",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/12 border-b border-gray-200",children:"Client"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/12 border-b border-gray-200",children:"Company"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/12 border-b border-gray-200",children:"Payment Method"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/12 border-b border-gray-200",children:"Category"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/12 border-b border-gray-200 tabular-nums",children:"Amount"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/12 border-b border-gray-200 tabular-nums",children:"Commission"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/12 border-b border-gray-200 tabular-nums",children:"Net Amount"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/12 border-b border-gray-200",children:"Currency"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/12 border-b border-gray-200",children:"PSP"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider w-1/12 border-b border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.transactions.map(s=>e.jsx(tt,{transaction:s,onView:Ut,onEdit:Mt,onDelete:It,normalizePaymentMethodName:Xt},s.id))})]})})]},s.dateKey))})(),e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"font-medium",children:[C.length," ",t("dashboard.total_transactions").toLowerCase()]}),e.jsxs("span",{className:"text-gray-500",children:["across ",At(C).length," date",1!==At(C).length?"s":""]})]}),e.jsxs("span",{className:"font-semibold text-gray-900",children:["Total: ",Ft(C.reduce((e,s)=>e+(s.amount||0),0),"TL")]})]})}),e.jsxs("div",{className:"border-t border-gray-200 bg-gradient-to-b from-white to-gray-50",children:[e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Showing ",C.length.toLocaleString()," ",1===C.length?"transaction":"transactions"]})]}),hs.total>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4 text-blue-500"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Total: ",e.jsx("span",{className:"font-semibold text-gray-900",children:hs.total.toLocaleString()})]})]}),hs.oldestDate&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4 text-purple-500"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Oldest: ",e.jsx("span",{className:"font-semibold text-gray-900",children:new Date(hs.oldestDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:["Displaying: ",Math.min(Ds,C.length),"/",C.length," | hasMore: ",hs.hasMore?"true":"false"," | Total: ",hs.total]}),Ds<C.length&&e.jsxs("div",{className:"flex items-center gap-2 bg-blue-50 px-3 py-1.5 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-blue-500"}),e.jsxs("span",{className:"text-xs font-medium text-blue-700",children:[Math.round(Ds/C.length*100),"% displayed"]})]}),e.jsx("div",{className:"w-24 h-1.5 bg-blue-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full transition-all duration-300",style:{width:`${Math.min(Ds/C.length*100,100)}%`}})})]})]})]})}),(()=>{const e=Ds<C.length,s=hs.hasMore;return e||s})()&&e.jsx("div",{className:"flex justify-center pb-6 px-6",children:e.jsx(os,{variant:"outline",size:"lg",onClick:async()=>{if(hs.loading)return;const e=Ds+100;if(Ts(e),e>=C.length&&hs.hasMore){Cs(e=>({...e,loading:!0}));try{await Ct(!1,!0)}catch(s){}finally{Cs(e=>({...e,loading:!1}))}}},disabled:hs.loading,icon:hs.loading?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}):e.jsx(i,{className:"h-4 w-4"}),iconPosition:"left",className:"min-w-[280px] border-blue-200 text-blue-700 hover:bg-blue-50 hover:border-blue-300 transition-all duration-200 shadow-sm hover:shadow-md",children:hs.loading?e.jsx("span",{children:"Loading older transactions..."}):e.jsxs("span",{children:["Load ",hs.itemsPerLoad," More Transactions"]})})}),!hs.hasMore&&C.length>0&&e.jsx("div",{className:"flex justify-center pb-6 px-6",children:e.jsxs("div",{className:"flex items-center gap-3 bg-green-50 border border-green-200 text-green-700 px-6 py-3 rounded-lg shadow-sm",children:[e.jsx(p,{className:"h-5 w-5"}),e.jsxs("span",{className:"font-medium",children:["All transactions loaded (",C.length.toLocaleString()," total)"]})]})})]})]})]})]})}),e.jsxs(Ke,{value:"analytics",className:"mt-6",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Analytics Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive insights and performance metrics"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-100 rounded-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Live Data"})]}),e.jsxs(ns,{variant:"outline",size:"sm",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Export Report"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(cs,{className:"hover:shadow-lg transition-all duration-300",children:e.jsx(Me,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:t("clients.total_revenue")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:Ft(k.reduce((e,s)=>e+s.total_amount,0),"₺")}),e.jsxs("p",{className:"text-sm text-green-600 mt-1 flex items-center",children:[e.jsx(o,{className:"h-4 w-4 mr-1"}),"+12.5% from last month"]})]}),e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(y,{className:"h-6 w-6 text-green-600"})})]})})}),e.jsx(cs,{className:"hover:shadow-lg transition-all duration-300",children:e.jsx(Me,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:t("clients.active_clients")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:k.filter(e=>e.transaction_count>0).length}),e.jsxs("p",{className:"text-sm text-blue-600 mt-1 flex items-center",children:[e.jsx(d,{className:"h-4 w-4 mr-1"}),k.length," total clients"]})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx(d,{className:"h-6 w-6 text-blue-600"})})]})})}),e.jsx(cs,{className:"hover:shadow-lg transition-all duration-300",children:e.jsx(Me,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:t("clients.avg_transaction")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:Ft(k.reduce((e,s)=>e+s.total_amount,0)/k.reduce((e,s)=>e+s.transaction_count,0)||0,"₺")}),e.jsxs("p",{className:"text-sm text-purple-600 mt-1 flex items-center",children:[e.jsx(n,{className:"h-4 w-4 mr-1"}),"Per transaction"]})]}),e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:e.jsx(n,{className:"h-6 w-6 text-purple-600"})})]})})}),e.jsx(cs,{className:"hover:shadow-lg transition-all duration-300",children:e.jsx(Me,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:t("clients.commission")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:Ft(k.reduce((e,s)=>e+s.total_commission,0),"₺")}),e.jsxs("p",{className:"text-sm text-orange-600 mt-1 flex items-center",children:[e.jsx(U,{className:"h-4 w-4 mr-1"}),"8.5% avg rate"]})]}),e.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center",children:e.jsx(U,{className:"h-6 w-6 text-orange-600"})})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[e.jsxs(cs,{children:[e.jsxs(Ye,{children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5 text-blue-600"}),"Transaction Volume Trend"]}),e.jsx(He,{children:"Monthly deposits and withdrawals over time"})]}),e.jsxs(Me,{children:[e.jsx("div",{className:"h-80",children:e.jsx(us,{width:"100%",height:"100%",children:e.jsxs(gs,{data:(()=>{const e=C.reduce((e,s)=>{if(!s.date)return e;const t=new Date(s.date),a=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`;return e[a]||(e[a]={month:a,deposits:0,withdrawals:0,net:0,count:0}),s.amount>0?e[a].deposits+=s.amount:e[a].withdrawals+=Math.abs(s.amount),e[a].net+=s.amount,e[a].count+=1,e},{});return Object.values(e).sort((e,s)=>e.month.localeCompare(s.month)).slice(-6)})(),children:[e.jsx(ps,{strokeDasharray:"3 3",stroke:"#f3f4f6"}),e.jsx(js,{dataKey:"month",stroke:"#6b7280",fontSize:12,tickFormatter:e=>{const[s,t]=e.split("-");return`${t}/${s.slice(2)}`}}),e.jsx(ys,{stroke:"#6b7280",fontSize:12,tickFormatter:e=>Ft(e,"₺")}),e.jsx(bs,{formatter:e=>[Ft(e,"₺"),""],labelFormatter:e=>{const[s,t]=e.split("-");return`${t}/${s}`},contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(fs,{type:"monotone",dataKey:"deposits",stroke:"#10b981",strokeWidth:3,dot:{fill:"#10b981",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#10b981",strokeWidth:2}}),e.jsx(fs,{type:"monotone",dataKey:"withdrawals",stroke:"#ef4444",strokeWidth:3,dot:{fill:"#ef4444",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#ef4444",strokeWidth:2}})]})})}),e.jsxs("div",{className:"flex items-center justify-center gap-6 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Deposits"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Withdrawals"})]})]})]})]}),e.jsxs(cs,{children:[e.jsxs(Ye,{children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5 text-purple-600"}),"Payment Method Distribution"]}),e.jsx(He,{children:"Volume breakdown by payment method"})]}),e.jsx(Me,{children:e.jsx("div",{className:"h-80",children:e.jsx(us,{width:"100%",height:"100%",children:e.jsxs(Ns,{children:[e.jsx(vs,{data:ra(),cx:"50%",cy:"50%",innerRadius:60,outerRadius:120,paddingAngle:5,dataKey:"volume",children:ra().map((s,t)=>e.jsx(ws,{fill:na[t%na.length]},`cell-${t}`))}),e.jsx(bs,{formatter:e=>[Ft(e,"₺"),"Volume"],contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(_s,{verticalAlign:"bottom",height:36,formatter:s=>e.jsx("span",{className:"text-sm text-gray-700",children:s})})]})})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs(cs,{children:[e.jsxs(Ye,{children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(n,{className:"h-5 w-5 text-green-600"}),"Top Client Performance"]}),e.jsx(He,{children:"Volume by client ranking"})]}),e.jsx(Me,{children:e.jsx("div",{className:"h-80",children:e.jsx(us,{width:"100%",height:"100%",children:e.jsxs(ks,{data:k.map(e=>({name:e.client_name,volume:e.total_amount,transactions:e.transaction_count,avgTransaction:e.avg_transaction,commission:e.total_commission})).sort((e,s)=>s.volume-e.volume).slice(0,10),children:[e.jsx(ps,{strokeDasharray:"3 3",stroke:"#f3f4f6"}),e.jsx(js,{dataKey:"name",stroke:"#6b7280",fontSize:10,angle:-45,textAnchor:"end",height:80,tickFormatter:e=>e.length>12?e.substring(0,12)+"...":e}),e.jsx(ys,{stroke:"#6b7280",fontSize:12,tickFormatter:e=>Ft(e,"₺")}),e.jsx(bs,{formatter:e=>[Ft(e,"₺"),"Volume"],contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(Ss,{dataKey:"volume",fill:"#3b82f6",radius:[4,4,0,0]})]})})})})]}),e.jsxs(cs,{children:[e.jsxs(Ye,{children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-5 w-5 text-blue-600"}),"Currency Distribution"]}),e.jsx(He,{children:"Volume breakdown by currency"})]}),e.jsx(Me,{children:e.jsx("div",{className:"h-80",children:e.jsx(us,{width:"100%",height:"100%",children:e.jsxs(ks,{data:(()=>{const e=C.reduce((e,s)=>{const t=s.currency||"Unknown";return e[t]||(e[t]={currency:t,volume:0,count:0}),e[t].volume+=Math.abs(s.amount),e[t].count+=1,e},{});return Object.values(e).sort((e,s)=>s.volume-e.volume)})(),children:[e.jsx(ps,{strokeDasharray:"3 3",stroke:"#f3f4f6"}),e.jsx(js,{dataKey:"currency",stroke:"#6b7280",fontSize:12}),e.jsx(ys,{stroke:"#6b7280",fontSize:12,tickFormatter:e=>Ft(e,"₺")}),e.jsx(bs,{formatter:e=>[Ft(e,"₺"),"Volume"],contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(Ss,{dataKey:"volume",fill:"#8b5cf6",radius:[4,4,0,0]})]})})})})]})]})]}),e.jsx(Ke,{value:"clients",className:"mt-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"px-8 py-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-xl flex items-center justify-center",children:e.jsx(d,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Client Information"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage your client relationships and details"})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(ns,{onClick:()=>Gs(!0),className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"}),"Add Client"]})})]})}),e.jsx("div",{className:"p-8",children:$?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-600"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Client"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Company"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:t("clients.total_amount")}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Transactions"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Last Transaction"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Actions"})]})}),e.jsx("tbody",{children:k.map((t,a)=>e.jsx(s.Fragment,{children:e.jsxs("tr",{className:"border-b border-gray-50 hover:bg-gray-50 hover:scale-[1.01] transition-all duration-300 ease-in-out cursor-pointer",children:[e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-gray-600",children:t.client_name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.client_name}),e.jsx("div",{className:"text-sm text-gray-500",children:t.company_name||"N/A"})]})]})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("div",{className:"text-sm text-gray-900",children:t.company_name||"N/A"})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:Ft(t.total_amount,"TL")})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("div",{className:"text-sm text-gray-600",children:t.transaction_count})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("div",{className:"text-sm text-gray-600",children:t.last_transaction?new Date(t.last_transaction).toLocaleDateString():"N/A"})}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ns,{variant:"outline",size:"sm",onClick:()=>(e=>{le(e),Ys(!0)})(t),className:"text-gray-600 hover:text-gray-700",children:e.jsx(F,{className:"w-4 h-4"})}),e.jsx(ns,{variant:"outline",size:"sm",onClick:()=>(e=>{le(e),Hs(!0)})(t),className:"text-green-600 hover:text-green-700",children:e.jsx(K,{className:"w-4 h-4"})}),e.jsx(ns,{variant:"outline",size:"sm",onClick:()=>(e=>{le(e),ce(!0)})(t),className:"text-red-600 hover:text-red-700",children:e.jsx(Y,{className:"w-4 h-4"})})]})})]})},a))})]})})})]})})]}),Ks&&ne&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Client Details"}),e.jsx(ns,{onClick:Ot,variant:"ghost",size:"icon-sm",className:"text-gray-400 hover:text-gray-600",children:e.jsx(P,{className:"h-5 w-5"})})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-accent-100 rounded-full flex items-center justify-center",children:e.jsx(D,{className:"h-8 w-8 text-accent-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-semibold text-gray-900",children:ne.client_name}),e.jsx("p",{className:"text-gray-600",children:ne.company_name||"No Company"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:t("clients.total_volume")}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:Ft(ne.total_amount,Array.isArray(ne.currencies)&&ne.currencies.length>0?ne.currencies[0]:"USD")})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Commissions"}),e.jsx("p",{className:"text-xl font-bold text-success-600",children:Ft(ne.total_commission,Array.isArray(ne.currencies)&&ne.currencies.length>0?ne.currencies[0]:"USD")})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Net Amount"}),e.jsx("p",{className:"text-xl font-bold text-accent-600",children:Ft(ne.total_net,Array.isArray(ne.currencies)&&ne.currencies.length>0?ne.currencies[0]:"USD")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Transaction Count"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ne.transaction_count})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:t("clients.avg_transaction")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Ft(ne.avg_transaction,Array.isArray(ne.currencies)&&ne.currencies.length>0?ne.currencies[0]:"USD")})]})]}),e.jsxs("div",{className:"space-y-4",children:[ne.payment_method&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Payment Method"}),e.jsx("p",{className:"text-sm text-gray-600",children:ne.payment_method})]})]}),ne.currencies&&ne.currencies.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Currencies"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ne.currencies.map(s=>e.jsx("span",{className:"inline-flex px-3 py-1 text-sm font-medium rounded-full bg-accent-100 text-accent-800",children:s},s))})]}),ne.psps&&ne.psps.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Payment Service Providers"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ne.psps.map(s=>e.jsx("span",{className:"inline-flex px-3 py-1 text-sm font-medium rounded-full bg-success-100 text-success-800",children:s},s))})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(M,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Last Transaction"}),e.jsx("p",{className:"text-sm text-gray-600",children:ne.last_transaction?(ia=ne.last_transaction,ia?new Date(ia).toLocaleDateString():"N/A"):"N/A"})]})]})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-100",children:e.jsx(ns,{onClick:Ot,variant:"outline",className:"w-full",children:"Close"})})]})}),Ws&&ne&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Edit Client"}),e.jsx("button",{onClick:Ot,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:e.jsx(P,{className:"h-5 w-5"})})]})}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-600 mb-6",children:"Edit functionality will be implemented here. This would include forms for updating client information."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:Ot,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200",children:"Cancel"}),e.jsx("button",{onClick:Ot,className:"flex-1 px-4 py-2 bg-accent-600 text-white rounded-lg hover:bg-accent-700 transition-colors duration-200",children:"Save Changes"})]})]})]})}),ie&&ne&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[e.jsx("div",{className:"p-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Delete Client"}),e.jsx("button",{onClick:Ot,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:e.jsx(P,{className:"h-5 w-5"})})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-danger-100 rounded-full flex items-center justify-center",children:e.jsx(Y,{className:"h-6 w-6 text-danger-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:"Are you sure?"}),e.jsx("p",{className:"text-gray-600",children:"This action cannot be undone."})]})]}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["You are about to delete"," ",e.jsx("strong",{children:ne.client_name}),". This will permanently remove all associated data."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:Ot,disabled:oe,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(ne)try{de(!0);const e=await Fe.delete(`/clients/${encodeURIComponent(ne.client_name)}`);if(e.ok)S(e=>e.filter(e=>e.client_name!==ne.client_name)),ce(!1),le(null);else{const s=await Fe.parseResponse(e);alert(s?.message||t("transactions.failed_delete_client"))}}catch(e){alert(t("transactions.failed_delete_client"))}finally{de(!1)}},disabled:oe,className:"flex-1 px-4 py-2 bg-danger-600 text-white rounded-lg hover:bg-danger-700 transition-colors duration-200 disabled:opacity-50",children:oe?"Deleting...":"Delete Client"})]})]})]})}),be&&Ne&&e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg max-w-5xl w-full max-h-[85vh] overflow-hidden border border-gray-100",children:[e.jsx("div",{className:"bg-gray-50 border-b border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-xl flex items-center justify-center",children:e.jsx(M,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Daily Summary"}),e.jsx("p",{className:"text-gray-500 text-sm",children:Ne.date_str})]})]}),e.jsx("button",{onClick:()=>{fe(!1),ve(null),Se("")},className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center hover:bg-gray-200 transition-colors duration-200",children:e.jsx(P,{className:"h-4 w-4 text-gray-600"})})]})}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(85vh-120px)]",children:we?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-300 border-t-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Loading summary..."})]})}):e.jsxs("div",{className:"space-y-6",children:[(()=>{const s=(e=>{if(Array.isArray(C)){const s=C.filter(s=>(s.date?s.date.split("T")[0]:null)===e),t=s.filter(e=>"DEP"===e.category||"Deposit"===e.category||"Investment"===e.category),a=s.filter(e=>"WD"===e.category||"Withdraw"===e.category||"Withdrawal"===e.category),r=t.reduce((e,s)=>{const t=null!==s.amount_tl&&void 0!==s.amount_tl?s.amount_tl:s.amount||0;return e+Math.abs(t)},0),n=a.reduce((e,s)=>{const t=null!==s.amount_tl&&void 0!==s.amount_tl?s.amount_tl:s.amount||0;return e+Math.abs(t)},0),l=s.length,i=new Set(s.map(e=>e.client_name).filter(e=>e)).size;if(l>0)return{totalDeposits:r,totalWithdrawals:n,transactionCount:l,uniqueClients:i}}return Ne&&Ne.date===e?{totalDeposits:Ne.total_deposits_tl||0,totalWithdrawals:Ne.total_withdrawals_tl||0,transactionCount:Ne.transaction_count||0,uniqueClients:Ne.unique_clients||0}:{totalDeposits:0,totalWithdrawals:0,transactionCount:0,uniqueClients:0}})(Ne.date);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-1 h-6 bg-gray-400 rounded-full"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Overview"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 hover:shadow-sm transition-shadow duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(o,{className:"h-4 w-4 text-green-600"})}),e.jsx("span",{className:"text-xs font-medium text-green-600 bg-green-50 px-2 py-1 rounded-full",children:"Deposits"})]}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900 mb-1",children:Ft(s.totalDeposits,"₺")}),e.jsx("p",{className:"text-xs text-gray-500",children:t("clients.total_incoming")})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 hover:shadow-sm transition-shadow duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx(o,{className:"h-4 w-4 text-red-600 rotate-180"})}),e.jsx("span",{className:"text-xs font-medium text-red-600 bg-red-50 px-2 py-1 rounded-full",children:"Withdrawals"})]}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900 mb-1",children:Ft(s.totalWithdrawals,"₺")}),e.jsx("p",{className:"text-xs text-gray-500",children:t("clients.total_outgoing")})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 hover:shadow-sm transition-shadow duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(b,{className:"h-4 w-4 text-gray-600"})}),e.jsx("span",{className:"text-xs font-medium text-gray-600 bg-gray-50 px-2 py-1 rounded-full",children:"Net"})]}),e.jsx("p",{className:"text-2xl font-semibold mb-1 "+((Ne?.gross_balance_tl||s.totalDeposits-s.totalWithdrawals)>=0?"text-green-600":"text-red-600"),children:Ft(Ne?.gross_balance_tl||s.totalDeposits-s.totalWithdrawals,"₺")}),e.jsx("p",{className:"text-xs text-gray-500",children:"Balance"})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 hover:shadow-sm transition-shadow duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(n,{className:"h-4 w-4 text-gray-600"})}),e.jsx("span",{className:"text-xs font-medium text-gray-600 bg-gray-50 px-2 py-1 rounded-full",children:"Stats"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Transactions"}),e.jsx("span",{className:"font-semibold text-gray-900",children:s.transactionCount})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Clients"}),e.jsx("span",{className:"font-semibold text-gray-900",children:s.uniqueClients})]}),s.transactionCount>0&&e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-600",children:t("common.average")}),e.jsx("span",{className:"font-semibold text-gray-900",children:Ft((s.totalDeposits+s.totalWithdrawals)/s.transactionCount)})]})]})]})]})]})})(),null!==Ne.usd_rate&&void 0!==Ne.usd_rate&&e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(y,{className:"h-4 w-4 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"USD Rate"}),e.jsxs("p",{className:"text-xl font-semibold text-gray-900",children:["$",Number(Ne.usd_rate).toFixed(2)]})]})]})}),(()=>{const s=(e=>{if(!Array.isArray(C))return{};const s=C.filter(s=>(s.date?s.date.split("T")[0]:null)===e),t={};return s.forEach(e=>{const s=e.payment_method||"Unknown",a=Xt(s),r=e.amount||0;t[a]||(t[a]={deposits:0,withdrawals:0,total:0}),"DEP"===e.category||"Deposit"===e.category||"Investment"===e.category?(t[a].deposits+=r,t[a].total+=r):"WD"!==e.category&&"Withdraw"!==e.category&&"Withdrawal"!==e.category||(t[a].withdrawals+=r,t[a].total-=r)}),t})(Ne.date);return Object.keys(s).length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-1 h-6 bg-gray-400 rounded-full"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Payment Methods"})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:Object.entries(s).sort(([,e],[,s])=>Math.abs(s.total)-Math.abs(e.total)).map(([s,t])=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 hover:shadow-sm transition-shadow duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:s}),e.jsx("div",{className:"text-sm font-semibold px-2 py-1 rounded-full "+(t.total>=0?"text-green-600 bg-green-50":"text-red-600 bg-red-50"),children:Ft(Math.abs(t.total),"₺")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-green-50 border border-green-100 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(o,{className:"h-3 w-3 text-green-600"}),e.jsx("span",{className:"text-xs font-medium text-green-700",children:"Deposits"})]}),e.jsx("p",{className:"text-lg font-semibold text-green-900",children:Ft(t.deposits,"₺")})]}),e.jsxs("div",{className:"bg-red-50 border border-red-100 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(o,{className:"h-3 w-3 text-red-600 rotate-180"}),e.jsx("span",{className:"text-xs font-medium text-red-700",children:"Withdrawals"})]}),e.jsx("p",{className:"text-lg font-semibold text-red-900",children:Ft(t.withdrawals,"₺")})]})]})]},s))})]}):null})(),Ne.transaction_count>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-1 h-6 bg-gray-400 rounded-full"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Breakdown"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[Ne.psp_summary.length>0&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-6 h-6 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(j,{className:"h-3 w-3 text-gray-600"})}),e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"PSPs"})]}),e.jsxs("div",{className:"space-y-3",children:[Ne.psp_summary.slice(0,4).map((s,t)=>{const a=s.is_tether||s.name&&(s.name.toLowerCase().includes("tether")||"TETHER"===s.name),r=a?s.gross_usd||s.amount_usd||0:s.gross_tl||s.amount_tl||0,n=a?s.commission_usd:s.commission_tl,l=a?s.net_usd:s.net_tl,i=a?"$":"₺";return e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 truncate",children:s.name}),e.jsxs("span",{className:"text-xs text-gray-500",children:[s.count," tx"]})]}),e.jsxs("div",{className:"space-y-1.5 text-xs",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Gross"}),e.jsxs("span",{className:"font-semibold text-blue-600",children:[i,r.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Commission"}),e.jsxs("span",{className:"font-semibold text-orange-600",children:[i,n.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-1 border-t border-gray-200",children:[e.jsx("span",{className:"text-gray-600",children:"Net"}),e.jsxs("span",{className:"font-bold text-green-600",children:[i,l.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]},t)}),Ne.psp_summary.length>4&&e.jsx("div",{className:"text-center pt-2 border-t border-gray-100",children:e.jsxs("span",{className:"text-xs text-gray-500",children:["+",Ne.psp_summary.length-4," more"]})})]})]}),Ne.category_summary.length>0&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-6 h-6 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(c,{className:"h-3 w-3 text-gray-600"})}),e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Categories"})]}),e.jsxs("div",{className:"space-y-2",children:[Ne.category_summary.slice(0,4).map((s,t)=>e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-600 truncate",children:s.name}),e.jsx("span",{className:"font-medium text-gray-900",children:s.count})]},t)),Ne.category_summary.length>4&&e.jsx("div",{className:"text-center pt-2 border-t border-gray-100",children:e.jsxs("span",{className:"text-xs text-gray-500",children:["+",Ne.category_summary.length-4," more"]})})]})]}),Ne.payment_method_summary.length>0&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-6 h-6 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(U,{className:"h-3 w-3 text-gray-600"})}),e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Payment Methods"})]}),e.jsxs("div",{className:"space-y-3",children:[Ne.payment_method_summary.slice(0,4).map((s,t)=>{const a=s.name&&(s.name.toLowerCase().includes("tether")||"TETHER"===s.name),r=a?s.gross_usd||s.amount_usd||0:s.gross_tl||s.amount_tl||0,n=a?s.commission_usd:s.commission_tl,l=a?s.net_usd:s.net_tl,i=a?"$":"₺";return e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:Xt(s.name)}),e.jsxs("span",{className:"text-xs text-gray-500",children:[s.count," tx"]})]}),e.jsxs("div",{className:"space-y-1.5 text-xs",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Gross (Before Comm.)"}),e.jsxs("span",{className:"font-semibold text-blue-600",children:[i,r.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Commission"}),e.jsxs("span",{className:"font-semibold text-orange-600",children:[i,n.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-1 border-t border-gray-200",children:[e.jsx("span",{className:"text-gray-600",children:"Net (After Comm.)"}),e.jsxs("span",{className:"font-bold text-green-600",children:[i,l.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]},t)}),Ne.payment_method_summary.length>4&&e.jsx("div",{className:"text-center pt-2 border-t border-gray-100",children:e.jsxs("span",{className:"text-xs text-gray-500",children:["+",Ne.payment_method_summary.length-4," more"]})})]})]})]})]})]})})]})}),Zs&&it&&e.jsx(Xs,{isOpen:Zs,onClose:()=>at(!1),title:t("transactions.view_transaction"),children:e.jsx(Qs,{transaction:it})}),nt&&it&&e.jsx(Xs,{isOpen:nt,onClose:()=>lt(!1),title:t("transactions.edit_transaction"),children:e.jsx(et,{transaction:it,onSave:e=>{T(s=>s.map(s=>s.id===e.id?e:s)),je[e.client_name]&&ye(s=>({...s,[e.client_name]:s[e.client_name].map(s=>s.id===e.id?e:s)})),Ne&&Ne.date===e.date&&aa(e.date),lt(!1),window.dispatchEvent(new CustomEvent("transactionsUpdated",{detail:{action:"update",transactionId:e.id,skipCurrentPage:!0}}))},onCancel:()=>lt(!1),dropdownOptions:es})}),mt&&e.jsx(Xs,{isOpen:mt,onClose:()=>xt(!1),title:t("transactions.import_guide"),size:"lg",children:e.jsxs("div",{className:"space-y-6 max-h-96 overflow-y-auto",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-800 mb-2",children:"✅ Supported File Formats:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full font-medium",children:"CSV (Fully Supported)"}),e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full font-medium",children:"XLSX (Fully Supported)"}),e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full font-medium",children:"XLS (Fully Supported)"}),e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full font-medium",children:"XLSM (Fully Supported)"})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-800 mb-2",children:"🎯 Essential vs Optional Fields:"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"font-medium text-green-700 mb-1",children:"✅ Essential Fields (Recommended):"}),e.jsxs("ul",{className:"text-green-600 space-y-1",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Client"})," - Client's full name"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Amount"})," - Transaction amount"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Company"})," - Company name"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Payment Method"})," - How payment was made"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Category"})," - Transaction category"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Currency"})," - Transaction currency"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"PSP"})," - Payment service provider"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Date"})," - Transaction date"]})]})]}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-medium text-gray-700 mb-1",children:"❓ Optional Fields:"}),e.jsxs("ul",{className:"text-gray-600 space-y-1",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Commission"})," - Auto-calculated if not provided"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Net Amount"})," - Auto-calculated if not provided"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Notes"})," - Additional transaction details"]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-800 mb-2",children:"📋 Essential Column Structure (in exact order):"}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 text-xs font-mono text-gray-700 overflow-x-auto",children:[e.jsxs("div",{className:"grid grid-cols-9 gap-1 text-center font-medium text-gray-600 mb-2",children:[e.jsx("div",{className:"col-span-1",children:"1"}),e.jsx("div",{className:"col-span-1",children:"2"}),e.jsx("div",{className:"col-span-1",children:"3"}),e.jsx("div",{className:"col-span-1",children:"4"}),e.jsx("div",{className:"col-span-1",children:"5"}),e.jsx("div",{className:"col-span-1",children:"6"}),e.jsx("div",{className:"col-span-1",children:"7"}),e.jsx("div",{className:"col-span-1",children:"8"}),e.jsx("div",{className:"col-span-1",children:"9"})]}),e.jsxs("div",{className:"grid grid-cols-9 gap-1 text-center",children:[e.jsx("div",{className:"col-span-1",children:"Client"}),e.jsx("div",{className:"col-span-1",children:"Company"}),e.jsx("div",{className:"col-span-1",children:"Payment"}),e.jsx("div",{className:"col-span-1",children:"Category"}),e.jsx("div",{className:"col-span-1",children:"Amount"}),e.jsx("div",{className:"col-span-1",children:"Currency"}),e.jsx("div",{className:"col-span-1",children:"PSP"}),e.jsx("div",{className:"col-span-1",children:"Date"})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[e.jsx("div",{className:"text-xs text-gray-600 text-center mb-2",children:"Optional Columns (if needed):"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1 text-center text-xs",children:[e.jsx("div",{className:"col-span-1",children:"10"}),e.jsx("div",{className:"col-span-1",children:"11"}),e.jsx("div",{className:"col-span-1",children:"12"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-1 text-center text-xs",children:[e.jsx("div",{className:"col-span-1",children:"Commission"}),e.jsx("div",{className:"col-span-1",children:"Net Amount"}),e.jsx("div",{className:"col-span-1",children:"Notes"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-800 mb-2",children:"💡 Example File Formats:"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-2",children:"📄 CSV Format (Essential Columns):"}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 text-xs font-mono text-gray-700 overflow-x-auto",children:[e.jsx("div",{className:"text-gray-600 font-medium mb-1",children:"Essential Header Row:"}),e.jsx("div",{className:"text-gray-800",children:"Client,Company,Payment Method,Category,Amount,Currency,PSP,Date"}),e.jsx("div",{className:"text-gray-600 font-medium mt-2 mb-1",children:"Essential Data Row (Example):"}),e.jsx("div",{className:"text-gray-800",children:"John Doe,ABC Corp,Credit Card,DEP,1000.50,USD,Stripe,2025-08-18"}),e.jsxs("div",{className:"mt-3 pt-2 border-t border-gray-200",children:[e.jsx("div",{className:"text-gray-600 font-medium mb-1",children:"Full Header Row (with optional columns):"}),e.jsx("div",{className:"text-gray-800",children:"Client,Company,Payment Method,Category,Amount,Commission,Net Amount,Currency,PSP,Date,Notes"}),e.jsx("div",{className:"text-gray-600 font-medium mt-2 mb-1",children:"Full Data Row (Example):"}),e.jsx("div",{className:"text-gray-800",children:"John Doe,ABC Corp,Credit Card,DEP,1000.50,25.00,975.50,USD,Stripe,2025-08-18,Monthly payment"})]})]})]}),e.jsxs("div",{children:[e.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-2",children:"📊 Excel Format (XLSX/XLS/XLSM):"}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 text-xs font-mono text-gray-700 overflow-x-auto",children:[e.jsx("div",{className:"text-gray-600 font-medium mb-1",children:"Essential Column Structure:"}),e.jsx("div",{className:"text-gray-800",children:"Column A: Client | Column B: Company | Column C: Payment Method"}),e.jsx("div",{className:"text-gray-800",children:"Column D: Category | Column E: Amount | Column F: Currency | Column G: PSP | Column H: Date"}),e.jsxs("div",{className:"mt-3 pt-2 border-t border-gray-200",children:[e.jsx("div",{className:"text-gray-600 font-medium mb-1",children:"Optional Columns (if needed):"}),e.jsx("div",{className:"text-gray-800",children:"Column J: Commission | Column K: Net Amount | Column L: Notes"})]}),e.jsx("div",{className:"text-gray-600 font-medium mt-2 mb-1",children:"💡 Tip: Excel files are automatically parsed - just ensure your first row contains headers!"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-800 mb-2",children:"📥 Download Template Examples:"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{className:"text-sm font-medium text-green-700 mb-2",children:"✅ Essential Template (9 columns):"}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[e.jsxs("div",{className:"text-sm text-green-800 mb-2",children:[e.jsx("strong",{children:"Perfect for most imports:"})," Contains only the essential columns needed for complete transaction data."]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>la("essential","csv"),className:"px-3 py-1.5 bg-green-600 text-white text-xs rounded-lg hover:bg-green-700 transition-colors duration-200 flex items-center gap-1",children:[e.jsx(B,{className:"w-3 h-3"}),"Download CSV Template"]}),e.jsxs("button",{onClick:()=>la("essential","xlsx"),className:"px-3 py-1.5 bg-green-600 text-white text-xs rounded-lg hover:bg-green-700 transition-colors duration-200 flex items-center gap-1",children:[e.jsx(B,{className:"w-3 h-3"}),"Download Excel Template"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-2",children:"📋 Full Template (12 columns):"}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:[e.jsxs("div",{className:"text-sm text-gray-800 mb-2",children:[e.jsx("strong",{children:"Complete template:"})," Includes all columns including commission, net amount, and notes for advanced users."]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>la("full","csv"),className:"px-3 py-1.5 bg-gray-600 text-white text-xs rounded-lg hover:bg-gray-700 transition-colors duration-200 flex items-center gap-1",children:[e.jsx(B,{className:"w-3 h-3"}),"Download CSV Template"]}),e.jsxs("button",{onClick:()=>la("full","xlsx"),className:"px-3 py-1.5 bg-gray-600 text-white text-xs rounded-lg hover:bg-gray-700 transition-colors duration-200 flex items-center gap-1",children:[e.jsx(B,{className:"w-3 h-3"}),"Download Excel Template"]})]})]})]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[e.jsx("h6",{className:"text-sm font-medium text-green-800 mb-1",children:"🧮 Smart Import Features:"}),e.jsxs("ul",{className:"text-sm text-green-700 space-y-1",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Essential 9 columns"})," provide complete transaction data"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Commission & Net Amount"})," are auto-calculated if not provided"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Transaction summaries"})," are automatically generated"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Client statistics"})," are updated in real-time"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Flexible import"})," - use 9 essential columns or all 12 columns"]}),e.jsxs("li",{children:["• Only import ",e.jsx("strong",{children:"raw data"})," - let the system handle calculations!"]})]})]})]})}),ht&&e.jsx(Xs,{isOpen:ht,onClose:()=>ut(!1),title:t("transactions.import_preview"),size:"lg",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-800 mb-2",children:"📊 Import Summary:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-600 font-medium",children:[t("clients.total_transactions"),":"]}),e.jsx("span",{className:"ml-2 text-gray-800",children:gt.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"File Type:"}),e.jsx("span",{className:"ml-2 text-gray-800",children:"CSV"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-800 mb-3",children:"👀 Preview (First 5 transactions):"}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Company"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Currency"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:jt.map((s,t)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900",children:s.client_name}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900",children:s.company||"-"}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm font-medium text-gray-900",children:s.amount}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500",children:s.currency}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500",children:s.category})]},t))})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>ut(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(gt&&0!==gt.length){dt(!0);try{const e=gt.map(e=>({client_name:e.client_name,company:e.company||"",payment_method:e.payment_method||"",category:e.category,amount:e.amount,commission:e.commission||0,net_amount:e.net_amount||e.amount,currency:e.currency||"TL",psp:e.psp||"",notes:e.notes||"",date:e.date||(new Date).toISOString().split("T")[0]})),s=await Fe.post("/transactions/bulk-import",{transactions:e});if(s.ok){const e=await Fe.parseResponse(s);let t="Import completed successfully!\n\n";t+="📊 Import Summary:\n",t+=`✅ Successfully imported: ${e.data.successful_imports} transactions\n`,t+=`❌ Failed imports: ${e.data.failed_imports} transactions\n`,t+=`⚠️ Duplicates skipped: ${e.data.skipped_duplicates} transactions\n`,t+=`📝 Total rows processed: ${e.data.total_rows}\n`,e.data.warnings&&e.data.warnings.length>0&&(t+="\n⚠️ Warnings:\n",e.data.warnings.slice(0,5).forEach(e=>{t+=`• ${e}\n`}),e.data.warnings.length>5&&(t+=`• ... and ${e.data.warnings.length-5} more warnings\n`)),e.data.errors&&e.data.errors.length>0&&(t+="\n❌ Errors:\n",e.data.errors.slice(0,5).forEach(e=>{t+=`• ${e}\n`}),e.data.errors.length>5&&(t+=`• ... and ${e.data.errors.length-5} more errors\n`)),e.data.summary&&(t+="\n💰 Summary:\n",t+=`• Total amount imported: ${e.data.summary.total_amount?.toLocaleString()||"N/A"} ₺\n`,t+=`• Categories imported: ${e.data.summary.categories_imported?.join(", ")||"N/A"}\n`),alert(t),ut(!1),pt([]),yt([]),"transactions"===Rs&&_t(),Dt()}else alert(`${t("transactions.import_failed")}: ${s.statusText||"Unknown error"}`)}catch(e){alert(`${t("transactions.import_error")}: ${e.message||"Unknown error occurred"}`)}finally{dt(!1)}}else alert(t("transactions.no_data_import"))},disabled:ot,className:"px-4 py-2 text-sm font-medium text-white bg-gray-600 border border-transparent rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 disabled:opacity-50 disabled:cursor-not-allowed",children:ot?"Importing...":`Import ${gt.length} Transactions`})]})]})}),bt&&e.jsx(Xs,{isOpen:bt,onClose:()=>{ft(!1),vt("")},title:"Paste & Import Transactions",size:"lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Format:"})," Tab-separated values (her satır bir transaction)",e.jsx("br",{}),e.jsx("strong",{children:"Kolonlar:"})," Müşteri Adı | Ödeme Yöntemi | Şirket | ORDER | Tarih (DD.MM.YYYY) | Kategori (YATIRIM/ÇEKME) | Tutar | Komisyon | Net Tutar | Para Birimi | PSP | MÜŞTERİ"]})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"pasteData",className:"block text-sm font-medium text-gray-700 mb-2",children:"Transaction Verileri (Tab-separated):"}),e.jsx("textarea",{id:"pasteData",value:Nt,onChange:e=>vt(e.target.value),placeholder:"Verileri buraya yapıştırın...",className:"w-full h-64 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 font-mono text-sm"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[Nt.split("\n").filter(e=>e.trim()).length," satır tespit edildi"]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>{ft(!1),vt("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"İptal"}),e.jsx("button",{onClick:async()=>{if(Nt.trim())try{const e=(e=>{const s=[],t=e.trim().split("\n"),a=e=>{const s=e.replace(/\./g,"").replace(",",".");return parseFloat(s)||0},r=e=>{try{const s=e.split(".");if(3===s.length){const e=s[0].padStart(2,"0"),t=s[1].padStart(2,"0");return`${s[2]}-${t}-${e}`}return null}catch{return null}},n=e=>{const s=e.trim().toUpperCase();return"YATIRIM"===s?"DEP":"ÇEKME"===s?"WD":"DEP"};for(const l of t){if(!l.trim())continue;const e=l.split("\t");if(e.length<12)continue;const t=e[0].trim(),i=e[1].trim(),c=e[2].trim(),o=e[4].trim(),d=e[5].trim(),m=e[6].trim(),x=e[7].trim(),h=e[8].trim(),u=e[9].trim(),g=e[10].trim(),p=r(o);if(!p)continue;const j=n(d);let y=a(m);const b=a(x);let f=a(h);"WD"===j&&y>0&&(y=-y,f=-f);const N={id:0,client_name:t,company:c||"Unknown",payment_method:i,category:j,date:p,amount:y,commission:b,net_amount:f,currency:u,psp:g,notes:""};"USD"===u&&(N.exchange_rate=42.6),s.push(N)}return s})(Nt);if(0===e.length)return void alert("Parse edilen transaction bulunamadı. Lütfen veri formatını kontrol edin.");dt(!0);const s=e.map(e=>({client_name:e.client_name,company:e.company||"",payment_method:e.payment_method||"",category:e.category,amount:e.amount,commission:e.commission||0,net_amount:e.net_amount||e.amount,currency:e.currency||"TL",psp:e.psp||"",notes:e.notes||"",date:e.date||(new Date).toISOString().split("T")[0],exchange_rate:e.exchange_rate})),t=await Fe.post("/transactions/bulk-import",{transactions:s});if(t.ok){const e=await Fe.parseResponse(t);let s="Import tamamlandı!\n\n";s+=`✅ Başarılı: ${e.data.successful_imports} transaction\n`,s+=`❌ Başarısız: ${e.data.failed_imports} transaction\n`,s+=`⚠️ Atlandı: ${e.data.skipped_duplicates} transaction\n`,s+=`📝 Toplam işlenen: ${e.data.total_rows} satır\n`,e.data.warnings&&e.data.warnings.length>0&&(s+="\n⚠️ Uyarılar:\n",e.data.warnings.slice(0,5).forEach(e=>{s+=`• ${e}\n`})),e.data.errors&&e.data.errors.length>0&&(s+="\n❌ Hatalar:\n",e.data.errors.slice(0,5).forEach(e=>{s+=`• ${e}\n`})),alert(s),ft(!1),vt(""),"transactions"===Rs&&await _t(),await Dt(),await Qt()}else{const e=await Fe.parseResponse(t);alert(`Import başarısız: ${e.error||"Bilinmeyen hata"}`)}}catch(e){alert(`Import hatası: ${e.message||"Bilinmeyen hata oluştu"}`)}finally{dt(!1)}else alert("Lütfen veri yapıştırın")},disabled:ot||!Nt.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 border border-transparent rounded-md hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed",children:ot?"Importing...":"Import Et"})]})]})}),me&&e.jsx(Xs,{isOpen:me,onClose:()=>xe(!1),title:t("transactions.bulk_delete_all"),size:"md",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(l,{className:"w-5 h-5 text-red-600"}),e.jsx("h5",{className:"text-sm font-medium text-red-800",children:"⚠️ DANGER ZONE"})]}),e.jsxs("p",{className:"text-sm text-red-700",children:["This action will ",e.jsx("strong",{children:"permanently delete ALL transactions"})," from the system. This action cannot be undone and will affect all client data, reports, and analytics."]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmationCode",className:"block text-sm font-medium text-gray-700 mb-2",children:"Enter Confirmation Code:"}),e.jsx("input",{type:"text",id:"confirmationCode",value:he,onChange:e=>ue(e.target.value),placeholder:"Enter 4-digit code",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-gray-500",maxLength:4,autoComplete:"off"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"You must enter the exact 4-digit confirmation code to proceed with deletion."})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>xe(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if("4561"===he){if(confirm(t("transactions.confirm_delete_all"))){pe(!0);try{const s=await Fe.post("/transactions/bulk-delete",{confirmation_code:he});if(s.ok){const a=await Fe.parseResponse(s);alert(t("transactions.deleted_success").replace("{count}",a.data.deleted_count)),xe(!1),ue(""),Vt(null),Jt(0);try{localStorage.removeItem("pipeline_transactions_data"),localStorage.removeItem("pipeline_clients_data"),localStorage.removeItem("pipeline_dashboard_cache")}catch(e){}T([]),S([]),v.current=!1,await wt(),await Qt()}else{const e=await Fe.parseResponse(s);alert(`${t("transactions.bulk_delete_failed")}: ${e.error||"Unknown error"}`)}}catch(s){alert(`${t("transactions.bulk_delete_failed")}: ${s.message||"Unknown error"}`)}finally{pe(!1)}}}else alert(t("transactions.invalid_confirmation_code"))},disabled:ge||"4561"!==he,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed",children:ge?"Deleting...":"Delete All Transactions"})]})]})}),Te&&e.jsx(Xs,{isOpen:Te,onClose:ta,title:`${t("exchange_rates.edit_rate")} - ${Ae}`,size:"md",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(cs,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center",children:e.jsx(E,{className:"w-4 h-4 text-gray-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-1",children:"USD/TRY Exchange Rate"}),e.jsxs("p",{className:"text-sm text-gray-600 leading-relaxed",children:["This rate is used to calculate gross balances for ",Ae,". Changing this rate will recalculate all balances for this date."]})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Exchange Rate (USD/TRY)"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(ts,{type:"number",step:"0.0001",min:"0",value:$e,onChange:e=>Ue(e.target.value),className:"flex-1",placeholder:"Enter exchange rate (e.g., 48.3900)",disabled:Ie}),e.jsxs(os,{onClick:()=>{Je(!0),Xe(Ae)},disabled:Ie,variant:"secondary",className:"flex items-center gap-2 whitespace-nowrap",children:[e.jsx(Q,{className:"w-4 h-4"}),"Select Date"]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Example: 48.3900 means 1 USD = 48.39 TRY"})]}),$e&&parseFloat($e)>0&&e.jsxs(cs,{className:"p-4",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-3",children:"Preview"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100 last:border-b-0",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"New Rate:"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["1 USD = ",parseFloat($e).toFixed(4)," TRY"]})]}),e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Inverse:"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["1 TRY = ",(1/parseFloat($e)).toFixed(6)," USD"]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(os,{onClick:ta,disabled:Ie,variant:"outline",children:"Cancel"}),e.jsx(os,{onClick:async()=>{if(Ae&&$e)try{Ve(!0);const e=parseFloat($e);if(isNaN(e)||e<=0)return void alert(t("transactions.invalid_rate"));De(s=>({...s,[Ae]:{...s[Ae],rate:e}}));const s=await Fe.put(`/exchange-rates/${Ae}`,{rate:e});if(s.ok)await Fe.parseResponse(s),await _t(),await Rt(C),ta(),alert(t("transactions.rate_updated_success").replace("{date}",Ae));else{await Rt(C);const e=await Fe.parseResponse(s);alert(`${t("transactions.failed_update_rate")}: ${e.error||"Unknown error"}`)}}catch(e){await Rt(C),alert(t("transactions.failed_save_rate"))}finally{Ve(!1)}},disabled:Ie||!$e||parseFloat($e)<=0,variant:"primary",children:Ie?"Saving...":"Save Rate"})]})]})}),qe&&e.jsx(Xs,{isOpen:qe,onClose:()=>Je(!1),title:t("exchange_rates.select_date"),size:"sm",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(cs,{className:"p-4 text-center",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 rounded-full bg-gray-100",children:e.jsx(Q,{className:"w-6 h-6 text-gray-600"})}),e.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-2",children:"Choose Date"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Select a date to fetch the USD/TRY exchange rate from yfinance"}),e.jsx(ts,{type:"date",value:Ge,onChange:e=>Xe(e.target.value),className:"w-full max-w-xs mx-auto",max:(new Date).toISOString().split("T")[0]})]}),e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsx(os,{onClick:()=>Je(!1),variant:"outline",children:"Cancel"}),e.jsx(os,{onClick:()=>(async e=>{if(e)try{Ve(!0),Je(!1);const s=await Fe.post(`/exchange-rates/${e}/fetch`);if(s.ok){const a=await Fe.parseResponse(s);if(a.success&&a.data){const s=a.data.rate;Ue(s.toString()),Re(e)}else alert(t("transactions.yfinance_failed"))}else alert(t("transactions.yfinance_failed"))}catch(s){alert(t("transactions.yfinance_error"))}finally{Ve(!1)}})(Ge),disabled:!Ge||Ie,variant:"primary",children:Ie?"Fetching...":"Get Rate"})]})]})})]})]});var ia}},Symbol.toStringTag,{value:"Module"})),lt={primary:{iconBg:"bg-blue-50",icon:"text-blue-600",accent:"#2D5EFF"},success:{iconBg:"bg-green-50",icon:"text-green-600",accent:"#16A34A"},warning:{iconBg:"bg-amber-50",icon:"text-amber-600",accent:"#F59E0B"},danger:{iconBg:"bg-red-50",icon:"text-red-600",accent:"#DC2626"},neutral:{iconBg:"bg-gray-50",icon:"text-gray-600",accent:"#6B7280"},turquoise:{iconBg:"bg-teal-50",icon:"text-teal-600",accent:"#2CC5A7"},gray:{iconBg:"bg-gray-50",icon:"text-gray-600",accent:"#6B7280"},green:{iconBg:"bg-green-50",icon:"text-green-600",accent:"#16A34A"},red:{iconBg:"bg-red-50",icon:"text-red-600",accent:"#DC2626"},purple:{iconBg:"bg-purple-50",icon:"text-purple-600",accent:"#7C3AED"},orange:{iconBg:"bg-orange-50",icon:"text-orange-600",accent:"#F59E0B"},indigo:{iconBg:"bg-indigo-50",icon:"text-indigo-600",accent:"#4F46E5"},teal:{iconBg:"bg-teal-50",icon:"text-teal-600",accent:"#2CC5A7"},pink:{iconBg:"bg-pink-50",icon:"text-pink-600",accent:"#EC4899"}},it=r.memo(({title:s,value:t,icon:a,variant:r="default",color:n="primary",loading:l=!1,subtitle:i,onClick:c,className:o=""})=>{const d=lt[n]||lt.primary,m=!!c;if(l)return e.jsx(Ls,{variant:r});const x=()=>{const s=a;return e.jsx(s,{style:{width:"var(--icon-default)",height:"var(--icon-default)"}})},h=`\n    enterprise-card\n    ${m?"cursor-pointer":""}\n    ${o}\n  `;switch(r){case"gradient":return e.jsxs("div",{className:`${h} enterprise-card enterprise-card-gradient`,onClick:c,children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("div",{className:"rounded-lg flex items-center justify-center backdrop-blur-sm",style:{width:"var(--space-8)",height:"var(--space-8)",backgroundColor:"rgba(255, 255, 255, 0.2)"},children:e.jsx("div",{className:"text-white",children:x()})})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"text-sm font-medium text-white/90",children:s}),e.jsx("p",{className:"text-lg font-semibold text-white",children:t}),i&&e.jsx("p",{className:"text-xs text-white/70",children:i})]})]});case"minimal":return e.jsx("div",{className:`${h} enterprise-card-compact`,onClick:c,children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`${d.iconBg} rounded-md flex items-center justify-center`,style:{width:"var(--space-6)",height:"var(--space-6)"},children:e.jsx("div",{className:d.icon,children:x()})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:s}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:t}),i&&e.jsx("p",{className:"text-xs text-gray-500",children:i})]})]})})});case"compact":return e.jsx("div",{className:`${h} enterprise-card-compact`,onClick:c,style:{padding:"var(--space-2)"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`${d.iconBg} rounded-md flex items-center justify-center`,style:{width:"var(--space-6)",height:"var(--space-6)"},children:e.jsx("div",{className:d.icon,children:x()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide truncate",children:s}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:t})}),i&&e.jsx("p",{className:"text-xs text-gray-500 truncate",children:i})]})]})});default:return e.jsxs("div",{className:h,onClick:c,children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("div",{className:`${d.iconBg} rounded-lg flex items-center justify-center`,style:{width:"var(--space-8)",height:"var(--space-8)"},children:e.jsx("div",{className:d.icon,children:x()})})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:s}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:t}),i&&e.jsx("p",{className:"text-xs text-gray-500",children:i})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 opacity-0 group-hover:opacity-100 transition-opacity duration-200",style:{backgroundColor:d.accent}})]})}});it.displayName="StandardMetricsCard";const ct=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{t:s}=Pe(),[t,a]=r.useState([]),[l,c]=r.useState(""),[x,h]=r.useState("all"),[u,g]=r.useState("all"),[p,f]=r.useState("all"),[N,v]=r.useState(!1),[w,_]=r.useState(!1),[k,S]=$s("overview"),C=()=>{try{const e=localStorage.getItem("systemDepartments");if(e)return JSON.parse(e)}catch(e){}return["Conversion","Retention","Marketing","Research","Operation","Management","Facility"]},[D,T]=r.useState(C());r.useEffect(()=>{const e=()=>{T(C())};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]);const[E,A]=r.useState({startDate:"",companyName:"",nickname:"",salary:0,insurance:!1,name:"",email:"",phone:"",role:"",department:""}),R=t.filter(e=>{const s=e.name.toLowerCase().includes(l.toLowerCase())||e.email.toLowerCase().includes(l.toLowerCase()),t="all"===x||e.status===x,a="all"===u||e.department===u,r="all"===p||e.department===p;return s&&t&&a&&r}),$=R.length,L=R.filter(e=>"active"===e.status).length,U=R.reduce((e,s)=>e+s.totalTransactions,0),M=R.length>0?Math.round(R.reduce((e,s)=>e+s.performance,0)/R.length):0,I=()=>{_(!0)},z=()=>{_(!1),A({startDate:"",companyName:"",nickname:"",salary:0,insurance:!1,name:"",email:"",phone:"",role:"",department:""})},W=(e,s)=>{A(t=>({...t,[e]:s}))};return e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(d,{className:"h-8 w-8 text-gray-600"}),"Agent Management"]}),e.jsx("p",{className:"text-gray-600",children:"Team management"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(os,{variant:"outline",size:"sm",onClick:()=>{const e=[["Name","Email","Phone","Role","Department","Status","Hire Date","Total Transactions","Performance","Company","Nickname","Salary","Insurance"].join(","),...t.map(e=>[`"${e.name}"`,`"${e.email}"`,`"${e.phone}"`,`"${e.role}"`,`"${e.department}"`,`"${e.status}"`,`"${e.hireDate}"`,e.totalTransactions,e.performance,`"${e.companyName||""}"`,`"${e.nickname||""}"`,e.salary||0,e.insurance?"Yes":"No"].join(","))].join("\n"),s=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),r=URL.createObjectURL(s);a.setAttribute("href",r),a.setAttribute("download",`agents_export_${(new Date).toISOString().split("T")[0]}.csv`),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)},icon:e.jsx(B,{className:"h-4 w-4"}),iconPosition:"left",children:"Export"}),e.jsx(os,{variant:"primary",size:"sm",onClick:I,icon:e.jsx(H,{className:"h-4 w-4"}),iconPosition:"left",children:"Add Agent"})]})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"bg-gray-50/50 border border-gray-200/60 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("span",{className:"font-medium",children:["Active Agents: ",L]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full"}),e.jsxs("span",{className:"font-medium",children:[s("dashboard.total_transactions"),": ",U.toLocaleString()]})]})]})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100/50 px-6 py-2",children:e.jsxs("nav",{className:"flex space-x-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>S("overview"),className:"tab-button px-6 py-3 rounded-xl font-medium text-sm transition-all duration-200 flex items-center gap-2 "+("overview"===k?"bg-white text-gray-600 shadow-md border border-gray-200":"text-gray-600 hover:text-gray-800 hover:bg-white/50"),children:[e.jsx(n,{className:"h-4 w-4"}),"Overview"]}),"overview"===k&&e.jsx("button",{onClick:()=>{window.location.reload()},className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-white/60 rounded-lg transition-all duration-200 hover:shadow-sm",title:"Refresh Overview data",children:e.jsx(i,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>S("agents"),className:"tab-button px-6 py-3 rounded-xl font-medium text-sm transition-all duration-200 flex items-center gap-2 "+("agents"===k?"bg-white text-gray-600 shadow-md border border-gray-200":"text-gray-600 hover:text-gray-800 hover:bg-white/50"),children:[e.jsx(d,{className:"h-4 w-4"}),"Agents"]}),"agents"===k&&e.jsx("button",{onClick:()=>{window.location.reload()},className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-white/60 rounded-lg transition-all duration-200 hover:shadow-sm",title:"Refresh Agents data",children:e.jsx(i,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>S("analytics"),className:"tab-button px-6 py-3 rounded-xl font-medium text-sm transition-all duration-200 flex items-center gap-2 "+("analytics"===k?"bg-white text-gray-600 shadow-md border border-gray-200":"text-gray-600 hover:text-gray-800 hover:bg-white/50"),children:[e.jsx(V,{className:"h-4 w-4"}),"Analytics"]}),"analytics"===k&&e.jsx("button",{onClick:()=>{window.location.reload()},className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-white/60 rounded-lg transition-all duration-200 hover:shadow-sm",title:"Refresh Analytics data",children:e.jsx(i,{className:"h-4 w-4"})})]})]})})}),"overview"===k&&e.jsx("div",{children:e.jsxs(cs,{variant:"elevated",className:"mb-6",children:[e.jsxs(Ye,{children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(n,{className:"h-5 w-5 text-gray-600"}),"Performance Overview"]}),e.jsx(He,{children:"Key metrics and performance indicators for your agent team"})]}),e.jsx(Me,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(it,{title:"Total Agents",value:$,subtitle:"+5.2% from last month",icon:d,color:"primary",variant:"default"}),e.jsx(it,{title:"Active Agents",value:L,subtitle:"+8.7% from last month",icon:b,color:"success",variant:"default"}),e.jsx(it,{title:s("dashboard.total_transactions"),value:U.toLocaleString(),subtitle:"+12.3% from last month",icon:y,color:"orange",variant:"default"}),e.jsx(it,{title:"Avg. Performance",value:`${M}%`,subtitle:"+3.1% from last month",icon:J,color:"purple",variant:"default"})]})})]})}),"agents"===k&&e.jsx("div",{children:e.jsxs(cs,{variant:"elevated",className:"mb-6",children:[e.jsxs(Ye,{children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(d,{className:"h-5 w-5 text-gray-600"}),"Agent Management"]}),e.jsx(He,{children:"Search, filter, and manage your agent team"})]}),e.jsxs(Me,{children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:[e.jsx("div",{className:"p-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-5 w-5 text-gray-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Filters"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",[l,x,u].filter(e=>e&&"all"!==e).length," ","active)"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ns,{variant:"outline",size:"sm",onClick:()=>{c(""),h("all"),g("all"),f("all")},className:"flex items-center gap-2",children:"Reset"}),e.jsxs(ns,{variant:"outline",size:"sm",onClick:()=>v(!N),className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4 transition-transform duration-200 "+(N?"rotate-180":"")}),N?"Hide":"Show"," Filters"]})]})]})}),N&&e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Agents"}),e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by name or email...",value:l,onChange:e=>c(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:x,onChange:e=>h(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),e.jsxs("select",{value:u,onChange:e=>g(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",children:[e.jsx("option",{value:"all",children:"All Departments"}),D.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"px-8 py-6 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-gray-100/50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-gray-500 to-purple-600 rounded-xl flex items-center justify-center shadow-sm",children:e.jsx(d,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Agents"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage and view all agent records"})]})]})}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("div",{className:"bg-white px-4 py-2 rounded-xl border border-gray-200 shadow-sm",children:e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[R.length," agent",1!==R.length?"s":""]})})})]})}),e.jsx("div",{className:"px-8 py-4 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-gray-100/30",children:e.jsxs("nav",{className:"flex space-x-1 overflow-x-auto",children:[e.jsxs("button",{onClick:()=>f("all"),className:"tab-button px-4 py-2 rounded-lg font-medium text-sm transition-all duration-200 flex items-center gap-2 whitespace-nowrap "+("all"===p?"bg-gray-600 text-white shadow-md":"text-gray-600 hover:text-gray-800 hover:bg-white/50"),children:[e.jsx(d,{className:"h-4 w-4"}),"All Departments",e.jsx("span",{className:"ml-1 px-2 py-0.5 text-xs bg-white/20 rounded-full",children:t.length})]}),D.map(s=>{const a=(e=>{switch(e){case"Conversion":return o;case"Retention":return m;case"Marketing":return n;case"Research":return se;case"Operation":return b;case"Management":return d;default:return j}})(s);return e.jsxs("button",{onClick:()=>f(s),className:"tab-button px-4 py-2 rounded-lg font-medium text-sm transition-all duration-200 flex items-center gap-2 whitespace-nowrap "+(p===s?"bg-gray-600 text-white shadow-md":"text-gray-600 hover:text-gray-800 hover:bg-white/50"),children:[e.jsx(a,{className:"h-4 w-4"}),s,e.jsx("span",{className:"ml-1 px-2 py-0.5 text-xs bg-white/20 rounded-full",children:t.filter(e=>e.department===s).length})]},s)})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{className:"h-3 w-3"}),"Agent"]})}),e.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-3 w-3"}),"Contact"]})}),e.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-3 w-3"}),"Role & Department"]})}),e.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{className:"h-3 w-3"}),"Performance"]})}),e.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-3 w-3"}),"Transactions"]})}),e.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-3 w-3"}),"Status"]})}),e.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-3 w-3"}),"Actions"]})})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:R.map((s,t)=>e.jsxs("tr",{className:"hover:bg-gradient-to-r hover:from-gray-50/50 hover:to-purple-50/50 transition-all duration-200 group "+(t%2==0?"bg-white":"bg-gray-50/30"),children:[e.jsx("td",{className:"px-8 py-5 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-500 to-gray-600 rounded-xl flex items-center justify-center shadow-sm",children:e.jsx("span",{className:"text-white font-semibold text-sm",children:s.name.split(" ").map(e=>e[0]).join("")})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:s.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Hired: ",new Date(s.hireDate).toLocaleDateString()]})]})]})}),e.jsxs("td",{className:"px-8 py-5 whitespace-nowrap",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-900 font-medium",children:s.email})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx(re,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-500",children:s.phone})]})]}),e.jsxs("td",{className:"px-8 py-5 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:s.role}),e.jsx("div",{className:"text-sm text-gray-500",children:s.department})]}),e.jsx("td",{className:"px-8 py-5 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2.5 mr-3",children:e.jsx("div",{className:"h-2.5 rounded-full transition-all duration-300 "+(s.performance>=90?"bg-green-500":s.performance>=70?"bg-yellow-500":"bg-red-500"),style:{width:`${s.performance}%`}})}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900 min-w-[3rem]",children:[s.performance,"%"]})]})}),e.jsx("td",{className:"px-8 py-5 whitespace-nowrap",children:e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:s.totalTransactions.toLocaleString()})}),e.jsx("td",{className:"px-8 py-5 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex px-3 py-1 text-xs font-semibold rounded-full "+("active"===s.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})}),e.jsx("td",{className:"px-8 py-5 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-50 rounded transition-colors duration-200",title:"View Details",children:e.jsx(F,{className:"h-3.5 w-3.5"})}),e.jsx("button",{className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors duration-200",title:"Edit Agent",children:e.jsx(K,{className:"h-3.5 w-3.5"})}),e.jsx("button",{className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors duration-200",title:"Delete Agent",children:e.jsx(Y,{className:"h-3.5 w-3.5"})})]})})]},s.id))})]})}),0===R.length&&e.jsxs("div",{className:"text-center py-16 px-6",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(d,{className:"h-10 w-10 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:l||"all"!==x||"all"!==u||"all"!==p?"No agents found":"No agents yet"}),e.jsx("p",{className:"text-gray-500 mb-6 max-w-md mx-auto",children:l||"all"!==x||"all"!==u||"all"!==p?"Try adjusting your search criteria or filters to find what you're looking for.":"Start building your team by adding your first agent to the system."}),e.jsxs("button",{onClick:I,className:"inline-flex items-center px-6 py-3 border border-transparent rounded-lg text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors shadow-sm",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Add Your First Agent"]})]}),R.length>0&&e.jsx("div",{className:"px-6 py-4 border-t border-gray-100 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-700",children:[e.jsxs("span",{children:["Showing ",R.length," agent",1!==R.length?"s":""]}),e.jsxs("span",{className:"font-semibold",children:["Avg Performance: ",M,"%"]})]})})]})]})]})}),"analytics"===k&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Agent Analytics"}),e.jsx("p",{className:"text-gray-600",children:"Analytics content will be implemented here."})]})}),w&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Add New Agent"}),e.jsx("button",{onClick:z,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:e.jsx(P,{className:"h-5 w-5"})})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),e.jsx("input",{type:"text",value:E.name,onChange:e=>W("name",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",placeholder:"Enter full name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",value:E.email,onChange:e=>W("email",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",placeholder:"Enter email address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone *"}),e.jsx("input",{type:"tel",value:E.phone,onChange:e=>W("phone",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",placeholder:"Enter phone number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date *"}),e.jsx("input",{type:"date",value:E.startDate,onChange:e=>W("startDate",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Company Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Name"}),e.jsx("input",{type:"text",value:E.companyName,onChange:e=>W("companyName",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",placeholder:"Enter company name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nickname"}),e.jsx("input",{type:"text",value:E.nickname,onChange:e=>W("nickname",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",placeholder:"Enter nickname"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Role & Department"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role *"}),e.jsxs("select",{value:E.role,onChange:e=>W("role",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",children:[e.jsx("option",{value:"",children:"Select role"}),e.jsx("option",{value:"Senior Agent",children:"Senior Agent"}),e.jsx("option",{value:"Agent",children:"Agent"}),e.jsx("option",{value:"Junior Agent",children:"Junior Agent"}),e.jsx("option",{value:"Team Lead",children:"Team Lead"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department *"}),e.jsxs("select",{value:E.department,onChange:e=>W("department",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",children:[e.jsx("option",{value:"",children:"Select department"}),D.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Financial Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Salary (₺)"}),e.jsx("input",{type:"number",value:E.salary,onChange:e=>W("salary",parseFloat(e.target.value)||0),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors duration-200",placeholder:"Enter salary amount"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Insurance"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"insurance",checked:!0===E.insurance,onChange:()=>W("insurance",!0),className:"h-4 w-4 text-gray-600 focus:ring-gray-500 border-gray-300"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Yes"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"insurance",checked:!1===E.insurance,onChange:()=>W("insurance",!1),className:"h-4 w-4 text-gray-600 focus:ring-gray-500 border-gray-300"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"No"})]})]})]})]})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-100",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:z,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200",children:"Cancel"}),e.jsx("button",{onClick:()=>{const e={id:Date.now(),...E,status:"active",hireDate:E.startDate,totalTransactions:0,performance:85};a(s=>[...s,e]),A({startDate:"",companyName:"",nickname:"",salary:0,insurance:!1,name:"",email:"",phone:"",role:"",department:""}),_(!1)},disabled:!(E.name&&E.email&&E.phone&&E.startDate&&E.role&&E.department),className:"flex-1 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Add Agent"})]})})]})})]})]})}},Symbol.toStringTag,{value:"Module"})),ot=e=>0===e?"text-gray-500":e<=2?"text-green-600":e<=5?"text-yellow-600":e<=10?"text-orange-600":"text-red-600",dt=e=>0===e?"bg-gray-100 text-gray-600":e<=2?"bg-green-100 text-green-800":e<=5?"bg-yellow-100 text-yellow-800":e<=10?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800",mt=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{isAuthenticated:a,isLoading:c}=Le(),{t:d}=Pe(),x=(e,s)=>"TETHER"===s.toUpperCase()?((e,s="en-US")=>Js(e,"$",s))(e):Js(e,"₺"),[h,u]=r.useState([]),[p,j]=r.useState(!0),[f,N]=r.useState(null),[v,w]=r.useState(""),[_,C]=r.useState("all"),[D,T]=r.useState(!1);r.useState(!1);const[F,E]=$s("overview"),[A,R]=r.useState(!1);r.useState("idle"),r.useState(!1);const[$,O]=r.useState(!1),[Y,W]=r.useState(null),[H,J]=r.useState(null),[G,X]=r.useState([]),[Q,Z]=r.useState(!1),[ee,se]=r.useState((new Date).getFullYear()),[te,ae]=r.useState((new Date).getMonth()+1),[re,de]=r.useState(new Set),[me,xe]=r.useState(1),[he]=r.useState(10);r.useState("30"),r.useState(""),r.useState(""),r.useState(!1);const[ue,ge]=r.useState(null),[pe,je]=r.useState([]),[ye,be]=r.useState(!1);r.useState({}),r.useState({});const[fe,Ne]=r.useState({}),[ve,we]=r.useState([]),[_e,ke]=r.useState(!1),[Se,Ce]=r.useState(null),[De,Te]=r.useState({}),[Ee,Ae]=r.useState(!1),[Re,$e]=r.useState([]),[Ue,Ie]=r.useState(!1),[Ve,qe]=r.useState(null),[Je,Ge]=r.useState(!1),[Xe,Qe]=r.useState(null),[Ze,es]=r.useState(""),[ss,as]=r.useState(!1),[rs,ls]=r.useState(!1),[is,os]=r.useState(null),[ds,xs]=r.useState(""),[hs,gs]=r.useState(!1),[fs,_s]=r.useState(""),[Es,As]=r.useState(!1),[Rs,Ps]=r.useState(null),[Ls,Us]=r.useState(""),[Ms,Is]=r.useState(!1),[zs,Bs]=r.useState(""),[Ks,Ys]=r.useState({startDate:"",endDate:"",psp:"",type:"",page:1}),Ws=(e,s,t)=>{const a=((e,s)=>{const t=new Date(e,s,0).getDate(),a=[];for(let r=1;r<=t;r++){const t=new Date(e,s-1,r),n=`${e}-${String(s).padStart(2,"0")}-${String(r).padStart(2,"0")}`;a.push({date:n,day:r,dayName:t.toLocaleDateString("tr-TR",{weekday:"short"}),isWeekend:0===t.getDay()||6===t.getDay()})}return a})(s,t),r=e.daily_breakdown||[],n=new Map;return r.forEach(e=>{n.set(e.date,e)}),a.map(e=>{const s=n.get(e.date);return s?{...s,day:e.day,dayName:e.dayName,isWeekend:e.isWeekend}:{date:e.date,day:e.day,dayName:e.dayName,isWeekend:e.isWeekend,yatimim:0,cekme:0,toplam:0,komisyon:0,net:0,tahs_tutari:0,kasa_top:0,devir:0,transaction_count:0}})};r.useEffect(()=>{window.scrollTo({top:0,behavior:"instant"})},[]),r.useEffect(()=>{a&&!c&&(N(null),Hs(),"overview"===F&&Gs())},[a,c,F]),r.useEffect(()=>{"monthly"===F&&a&&!c&&(qs(ee,te),Zs(Ks.page))},[F,a,c,ee,te,Ks.startDate,Ks.endDate,Ks.psp,Ks.type]),r.useEffect(()=>{const e=e=>{a&&!c&&(Hs(!0),"overview"===F&&Gs(!0))};return window.addEventListener("transactionsUpdated",e),()=>{window.removeEventListener("transactionsUpdated",e)}},[a,c,F]),r.useEffect(()=>()=>{Fe.clearCacheForUrl("psp_summary_stats"),Fe.clearCacheForUrl("ledger-data")},[]);const Hs=async(e=!1)=>{try{j(!0),N(null),e&&Fe.clearCacheForUrl("psp_summary_stats");const s=await Fe.get("/transactions/psp_summary_stats");if(401===s.status)return;const t=Fe.parseResponse(s);if(200===s.status&&t){const e=(Array.isArray(t)?t:[]).map(e=>({psp:e.psp||"Unknown",total_amount:e.total_amount||0,total_commission:e.total_commission||0,total_net:e.total_net||0,total_allocations:e.total_allocations||0,total_deposits:e.total_deposits||0,total_withdrawals:e.total_withdrawals||0,transaction_count:e.transaction_count||0,commission_rate:e.commission_rate||0}));u(e)}else{const e=t&&"object"==typeof t&&"message"in t?t.message:"Failed to load PSP data";N(e),u([])}}catch(s){N(`Failed to load PSP data: ${s instanceof Error?s.message:"Unknown error"}`),u([])}finally{j(!1)}},Vs=(e,s)=>{if(0===s)return"Normal";const t=e/s;return t>.3?"Critical":t>.2?"High":t>.1?"Medium":"Normal"},qs=async(e,s,t=!1,a=!0)=>{try{Z(!0),N(null);const r=`/transactions/psp_monthly_stats?year=${e}&month=${s}${a?"&include_daily=true":"&include_daily=false"}${t?`&_t=${Date.now()}`:""}`,n=await Fe.get(r,void 0,!t);if(401===n.status)return;if(!n.ok){const e=await n.json().catch(()=>({}));throw new Error(e.message||`HTTP ${n.status}: ${n.statusText}`)}const l=await Fe.parseResponse(n);let i=[];if(Array.isArray(l))i=l;else if(l&&Array.isArray(l.data))i=l.data;else if(l&&"object"==typeof l){const e=["psps","psp_data","monthly_data","results"];for(const s of e)if(Array.isArray(l[s])){i=l[s];break}}X(i),0===i.length?N(`No PSP data available for ${new Date(e,s-1).toLocaleString("default",{month:"long",year:"numeric"})}`):N(null)}catch(r){const e=r instanceof Error?r.message:"Failed to fetch monthly data";N(e),X([])}finally{Z(!1)}},Gs=async(e=!1)=>{be(!0);try{e&&Fe.clearCacheForUrl("ledger-data");const t=await Fe.get("/analytics/ledger-data",void 0,!e);if(t.ok){const e=await Fe.parseResponse(t),s=e.ledger_data||[];je(s);const a={};if(s.forEach(e=>{Object.entries(e.psps).forEach(([s,t])=>{const r=`${e.date}-${s}`,n=t;a[r]=n.allocation||0})}),Ne(a),Xs(s,h),e&&"object"==typeof e&&"validation_errors"in e){const s=e.validation_errors;Array.isArray(s)&&s.length>0?N(`Data loaded with warnings: ${s.join(", ")}`):N(null)}else N(null)}else{let e="Failed to fetch ledger data";try{const s=await Fe.parseResponse(t).catch(()=>({}));s&&"object"==typeof s&&"error"in s?e=s.error||e:404===t.status&&(e="Ledger data endpoint not found. Please check backend configuration.")}catch(s){404===t.status&&(e="Ledger data endpoint not found. Please check backend configuration.")}N(e)}}catch(t){const e=t?.message||"Network error occurred";e.includes("bulunamadı")||e.includes("404")||e.includes("Not Found")?N("Endpoint bulunamadı. Backend servisinin çalıştığından emin olun."):N(`Failed to load ledger data: ${e}`),je([])}finally{be(!1)}},Xs=r.useCallback((e,s)=>{const t=new Map;e.forEach(e=>{Object.entries(e.psps).forEach(([s,a])=>{t.has(s)||t.set(s,{psp:s,total_deposits:0,total_withdrawals:0,total_net:0,total_allocations:0,total_rollover:0,transaction_count:0,average_transaction:0,last_activity:e.date_str});const r=t.get(s);r.total_deposits+=a.deposit||0,r.total_withdrawals+=a.withdraw||0,r.total_net+=a.net||0,r.transaction_count+=a.transaction_count||1,r.last_activity=e.date_str})}),t.forEach(e=>{const t=s.find(s=>s.psp===e.psp);e.total_allocations=t?.total_allocations||0,e.average_transaction=e.transaction_count>0?e.total_net/e.transaction_count:0,e.total_rollover=e.total_net-e.total_allocations});const a=Array.from(t.values());we(a)},[]),Qs=()=>{ke(!1),Ce(null),Te({})},Zs=async(e=1)=>{Ie(!0);try{const s=new URLSearchParams({page:e.toString(),per_page:"50"});Ks.startDate&&s.append("start_date",Ks.startDate),Ks.endDate&&s.append("end_date",Ks.endDate),Ks.psp&&s.append("psp",Ks.psp),Ks.type&&s.append("type",Ks.type);const t=await Fe.get(`/analytics/unified-history?${s}`);if(t.ok){const e=await Fe.parseResponse(t);if(e&&"object"==typeof e&&"success"in e&&e.success){const s=e.data||[];$e(s),qe(e.pagination||null)}else e&&"object"==typeof e&&"error"in e&&N(e.error||"Failed to load history data")}else{const e=await Fe.parseResponse(t).catch(()=>({}));N(e?.error||"Failed to fetch history data")}}catch(s){const e=s instanceof Error?s.message:"Failed to fetch history data";N(e),$e([]),qe(null)}finally{Ie(!1)}},et=(e,s)=>{const t={...Ks,[e]:s,page:1};Ys(t),Zs(1)},st=e=>{Ys(s=>({...s,page:e})),Zs(e)},tt=async e=>{try{const s=new URLSearchParams({format:e});Ks.startDate&&s.append("start_date",Ks.startDate),Ks.endDate&&s.append("end_date",Ks.endDate),Ks.psp&&s.append("psp",Ks.psp),Ks.type&&s.append("type",Ks.type);const t=await Fe.get(`/analytics/unified-history/export?${s}`,{responseType:"blob"});if(t.ok){const s=window.URL.createObjectURL(await t.blob()),a=document.createElement("a");a.href=s,a.setAttribute("download",`unified_history_${(new Date).toISOString().split("T")[0]}.${e}`),document.body.appendChild(a),a.click(),a.remove(),window.URL.revokeObjectURL(s)}}catch(s){}},at=async(e,s,t)=>{let a=0;for(;a<=2;)try{if(a>0)try{Fe.clearToken?.(),await Fe.get("/auth/csrf-token"),await new Promise(e=>setTimeout(e,300))}catch(r){}const l=await Fe.post("/analytics/update-allocation",{date:e,psp:s,allocation:t});if(!l.ok){let e="Allocation kaydedilemedi",s="";try{const t=await Fe.parseResponse(l);if((t?.csrf_error||t?.error?.includes("CSRF")||t?.error?.includes("token")||t?.error?.includes("Security token")||t?.message?.includes("CSRF")||t?.message?.includes("token"))&&a<2){a++;continue}e=t?.error||t?.message||e,s=t?.details||t?.message||""}catch(n){if(a<2){a++;continue}e=`HTTP ${l.status}`}const t=s?`${e} - ${s}`:e;throw new Error(t)}try{return await Fe.parseResponse(l)||{success:!0}}catch(n){return{success:!0}}}catch(l){if((l?.message?.includes("CSRF")||l?.message?.includes("token")||l?.message?.includes("Security token"))&&a<2){a++,await new Promise(e=>setTimeout(e,300));continue}throw l.message?l:new Error("Ağ hatası veya istek başarısız oldu")}throw new Error("Güvenlik token hatası - Lütfen sayfayı yenileyin ve tekrar deneyin")},nt=()=>{Ge(!1),Qe(null),es("")},lt=()=>{ls(!1),os(null),xs(""),_s("")},it=()=>{As(!1),Ps(null),Us(""),Bs("")},ct=()=>{O(!1),W(null),J(null),ge(null)},mt=e=>new Intl.NumberFormat("en-US").format(e),xt=Array.isArray(h)?h.filter(e=>{const s=e.psp.toLowerCase().includes(v.toLowerCase()),t="all"===_||e.psp===_;return s&&t}):[];return xt.reduce((e,s)=>e+s.total_amount,0),xt.reduce((e,s)=>e+s.total_commission,0),xt.reduce((e,s)=>e+s.total_net,0),xt.reduce((e,s)=>e+s.transaction_count,0),!Array.isArray(h)||new Set(h.map(e=>e.psp)),c||p?e.jsx(Os,{}):f?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-50 to-red-50",children:e.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(l,{className:"h-10 w-10 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Error Loading Data"}),e.jsx("p",{className:"text-gray-600 mb-6",children:f}),e.jsxs("button",{onClick:()=>Hs(!0),className:"inline-flex items-center gap-2 px-6 py-3 bg-accent-600 text-white rounded-lg hover:bg-accent-700 transition-colors duration-200",children:[e.jsx(i,{className:"h-4 w-4"}),"Try Again"]})]})}):e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(L,{className:"h-8 w-8 text-gray-600"}),d("ledger.psp_ledger")]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:d("ledger.psp_transactions_balances")})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(ns,{variant:"outline",size:"default",onClick:async()=>{T(!0);try{const e=[Hs(!0),Gs(!0)];"monthly"===F&&e.push(qs(ee,te,!0)),await Promise.all(e)}finally{T(!1)}},disabled:D,className:"flex items-center gap-2 h-10 px-4 hover:bg-blue-50 hover:border-blue-300 hover:text-blue-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-sm",children:[e.jsx(i,{className:"h-4 w-4 "+(D?"animate-spin":"")}),d(D?"ledger.refreshing":"ledger.refresh")]}),e.jsxs(ns,{variant:"outline",size:"default",onClick:()=>{try{const e=["Date","PSP","Deposits","Withdrawals","Total","Commission","Net","Allocation","Rollover","Risk Level"],s=[];pe.forEach(e=>{Object.entries(e.psps).forEach(([t,a])=>{const r=(a.net||0)-(a.allocation||0),n=Vs(r,a.net||0);s.push([e.date_str,t,a.deposit||0,a.withdraw||0,a.toplam||0,a.komisyon||0,a.net||0,a.allocation||0,r,n])})});const t=[e,...s].map(e=>e.map(e=>`"${e}"`).join(",")).join("\n"),a=new Blob([t],{type:"text/csv;charset=utf-8;"}),r=window.URL.createObjectURL(a),n=document.createElement("a");n.href=r,n.download=`ledger_export_${(new Date).toISOString().split("T")[0]}.csv`,n.click(),window.URL.revokeObjectURL(r)}catch(e){alert(d("ledger.export_failed"))}},className:"flex items-center gap-2 h-10 px-4 hover:bg-gray-50 hover:border-gray-300 transition-all shadow-sm",children:[e.jsx(B,{className:"h-4 w-4"}),d("ledger.export")]})]})]})}),e.jsx("div",{className:"p-6",children:e.jsxs(Oe,{value:F,onValueChange:E,className:"w-full",children:[e.jsxs(ze,{className:"grid w-full grid-cols-4 bg-gray-50/80 border border-gray-200/60 rounded-lg shadow-sm",children:[e.jsxs(Be,{value:"overview",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg",children:[e.jsx(ne,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-blue-600"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:d("tabs.overview")})]}),e.jsxs(Be,{value:"monthly",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg",children:[e.jsx(M,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-blue-600"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:d("tabs.monthly")})]}),e.jsxs(Be,{value:"trust",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg",children:[e.jsx(le,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-blue-600"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:d("tabs.trust")})]}),e.jsxs(Be,{value:"analytics",className:"group flex items-center gap-2 transition-all duration-300 ease-in-out hover:bg-white/90 hover:shadow-md hover:scale-[1.02] data-[state=active]:bg-white data-[state=active]:shadow-lg",children:[e.jsx(n,{className:"h-4 w-4 transition-all duration-300 ease-in-out group-hover:scale-110 group-hover:text-blue-600"}),e.jsx("span",{className:"transition-all duration-300 ease-in-out group-hover:font-semibold",children:d("tabs.analytics")})]})]}),e.jsxs(Ke,{value:"overview",className:"mt-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(n,{className:"h-5 w-5 text-gray-600"}),d("ledger.psp_overview")]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:d("ledger.key_performance_all_psps")})]}),e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(rt,{title:d("ledger.total_psps"),value:mt(h.length),subtitle:d("ledger.active_providers"),icon:L,color:"gray",animated:!0,animationDuration:500}),(()=>{const s=pe.reduce((e,s)=>(Object.entries(s.psps).forEach(([s,t])=>{const a=(t.net||0)-(t.allocation||0),r=Vs(a,t.net||0);"Critical"===r?e.critical++:"High"===r?e.high++:"Medium"===r?e.medium++:e.normal++,e.totalRollover+=a}),e),{critical:0,high:0,medium:0,normal:0,totalRollover:0}),a=s.critical>0||s.high>0,r=a?"red":"green",n=a?t:S,l=a?`${s.critical+s.high}`:"0",i=a?`${s.critical} critical, ${s.high} high`:"Healthy levels";return e.jsx(rt,{title:d("ledger.rollover_risk"),value:l,subtitle:i,icon:n,color:r,animated:!0,animationDuration:500})})(),e.jsx(rt,{title:d("ledger.total_allocations"),value:Js(h.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.total_allocations),0),"₺"),subtitle:d("ledger.funds_allocated"),icon:U,color:"orange",animated:!0,animationDuration:500}),e.jsx(rt,{title:d("ledger.total_rollover"),value:Js(h.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.total_allocations-s.total_net),0),"₺"),subtitle:d("ledger.available_balance"),icon:b,color:"purple",animated:!0,animationDuration:500})]})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(L,{className:"h-5 w-5 text-gray-600"}),d("ledger.psp_overview_cards")]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:`${h.length} ${d("ledger.psp_count")} - ${d("ledger.all_available_data")}`})]}),e.jsxs("div",{children:[ye?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(s=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 space-y-4 animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-5 bg-gray-200 rounded w-24 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-100 rounded w-32"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-16 bg-gray-100 rounded"}),e.jsx("div",{className:"h-16 bg-gray-100 rounded"})]})]},s))}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map((s,t)=>{const a=(e=>{const s=[L,U,b,oe,n,g];return s[e.length%s.length]})(s.psp)||L,r=s.total_net-s.total_allocations,l=s.total_net>0?r/s.total_net*100:0,i=r>0;return e.jsxs("div",{className:"bg-white rounded-xl shadow-md hover:shadow-xl transition-all duration-300 group border border-gray-100 hover:border-blue-200 overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-100 bg-gradient-to-br from-white to-gray-50/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl flex items-center justify-center shadow-sm group-hover:shadow-md transition-shadow",children:e.jsx(a,{className:"h-6 w-6 text-blue-600 group-hover:scale-110 transition-transform"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 group-hover:text-blue-700 transition-colors",children:s.psp}),e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:d("ledger.payment_provider")})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold "+(i?"text-green-600":"text-red-600"),children:[l.toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-gray-500 font-medium",children:d("ledger.rollover_rate")})]})]})}),e.jsxs("div",{className:"p-6 space-y-4 bg-white",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-gray-50 to-white rounded-xl border border-gray-100 hover:border-blue-200 transition-all group/metric",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:d("ledger.total_deposits")}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:x(s.total_deposits,s.psp)})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:d("ledger.total_withdrawals")}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:x(s.total_withdrawals,s.psp)})]})]}),e.jsxs("div",{className:"text-center p-4 bg-primary-50 rounded-lg border border-primary-100",children:[e.jsx("div",{className:"text-xs text-primary-600 mb-2",children:d("ledger.net_amount")}),e.jsx("div",{className:"text-lg font-semibold text-primary-900",children:x(s.total_net,s.psp)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:d("ledger.allocations")}),e.jsx("div",{className:"text-sm font-semibold text-warning-600",children:x(s.total_allocations,s.psp)})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:d("ledger.rollover")}),e.jsx("div",{className:"text-sm font-semibold "+(i?"text-success-600":"text-destructive-600"),children:x(r,s.psp)})]})]})]}),e.jsx("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-600",children:d("ledger.total_transactions")}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:mt(s.transaction_count)})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-600",children:d("ledger.avg_transaction")}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:x(s.transaction_count>0?s.total_net/s.transaction_count:0,s.psp)})]})]})})]},s.psp)})}),0===h.length&&!ye&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-50 to-blue-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(L,{className:"h-10 w-10 text-blue-500"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:d("ledger.no_psp_data_available")}),e.jsx("p",{className:"text-sm text-gray-600 max-w-md mx-auto mb-6",children:d("ledger.no_psp_data_desc")}),e.jsxs("div",{className:"flex flex-col items-center gap-3 text-xs text-gray-500 max-w-sm mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full"}),e.jsx("span",{children:"Transaction data appears automatically when processed"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full"}),e.jsx("span",{children:"Use the refresh button to update statistics"})]})]})]})]})]})]}),e.jsxs(Ke,{value:"monthly",className:"mt-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden",children:[e.jsx("div",{className:"bg-slate-100 px-6 py-3 border-b border-slate-300",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-700 rounded-lg flex items-center justify-center",children:e.jsx(M,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 tracking-tight",children:d("ledger.monthly_psp_report")}),e.jsx("p",{className:"text-sm text-slate-600",children:d("tabs.monthly_desc")})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Year:"}),e.jsx("select",{value:ee,onChange:e=>se(parseInt(e.target.value)),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",children:Array.from({length:5},(e,s)=>(new Date).getFullYear()-s).map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Month:"}),e.jsx("select",{value:te,onChange:e=>ae(parseInt(e.target.value)),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",children:Array.from({length:12},(e,s)=>s+1).map(s=>e.jsx("option",{value:s,children:new Date(2024,s-1).toLocaleString("default",{month:"long"})},s))})]}),e.jsxs(ns,{onClick:()=>qs(ee,te,!0),variant:"outline",size:"sm",className:"flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:Q,children:[e.jsx(i,{className:"h-4 w-4 "+(Q?"animate-spin":"")}),Q?"Refreshing...":"Refresh"]})]})]})}),Q?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(i,{className:"h-5 w-5 animate-spin text-slate-600"}),e.jsx("span",{className:"text-slate-600",children:"Loading monthly data..."})]})}):f?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(l,{className:"h-8 w-8 text-red-500"})}),e.jsx("h3",{className:"text-lg font-medium text-red-900 mb-2",children:"Error Loading Monthly Data"}),e.jsx("p",{className:"text-red-600 mb-4",children:f}),e.jsxs(ns,{onClick:()=>qs(ee,te,!0),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(i,{className:"h-4 w-4"}),"Try Again"]})]}):0===G.length?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(M,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:d("ledger.no_psp_data_available")}),e.jsx("p",{className:"text-slate-600 mb-4",children:d("ledger.no_psp_data")}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Selected: ",new Date(ee,te-1).toLocaleString("default",{month:"long",year:"numeric"})]})]}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-100 border-b border-slate-300",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider w-12"}),e.jsx("th",{className:"text-left py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[180px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-3.5 w-3.5 text-slate-600"}),d("ledger.psp_count")]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[120px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx(o,{className:"h-3.5 w-3.5 text-slate-600"}),"YATIRIM"]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[120px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx(q,{className:"h-3.5 w-3.5 text-slate-600"}),"ÇEKME"]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[120px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx(y,{className:"h-3.5 w-3.5 text-slate-600"}),"TOPLAM"]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[140px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[A?e.jsx("div",{className:"animate-spin h-3.5 w-3.5 border-2 border-slate-600 border-t-transparent rounded-full"}):e.jsx(b,{className:"h-3.5 w-3.5 text-slate-600"}),e.jsx("span",{children:"KOMİSYON"})]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[120px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx(m,{className:"h-3.5 w-3.5 text-slate-600"}),"NET"]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[140px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx(U,{className:"h-3.5 w-3.5 text-slate-600"}),"TAHS TUTARI"]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[120px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx(n,{className:"h-3.5 w-3.5 text-slate-600"}),"KASA TOP"]})}),e.jsx("th",{className:"text-right py-3 px-6 font-semibold text-slate-700 text-xs uppercase tracking-wider min-w-[120px] tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx(i,{className:"h-3.5 w-3.5 text-slate-600"}),"DEVİR"]})})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200",children:G.filter(e=>e&&e.psp).slice((me-1)*he,me*he).map((t,a)=>e.jsxs(s.Fragment,{children:[e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"py-4 px-6",children:e.jsx("button",{onClick:()=>{return e=t.psp,void de(s=>{const t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t});var e},className:"p-1.5 hover:bg-slate-200 rounded transition-colors",title:re.has(t.psp)?"Collapse details":"Expand details",children:re.has(t.psp)?e.jsx(z,{className:"h-3.5 w-3.5 text-slate-600"}):e.jsx(ie,{className:"h-3.5 w-3.5 text-slate-600"})})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded flex items-center justify-center",children:e.jsx(L,{className:"h-4 w-4 text-slate-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-slate-900 text-sm",children:t.psp}),e.jsxs("div",{className:"text-xs text-slate-500",children:[t.transaction_count||0," txns"]})]})]})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:x(t.yatimim||0,t.psp)})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:x(t.cekme||0,t.psp)})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:x(t.toplam||0,t.psp)})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:x(t.komisyon||0,t.psp)}),void 0!==t.commission_rate&&"TETHER"!==t.psp.toUpperCase()&&e.jsxs("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-slate-200 text-slate-700",children:[t.commission_rate,"%"]})]})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:x(t.net||0,t.psp)})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:x(t.tahs_tutari||0,t.psp)})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:x(t.kasa_top||0,t.psp)})}),e.jsx("td",{className:"py-4 px-6 text-right tabular-nums",children:e.jsx("span",{className:"font-semibold text-sm "+((t.devir||0)>=0?"text-slate-900":"text-red-700"),children:x(t.devir||0,t.psp)})})]}),re.has(t.psp)&&e.jsx("tr",{className:"bg-gradient-to-r from-slate-50/50 to-blue-50/30",children:e.jsx("td",{colSpan:10,className:"py-6 px-6",children:e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-xl border border-slate-200/60 shadow-lg shadow-slate-200/20",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-200/60 bg-gradient-to-r from-slate-50/80 to-blue-50/40 rounded-t-xl",children:e.jsxs("h4",{className:"text-sm font-bold text-slate-800 flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-800 rounded-lg flex items-center justify-center",children:e.jsx(M,{className:"h-4 w-4 text-white"})}),"Daily Transaction Breakdown - ",t.psp,e.jsxs("span",{className:"ml-auto text-xs font-medium text-slate-600 bg-slate-200/60 px-3 py-1 rounded-full",children:[Ws(t,ee,te).length," days"]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gradient-to-r from-slate-50 to-slate-100/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"YATIRIM"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"ÇEKME"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"TOPLAM"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{children:"KOMİSYON"}),e.jsx("span",{className:"text-xs font-normal text-slate-500 normal-case",children:"Deposits Only"})]})}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"NET"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"TAHS TUTARI"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"KASA TOP"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"DEVİR"}),e.jsx("th",{className:"text-center py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"Tx Count"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100/60",children:Ws(t,ee,te).map((s,a)=>e.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors duration-150 "+(s.transaction_count>0?a%2==0?"bg-white/50":"bg-slate-50/30":s.isWeekend?"bg-orange-50/30":"bg-gray-50/20"),children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full "+(s.transaction_count>0?"bg-blue-400":s.isWeekend?"bg-orange-300":"bg-gray-300")}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-medium text-slate-800 text-sm",children:[s.day," ",s.dayName]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(s.date).toLocaleDateString("tr-TR")})]})]})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsx("span",{className:"font-mono text-sm font-semibold "+(s.transaction_count>0?"text-emerald-700":"text-gray-400"),children:x(s.yatimim||0,t.psp)})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsx("span",{className:"font-mono text-sm font-semibold "+(s.transaction_count>0?"text-red-700":"text-gray-400"),children:x(s.cekme||0,t.psp)})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsx("span",{className:"font-mono text-sm font-bold "+(s.transaction_count>0?"text-slate-800":"text-gray-400"),children:x(s.toplam||0,t.psp)})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-mono text-sm font-semibold ${s.transaction_count>0?ot(t.commission_rate||0):"text-gray-400"}`,children:x(s.komisyon||0,t.psp)}),"TETHER"===t.psp.toUpperCase()?e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:"Internal KASA"}):void 0!==t.commission_rate?e.jsxs("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium ${dt(t.commission_rate)}`,children:[t.commission_rate,"%"]}):null]}),e.jsx("span",{className:"text-xs text-slate-500 mt-1",children:"Deposits Only"})]})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsx("span",{className:"font-mono text-sm font-semibold "+(s.transaction_count>0?"text-blue-700":"text-gray-400"),children:x(s.net||0,t.psp)})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("span",{className:"font-mono text-sm font-semibold "+(s.transaction_count>0?"text-purple-700":"text-gray-400"),children:x(s.tahs_tutari||0,t.psp)}),e.jsx("button",{onClick:()=>((e,s,t)=>{Qe({psp:e,date:s,currentAmount:t}),es(t.toString()),Ge(!0)})(t.psp,s.date,s.tahs_tutari||0),className:"p-1.5 hover:bg-purple-100 rounded-md transition-colors duration-200 group opacity-70 hover:opacity-100",title:"Edit allocation amount",children:e.jsx(K,{className:"h-4 w-4 text-purple-600 group-hover:text-purple-700"})})]})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("span",{className:"font-mono text-sm font-semibold "+(s.transaction_count>0?"text-indigo-700":"text-gray-400"),children:x(s.kasa_top||0,t.psp)}),e.jsx("button",{onClick:()=>((e,s,t)=>{Ps({psp:e,date:s,currentAmount:t}),Us(t.toString()),Bs(""),As(!0)})(t.psp,s.date,s.kasa_top||0),className:"p-1.5 hover:bg-indigo-100 rounded-md transition-colors duration-200 group opacity-70 hover:opacity-100",title:"Edit KASA TOP amount",children:e.jsx(K,{className:"h-4 w-4 text-indigo-600 group-hover:text-indigo-700"})})]})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("span",{className:"font-mono text-sm font-semibold "+(s.transaction_count>0?(s.devir||0)>=0?"text-emerald-700":"text-red-700":"text-gray-400"),children:x(s.devir||0,t.psp)}),e.jsx("button",{onClick:()=>((e,s,t)=>{os({psp:e,date:s,currentAmount:t}),xs(t.toString()),_s(""),ls(!0)})(t.psp,s.date,s.devir||0),className:"p-1.5 hover:bg-emerald-100 rounded-md transition-colors duration-200 group opacity-70 hover:opacity-100",title:"Edit Devir amount",children:e.jsx(K,{className:"h-4 w-4 text-emerald-600 group-hover:text-emerald-700"})})]})}),e.jsx("td",{className:"py-3 px-4 text-center",children:e.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 rounded-full text-xs font-medium "+(s.transaction_count>0?"bg-slate-100 text-slate-700":"bg-gray-50 text-gray-400"),children:s.transaction_count||0})})]},s.date))}),e.jsx("tfoot",{className:"bg-gradient-to-r from-slate-100 to-slate-200/60 border-t border-slate-200",children:e.jsxs("tr",{className:"font-bold",children:[e.jsx("td",{className:"py-4 px-4 text-slate-800",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-slate-400 rounded-full"}),"Daily Totals"]})}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-emerald-800 text-sm",children:x(Ws(t,ee,te).reduce((e,s)=>e+(s.yatimim||0),0),t.psp)}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-red-800 text-sm",children:x(Ws(t,ee,te).reduce((e,s)=>e+(s.cekme||0),0),t.psp)}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-slate-800 text-sm",children:x(Ws(t,ee,te).reduce((e,s)=>e+(s.toplam||0),0),t.psp)}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-amber-800 text-sm",children:x(Ws(t,ee,te).reduce((e,s)=>e+(s.komisyon||0),0),t.psp)}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-blue-800 text-sm",children:x(Ws(t,ee,te).reduce((e,s)=>e+(s.net||0),0),t.psp)}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-purple-800 text-sm",children:x(Ws(t,ee,te).reduce((e,s)=>e+(s.tahs_tutari||0),0),t.psp)}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-indigo-800 text-sm",children:x((()=>{const e=Ws(t,ee,te),s=e[e.length-1];return s?.kasa_top||0})(),t.psp)}),e.jsx("td",{className:"py-4 px-4 text-right font-mono text-slate-800 text-sm",children:x((()=>{const e=Ws(t,ee,te),s=e[e.length-1];return s?.devir||0})(),t.psp)}),e.jsx("td",{className:"py-4 px-4 text-center",children:e.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 bg-slate-300 rounded-full text-xs font-bold text-slate-800",children:Ws(t,ee,te).reduce((e,s)=>e+(s.transaction_count||0),0)})})]})})]})})]})})},`${t.psp}-daily`)]},t.psp))})]}),G.length>he&&e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 bg-slate-50 border-t border-slate-200",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:["Showing ",(me-1)*he+1," to ",Math.min(me*he,G.length)," of ",G.length," PSPs"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ns,{onClick:()=>xe(Math.max(1,me-1)),disabled:1===me,variant:"outline",size:"sm",className:"flex items-center gap-1",children:[e.jsx(ce,{className:"h-4 w-4"}),"Previous"]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.ceil(G.length/he)},(e,s)=>s+1).map(s=>e.jsx(ns,{onClick:()=>xe(s),variant:me===s?"default":"outline",size:"sm",className:"w-10",children:s},s))}),e.jsxs(ns,{onClick:()=>xe(Math.min(Math.ceil(G.length/he),me+1)),disabled:me===Math.ceil(G.length/he),variant:"outline",size:"sm",className:"flex items-center gap-1",children:["Next",e.jsx(ie,{className:"h-4 w-4"})]})]})]}),e.jsx("table",{className:"w-full",children:e.jsx("tfoot",{className:"bg-gradient-to-r from-slate-100 via-slate-200/80 to-slate-100 border-t-2 border-slate-300",children:e.jsxs("tr",{className:"font-bold",children:[e.jsx("td",{className:"py-6 px-6"}),e.jsx("td",{className:"py-6 px-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-slate-600 to-slate-700 rounded-lg flex items-center justify-center shadow-lg",children:e.jsx(n,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-900 text-sm font-bold",children:"MONTHLY TOTALS"}),e.jsxs("div",{className:"text-xs text-slate-600",children:[G.length," PSPs"]})]})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold text-emerald-800",children:Js(G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.yatimim||0),0))}),e.jsx("span",{className:"text-xs text-emerald-700/70 font-medium",children:d("ledger.total_deposits")})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold text-red-800",children:Js(G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.cekme||0),0))}),e.jsx("span",{className:"text-xs text-red-700/70 font-medium",children:d("ledger.total_withdrawals")})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold text-slate-900",children:Js(G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.toplam||0),0))}),e.jsx("span",{className:"text-xs text-slate-700/70 font-medium",children:"Net Total"})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold text-amber-800",children:Js(G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.komisyon||0),0))}),e.jsx("span",{className:"text-xs text-amber-700/70 font-medium",children:d("ledger.total_commission")})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold text-blue-800",children:Js(G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.net||0),0))}),e.jsx("span",{className:"text-xs text-blue-700/70 font-medium",children:"Net Amount"})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold text-purple-800",children:Js(G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.tahs_tutari||0),0))}),e.jsx("span",{className:"text-xs text-purple-700/70 font-medium",children:d("ledger.total_allocations")})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold text-indigo-800",children:Js(G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.kasa_top||0),0))}),e.jsx("span",{className:"text-xs text-indigo-700/70 font-medium",children:d("ledger.total_revenue")})]})}),e.jsx("td",{className:"py-6 px-6 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-base font-bold "+(G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.kasa_top||0),0)-G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.tahs_tutari||0),0)>=0?"text-emerald-800":"text-red-800"),children:Js(G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.kasa_top||0),0)-G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.tahs_tutari||0),0))}),e.jsx("span",{className:"text-xs font-medium "+(G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.kasa_top||0),0)-G.reduce((e,s)=>e+("TETHER"===s.psp.toUpperCase()?0:s.tahs_tutari||0),0)>=0?"text-emerald-700/70":"text-red-700/70"),children:"Total Rollover"})]})})]})})})]})]}),e.jsx("div",{className:"mt-6",children:e.jsxs(cs,{variant:"elevated",className:"mb-6",children:[e.jsxs(Ye,{children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5 text-gray-600"}),"Audit History"]}),e.jsx(He,{children:"Complete audit trail of all manual overrides (Allocation, Devir, KASA TOP) with filtering and export capabilities"})]}),e.jsxs(Me,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx(ts,{type:"date",value:Ks.startDate,onChange:e=>et("startDate",e.target.value),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx(ts,{type:"date",value:Ks.endDate,onChange:e=>et("endDate",e.target.value),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:d("ledger.psp_filter")}),e.jsx(ts,{type:"text",placeholder:d("ledger.filter_by_psp"),value:Ks.psp,onChange:e=>et("psp",e.target.value),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type Filter"}),e.jsxs("select",{value:Ks.type,onChange:e=>et("type",e.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"allocation",children:"Allocation"}),e.jsx("option",{value:"devir",children:"Devir"}),e.jsx("option",{value:"kasa_top",children:"KASA TOP"})]})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsxs(ns,{onClick:()=>tt("csv"),variant:"outline",className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),"CSV"]}),e.jsxs(ns,{onClick:()=>tt("json"),variant:"outline",className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),"JSON"]})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:Ue?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(i,{className:"h-6 w-6 animate-spin text-gray-400"}),e.jsx("span",{className:"ml-2 text-gray-500",children:"Loading history data..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:d("ledger.psp_name")}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Created At"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Updated At"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:0===Re.length?e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:[e.jsx(k,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"No history found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your filters or check back later"})]})}):Re.map((s,t)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+("Allocation"===s.type?"bg-purple-100 text-purple-800":"Devir"===s.type?"bg-emerald-100 text-emerald-800":"bg-indigo-100 text-indigo-800"),children:s.type})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:new Date(s.date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4 text-gray-400"}),s.psp_name]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-semibold text-gray-900",children:Js(s.amount,"₺")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(s.created_at).toLocaleString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(s.updated_at).toLocaleString()})]},`${s.id}-${t}`))})]})}),Ve&&Ve.pages>1&&e.jsx("div",{className:"bg-gray-50 px-6 py-3 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",(Ve.page-1)*Ve.per_page+1," to"," ",Math.min(Ve.page*Ve.per_page,Ve.total)," of"," ",Ve.total," entries"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ns,{variant:"outline",size:"sm",onClick:()=>st(Ve.page-1),disabled:!Ve.has_prev,children:"Previous"}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",Ve.page," of ",Ve.pages]}),e.jsx(ns,{variant:"outline",size:"sm",onClick:()=>st(Ve.page+1),disabled:!Ve.has_next,children:"Next"})]})]})})]})})]})]})})]}),e.jsx(Ke,{value:"trust",className:"mt-6",children:e.jsx(ms,{})}),e.jsxs(Ke,{value:"analytics",className:"mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(n,{className:"h-6 w-6 text-primary-600"}),"Analytics Dashboard"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive insights and performance metrics"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(ns,{onClick:()=>{Hs(!0),Gs(!0)},variant:"outline",size:"default",className:"flex items-center gap-2 h-10 px-4 hover:bg-blue-50 hover:border-blue-300 hover:text-blue-700 transition-all shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",disabled:ye,children:[e.jsx(i,{className:"h-4 w-4 "+(ye?"animate-spin":"")}),ye?"Refreshing...":"Refresh Data"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(rt,{title:d("ledger.total_volume"),value:Js(h.reduce((e,s)=>e+s.total_amount,0),"₺"),subtitle:d("ledger.all_psps_combined"),icon:y,color:"indigo",animated:!0,animationDuration:500}),e.jsx(rt,{title:d("ledger.active_psps"),value:h.length.toString(),subtitle:d("ledger.payment_providers"),icon:L,color:"green",animated:!0,animationDuration:500}),e.jsx(rt,{title:d("ledger.avg_commission_rate"),value:`${(h.reduce((e,s)=>e+s.commission_rate,0)/h.length||0).toFixed(1)}%`,subtitle:d("ledger.weighted_average"),icon:m,color:"orange",animated:!0,animationDuration:500}),e.jsx(rt,{title:d("ledger.total_transactions"),value:mt(h.reduce((e,s)=>e+s.transaction_count,0)),subtitle:d("ledger.all_time"),icon:b,color:"purple",animated:!0,animationDuration:500})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(cs,{variant:"elevated",className:"p-6",children:[e.jsxs(Ye,{className:"pb-4",children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(n,{className:"h-5 w-5 text-primary-600"}),d("ledger.psp_performance_comparison")]}),e.jsx(He,{children:d("ledger.net_amounts_transaction_counts")})]}),e.jsx(Me,{children:e.jsx("div",{className:"h-80",children:e.jsx(us,{width:"100%",height:"100%",children:e.jsxs(ks,{data:h.map(e=>({name:e.psp,net:e.total_net,transactions:e.transaction_count,commission:e.total_commission})),children:[e.jsx(ps,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(js,{dataKey:"name",tick:{fontSize:12},angle:-45,textAnchor:"end",height:80}),e.jsx(ys,{tick:{fontSize:12}}),e.jsx(bs,{formatter:(e,s)=>["net"===s||"commission"===s?Js(Number(e),"₺"):e,"net"===s?"Net Amount":"transactions"===s?"Transactions":"Commission"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(Ss,{dataKey:"net",fill:"#3b82f6",radius:[4,4,0,0]})]})})})})]}),e.jsxs(cs,{variant:"elevated",className:"p-6",children:[e.jsxs(Ye,{className:"pb-4",children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5 text-primary-600"}),d("ledger.psp_market_share")]}),e.jsx(He,{children:d("ledger.distribution_total_volume")})]}),e.jsx(Me,{children:e.jsx("div",{className:"h-80",children:e.jsx(us,{width:"100%",height:"100%",children:e.jsxs(Ns,{children:[e.jsx(vs,{data:h.map(e=>({name:e.psp,value:e.total_amount,net:e.total_net})),cx:"50%",cy:"50%",labelLine:!1,label:({name:e,percent:s})=>`${e} ${(100*s).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:h.map((s,t)=>e.jsx(ws,{fill:`hsl(${60*t}, 70%, 50%)`},`cell-${t}`))}),e.jsx(bs,{formatter:e=>[Js(Number(e),"₺"),"Total Amount"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}})]})})})})]})]}),e.jsxs(cs,{variant:"elevated",className:"p-6",children:[e.jsxs(Ye,{className:"pb-4",children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5 text-primary-600"}),"Daily Transaction Trends"]}),e.jsx(He,{children:"Net amounts and transaction counts over time"})]}),e.jsx(Me,{children:e.jsx("div",{className:"h-80",children:e.jsx(us,{width:"100%",height:"100%",children:e.jsxs(Cs,{data:pe.map(e=>({date:new Date(e.date).toLocaleDateString("en-US",{month:"short",day:"numeric"}),net:e.totals.net,transactions:e.totals.total_psp,commission:e.totals.commission})),children:[e.jsx(ps,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(js,{dataKey:"date",tick:{fontSize:12}}),e.jsx(ys,{tick:{fontSize:12}}),e.jsx(bs,{formatter:(e,s)=>["net"===s||"commission"===s?Js(Number(e),"₺"):e,"net"===s?"Net Amount":"transactions"===s?"Transactions":"Commission"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(Ds,{type:"monotone",dataKey:"net",stackId:"1",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.6}),e.jsx(Ds,{type:"monotone",dataKey:"commission",stackId:"2",stroke:"#f59e0b",fill:"#f59e0b",fillOpacity:.6})]})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(cs,{variant:"elevated",className:"p-6",children:[e.jsxs(Ye,{className:"pb-4",children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(m,{className:"h-5 w-5 text-primary-600"}),d("ledger.allocation_vs_net")]}),e.jsx(He,{children:d("ledger.allocation_vs_net_desc")})]}),e.jsx(Me,{children:e.jsx("div",{className:"h-80",children:e.jsx(us,{width:"100%",height:"100%",children:e.jsxs(Ts,{data:h.map(e=>({net:e.total_net,allocation:e.total_allocations,psp:e.psp,rollover:e.total_net-e.total_allocations})),children:[e.jsx(ps,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(js,{type:"number",dataKey:"net",name:"Net Amount",tick:{fontSize:12},tickFormatter:e=>Js(e,"₺")}),e.jsx(ys,{type:"number",dataKey:"allocation",name:"Allocation",tick:{fontSize:12},tickFormatter:e=>Js(e,"₺")}),e.jsx(bs,{formatter:(e,s)=>[Js(Number(e),"₺"),"net"===s?"Net Amount":"allocation"===s?"Allocation":"Rollover"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(Fs,{dataKey:"allocation",fill:"#3b82f6",r:6})]})})})})]}),e.jsxs(cs,{variant:"elevated",className:"p-6",children:[e.jsxs(Ye,{className:"pb-4",children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(o,{className:"h-5 w-5 text-primary-600"}),d("ledger.rollover_analysis")]}),e.jsx(He,{children:d("ledger.rollover_risk_levels")})]}),e.jsx(Me,{children:e.jsx("div",{className:"h-80",children:e.jsx(us,{width:"100%",height:"100%",children:e.jsxs(ks,{data:h.map(e=>{const s=e.total_net-e.total_allocations,t=e.total_net>0?s/e.total_net*100:0;return{name:e.psp,rollover:s,percentage:t,color:s>0?"#ef4444":"#10b981"}}),children:[e.jsx(ps,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(js,{dataKey:"name",tick:{fontSize:12},angle:-45,textAnchor:"end",height:80}),e.jsx(ys,{tick:{fontSize:12}}),e.jsx(bs,{formatter:(e,s)=>["rollover"===s?Js(Number(e),"₺"):`${Number(e).toFixed(1)}%`,"rollover"===s?"Rollover Amount":"Rollover %"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(Ss,{dataKey:"rollover",fill:"#3b82f6",radius:[4,4,0,0]})]})})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4 lg:gap-6",children:[e.jsxs(cs,{variant:"elevated",className:"p-6",children:[e.jsxs(Ye,{className:"pb-4",children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(m,{className:"h-5 w-5 text-primary-600"}),d("ledger.commission_rates_comparison")]}),e.jsx(He,{children:d("ledger.commission_rates_all_psps")})]}),e.jsx(Me,{children:e.jsx("div",{className:"h-64 sm:h-72 lg:h-80",children:e.jsx(us,{width:"100%",height:"100%",children:e.jsxs(ks,{data:h.map(e=>({psp:e.psp,rate:e.commission_rate,deposits:e.total_deposits,commission:e.total_commission})),children:[e.jsx(ps,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(js,{dataKey:"psp",tick:{fontSize:10},angle:-45,textAnchor:"end",height:60,interval:0}),e.jsx(ys,{tick:{fontSize:10},tickFormatter:e=>`${e}%`,width:40}),e.jsx(bs,{formatter:(e,s)=>["rate"===s?`${e}%`:Js(Number(e),"₺"),"rate"===s?"Commission Rate":"deposits"===s?"Total Deposits":"Commission Amount"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(Ss,{dataKey:"rate",fill:"#f59e0b",radius:[4,4,0,0],name:"Commission Rate"})]})})})})]}),e.jsxs(cs,{variant:"elevated",className:"p-6",children:[e.jsxs(Ye,{className:"pb-4",children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5 text-primary-600"}),d("ledger.commission_vs_deposits")]}),e.jsx(He,{children:d("ledger.commission_vs_deposits_desc")})]}),e.jsx(Me,{children:e.jsx("div",{className:"h-64 sm:h-72 lg:h-80",children:e.jsx(us,{width:"100%",height:"100%",children:e.jsxs(Ts,{data:h.map(e=>({deposits:e.total_deposits,commission:e.total_commission,psp:e.psp,rate:e.commission_rate})),children:[e.jsx(ps,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(js,{type:"number",dataKey:"deposits",name:"Total Deposits",tick:{fontSize:10},tickFormatter:e=>Js(e,"₺"),width:60}),e.jsx(ys,{type:"number",dataKey:"commission",name:"Commission",tick:{fontSize:10},tickFormatter:e=>Js(e,"₺"),width:60}),e.jsx(bs,{formatter:(e,s)=>["deposits"===s||"commission"===s?Js(Number(e),"₺"):e,"deposits"===s?"Total Deposits":"commission"===s?"Commission Amount":"rate"===s?"Commission Rate":"PSP"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(Fs,{dataKey:"commission",fill:"#f59e0b",r:6})]})})})})]})]}),e.jsxs(cs,{variant:"elevated",className:"p-6",children:[e.jsxs(Ye,{className:"pb-4",children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(m,{className:"h-5 w-5 text-primary-600"}),"Commission Rate Comparison"]}),e.jsx(He,{children:"Detailed comparison of commission rates and their impact"})]}),e.jsx(Me,{children:e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs("table",{className:"w-full min-w-[600px]",children:[e.jsx("thead",{className:"bg-gradient-to-r from-slate-50 to-slate-100/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:d("ledger.psp")}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:d("ledger.commission_rate")}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:d("ledger.total_deposits")}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:d("ledger.commission_amount")}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"Efficiency"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100/60",children:h.sort((e,s)=>s.commission_rate-e.commission_rate).map((s,t)=>{const a=s.total_deposits>0?s.total_commission/s.total_deposits*100:0;return e.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors duration-150 "+(t%2==0?"bg-white/50":"bg-slate-50/30"),children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${dt(s.commission_rate).split(" ")[0]}`}),e.jsx("span",{className:"font-medium text-slate-800 text-sm",children:s.psp})]})}),e.jsx("td",{className:"py-3 px-4 text-right",children:"TETHER"===s.psp.toUpperCase()?e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Internal KASA"}):e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${dt(s.commission_rate)}`,children:[s.commission_rate,"%"]})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsx("span",{className:"font-mono text-sm font-semibold text-slate-800",children:Js(s.total_deposits)})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsx("span",{className:`font-mono text-sm font-semibold ${ot(s.commission_rate)}`,children:Js(s.total_commission||0)})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsxs("span",{className:"text-sm font-medium text-slate-600",children:[a.toFixed(2),"%"]})})]},s.psp)})})]})})})]}),e.jsxs(cs,{variant:"elevated",className:"p-6",children:[e.jsxs(Ye,{className:"pb-4",children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-5 w-5 text-primary-600"}),"Performance Insights"]}),e.jsx(He,{children:"Key findings and recommendations based on current data"})]}),e.jsx(Me,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-6 border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-lg flex items-center justify-center",children:e.jsx(o,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-green-900",children:"Top Performer"}),e.jsx("p",{className:"text-sm text-green-700",children:"Highest net amount"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-bold text-green-900",children:h.length>0?h.reduce((e,s)=>s.total_net>e.total_net?s:e).psp:"N/A"}),e.jsx("p",{className:"text-sm text-green-700",children:h.length>0?Js(h.reduce((e,s)=>s.total_net>e.total_net?s:e).total_net,"₺"):"₺0"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-6 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center",children:e.jsx(m,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900",children:"Most Efficient"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Best allocation ratio"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-bold text-blue-900",children:h.length>0?h.reduce((e,s)=>(s.total_net>0?s.total_allocations/s.total_net:0)>(e.total_net>0?e.total_allocations/e.total_net:0)?s:e).psp:"N/A"}),e.jsx("p",{className:"text-sm text-blue-700",children:h.length>0?`${(h.reduce((e,s)=>(s.total_net>0?s.total_allocations/s.total_net:0)>(e.total_net>0?e.total_allocations/e.total_net:0)?s:e).total_net>0?h.reduce((e,s)=>(s.total_net>0?s.total_allocations/s.total_net:0)>(e.total_net>0?e.total_allocations/e.total_net:0)?s:e).total_allocations/h.reduce((e,s)=>(s.total_net>0?s.total_allocations/s.total_net:0)>(e.total_net>0?e.total_allocations/e.total_net:0)?s:e).total_net*100:0).toFixed(1)}%`:"0%"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 rounded-xl p-6 border border-orange-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-500 rounded-lg flex items-center justify-center",children:e.jsx(t,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-orange-900",children:"Risk Alert"}),e.jsx("p",{className:"text-sm text-orange-700",children:"Highest rollover"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-bold text-orange-900",children:h.length>0?h.reduce((e,s)=>s.total_allocations-s.total_net>e.total_allocations-e.total_net?s:e).psp:"N/A"}),e.jsx("p",{className:"text-sm text-orange-700",children:h.length>0?Js(h.reduce((e,s)=>s.total_allocations-s.total_net>e.total_allocations-e.total_net?s:e).total_allocations-h.reduce((e,s)=>s.total_allocations-s.total_net>e.total_allocations-e.total_net?s:e).total_net,"₺"):"₺0"})]})]})]})})]})]})]})}),$&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-in fade-in duration-200",onClick:e=>{e.target===e.currentTarget&&ct()},onKeyDown:e=>{"Escape"===e.key&&ct()},tabIndex:-1,children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-5 border-b border-gray-100",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-xl flex items-center justify-center",children:e.jsx(L,{className:"h-5 w-5 text-blue-600"})}),"psp"===ue?.type?`${d("ledger.psp_details")}: ${ue.psp}`:`${d("ledger.psp_details")}: ${ue?.date} - ${ue?.psp}`]}),e.jsx("button",{onClick:ct,className:"h-10 w-10 p-0 hover:bg-gray-100 rounded-xl transition-colors flex items-center justify-center",children:e.jsx(P,{className:"h-5 w-5 text-gray-500"})})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:ue?.error?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(l,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-red-600",children:ue.error})]}):ue?.transactions?.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:d("ledger.total_transactions")}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:ue.transactions.length})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:d("ledger.total_amount")}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Js(ue.transactions.reduce((e,s)=>e+(s.amount||0),0),"₺")})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:d("ledger.total_commission")}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Js(ue.transactions.reduce((e,s)=>e+(s.commission||0),0),"₺")})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Commission"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Net Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ue.transactions.map((s,t)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(s.date||s.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Js(s.amount||0,"₺")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Js(s.commission||0,"₺")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Js(s.net_amount||0,"₺")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full "+("DEP"===s.category?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:"DEP"===s.category?"Deposit":"Withdrawal"})})]},s.id||`${s.date||s.created_at}-${s.amount}-${t}`))})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(b,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No transactions found"})]})})]})}),_e&&Se&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-300",onClick:e=>{e.target===e.currentTarget&&Qs()},onKeyDown:e=>{"Escape"===e.key&&Qs()},tabIndex:-1,children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-5xl w-full max-h-[92vh] overflow-hidden animate-in zoom-in-95 duration-300",children:[e.jsx("div",{className:"px-10 py-8 border-b border-gray-100 bg-gradient-to-br from-white via-gray-50/30 to-primary-50/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-primary-100 to-primary-200 rounded-2xl flex items-center justify-center shadow-sm",children:e.jsx(L,{className:"h-8 w-8 text-primary-700"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 tracking-tight",children:"Bulk Allocation"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(M,{className:"h-4 w-4 text-gray-500"}),e.jsx("p",{className:"text-base text-gray-600 font-medium",children:pe.find(e=>e.date===Se)?.date_str})]})]})]}),e.jsx("button",{onClick:Qs,className:"w-12 h-12 rounded-xl bg-gray-100/80 hover:bg-gray-200/80 flex items-center justify-center transition-all duration-200 hover:scale-105",children:e.jsx(P,{className:"h-6 w-6 text-gray-600"})})]})}),e.jsx("div",{className:"px-10 py-8 max-h-[60vh] overflow-y-auto",children:e.jsx("div",{className:"space-y-4",children:h.map((s,t)=>{const a=`${Se}-${s.psp}`,r=De[a]||0,n=pe.find(e=>e.date===Se),l=n?.psps[s.psp],i=l?.net||0,c=l?.allocation||0,o=c-i,m=s.total_allocations-s.total_net,x=!!l;return e.jsx("div",{className:"group bg-white shadow-sm rounded-2xl p-8 hover:shadow-lg hover:shadow-primary-100/20 transition-all duration-300 hover:-translate-y-0.5",style:{animationDelay:50*t+"ms"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl flex items-center justify-center shadow-sm transition-all duration-200 "+(x?"bg-gradient-to-br from-primary-100 to-primary-200 group-hover:from-primary-200 group-hover:to-primary-300":"bg-gradient-to-br from-gray-100 to-gray-200"),children:e.jsx(L,{className:"h-7 w-7 transition-colors duration-200 "+(x?"text-primary-700":"text-gray-500")})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("h4",{className:"text-lg font-bold text-gray-900",children:s.psp}),!x&&e.jsx("span",{className:"px-3 py-1.5 text-xs font-semibold bg-gradient-to-r from-orange-100 to-orange-200 text-orange-700 rounded-full border border-orange-200",children:"No Activity"}),x&&e.jsx("span",{className:"px-3 py-1.5 text-xs font-semibold bg-gradient-to-r from-green-100 to-green-200 text-green-700 rounded-full border border-green-200",children:"Active"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-warning-50/80 rounded-xl p-4 border border-warning-200",children:[e.jsx("div",{className:"text-xs font-medium text-warning-600 uppercase tracking-wide mb-1",children:d("ledger.allocations")}),e.jsx("div",{className:"text-lg font-bold text-warning-700",children:Js(x?c:s.total_allocations,"₺")})]}),e.jsxs("div",{className:"rounded-xl p-4 border "+((x?o:m)>0?"bg-destructive-50/80 border-destructive-200":"bg-success-50/80 border-success-200"),children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:d("ledger.rollover")}),e.jsx("div",{className:"text-lg font-bold "+((x?o:m)>0?"text-destructive-600":"text-success-600"),children:Js(x?o:m,"₺")})]})]})]})]})}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"text-right",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"New Allocation"}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:r,onChange:e=>((e,s)=>{if(!Se)return;const t=`${Se}-${e}`;Te(e=>({...e,[t]:s}))})(s.psp,parseFloat(e.target.value)||0),className:"w-40 px-5 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-right font-bold text-lg transition-all duration-200 bg-white shadow-sm",placeholder:"0.00",step:"0.01"}),e.jsx("div",{className:"absolute inset-y-0 right-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-sm font-bold text-gray-500",children:"₺"})})]})})]})})]})},s.psp)})})}),e.jsx("div",{className:"px-10 py-8 border-t border-gray-100 bg-gradient-to-r from-gray-50/80 via-white to-gray-50/80",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-xl flex items-center justify-center",children:e.jsx(L,{className:"h-5 w-5 text-primary-700"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold text-gray-700",children:[Object.keys(De).length," ",d("ledger.psps_selected")]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Ready for allocation"})]})]}),e.jsx("div",{className:"h-8 w-px bg-gray-200"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(y,{className:"h-5 w-5 text-green-700"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700",children:"Total Allocation"}),e.jsx("div",{className:"text-lg font-bold text-green-600",children:Js(Object.values(De).reduce((e,s)=>e+s,0),"₺")})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:Qs,className:"px-8 py-3 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-xl transition-all duration-200 font-semibold shadow-sm hover:shadow",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(Se){Ae(!0);try{const e=Object.entries(De).map(async([e,s])=>{const t=e.lastIndexOf("-"),a=e.substring(0,t),r=e.substring(t+1);return at(a,r,s)});await Promise.all(e),Ne(e=>({...e,...De})),ke(!1),Ce(null),Te({}),await Promise.all([Gs(!0),Hs(!0)])}catch(e){}finally{Ae(!1)}}},disabled:Ee,className:"px-8 py-3 bg-gradient-to-r from-primary-600 to-primary-700 text-white rounded-xl hover:from-primary-700 hover:to-primary-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center gap-3 font-semibold shadow-lg hover:shadow-xl hover:-translate-y-0.5",children:Ee?e.jsxs(e.Fragment,{children:[e.jsx(i,{className:"h-5 w-5 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"h-5 w-5"}),"Apply Allocations"]})})]})]})})]})}),Je&&Xe&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-md w-full animate-in zoom-in-95 duration-300",children:[e.jsx("div",{className:"px-8 py-6 border-b border-gray-100 bg-gradient-to-br from-white via-gray-50/30 to-primary-50/20 rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-primary-100 to-primary-200 rounded-2xl flex items-center justify-center shadow-sm",children:e.jsx(K,{className:"h-6 w-6 text-primary-700"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 tracking-tight",children:"Edit Allocation"}),e.jsxs("p",{className:"text-sm text-gray-600 font-medium",children:[Xe.psp," - ",new Date(Xe.date).toLocaleDateString("tr-TR")]})]})]}),e.jsx("button",{onClick:nt,className:"w-10 h-10 rounded-xl bg-gray-100/80 hover:bg-gray-200/80 flex items-center justify-center transition-all duration-200 hover:scale-105",children:e.jsx(P,{className:"h-5 w-5 text-gray-600"})})]})}),e.jsx("div",{className:"px-8 py-6",children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Allocation Amount (₺)"}),e.jsx("input",{type:"number",value:Ze,onChange:e=>es(e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all duration-200 text-lg font-mono",placeholder:"Enter allocation amount",min:"0",step:"0.01",autoFocus:!0,disabled:ss}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Current amount: ",Js(Xe.currentAmount,"₺")]})]})})}),e.jsx("div",{className:"px-8 py-6 border-t border-gray-100 bg-gray-50/50 rounded-b-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:nt,className:"px-6 py-3 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-all duration-200 font-semibold shadow-sm hover:shadow",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(!Xe)return;const e=parseFloat(Ze);if(isNaN(e)||e<0)alert(d("ledger.enter_valid_amount"));else{as(!0);try{await at(Xe.date,Xe.psp,e),await Promise.all([qs(ee,te,!0),Gs(!0),Zs(Ks.page)]),nt(),alert(d("ledger.allocation_updated"))}catch(s){const e=s?.message||d("ledger.failed_update_allocation");alert(`${d("ledger.failed_update_allocation")}\n\nDetay: ${e}`)}finally{as(!1)}}},disabled:ss,className:"px-6 py-3 bg-gradient-to-r from-primary-600 to-primary-700 text-white rounded hover:from-primary-700 hover:to-primary-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center gap-3 font-semibold shadow-lg hover:shadow-xl hover:-translate-y-0.5",children:ss?e.jsxs(e.Fragment,{children:[e.jsx(i,{className:"h-4 w-4 animate-spin"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"h-4 w-4"}),"Update Allocation"]})})]})})]})}),rs&&is&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-md w-full animate-in zoom-in-95 duration-300",children:[e.jsx("div",{className:"px-8 py-6 border-b border-gray-100 bg-gradient-to-br from-white via-emerald-50/30 to-emerald-50/20 rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-emerald-100 to-emerald-200 rounded-2xl flex items-center justify-center shadow-sm",children:e.jsx(K,{className:"h-6 w-6 text-emerald-700"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 tracking-tight",children:"Edit Devir Amount"}),e.jsxs("p",{className:"text-sm text-gray-600 font-medium",children:[is.psp," - ",new Date(is.date).toLocaleDateString("tr-TR")]})]})]}),e.jsx("button",{onClick:lt,className:"w-10 h-10 rounded-xl bg-gray-100/80 hover:bg-gray-200/80 flex items-center justify-center transition-all duration-200 hover:scale-105",children:e.jsx(P,{className:"h-5 w-5 text-gray-600"})})]})}),e.jsx("div",{className:"px-8 py-6",children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Devir Amount (₺)"}),e.jsx("input",{type:"number",value:ds,onChange:e=>xs(e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-all duration-200 text-lg font-mono",placeholder:"Enter Devir amount",step:"0.01",autoFocus:!0}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Current amount: ",Js(is.currentAmount,"₺")]})]})})}),e.jsx("div",{className:"px-8 py-6 border-t border-gray-100 bg-gray-50/50 rounded-b-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:lt,className:"px-6 py-3 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-all duration-200 font-semibold shadow-sm hover:shadow",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(!is)return;const e=parseFloat(ds);if(isNaN(e))alert(d("ledger.enter_valid_amount"));else{gs(!0);try{const t={date:is.date,psp:is.psp,devir_amount:e},a=await Fe.post("/analytics/update-devir",t);if(a.ok)try{await Fe.parseResponse(a),await Promise.all([qs(ee,te,!0),Gs(!0),Zs(Ks.page)]),await new Promise(e=>setTimeout(e,500)),lt(),alert(d("ledger.devir_updated"))}catch(s){await Promise.all([qs(ee,te,!0),Gs(!0),Zs(Ks.page)]),lt(),alert(d("ledger.devir_updated"))}else try{const e=await Fe.parseResponse(a),s=e?.error||e?.message||`HTTP ${a.status}`;alert(`${d("ledger.failed_update_devir")}: ${s}`)}catch(s){alert(`${d("ledger.failed_update_devir")}: HTTP ${a.status}`)}}catch(t){const e=t?.message||t?.toString()||"Network error";alert(`${d("ledger.failed_save_devir")}\n\nDetay: ${e}`)}finally{gs(!1)}}},disabled:hs,className:"px-6 py-3 bg-gradient-to-r from-emerald-600 to-emerald-700 text-white rounded hover:from-emerald-700 hover:to-emerald-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center gap-3 font-semibold shadow-lg hover:shadow-xl hover:-translate-y-0.5",children:hs?e.jsxs(e.Fragment,{children:[e.jsx(i,{className:"h-4 w-4 animate-spin"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"h-4 w-4"}),"Update Devir"]})})]})})]})}),Es&&Rs&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-md w-full animate-in zoom-in-95 duration-300",children:[e.jsx("div",{className:"px-8 py-6 border-b border-gray-100 bg-gradient-to-br from-white via-indigo-50/30 to-indigo-50/20 rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-indigo-100 to-indigo-200 rounded-2xl flex items-center justify-center shadow-sm",children:e.jsx(K,{className:"h-6 w-6 text-indigo-700"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 tracking-tight",children:"Edit KASA TOP Amount"}),e.jsxs("p",{className:"text-sm text-gray-600 font-medium",children:[Rs.psp," - ",new Date(Rs.date).toLocaleDateString("tr-TR")]})]})]}),e.jsx("button",{onClick:it,className:"w-10 h-10 rounded-xl bg-gray-100/80 hover:bg-gray-200/80 flex items-center justify-center transition-all duration-200 hover:scale-105",children:e.jsx(P,{className:"h-5 w-5 text-gray-600"})})]})}),e.jsx("div",{className:"px-8 py-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Secret Code"}),e.jsx("input",{type:"password",value:zs,onChange:e=>Bs(e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200 text-lg font-mono",placeholder:"Enter secret code",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"KASA TOP Amount (₺)"}),e.jsx("input",{type:"number",value:Ls,onChange:e=>Us(e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200 text-lg font-mono",placeholder:"Enter KASA TOP amount",step:"0.01"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Current amount: ",Js(Rs.currentAmount,"₺")]})]})]})}),e.jsx("div",{className:"px-8 py-6 border-t border-gray-100 bg-gray-50/50 rounded-b-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:it,className:"px-6 py-3 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-all duration-200 font-semibold shadow-sm hover:shadow",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(!Rs)return;if("4561"!==zs)return void alert(d("ledger.invalid_secret_kasa"));const e=parseFloat(Ls);if(isNaN(e))alert(d("ledger.enter_valid_amount"));else{Is(!0);try{const t={date:Rs.date,psp:Rs.psp,kasa_top_amount:e},a=await Fe.post("/analytics/update-kasa-top",t);if(a.ok)try{await Fe.parseResponse(a),await Promise.all([qs(ee,te,!0),Gs(!0),Zs(Ks.page)]),await new Promise(e=>setTimeout(e,500)),it(),alert(d("ledger.kasa_updated"))}catch(s){await Promise.all([qs(ee,te,!0),Gs(!0),Zs(Ks.page)]),it(),alert(d("ledger.kasa_updated"))}else try{const e=await Fe.parseResponse(a),s=e?.error||e?.message||`HTTP ${a.status}`;alert(`${d("ledger.failed_update_kasa")}: ${s}`)}catch(s){alert(`${d("ledger.failed_update_kasa")}: HTTP ${a.status}`)}}catch(t){const e=t?.message||t?.toString()||"Network error";alert(`${d("ledger.failed_save_kasa")}\n\nDetay: ${e}`)}finally{Is(!1)}}},disabled:Ms||"4561"!==zs,className:"px-6 py-3 bg-gradient-to-r from-indigo-600 to-indigo-700 text-white rounded hover:from-indigo-700 hover:to-indigo-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center gap-3 font-semibold shadow-lg hover:shadow-xl hover:-translate-y-0.5",children:Ms?e.jsxs(e.Fragment,{children:[e.jsx(i,{className:"h-4 w-4 animate-spin"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"h-4 w-4"}),"Update KASA TOP"]})})]})})]})})]})}},Symbol.toStringTag,{value:"Module"})),xt=r.lazy(()=>Ee(()=>import("./pages-systemmonitor-Bslpk-F-.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),ht=r.lazy(()=>Ee(()=>import("./DatabaseManagement-BUxk6TQV.js"),__vite__mapDeps([9,1,3,2,8,4,5,6,7]))),ut=r.lazy(()=>Ee(()=>import("./SecurityManagement-DQ4bj87W.js"),__vite__mapDeps([10,1,3,2,8,4,5,6,7]))),gt=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const[s,t]=$s("general"),[a,l]=r.useState(!1),[m,x]=r.useState(!1),[h,g]=r.useState(!1),{t:y,currentLanguage:f,setLanguage:N,supportedLanguages:v}=Pe(),[w,_]=r.useState(!1),D=f||"en",T=v||{en:{flag:"🇺🇸",name:"English"},tr:{flag:"🇹🇷",name:"Türkçe"}};r.useEffect(()=>{const e=new URLSearchParams(window.location.search),s=e.get("tab"),a=e.get("view");s&&["general","dropdowns","departments","admin","notifications","integrations","translations"].includes(s)&&t(s),"admin"===s&&"monitor"===a&&(t("admin"),l(!0)),"admin"===s&&"database"===a&&(t("admin"),x(!0)),"admin"===s&&"security"===a&&(t("admin"),g(!0))},[]),r.useEffect(()=>{const e=e=>{w&&(e.target.closest(".custom-dropdown-container")||_(!1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[w]);const[F,E]=r.useState({}),[R,$]=r.useState(!1),[U,M]=r.useState(!1),[O,W]=r.useState(!1);r.useState(null);const[V,q]=r.useState(null),[J,G]=r.useState({field_name:"",value:"",commission_rate:""}),[X,Q]=r.useState(""),[Z,ee]=r.useState(["Conversion","Retention","Marketing","Research","Operation","Management","Facility"]),[se,ae]=r.useState(!1),[ne,le]=r.useState(!1),[ie,ce]=r.useState(""),[pe,je]=r.useState(""),[ye,be]=r.useState(!1),fe=[{value:"payment_method",label:y("settings.payment_method"),requiresCommission:!1,isStatic:!0,staticValues:["Bank","Credit card","Tether"]},{value:"currency",label:y("settings.currency"),requiresCommission:!1,isStatic:!0,staticValues:["TL","USD","EUR"]},{value:"category",label:y("settings.category"),requiresCommission:!1,isStatic:!0,staticValues:["DEP","WD"]},{value:"psp",label:y("settings.psp_kasa"),requiresCommission:!0,isStatic:!1,isProtected:!1},{value:"company",label:y("settings.company"),requiresCommission:!1,isStatic:!1,isProtected:!1}],Ne=async()=>{try{$(!0);const e=await Fe.get("/transactions/dropdown-options");if(e.ok){const s=await Fe.parseResponse(e);E(s||{})}}catch(e){}finally{$(!1)}},ve=async()=>{try{ae(!0);const e=localStorage.getItem("systemDepartments");if(e)ee(JSON.parse(e));else{const e=["Conversion","Retention","Marketing","Research","Operation","Management","Facility"];ee(e),localStorage.setItem("systemDepartments",JSON.stringify(e))}}catch(e){}finally{ae(!1)}},we=e=>{e?(ce(e),be(!0)):(je(""),be(!1)),le(!0)};r.useEffect(()=>{"dropdowns"===s&&Ne(),"departments"===s&&ve()},[s]),Ue([{key:"1",ctrlKey:!0,action:()=>t("general")},{key:"2",ctrlKey:!0,action:()=>t("dropdowns")},{key:"3",ctrlKey:!0,action:()=>t("departments")},{key:"4",ctrlKey:!0,action:()=>t("admin")},{key:"5",ctrlKey:!0,action:()=>t("notifications")},{key:"6",ctrlKey:!0,action:()=>t("integrations")},{key:"7",ctrlKey:!0,action:()=>t("translations")}]);const _e=()=>{l(!1),x(!1),g(!1);const e=new URL(window.location.href);e.searchParams.set("tab","admin"),e.searchParams.delete("view"),window.history.pushState({},"",e.toString())},ke=[{id:"general",label:y("settings.general"),icon:A,content:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ls,{className:"border border-gray-200 shadow-sm",children:[e.jsx(Ye,{className:"border-b border-gray-100 bg-gray-50/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(L,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx(We,{className:"text-lg font-semibold text-gray-900",children:y("settings.company_information")}),e.jsx(He,{className:"text-sm text-gray-600",children:y("settings.order_invest_pipeline_collab")})]})]})}),e.jsxs(Me,{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-md",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-2 uppercase tracking-wide",children:y("settings.company_name")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-base font-semibold text-gray-900",children:"Order Invest"}),e.jsx("span",{className:"text-gray-400",children:"×"}),e.jsx("span",{className:"text-base font-semibold text-gray-700",children:"PipLine"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:y("settings.strategic_partnership")})]}),e.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-md",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-2 uppercase tracking-wide",children:y("settings.contact_email")}),e.jsx(ts,{type:"email",placeholder:"contact@orderinvest.com",className:"bg-white border-gray-300"})]})]}),e.jsx("div",{className:"mt-4 p-4 bg-slate-50 border border-slate-200 rounded-md",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"text-slate-600 mt-0.5",children:e.jsx(b,{className:"h-4 w-4"})}),e.jsxs("div",{className:"text-sm text-slate-700",children:[e.jsx("p",{className:"font-medium mb-1",children:y("settings.partnership_overview")}),e.jsx("p",{className:"text-xs leading-relaxed text-slate-600",children:y("settings.partnership_description")})]})]})})]})]}),e.jsxs(ls,{className:"border border-gray-200 shadow-sm",children:[e.jsx(Ye,{className:"border-b border-gray-100 bg-gray-50/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(u,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx(We,{className:"text-lg font-semibold text-gray-900",children:y("settings.system_preferences")}),e.jsx(He,{className:"text-sm text-gray-600",children:y("settings.configure_system")})]})]})}),e.jsxs(Me,{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-md",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-2 uppercase tracking-wide",children:y("settings.timezone")}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors bg-white text-sm text-gray-900 appearance-none cursor-pointer",style:{zIndex:9999},children:[e.jsx("option",{className:"bg-white text-gray-900",children:"Europe/Istanbul (UTC+3)"}),e.jsx("option",{className:"bg-white text-gray-900",children:"UTC"}),e.jsx("option",{className:"bg-white text-gray-900",children:"Europe/London (UTC+0)"}),e.jsx("option",{className:"bg-white text-gray-900",children:"America/New_York (UTC-5)"}),e.jsx("option",{className:"bg-white text-gray-900",children:"Asia/Dubai (UTC+4)"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:y("settings.default_europe_istanbul")})]}),e.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-md",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-2 uppercase tracking-wide",children:y("settings.language")}),e.jsx("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors bg-white text-sm text-gray-900 appearance-none cursor-pointer",style:{zIndex:9999},value:D,onChange:e=>(async e=>{try{await N(e)}catch(s){}})(e.target.value),children:Object.entries(T).map(([s,t])=>e.jsxs("option",{value:s,className:"bg-white text-gray-900",children:[t.flag," ",t.name]},s))}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:y("settings.primary_turkish")})]})]}),e.jsx("div",{className:"mt-4 p-4 bg-slate-50 border border-slate-200 rounded-md",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"text-slate-600 mt-0.5",children:e.jsx(b,{className:"h-4 w-4"})}),e.jsxs("div",{className:"text-sm text-slate-700",children:[e.jsx("p",{className:"font-medium mb-1",children:y("settings.currency_standard")}),e.jsx("p",{className:"text-xs leading-relaxed text-slate-600",children:y("settings.currency_standard_desc")})]})]})})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs(ns,{size:"lg",className:"px-8 py-3 bg-slate-700 hover:bg-slate-800 text-white font-medium",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),y("settings.save_config_changes")]})})]})},{id:"dropdowns",label:y("settings.dropdown_management"),icon:de,content:e.jsxs("div",{className:"space-y-6",children:[e.jsx(ls,{className:"border border-gray-200 shadow-sm",children:e.jsx(Ye,{className:"border-b border-gray-100 bg-gray-50/50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(de,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx(We,{className:"text-lg font-semibold text-gray-900",children:y("settings.dropdown_management")}),e.jsx(He,{className:"text-sm text-gray-600",children:y("settings.manage_dropdown_options")})]})]}),e.jsxs(ns,{onClick:()=>{Q(""),M(!0)},className:"bg-slate-700 hover:bg-slate-800 text-white",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),y("settings.add_new_option")]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(ls,{className:"border border-gray-200",children:e.jsx(Me,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-slate-700 font-semibold text-base",children:"₺"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide",children:y("settings.currency_options")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:F.currency?.length||0})]})]})})}),e.jsx(ls,{className:"border border-gray-200",children:e.jsx(Me,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-slate-700 font-semibold text-base",children:"💳"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide",children:y("settings.payment_methods")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:F.payment_method?.length||0})]})]})})}),e.jsx(ls,{className:"border border-gray-200",children:e.jsx(Me,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-slate-700 font-semibold text-base",children:"🏢"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide",children:y("settings.psp_kasa")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:F.psp?.length||0})]})]})})}),e.jsx(ls,{className:"border border-gray-200",children:e.jsx(Me,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-slate-700 font-semibold text-base",children:"📊"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide",children:y("common.total_options")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Object.values(F).reduce((e,s)=>e+(s?.length||0),0)})]})]})})})]}),R?e.jsx(ls,{className:"p-8 border border-gray-200",children:e.jsxs(Me,{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-700 font-medium",children:y("settings.loading_configuration_data")}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:y("settings.please_wait_retrieve_settings")})]})}):e.jsxs(ls,{className:"border border-gray-200 overflow-hidden",children:[e.jsx(Ye,{className:"px-6 py-4 border-b border-gray-200 bg-gray-50/50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(We,{className:"text-base font-semibold text-gray-900",children:y("settings.configuration_categories")}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(is,{variant:"secondary",className:"text-xs bg-slate-100 text-slate-700",children:[Object.values(F).reduce((e,s)=>e+(s?.length||0),0)," ",y("settings.total_items")]})})]})}),e.jsx(Me,{className:"p-0",children:e.jsx("div",{className:"divide-y divide-gray-100",children:fe.map(s=>e.jsxs("div",{className:"p-6 hover:bg-gray-50 transition-colors duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-600 to-gray-600 rounded-lg flex items-center justify-center shadow-sm",children:e.jsx(de,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h5",{className:"text-lg font-bold text-gray-900",children:s.label}),s.isProtected&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-amber-100 text-amber-700 rounded-full text-xs font-medium",children:[e.jsx(S,{className:"h-3 w-3"}),y("settings.protected")]})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsx("span",{className:"text-sm text-gray-600",children:s.isStatic?`${s.staticValues?.length||0} ${y("settings.fixed_options")}`:`${F[s.value]?.length||0} ${y("settings.options_configured")}`}),s.isStatic&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:y("settings.fixed_values")}),s.isProtected&&!s.isStatic&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-amber-100 text-amber-800",children:[e.jsx(S,{className:"h-3 w-3 mr-1"}),y("settings.protected")]}),s.requiresCommission&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:y("settings.commission_required")})]})]})]}),!s.isStatic&&e.jsxs(os,{variant:"outline",size:"sm",onClick:()=>{G(e=>({...e,field_name:s.value})),M(!0)},icon:e.jsx(H,{className:"h-4 w-4"}),iconPosition:"left",children:["Add ",s.label]})]}),s.isStatic?e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:s.staticValues?.map((s,t)=>e.jsx("div",{className:"bg-white rounded-lg p-3 border border-gray-200 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-semibold text-gray-900 text-sm",children:s}),e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:y("settings.protected")})]}),e.jsx("p",{className:"text-xs text-gray-500",children:y("settings.static_value")})]}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx(C,{className:"h-4 w-4 text-gray-400"})})]})},t))})}):F[s.value]?.length>0?e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:F[s.value].map(t=>e.jsx("div",{className:"bg-white rounded-lg p-3 border border-gray-200 hover:border-gray-300 hover:shadow-sm transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-semibold text-gray-900 text-sm",children:t.value}),"TETHER"===t.value.toUpperCase()?e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:"Internal KASA"}):null!==t.commission_rate&&void 0!==t.commission_rate?e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:[(100*Number(t.commission_rate)).toFixed(1),"%"]}):null,s.isProtected&&e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-amber-100 text-amber-800",children:[e.jsx(S,{className:"h-3 w-3 mr-1"}),y("settings.protected")]})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["ID: ",t.id," • ",y("settings.created"),": ",t.created_at?new Date(t.created_at).toLocaleDateString():"N/A"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),((e,s)=>{q(e);const t=e.commission_rate?(100*parseFloat(e.commission_rate.toString())).toString():"";G({field_name:s,value:e.value,commission_rate:t}),Q(""),W(!0)})(t,s.value)},className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-50 rounded transition-colors duration-200",title:y("settings.edit_option"),type:"button",children:e.jsx(K,{className:"h-4 w-4"})}),e.jsx("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),(async(e,s)=>{const t=fe.find(e=>e.value===s);if(t?.isProtected){const s=y("settings.delete_protected_warning",{field:t?.label||"Unknown"});if("DELETE"!==prompt(s))return void alert(y("settings.must_type_delete"));if(!confirm(y("settings.final_delete_warning",{option:e.value,field:t?.label||"Unknown"})))return void alert(y("settings.deletion_cancelled"))}else if(!confirm("Are you sure you want to delete this option?"))return;try{Fe.clearToken();const s=await Fe.delete(`/transactions/dropdown-options/${e.id}`);if(s.ok)await Ne(),Fe.clearToken();else{let e="Failed to delete option";try{const t=await s.text(),a=JSON.parse(t);e=a.error||a.message||e}catch(a){}}}catch(r){}})(t,s.value)},className:"p-1.5 rounded transition-colors duration-200 "+(s.isProtected?"text-red-400 hover:text-red-600 hover:bg-red-50":"text-gray-400 hover:text-red-600 hover:bg-red-50"),title:s.isProtected?y("settings.protected_option_warning"):y("settings.delete_option"),type:"button",children:e.jsx(Y,{className:"h-4 w-4"})})]})]})},t.id))})}):e.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(de,{className:"h-8 w-8 text-gray-400"})}),e.jsxs("h6",{className:"text-gray-600 font-medium mb-1",children:["No ",s.label," configured"]}),e.jsxs("p",{className:"text-sm text-gray-500 mb-3",children:["Start building your ",s.label.toLowerCase()," configuration"]}),e.jsxs("button",{onClick:()=>M(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors duration-200 font-medium text-sm",children:[e.jsx(H,{className:"h-4 w-4"}),"Add First ",s.label]})]})]},s.value))})})]})]})},{id:"departments",label:y("settings.departments"),icon:L,content:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(cs,{variant:"elevated",className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gray-100 rounded-full -translate-y-16 translate-x-16"}),e.jsx(Me,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-700 to-gray-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx(L,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx(We,{className:"text-2xl font-bold text-gray-900",children:y("settings.department_management")}),e.jsx(He,{className:"text-gray-600 font-medium",children:y("settings.organizational_structure_desc")})]})]}),e.jsx(os,{variant:"primary",size:"lg",onClick:()=>we(),icon:e.jsx(H,{className:"h-5 w-5"}),iconPosition:"left",className:"px-6 py-3 font-semibold shadow-lg hover:shadow-lg",children:y("settings.add_new_department")})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(cs,{variant:"outlined",className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-gray-100 rounded-full -translate-y-8 translate-x-8"}),e.jsx(Me,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(L,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:y("settings.total_departments")}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:Z.length})]})]})})]}),e.jsxs(cs,{variant:"outlined",className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-slate-100 rounded-full -translate-y-8 translate-x-8"}),e.jsx(Me,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(d,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:y("settings.active_teams")}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:Z.filter(e=>["Conversion","Retention","Marketing","Research","Operation"].includes(e)).length})]})]})})]}),e.jsxs(cs,{variant:"outlined",className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-slate-100 rounded-full -translate-y-8 translate-x-8"}),e.jsx(Me,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(j,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:y("settings.support_functions")}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:Z.filter(e=>["Management","Facility"].includes(e)).length})]})]})})]})]}),se?e.jsx(cs,{variant:"outlined",className:"p-8",children:e.jsxs(Me,{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 font-medium",children:y("settings.loading_organizational_structure")}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:y("settings.please_wait_retrieve_department_config")})]})}):e.jsxs(cs,{variant:"outlined",className:"overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-gray-50 to-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:y("settings.organizational_structure")}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-xs text-gray-500 bg-white px-2 py-1 rounded-full border border-gray-200",children:[Z.length," ",y("settings.departments")]})})]})}),0===Z.length?e.jsxs("div",{className:"text-center py-12 px-6",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(L,{className:"h-10 w-10 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:y("settings.no_departments_configured")}),e.jsx("p",{className:"text-gray-500 mb-6 max-w-md mx-auto text-sm",children:y("settings.start_building_organizational_structure")}),e.jsxs("button",{onClick:()=>we(),className:"inline-flex items-center px-6 py-3 border border-transparent rounded-lg text-sm font-medium text-white bg-gradient-to-r from-gray-700 to-gray-600 hover:from-gray-800 hover:to-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors shadow-sm",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),y("settings.create_first_department")]})]}):e.jsx("div",{className:"divide-y divide-gray-100",children:Z.map((s,t)=>e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-600 to-gray-600 rounded-lg flex items-center justify-center shadow-sm",children:e.jsx(L,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-bold text-gray-900",children:s}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[y("settings.department_id"),": ",t+1]}),["Conversion","Retention","Marketing","Research","Operation"].includes(s)&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:y("settings.core_team")}),["Management","Facility"].includes(s)&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:y("settings.support_function")})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>we(s),className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 font-medium text-sm",title:y("settings.edit"),children:[e.jsx(K,{className:"h-4 w-4"}),y("settings.edit")]}),e.jsxs("button",{onClick:()=>(async e=>{if(confirm(`Are you sure you want to delete the department "${e}"? This action cannot be undone.`))try{const s=Z.filter(s=>s!==e);ee(s),localStorage.setItem("systemDepartments",JSON.stringify(s))}catch(s){}})(s),className:"inline-flex items-center gap-2 px-4 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors duration-200 font-medium text-sm",title:y("settings.delete"),children:[e.jsx(Y,{className:"h-4 w-4"}),y("settings.delete")]})]})]})},t))})]})]})},{id:"admin",label:y("settings.system_administration"),icon:S,content:e.jsx("div",{className:"space-y-5",children:a||m||h?h?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:_e,className:"inline-flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:[e.jsx("span",{children:"←"}),"Back to Administration"]}),e.jsx("div",{className:"h-6 w-px bg-gray-300"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5 text-slate-700"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Security Management"})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsx(r.Suspense,{fallback:e.jsx(Es,{}),children:e.jsx(ut,{})})})]}):a?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:_e,className:"inline-flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:[e.jsx("span",{children:"←"}),"Back to Administration"]}),e.jsx("div",{className:"h-6 w-px bg-gray-300"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-5 w-5 text-slate-700"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"System Monitor"})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsx(r.Suspense,{fallback:e.jsx(Es,{}),children:e.jsx(xt,{})})})]}):m?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:_e,className:"inline-flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:[e.jsx("span",{children:"←"}),"Back to Administration"]}),e.jsx("div",{className:"h-6 w-px bg-gray-300"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-5 w-5 text-slate-700"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Database Management"})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden p-6",children:e.jsx(r.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(i,{className:"h-8 w-8 animate-spin text-slate-700"})}),children:e.jsx(ht,{})})})]}):null:e.jsxs("div",{className:"space-y-5",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:y("settings.system_administration")}),e.jsx("p",{className:"text-sm text-gray-600",children:y("settings.manage_system_admin")})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-all duration-200 hover:border-gray-300 hover:shadow-sm",children:[e.jsx(d,{className:"h-7 w-7 text-gray-600 mb-2"}),e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:y("settings.user_management")}),e.jsx("p",{className:"text-xs text-gray-500",children:y("settings.manage_system_users")})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-all duration-200 hover:border-slate-300 hover:shadow-sm",children:[e.jsx(C,{className:"h-7 w-7 text-slate-700 mb-2"}),e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:y("settings.permissions")}),e.jsx("p",{className:"text-xs text-gray-500",children:y("settings.configure_access_controls")})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-all duration-200 hover:border-slate-300 hover:shadow-md",onClick:()=>{l(!0),x(!1);const e=new URL(window.location.href);e.searchParams.set("tab","admin"),e.searchParams.set("view","monitor"),window.history.pushState({},"",e.toString())},children:[e.jsx(xe,{className:"h-7 w-7 text-slate-700 mb-2"}),e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:y("settings.system_monitor")}),e.jsx("p",{className:"text-xs text-gray-500",children:y("settings.realtime_system_monitoring")})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-all duration-200 hover:border-slate-300 hover:shadow-md",onClick:()=>{x(!0),l(!1);const e=new URL(window.location.href);e.searchParams.set("tab","admin"),e.searchParams.set("view","database"),window.history.pushState({},"",e.toString())},children:[e.jsx(he,{className:"h-7 w-7 text-slate-700 mb-2"}),e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:y("settings.database")}),e.jsx("p",{className:"text-xs text-gray-500",children:y("settings.database_management")})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-all duration-200 hover:border-red-300 hover:shadow-sm",children:[e.jsx(he,{className:"h-7 w-7 text-red-600 mb-2"}),e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:y("settings.backup_restore")}),e.jsx("p",{className:"text-xs text-gray-500",children:y("settings.data_backup_recovery")})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-all duration-200 hover:border-indigo-300 hover:shadow-sm",onClick:()=>{g(!0),l(!1),x(!1);const e=new URL(window.location.href);e.searchParams.set("tab","admin"),e.searchParams.set("view","security"),window.history.pushState({},"",e.toString())},children:[e.jsx(S,{className:"h-7 w-7 text-slate-700 mb-2"}),e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:y("settings.security")}),e.jsx("p",{className:"text-xs text-gray-500",children:y("settings.security_config")})]})]})]})})},{id:"notifications",label:y("settings.notifications"),icon:me,content:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 border border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-700 rounded-lg flex items-center justify-center shadow-sm",children:e.jsx(me,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:y("settings.notifications_title")}),e.jsx("p",{className:"text-sm text-gray-600",children:y("settings.configure_notifications")})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white rounded-lg p-5 border border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-gray-500 to-gray-600 rounded-lg flex items-center justify-center",children:e.jsx(te,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:y("settings.email_notifications_title")}),e.jsx("p",{className:"text-xs text-gray-500",children:y("settings.receive_important_updates")})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer"}),e.jsx("div",{className:"w-10 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-orange-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-gray-500"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg p-5 border border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-700 rounded-lg flex items-center justify-center",children:e.jsx(re,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:y("settings.sms_notifications_title")}),e.jsx("p",{className:"text-xs text-gray-500",children:y("settings.urgent_alerts_text")})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer"}),e.jsx("div",{className:"w-10 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-orange-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-gray-500"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg p-5 border border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-700 rounded-lg flex items-center justify-center",children:e.jsx(me,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:y("settings.push_notifications_title")}),e.jsx("p",{className:"text-xs text-gray-500",children:y("settings.realtime_browser_notifications")})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer"}),e.jsx("div",{className:"w-10 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-orange-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-gray-500"})]})]})})]})]})})},{id:"integrations",label:y("settings.integrations"),icon:u,content:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-gray-50 rounded-xl p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-700 to-gray-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx(u,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:y("settings.system_integrations")}),e.jsx("p",{className:"text-gray-600 font-medium",children:y("settings.connect_external_services")})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-gray-50 to-gray-50",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:y("settings.api_integrations")}),e.jsx("p",{className:"text-sm text-gray-600",children:y("settings.connect_external_data_sources")})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(o,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 text-sm",children:y("settings.exchange_rate_apis")}),e.jsx("p",{className:"text-xs text-gray-500",children:y("settings.realtime_currency_conversion")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:y("settings.active")}),e.jsx("button",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 text-xs font-medium",children:y("settings.configure")})]})]})}),e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(L,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 text-sm",children:y("settings.banking_apis")}),e.jsx("p",{className:"text-xs text-gray-500",children:y("settings.account_balance_sync")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:y("settings.pending")}),e.jsx("button",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 text-xs font-medium",children:y("settings.setup")})]})]})}),e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(n,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 text-sm",children:y("settings.market_data_apis")}),e.jsx("p",{className:"text-xs text-gray-500",children:y("settings.stock_prices_analytics")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:y("settings.inactive")}),e.jsx("button",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 text-xs font-medium",children:y("settings.enable")})]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:y("settings.data_integrations")}),e.jsx("p",{className:"text-sm text-gray-600",children:y("settings.import_export_external_data")})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(c,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 text-sm",children:y("settings.excel_csv_import")}),e.jsx("p",{className:"text-xs text-gray-500",children:y("settings.bulk_transaction_import")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:y("settings.active")}),e.jsx("button",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 text-xs font-medium",children:y("settings.manage")})]})]})}),e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(i,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 text-sm",children:y("settings.database_sync")}),e.jsx("p",{className:"text-xs text-gray-500",children:y("settings.realtime_data_sync")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:y("settings.active")}),e.jsx("button",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 text-xs font-medium",children:y("settings.monitor")})]})]})}),e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx(B,{className:"h-5 w-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 text-sm",children:y("settings.report_export")}),e.jsx("p",{className:"text-xs text-gray-500",children:y("settings.automated_report_generation")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:y("settings.active")}),e.jsx("button",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 text-xs font-medium",children:y("settings.configure")})]})]})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:y("settings.integration_health_status")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg border border-slate-200",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(p,{className:"h-5 w-5 text-slate-700"})}),e.jsx("p",{className:"text-sm font-medium text-slate-700",children:y("settings.active")}),e.jsxs("p",{className:"text-xs text-slate-700",children:["4 ",y("settings.integrations")]})]}),e.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:[e.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(k,{className:"h-5 w-5 text-yellow-600"})}),e.jsx("p",{className:"text-sm font-medium text-yellow-800",children:y("settings.pending")}),e.jsxs("p",{className:"text-xs text-yellow-600",children:["1 ",y("settings.integrations")]})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(ue,{className:"h-5 w-5 text-gray-600"})}),e.jsx("p",{className:"text-sm font-medium text-gray-800",children:y("settings.inactive")}),e.jsxs("p",{className:"text-xs text-gray-600",children:["1 ",y("settings.integrations")]})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(n,{className:"h-5 w-5 text-gray-600"})}),e.jsx("p",{className:"text-sm font-medium text-gray-800",children:y("settings.total")}),e.jsxs("p",{className:"text-xs text-gray-600",children:["6 ",y("settings.integrations")]})]})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-gray-50 rounded-xl p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:y("settings.need_more_integrations")}),e.jsx("p",{className:"text-sm text-gray-600",children:y("settings.contact_integration_team")})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 font-medium text-sm",children:y("settings.view_documentation")}),e.jsx("button",{className:"px-6 py-2 bg-gradient-to-r from-gray-700 to-gray-600 text-white rounded-lg hover:from-gray-800 hover:to-gray-700 transition-all duration-200 font-medium text-sm",children:y("settings.request_integration")})]})]})})]})}];return e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("h1",{className:"text-2xl font-semibold text-gray-900 flex items-center gap-3",children:[e.jsx(A,{className:"h-7 w-7 text-slate-700"}),y("settings.title")]}),e.jsx("p",{className:"text-sm text-gray-600",children:y("settings.config")})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(ns,{variant:"outline",size:"sm",onClick:()=>{"dropdowns"===s?Ne():"departments"===s?ve():window.location.reload()},className:"border-gray-300 hover:bg-gray-50",children:[e.jsx(i,{className:"h-4 w-4 mr-2"}),y("settings.refresh")]})})]})}),e.jsxs(Oe,{value:s,onValueChange:t,className:"w-full",children:[e.jsxs(ze,{className:"grid w-full grid-cols-6 bg-gray-50/80 border border-gray-200/60 rounded-lg shadow-sm",children:[e.jsxs(Be,{value:"general",className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),y("tabs.general")]}),e.jsxs(Be,{value:"dropdowns",className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"}),y("tabs.dropdowns")]}),e.jsxs(Be,{value:"departments",className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),y("tabs.departments")]}),e.jsxs(Be,{value:"admin",className:"flex items-center gap-2",children:[e.jsx(S,{className:"h-4 w-4"}),y("tabs.admin")]}),e.jsxs(Be,{value:"notifications",className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4"}),y("tabs.notifications")]}),e.jsxs(Be,{value:"integrations",className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),y("tabs.integrations")]})]}),ke.map(s=>e.jsx(Ke,{value:s.id,className:"mt-6",children:s.content},s.id))]}),U&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",onClick:()=>M(!1),children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full relative",onClick:e=>e.stopPropagation(),children:[e.jsx("div",{className:"p-5 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:y("settings.add_option")}),e.jsx(os,{variant:"ghost",size:"sm",onClick:()=>M(!1),icon:e.jsx(P,{className:"h-4 w-4"}),children:"Close"})]})}),e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{className:"relative custom-dropdown-container",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:y("settings.field_type")}),e.jsxs("div",{className:"relative custom-dropdown-container",children:[e.jsxs("button",{type:"button",onClick:()=>_(!w),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 bg-white text-gray-900 cursor-pointer text-left flex items-center justify-between hover:border-gray-400 transition-colors",children:[e.jsx("span",{className:J.field_name?"text-gray-900":"text-gray-500",children:J.field_name?fe.find(e=>e.value===J.field_name)?.label:"Select field type..."}),e.jsx(z,{className:"h-4 w-4 text-gray-500 transition-transform "+(w?"rotate-180":"")})]}),w&&e.jsx("div",{className:"absolute z-[10001] w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-auto",children:e.jsx("div",{className:"py-1",children:fe.filter(e=>!e.isStatic).map(s=>e.jsxs("button",{type:"button",onClick:()=>{G(e=>({...e,field_name:s.value})),_(!1)},className:"w-full px-3 py-2 text-left hover:bg-gray-100 transition-colors flex items-center justify-between "+(J.field_name===s.value?"bg-gray-50 text-gray-900 font-medium":"text-gray-700"),children:[e.jsx("span",{children:s.label}),J.field_name===s.value&&e.jsx(ge,{className:"h-4 w-4 text-gray-600"})]},s.value))})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:y("settings.option_value")}),e.jsx(ts,{type:"text",value:J.value,onChange:e=>G(s=>({...s,value:e.target.value})),placeholder:"Enter option value..."})]}),fe.find(e=>e.value===J.field_name)?.requiresCommission&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:y("settings.commission_rate_required")}),e.jsx(ts,{type:"number",step:"0.01",min:"0",max:"100",value:J.commission_rate,onChange:e=>G(s=>({...s,commission_rate:e.target.value})),placeholder:"2.5 (for 2.5%)",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter as percentage (2.5 for 2.5%, 5 for 5%)"})]}),fe.find(e=>e.value===J.field_name)?.isProtected&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Security Code ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ts,{type:"password",value:X,onChange:e=>Q(e.target.value),placeholder:"Enter security code...",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Required for adding protected options"})]})]}),e.jsxs("div",{className:"p-5 border-t border-gray-100 flex gap-3",children:[e.jsx(os,{variant:"outline",onClick:()=>M(!1),className:"flex-1",children:"Cancel"}),e.jsx(os,{variant:"primary",onClick:async()=>{if(!J.field_name)return;const e=fe.find(e=>e.value===J.field_name);if(e?.isProtected){if(!X.trim())return;if("4561"!==X.trim())return}if(!J.value.trim())return;if((F[J.field_name]||[]).find(e=>e.value===J.value.trim()))return;let s=null;if("psp"===J.field_name){if(!J.commission_rate||""===J.commission_rate.trim())return void alert("Commission rate is required for PSP options");let e=parseFloat(J.commission_rate);if(isNaN(e))return void alert("Commission rate must be a valid number");if(e>1&&(e/=100),e<0||e>1)return void alert("Commission rate must be between 0 and 100% (enter as decimal: 0.025 for 2.5% or as percentage: 2.5)");s=e.toString()}try{const e=await Fe.post("/transactions/dropdown-options",{field_name:J.field_name,value:J.value.trim(),commission_rate:s});if(e.ok||201===e.status)M(!1),G({field_name:"",value:"",commission_rate:""}),Q(""),await Ne();else{let s="Failed to add option";try{const t=e.data||{};s=t.error||t.message||s}catch(t){}alert(s)}}catch(a){}},disabled:!J.field_name||!J.value||fe.find(e=>e.value===J.field_name)?.requiresCommission&&!J.commission_rate||fe.find(e=>e.value===J.field_name)?.isProtected&&!X,className:"flex-1",children:y("settings.add_option")})]})]})}),O&&V&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",onClick:()=>W(!1),children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full relative",onClick:e=>e.stopPropagation(),children:[e.jsx("div",{className:"p-5 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:y("settings.edit_option")}),e.jsx(os,{variant:"ghost",size:"sm",onClick:()=>W(!1),icon:e.jsx(P,{className:"h-4 w-4"}),children:"Close"})]})}),e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:y("settings.field_type")}),e.jsx(ts,{type:"text",value:fe.find(e=>e.value===J.field_name)?.label||J.field_name,className:"bg-gray-50",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:y("settings.option_value")}),e.jsx(ts,{type:"text",value:J.value,onChange:e=>G(s=>({...s,value:e.target.value})),placeholder:"Enter option value..."})]}),fe.find(e=>e.value===J.field_name)?.requiresCommission&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:y("settings.commission_rate_required")}),e.jsx(ts,{type:"number",step:"0.01",min:"0",max:"100",value:J.commission_rate,onChange:e=>G(s=>({...s,commission_rate:e.target.value})),placeholder:"2.5 (for 2.5%)",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter as percentage (2.5 for 2.5%, 5 for 5%)"})]}),fe.find(e=>e.value===J.field_name)?.isProtected&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Security Code ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ts,{type:"password",value:X,onChange:e=>Q(e.target.value),placeholder:"Enter security code...",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Required for editing protected options"})]})]}),e.jsxs("div",{className:"p-5 border-t border-gray-100 flex gap-3",children:[e.jsx(os,{variant:"outline",onClick:()=>W(!1),className:"flex-1",children:"Cancel"}),e.jsx(os,{variant:"primary",onClick:async()=>{if(!V)return;const e=fe.find(e=>e.value===J.field_name);if(e?.isProtected){if(!X.trim())return void alert(y("settings.security_code_required"));if("4561"!==X.trim())return void alert(y("settings.invalid_security_code"))}if((F[J.field_name]||[]).find(e=>e.value===J.value.trim()&&e.id!==V.id))return void alert(y("settings.option_value_exists").replace("{value}",J.value.trim()).replace("{field}",e?.label||J.field_name));if(!J.value.trim())return;let s=null;if("psp"===J.field_name){if(!J.commission_rate||""===J.commission_rate.trim())return void alert("Commission rate is required for PSP options");let e=parseFloat(J.commission_rate);if(isNaN(e))return void alert("Commission rate must be a valid number");if(e>1&&(e/=100),e<0||e>1)return void alert("Commission rate must be between 0 and 100% (enter as decimal: 0.025 for 2.5% or as percentage: 2.5)");s=e.toString()}try{const e=await Fe.put(`/transactions/dropdown-options/${V.id}`,{value:J.value.trim(),commission_rate:s});if(e.ok){try{await Fe.parseResponse(e)}catch(t){}W(!1),q(null),G({field_name:"",value:"",commission_rate:""}),Q("");try{$(!0);const e=await Fe.get("/transactions/dropdown-options",void 0,!1);if(e.ok){const s=await Fe.parseResponse(e);E(s||{})}}catch(a){await Ne()}finally{$(!1)}Fe.clearToken()}else{let s="Failed to update option";try{const t=await e.text(),a=JSON.parse(t);s=a.error||a.message||s}catch(t){}}}catch(r){const e=r instanceof Error?r.message:"Failed to update option. Please try again.";alert(e)}},disabled:!J.value||fe.find(e=>e.value===J.field_name)?.requiresCommission&&!J.commission_rate||fe.find(e=>e.value===J.field_name)?.isProtected&&!X,className:"flex-1",children:y("settings.edit_option")})]})]})}),ne&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:()=>le(!1),children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",onClick:e=>e.stopPropagation(),children:[e.jsx("div",{className:"p-5 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:y(ye?"settings.edit_department":"settings.add_new_department")}),e.jsx(os,{variant:"ghost",size:"sm",onClick:()=>le(!1),icon:e.jsx(P,{className:"h-4 w-4"}),children:y("settings.close")})]})}),e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:y("settings.department_name")}),e.jsx(ts,{type:"text",value:ye?ie:pe,onChange:e=>ye?ce(e.target.value):je(e.target.value),placeholder:"Enter department name...",autoFocus:!0})]}),e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-5 h-5 bg-gray-100 rounded-full flex items-center justify-center mt-0.5",children:e.jsx("span",{className:"text-gray-600 text-xs font-bold",children:"i"})}),e.jsxs("div",{className:"text-sm text-gray-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"Department Management"}),e.jsx("p",{className:"text-xs",children:ye?"Editing a department will update it across the entire system, including all existing agents assigned to this department.":"New departments will be available immediately for assigning to agents and will appear in the department tabs."})]})]})})]}),e.jsxs("div",{className:"p-5 border-t border-gray-100 flex gap-3",children:[e.jsx(os,{variant:"outline",onClick:()=>le(!1),className:"flex-1",children:"Cancel"}),e.jsx(os,{variant:"primary",onClick:ye?async()=>{if(ie.trim())try{const e=Z.find(e=>e!==ie);if(!e)return void alert(y("settings.department_not_found"));if(Z.includes(ie.trim())&&ie.trim()!==e)return void alert(y("settings.department_name_exists"));const s=Z.map(s=>s===e?ie.trim():s);ee(s),localStorage.setItem("systemDepartments",JSON.stringify(s)),ce(""),be(!1),le(!1)}catch(e){}}:async()=>{if(pe.trim())try{if(Z.includes(pe.trim()))return void alert(y("settings.department_exists"));const e=[...Z,pe.trim()];ee(e),localStorage.setItem("systemDepartments",JSON.stringify(e)),je(""),le(!1)}catch(e){}},disabled:ye?!ie.trim():!pe.trim(),className:"flex-1",children:ye?"Update Department":"Add Department"})]})]})})]})}},Symbol.toStringTag,{value:"Module"})),pt=new class{baseUrl;constructor(){this.baseUrl=""}async makeRequest(e,s={}){const t=this.baseUrl?`${this.baseUrl}${e}`:e,a={headers:{"Content-Type":"application/json",...s.headers},credentials:"include"},r=await fetch(t,{...a,...s});if(!r.ok){if(401===r.status)throw new Error("Authentication required. Please log in.");if(404===r.status)throw new Error("Exchange rate not found.");if(r.status>=500)throw new Error("Server error. Please try again later.");const e=await r.json().catch(()=>({}));throw new Error(e.message||`HTTP ${r.status}: ${r.statusText}`)}return r.json()}async getStatus(){return this.makeRequest("/api/v1/exchange-rates/status")}async fetchRate(e){const s=await this.makeRequest("/api/v1/exchange-rates/current");return s.success&&s.rate?{status:"success",message:s.message||"Rate fetched successfully",rate:{...s.rate,currency_pair:e.currency_pair}}:{status:"error",message:s.message||"Failed to fetch rate"}}async getDailySummaryRates(e){const s=await this.makeRequest("/api/v1/exchange-rates/current");return s.success&&s.rate?{status:"success",message:s.message||"Rate fetched successfully",rates:{USDTRY:{...s.rate,currency_pair:"USDTRY"}}}:{status:"error",message:s.message||"Failed to fetch rates"}}async updateManualRate(e){return{status:"error",message:"Manual rate updates not currently supported"}}async refreshRates(e){const s=await this.makeRequest("/api/v1/exchange-rates/update",{method:"POST"});return s.success?{status:"success",message:s.message||"Rates refreshed successfully"}:{status:"error",message:s.message||"Failed to refresh rates"}}async getHistory(e){const s=new URLSearchParams({start_date:e.start_date,end_date:e.end_date});return e.currency_pair&&s.append("currency_pair",e.currency_pair),this.makeRequest(`/api/v1/exchange-rates/history?${s}`)}async getMissingRates(e){return{status:"success",message:"No missing rates detected",missing_dates:[]}}async getRate(e,s){try{return(await this.fetchRate({date:s,currency_pair:e})).rate||null}catch(t){return null}}async getRatesForDate(e){try{const s=await this.getDailySummaryRates({date:e});return s.rates&&"object"==typeof s.rates&&!Array.isArray(s.rates)?s.rates:{}}catch(s){return{}}}formatCurrencyPair(e){const[s,t]=e.split("/");return`${s} → ${t}`}getSourceDisplayName(e){switch(e.toLowerCase()){case"yfinance":return"Yahoo Finance";case"manual":return"Manual Override";case"tcmb":return"TCMB";default:return e}}getQualityDisplayName(e){switch(e.toLowerCase()){case"closing_price":return"Closing Price";case"closest_available":return"Closest Available";case"manual":return"Manual";default:return e}}getQualityColor(e){switch(e.toLowerCase()){case"closing_price":return"text-green-600";case"closest_available":return"text-yellow-600";case"manual":return"text-blue-600";default:return"text-gray-600"}}getSourceIcon(e){switch(e.toLowerCase()){case"yfinance":return"📊";case"manual":return"✏️";case"tcmb":return"🏛️";default:return"📈"}}validateRate(e,s){const[t,a]={"USD/TRY":[1,100],"EUR/TRY":[1,150],"GBP/TRY":[1,200]}[s]||[.1,1e3];return e<=0?{isValid:!1,warning:"Rate must be positive"}:e<t||e>a?{isValid:!0,warning:`${s} rate (${e}) seems unusual (expected ${t}-${a})`}:{isValid:!0}}formatRate(e,s){const[t,a]=s.split("/");return"TRY"===a?`${e.toFixed(4)} ${a}`:`${e.toFixed(2)} ${a}`}calculateConvertedAmount(e,s){return e*s}getSupportedPairs(){return["USD/TRY","EUR/TRY","GBP/TRY"]}isSupportedPair(e){return this.getSupportedPairs().includes(e)}},jt=new class{isMonitoring=!1;checkInterval=null;lastHealthStatus=null;startMonitoring(e=3e4){this.isMonitoring||(this.isMonitoring=!0,this.performHealthCheck(),this.checkInterval=setInterval(()=>{this.performHealthCheck()},e))}stopMonitoring(){this.isMonitoring&&(this.isMonitoring=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null))}async performHealthCheck(){const e=[],s=[],t={backend:!1,frontend:!1,session:!1,csrf:!1,timestamp:(new Date).toISOString()};try{try{const a=await Fe.get("/health");t.backend=a.ok,a.ok||(e.push("Backend is not responding"),s.push("Check if the Flask server is running"))}catch(a){e.push("Cannot connect to backend"),s.push("Restart the Flask server")}try{const a=await fetch("/api/v1/health");t.frontend=a.ok,a.ok||(e.push("Frontend proxy is not working"),s.push("Check Vite configuration and restart frontend"))}catch(a){e.push("Frontend proxy connection failed"),s.push("Restart the frontend development server")}try{const a=await Fe.get("/auth/check");t.session=a.ok,a.ok||(e.push("Session is invalid or expired"),s.push("User should log in again"))}catch(a){e.push("Session check failed"),s.push("Clear browser cookies and log in again")}try{const a=await Fe.get("/auth/csrf-token");if(a.ok){const r=Fe.parseResponse(a);t.csrf=!!r.csrf_token,r.csrf_token||(e.push("CSRF token generation failed"),s.push("Refresh the page to get a new token"))}else e.push("CSRF token endpoint not responding"),s.push("Check backend CSRF configuration")}catch(a){e.push("CSRF token check failed"),s.push("Refresh the page and try again")}}catch(a){e.push("Health check process failed"),s.push("Check browser console for errors")}return this.logHealthStatus(t,e,s),this.lastHealthStatus=t,{status:t,issues:e,recommendations:s}}logHealthStatus(e,s,t){Object.values(e).every(Boolean)&&s.length}getLastHealthStatus(){return this.lastHealthStatus}isHealthy(){return!!this.lastHealthStatus&&Object.values(this.lastHealthStatus).every(Boolean)}async refreshSession(){try{return Fe.clearToken(),!!(await Fe.get("/api/v1/auth/csrf-token")).ok}catch(e){return!1}}async testTransactionCreation(){try{const e={client_name:"HEALTH CHECK TEST",amount:"1.00",currency:"TL",payment_method:"BANKA",category:"DEP",psp:"#61",iban:"IBAN",company_order:"TEST COMPANY",date:(new Date).toISOString().split("T")[0],notes:"Health check test transaction"},s=await Fe.post("/transactions",e);return!!s.ok&&!!Fe.parseResponse(s).success}catch(e){return!1}}};"undefined"!=typeof window&&setTimeout(()=>{jt.startMonitoring()},5e3);const yt=Object.freeze(Object.defineProperty({__proto__:null,default:function(){Pe();const{isAuthenticated:s,isLoading:a}=Le(),[n,l]=r.useState(!1),[d,m]=r.useState(!1),[x,h]=r.useState(null),[g,b]=r.useState(!1),[f,N]=r.useState({}),[v,w]=r.useState(!1),_={currency:[{id:1,value:"TL"},{id:2,value:"USD"},{id:3,value:"EUR"}],payment_method:[{id:1,value:"Bank"},{id:2,value:"Credit card"},{id:3,value:"Tether"}],psp:[],company:[]},[k,C]=r.useState({has_rates:!1}),[T,F]=r.useState(!1),[R,$]=r.useState(!1),[O,z]=r.useState(""),[B,K]=r.useState(""),[Y,W]=r.useState("saved"),[V,q]=r.useState(!1),[J,G]=r.useState(""),[X,Q]=r.useState(""),[Z,ee]=r.useState(!1),[se,te]=r.useState(""),[ae,re]=r.useState({client_name:"",company:"",date:"",amount:"",payment_method:"",currency:"",category:"",psp:"",notes:"",eur_rate:"",usd_rate:""}),ne="addTransaction_autoSave";r.useEffect(()=>{const e=localStorage.getItem(ne);if(e)try{const s=JSON.parse(e);re(s)}catch(s){localStorage.removeItem(ne)}},[]),r.useEffect(()=>{const e=setTimeout(()=>{if(ae.client_name||ae.amount||ae.date){W("saving");try{localStorage.setItem(ne,JSON.stringify(ae)),W("saved")}catch(e){W("error")}}},2e3);return()=>clearTimeout(e)},[ae]),r.useEffect(()=>{!s||a||v||(le(),jt.performHealthCheck().then(e=>{e.issues.length}))},[s,a,v]),r.useEffect(()=>{if(s&&!a&&!v){const e=setTimeout(()=>{v||le()},1e3);return()=>clearTimeout(e)}},[s,a,v]);const le=async()=>{try{l(!0),h(null);const e=await Fe.get("/transactions/dropdown-options");if(e.ok&&e.data){const s=e.data;if(!s||"object"!=typeof s)throw new Error("Invalid data format received from API");N(s),w(!0)}else e.status,h(`Dropdown seçenekleri yüklenemedi (Status: ${e.status}). Lütfen sayfayı yenileyin.`)}catch(e){const s=e?.message||"Bilinmeyen hata",t=e?.status?` (Status: ${e.status})`:"";N(_),w(!0),h(`Dropdown seçenekleri API'den yüklenemedi, varsayılan değerler kullanılıyor. (${s}${t})`),setTimeout(()=>{h(null)},5e3)}finally{l(!1)}},ie=(e,s)=>{if(re(t=>({...t,[e]:s})),"currency"===e&&"USD"===s&&$(!0),"currency"===e||"date"===e){const t={...ae,[e]:s};ce(t.currency,t.date)}},ce=async(e,s)=>{const t=e||ae.currency,a=s||ae.date;"EUR"!==t&&"USD"!==t||!a?F(!1):(F(!0),await oe(a,t))},oe=async(e,s)=>{try{if(z("Checking existing rates..."),"EUR"===s){const s=await pt.fetchRate({date:e,currency_pair:"EUR/TRY"});if("success"===s.status&&s.rate?.rate){const e=s.rate.rate;z(`✓ EUR/TRY rate fetched: ${e}`),C({has_rates:!0,eur_rate:e}),re(s=>({...s,eur_rate:e.toString()}))}else z(`⚠ EUR/TRY rate not found for ${e}.`),C({has_rates:!1}),re(e=>({...e,eur_rate:"0.00"}))}if("USD"===s){const s=await pt.fetchRate({date:e,currency_pair:"USD/TRY"});if("success"===s.status&&s.rate?.rate){const e=s.rate.rate;z(`✓ USD/TRY rate fetched: ${e}`),re(s=>({...s,usd_rate:e.toString()}))}else z(`⚠ USD/TRY rate not found for ${e}.`),re(e=>({...e,usd_rate:"0.00"}))}}catch(t){z(`✗ Error: ${t}`)}},de=()=>{window.location.href="/clients"};return a||n?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsx(cs,{className:"max-w-sm w-full text-center",variant:"elevated",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(i,{className:"h-8 w-8 text-blue-600 animate-spin"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Loading Transaction Form"}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we prepare the form and load your options..."})]})]})})}):g?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsx(cs,{className:"max-w-md w-full text-center",variant:"elevated",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(p,{className:"h-10 w-10 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Transaction Added Successfully!"}),e.jsx("p",{className:"text-gray-600",children:"The transaction has been added to your pipeline and is now available in your transaction list."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(os,{variant:"primary",size:"lg",onClick:()=>window.location.href="/clients",icon:e.jsx(c,{className:"h-4 w-4"}),className:"flex-1",children:"View Clients"}),e.jsx(os,{variant:"outline",size:"lg",onClick:()=>{re({client_name:"",company:"",date:"",amount:"",payment_method:"",currency:"",category:"",psp:"",notes:"",eur_rate:"",usd_rate:""}),b(!1),h(null),w(!1),K(""),localStorage.removeItem(ne),W("saved")},icon:e.jsx(H,{className:"h-4 w-4"}),className:"flex-1",children:"Add Another"})]})]})})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(os,{variant:"ghost",size:"sm",onClick:de,icon:e.jsx(pe,{className:"h-4 w-4"}),className:"text-gray-600 hover:text-gray-900",children:"Back to Transactions"}),e.jsx("div",{className:"h-6 w-px bg-gray-300"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-lg flex items-center justify-center shadow-sm",children:e.jsx(c,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Add New Transaction"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Create a new transaction record"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:["saving"===Y&&e.jsxs(e.Fragment,{children:[e.jsx(i,{className:"h-4 w-4 text-blue-500 animate-spin"}),e.jsx("span",{className:"text-blue-600",children:"Saving..."})]}),"saved"===Y&&e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-green-600",children:"Auto-saved"})]}),"error"===Y&&e.jsxs(e.Fragment,{children:[e.jsx(t,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{className:"text-red-600",children:"Save failed"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-green-600",children:[e.jsx(S,{className:"h-4 w-4"}),e.jsx("span",{children:"Secure"})]})]})]})})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"space-y-6",children:[x&&e.jsx(cs,{variant:"outlined",className:"border-red-200 bg-red-50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(t,{className:"h-4 w-4 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-red-900",children:"Validation Error"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:x})]})]})}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),ae.client_name.trim())if(!ae.amount||parseFloat(ae.amount)<=0)h("Please enter a valid amount greater than 0.");else if(ae.date)if(ae.currency)if(ae.category)if(["WD","DEP"].includes(ae.category))if(["TL","USD","EUR"].includes(ae.currency))if("EUR"!==ae.currency||ae.eur_rate)if("USD"!==ae.currency||ae.usd_rate)try{if(m(!0),h(null),!(await Fe.get("/auth/check")).ok&&!(await Fe.refreshSession()))return h("Session validation failed. Please refresh the page and try again."),void m(!1);if(!(await Fe.get("/auth/csrf-token")).ok&&!(await Fe.refreshSession()))return h("CSRF token validation failed. Please refresh the page and try again."),void m(!1);const e={...ae};"USD"===ae.currency&&ae.usd_rate&&(e.exchange_rate=ae.usd_rate),"EUR"===ae.currency&&ae.eur_rate&&(e.exchange_rate=ae.eur_rate),Z&&X&&parseFloat(X)>0&&(e.manual_commission_rate=parseFloat(X),e.use_manual_commission=!0);let r=null,n=0;const l=2;for(;n<=l;)try{if(r=await Fe.post("/transactions/",e),r&&r.ok)break;if(r&&!r.ok&&r.data&&r.data,r&&(401===r.status||400===r.status)&&n<l){try{await Fe.refreshSession()||await jt.refreshSession()}catch(s){if(n===l-1)return h("Session expired. Please refresh the page and try again."),void m(!1)}n++;continue}break}catch(t){if(n<l){n++,await new Promise(e=>setTimeout(e,1e3));continue}throw t}if(!r)throw new Error("Failed to get response from server after all retry attempts");if(!r.ok){let e="Failed to add transaction";try{const s=r.data;s?.error?.message?e=s.error.message:s?.error?e="string"==typeof s.error?s.error:JSON.stringify(s.error):s?.message?e=s.message:"string"==typeof s&&(e=s)}catch(a){}throw new Error(`Server error (${r.status}): ${e}`)}const i=Fe.parseResponse(r);if(r.ok&&(i&&"object"==typeof i&&"success"in i&&i.success||i&&"object"==typeof i&&"id"in i||i&&"object"==typeof i&&"transaction"in i)){b(!0),localStorage.removeItem(ne),W("saved");const e=i?.transaction?.id||i?.id||i?.data?.id;setTimeout(()=>{window.dispatchEvent(new CustomEvent("transactionsUpdated",{detail:{action:"create",transactionId:e}}))},500),re({client_name:"",company:"",date:"",amount:"",payment_method:"",currency:"",category:"",psp:"",notes:"",eur_rate:"",usd_rate:""}),K("")}else h(i?.error?.message||i?.error||i?.message||"Failed to add transaction")}catch(t){if(t instanceof Error){const e=t.message;e.includes("CSRF")||e.includes("Security token")?h("Security token issue. Please refresh the page and try again."):e.includes("Authentication")||e.includes("login")?h("Session expired. Please log in again."):e.includes("401")||e.includes("unauthorized")?h("Authentication required. Please log in to continue."):e.includes("308")||e.includes("redirect")?h("URL redirect issue. Please try again."):e.includes("404")?h("API endpoint not found. Please check your connection."):e.includes("500")?h("Server error. Please try again in a few moments."):e.includes("403")?h("Access denied. Please check your permissions."):h(`Failed to add transaction: ${e}`)}else h("Failed to add transaction. Please try again.")}finally{m(!1)}else h("Please enter the USD exchange rate.");else h("Please enter the EUR exchange rate.");else h("Currency must be TL, USD, or EUR.");else h("Category must be WD (Withdraw) or DEP (Deposit).");else h("Please select a category (WD or DEP).");else h("Please select a currency.");else h("Please select a date.");else h("Client name is required.")},className:"space-y-6",children:[e.jsx(cs,{header:{title:"Basic Information",description:"Essential transaction details"},children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Client Name *"}),e.jsxs("div",{className:"relative",children:[e.jsx(D,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",value:ae.client_name,onChange:e=>ie("client_name",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white",placeholder:"Enter client name",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Transaction Date *"}),e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"date",value:ae.date,onChange:e=>ie("date",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Amount *"}),e.jsxs("div",{className:"relative",children:[e.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"0.01",value:ae.amount,onChange:e=>ie("amount",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white",placeholder:"0.00",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Currency *"}),e.jsxs("div",{className:"relative",children:[e.jsx(u,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none z-10"}),e.jsxs("select",{value:ae.currency,onChange:e=>ie("currency",e.target.value),className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white appearance-none cursor-pointer",required:!0,disabled:!v,children:[e.jsx("option",{value:"",children:v?"Select Currency":"Loading..."}),f.currency&&f.currency.length>0?f.currency.map(s=>e.jsx("option",{value:s.value,children:s.value},s.id)):v?[e.jsx("option",{value:"TL",children:"TL"},"TL"),e.jsx("option",{value:"USD",children:"USD"},"USD"),e.jsx("option",{value:"EUR",children:"EUR"},"EUR")]:null]}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})]})}),e.jsx(cs,{header:{title:"Payment Information",description:"Payment method and transaction category"},children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Method *"}),e.jsxs("div",{className:"relative",children:[e.jsx(U,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none z-10"}),e.jsxs("select",{value:ae.payment_method,onChange:e=>ie("payment_method",e.target.value),className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white appearance-none cursor-pointer",required:!0,disabled:!v,children:[e.jsx("option",{value:"",children:v?"Select Payment Method":"Loading..."}),f.payment_method&&f.payment_method.length>0?f.payment_method.map(s=>e.jsx("option",{value:s.value,children:s.value},s.id)):v?[e.jsx("option",{value:"Bank",children:"Bank"},"Bank"),e.jsx("option",{value:"Credit card",children:"Credit card"},"CreditCard"),e.jsx("option",{value:"Tether",children:"Tether"},"Tether")]:null]}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Transaction Category *"}),e.jsxs("div",{className:"relative",children:[e.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none z-10"}),e.jsxs("select",{value:ae.category,onChange:e=>ie("category",e.target.value),className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white appearance-none cursor-pointer",required:!0,children:[e.jsx("option",{value:"",children:"Select Category"}),e.jsx("option",{value:"WD",children:"WD (Withdraw)"}),e.jsx("option",{value:"DEP",children:"DEP (Deposit)"})]}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 bg-blue-50 p-2 rounded-lg",children:[e.jsx(E,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{children:"WD = Withdraw (no commission), DEP = Deposit (with commission)"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"PSP/KASA (Optional)"}),e.jsxs("div",{className:"relative",children:[e.jsx(j,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none z-10"}),e.jsxs("select",{value:ae.psp,onChange:e=>ie("psp",e.target.value),className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white appearance-none cursor-pointer",disabled:!v,children:[e.jsx("option",{value:"",children:v?"Select PSP/KASA":"Loading..."}),f.psp&&f.psp.length>0?f.psp.map(s=>e.jsx("option",{value:s.value,children:s.value},s.id)):null]}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})]})}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Manual Commission"}),Z&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-green-700 bg-green-100 rounded-full",children:[e.jsx(p,{className:"h-3 w-3"}),"Active"]})]}),Z?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",step:"0.01",value:X,onChange:e=>Q(e.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Commission %"}),e.jsx("button",{type:"button",onClick:()=>{ee(!1),q(!1),G(""),Q(""),te("")},className:"px-3 py-2 text-sm font-medium text-gray-600 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:"Disable"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Overrides automatic PSP commission rate"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"password",value:J,onChange:e=>G(e.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Security code"}),e.jsx("button",{type:"button",onClick:()=>{"4561"===J?(ee(!0),te(""),q(!0)):(te("Invalid security code. Please try again."),ee(!1))},className:"px-3 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:ring-1 focus:ring-blue-500",children:"Enable"})]}),se&&e.jsx("p",{className:"text-xs text-red-600",children:se})]})]}),e.jsx(cs,{header:{title:"Company Information",description:"Select the company for this transaction"},children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Company"}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none z-10"}),e.jsxs("select",{value:ae.company,onChange:e=>ie("company",e.target.value),className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white appearance-none cursor-pointer",disabled:!v,children:[e.jsx("option",{value:"",children:v?"Select Company":"Loading..."}),f.company&&f.company.length>0?f.company.map(s=>e.jsx("option",{value:s.value,children:s.value},s.id)):null]}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})}),e.jsx(cs,{header:{title:"Additional Information",description:"Optional notes and comments"},children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Transaction Notes"}),e.jsxs("div",{className:"relative",children:[e.jsx(ye,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx("textarea",{value:ae.notes,onChange:e=>ie("notes",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white resize-none",placeholder:"Enter any additional notes or comments about this transaction",rows:4})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 bg-gray-50 p-2 rounded-lg",children:[e.jsx(E,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:"Optional notes to help track transaction details"})]})]})}),T&&e.jsx(cs,{variant:"outlined",className:"border-amber-200 bg-amber-50",header:{title:"Exchange Rates Required",description:"Foreign currency transactions require exchange rates"},children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-amber-100 border border-amber-200 rounded-lg",children:[e.jsx(t,{className:"h-5 w-5 text-amber-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-800 font-medium",children:"Exchange rates are required for foreign currency transactions"}),e.jsx("p",{className:"text-amber-700 text-sm mt-1",children:"Please enter the exchange rates for the selected date to ensure accurate conversions"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:["EUR"===ae.currency&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"EUR to TL Rate"}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"0.0001",min:"0",value:ae.eur_rate,onChange:e=>ie("eur_rate",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white",placeholder:"0.0000",required:"EUR"===ae.currency})]}),e.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-2 rounded-lg",children:"Auto-fetched when possible. If no rate, it defaults to 0.00."})]}),"USD"===ae.currency&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"USD to TL Rate"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(o,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"0.0001",min:"0",value:ae.usd_rate,onChange:e=>ie("usd_rate",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 bg-white",placeholder:"0.0000"})]}),e.jsx(os,{type:"button",variant:"success",size:"sm",onClick:()=>$(!0),icon:e.jsx(y,{className:"h-4 w-4"}),children:"Get Rate"}),e.jsx(os,{type:"button",variant:"outline",size:"sm",onClick:()=>{const e=parseFloat(ae.amount||"0"),s=parseFloat(ae.usd_rate||"0");!isNaN(e)&&!isNaN(s)&&s>0?K((e*s).toFixed(2)):K("")},icon:e.jsx(i,{className:"h-4 w-4"}),children:"Apply"})]}),B&&e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-green-800",children:[e.jsx("strong",{children:"Converted TL Amount:"})," ",B]})}),e.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-2 rounded-lg",children:"Auto-fetched when possible. If no rate, it defaults to 0.00."})]})]}),O&&e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(E,{className:"h-5 w-5 text-blue-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-800 font-medium",children:"Rate Validation"}),e.jsx("p",{className:"text-blue-700 text-sm",children:O})]})]})})]})}),e.jsx(cs,{className:"bg-gray-50",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(os,{type:"button",variant:"outline",size:"lg",onClick:de,className:"flex-1",icon:e.jsx(P,{className:"h-4 w-4"}),children:"Cancel"}),e.jsx(os,{type:"submit",variant:"primary",size:"lg",disabled:d,loading:d,className:"flex-1",icon:e.jsx(I,{className:"h-4 w-4"}),children:d?"Adding Transaction...":"Add Transaction"})]})})]}),e.jsx(cs,{header:{title:"Dropdown Management",description:"Customize your dropdown options"},children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(os,{variant:"success",size:"lg",onClick:()=>window.location.href="/settings?tab=dropdowns",icon:e.jsx(A,{className:"h-4 w-4"}),className:"mx-auto",children:"Manage Dropdown Options"}),e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3 text-left",children:[e.jsx(E,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-blue-900 mb-1",children:"Need to customize dropdown options?"}),e.jsx("p",{className:"text-blue-800",children:"Add your own payment methods, companies, or PSPs by clicking the button above. This will take you to the settings page where you can manage all dropdown options."})]})]})})]})})]})}),e.jsx(Zs,{isOpen:R,onClose:()=>$(!1),onRateSelect:e=>{re(s=>({...s,usd_rate:e.toString()})),$(!1)},currentAmount:parseFloat(ae.amount)||0,transactionDate:ae.date})]})}},Symbol.toStringTag,{value:"Module"})),bt=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{t:t,currentLanguage:a}=Pe(),{isAuthenticated:c,isLoading:d}=Le(),{success:m,error:x,info:h}=Ae();f();const[u,g]=$s("overview"),[j,y]=r.useState("all"),[N,v]=r.useState("calculator"),[w,_]=r.useState(null),[S,C]=r.useState((new Date).getMonth()+1),[D,T]=r.useState((new Date).getFullYear()),[A,R]=r.useState("desc"),[$,L]=r.useState(null),[I,z]=r.useState([]),[G,Q]=r.useState(!0),[Z,ee]=r.useState(null),[te,ae]=r.useState(""),[re,ne]=r.useState(""),[oe,de]=r.useState("all");r.useState(!1);const[me,xe]=r.useState(1),he=50,[ue,ge]=r.useState(!1),[pe,je]=r.useState(null),[ye,_e]=r.useState(null),[ke,Se]=r.useState(!1),[Ce,De]=r.useState({description:"",detail:"",amount_try:"",amount_usd:"",status:"pending",cost_period:"",payment_date:"",payment_period:"",source:""}),[Ee,Re]=r.useState("TRY"),[$e,Ue]=r.useState(null),[Ie,Ve]=r.useState(!1);function qe({expenses:a,recordToLoad:n,onRecordLoaded:c}){const d=e=>`net_tab_values_${e}`,u=(e,s)=>{try{const t=d(e);localStorage.setItem(t,JSON.stringify(s)),Te.info("[Net Tab] Saved values to localStorage for date:",e)}catch(t){Te.error("[Net Tab] Failed to save values to localStorage:",t)}},g=e=>{try{const s=d(e),t=localStorage.getItem(s);if(t){const s=JSON.parse(t);return Te.info("[Net Tab] Loaded values from localStorage for date:",e),s}}catch(s){Te.error("[Net Tab] Failed to load values from localStorage:",s)}return null},[j,y]=r.useState(()=>{const e=localStorage.getItem("net_tab_date");if(e)return Te.info("[Net Tab] Loaded date from localStorage:",e),e;const s=(new Date).toISOString().slice(0,10);return Te.info("[Net Tab] Initial date set to:",s),s}),b=(()=>{const e=localStorage.getItem("net_tab_date")||(new Date).toISOString().slice(0,10);return g(e)})(),[f,N]=r.useState(()=>b?.expensesUsd||"0"),[v,w]=r.useState(()=>b?.rolloverUsd||"0"),[_,S]=r.useState(()=>b?.netCashUsd||"0"),[C,D]=r.useState(()=>b?.commissionUsd||"0"),[T,F]=r.useState(()=>b?.oncekiKapanisUsd||"0"),[E,A]=r.useState(()=>b?.companyCashUsd||"0"),[R,$]=r.useState(()=>b?.cryptoBalanceUsd||"0"),[L,I]=r.useState(()=>b?.anlikKasaUsd||"0"),[O,z]=r.useState(()=>b?.bekleyenTahsilatUsd||"0"),[K,W]=r.useState(()=>b?.anlikKasaManual||!1),H=e=>{Te.info("[Net Tab] Date being changed to:",e),u(j,{expensesUsd:f,rolloverUsd:v,netCashUsd:_,commissionUsd:C,oncekiKapanisUsd:T,companyCashUsd:E,cryptoBalanceUsd:R,anlikKasaUsd:L,bekleyenTahsilatUsd:O,anlikKasaManual:K}),localStorage.setItem("net_tab_date",e),y(e);const s=g(e);s?(N(s.expensesUsd||"0"),w(s.rolloverUsd||"0"),S(s.netCashUsd||"0"),D(s.commissionUsd||"0"),F(s.oncekiKapanisUsd||"0"),A(s.companyCashUsd||"0"),$(s.cryptoBalanceUsd||"0"),I(s.anlikKasaUsd||"0"),z(s.bekleyenTahsilatUsd||"0"),W(s.anlikKasaManual||!1)):(N("0"),w("0"),S("0"),D("0"),F("0"),A("0"),$("0"),I("0"),z("0"),W(!1))},[V,q]=r.useState(!1),[G,X]=r.useState(""),[Q,Z]=r.useState(!1),[ee,se]=r.useState(""),[te,ae]=r.useState(null),[re,ne]=r.useState(!1),[oe,de]=r.useState(null),[me,xe]=r.useState(!1),[he,ue]=r.useState(!1),[ge,pe]=r.useState(!1),[je,ye]=r.useState(!1),[be,Ne]=r.useState(!1),[we,_e]=r.useState(!1),[ke,Se]=r.useState(()=>j?new Date(j):new Date),Ce=s.useRef(!0),De=async()=>{try{ne(!0),de(null);const e=new URLSearchParams({date:j,expenses_usd:f||"0",rollover_usd:v||"0",net_cash_usd:_||"0",commissions_usd:C||"0",onceki_kapanis_usd:T||"0",company_cash_usd:E||"0",crypto_balance_usd:R||"0",anlik_kasa_usd:L||"0",anlik_kasa_manual:K?"true":"false",bekleyen_tahsilat_usd:O||"0"}).toString(),s=await Fe.get(`/accounting/net?${e}`),a=await Fe.parseResponse(s);a&&a.success?(ae(a.data),ue(a.is_saved||!1),!we&&a.is_saved&&a.data?"0"===_&&"0"===C&&"0"===f&&"0"===v&&"0"===T&&"0"===E&&"0"===R&&"0"===L&&"0"===O&&(Te.info("[fetchNet] Loading saved values from database"),N(String(a.data.expenses_usd||"0")),w(String(a.data.rollover_usd||"0")),S(String(a.data.net_cash_usd||"0")),D(String(a.data.commissions_usd||"0")),F(String(a.data.onceki_kapanis_usd||"0")),A(String(a.data.company_cash_usd||"0")),$(String(a.data.crypto_balance_usd||"0")),I(String(a.data.anlik_kasa_usd||"0")),W(a.data.anlik_kasa_manual||!1),z(String(a.data.bekleyen_tahsilat_usd||"0"))):we&&Te.info("[fetchNet] Skipping saved value load - just fetched data (protection active)")):de(t("accounting.net.calculation_failed"))}catch(e){de(e?.message||t("accounting.net.calculation_failed"))}finally{ne(!1)}},Ee=async(e={})=>{try{ne(!0),de(null);const s={date:j,expenses_usd:e.expenses_usd??(f||"0"),rollover_usd:e.rollover_usd??(v||"0"),net_cash_usd:e.net_cash_usd??(_||"0"),commissions_usd:e.commissions_usd??(C||"0"),onceki_kapanis_usd:e.onceki_kapanis_usd??(T||"0"),company_cash_usd:e.company_cash_usd??(E||"0"),crypto_balance_usd:e.crypto_balance_usd??(R||"0"),anlik_kasa_usd:e.anlik_kasa_usd??(L||"0"),bekleyen_tahsilat_usd:e.bekleyen_tahsilat_usd??(O||"0")},a=new URLSearchParams(s).toString(),r=await Fe.get(`/accounting/net?${a}`),n=await Fe.parseResponse(r);n&&n.success?(ae(n.data),ue(n.is_saved||!1)):de(t("accounting.net.calculation_failed"))}catch(s){de(s?.message||t("accounting.net.calculation_failed"))}finally{ne(!1)}},Ae=async(e=!1)=>{try{Ne(!0),Te.info(`[Crypto Balance] ${e?"Auto-fetching":"Fetching"} total balance from all active wallets`);const s=await Fe.get("/accounting/crypto-balance"),t=await Fe.parseResponse(s);if(t&&t.success){const s=(t.data.total_usd||0).toFixed(2);Te.info(`[Crypto Balance] Total fetched: $${s}`),$(s),ue(!1);const a=(parseFloat(E||"0")+parseFloat(s)).toFixed(2);I(a),e||m(`Crypto Balance Fetched: $${s} (${t.data.wallet_count} wallets)`),Ee({crypto_balance_usd:s,anlik_kasa_usd:a})}else e||x("Failed to fetch crypto balance")}catch(s){Te.error("[Crypto Balance] Failed to fetch:",s),e||x(s?.message||"Failed to fetch crypto balance")}finally{Ne(!1)}};s.useEffect(()=>{if(K)return;const e=parseFloat(E||"0"),s=parseFloat(R||"0"),t=(e+s).toFixed(2);L!==t&&(Te.info(`[Auto Calculate] Updating Anlik Kasa: ${e} + ${s} = ${t}`),I(t))},[E,R,K]);const Re=()=>{"4561"===G?(W(!0),q(!1),X(""),ue(!1)):(alert(t("accounting.net.invalid_confirmation_code")||"Invalid confirmation code. Please enter the correct 4-digit code."),X(""))},$e=()=>{Z(!0)},Pe=()=>{"4561"===ee?(N("0"),w("0"),S("0"),D("0"),F("0"),A("0"),$("0"),I("0"),z("0"),W(!1),ue(!1),ae(null),Z(!1),se(""),u(j,{expensesUsd:"0",rolloverUsd:"0",netCashUsd:"0",commissionUsd:"0",oncekiKapanisUsd:"0",companyCashUsd:"0",cryptoBalanceUsd:"0",anlikKasaUsd:"0",bekleyenTahsilatUsd:"0",anlikKasaManual:!1}),m(t("accounting.net.all_values_deleted")),setTimeout(()=>De(),100)):(alert(t("accounting.net.invalid_confirmation_code")||"Invalid confirmation code. Please enter the correct 4-digit code."),se(""))};r.useEffect(()=>{Ce.current?(Ce.current=!1,Te.info("[Net Tab] Initial mount - fetching net data for date:",j),ue(!1),De(),Ae(!0)):(Te.info("[Net Tab] Date changed to:",j),ue(!1),De(),Ae(!0))},[j]),r.useEffect(()=>{if(j){const e=new Date(j);Se(new Date(e.getFullYear(),e.getMonth(),1))}},[j]),r.useEffect(()=>{if(n){Te.info("[Load Record] Loading record into calculator:",n);const e={expensesUsd:String(n.expenses_usd||"0"),rolloverUsd:String(n.rollover_usd||"0"),netCashUsd:String(n.net_cash_usd||"0"),commissionUsd:String(n.commissions_usd||"0"),oncekiKapanisUsd:String(n.onceki_kapanis_usd||"0"),companyCashUsd:String(n.company_cash_usd||"0"),cryptoBalanceUsd:String(n.crypto_balance_usd||"0"),anlikKasaUsd:String(n.anlik_kasa_usd||"0"),bekleyenTahsilatUsd:String(n.bekleyen_tahsilat_usd||"0"),anlikKasaManual:n.anlik_kasa_manual||!1};u(n.date,e),H(n.date),ue(!1),c(),m(`Loaded record for ${n.date}`)}},[n]),r.useEffect(()=>{if(Ce.current)return;const e=setTimeout(()=>{u(j,{expensesUsd:f,rolloverUsd:v,netCashUsd:_,commissionUsd:C,oncekiKapanisUsd:T,companyCashUsd:E,cryptoBalanceUsd:R,anlikKasaUsd:L,bekleyenTahsilatUsd:O,anlikKasaManual:K})},500);return()=>clearTimeout(e)},[j,f,v,_,C,T,E,R,L,O,K]),r.useEffect(()=>{if(!te||he)return;const e=setInterval(async()=>{if(te&&!he)try{Te.info("[Auto-save] Saving draft to database..."),await saveNetCalculation(),h("Draft auto-saved successfully")}catch(e){Te.error("[Auto-save] Failed to save draft:",e)}},9e5);return()=>clearInterval(e)},[te,he]);const Le=e=>{Se(s=>{const t=new Date(s);return"prev"===e?t.setMonth(s.getMonth()-1):t.setMonth(s.getMonth()+1),t})},Ue=j?new Date(j):new Date,Me=(Ie=ke,new Date(Ie.getFullYear(),Ie.getMonth()+1,0).getDate());var Ie;const Oe=(e=>new Date(e.getFullYear(),e.getMonth(),1).getDay())(ke),ze=ke.toLocaleDateString("en-US",{month:"long",year:"numeric"}),Be=[];for(let e=0;e<Oe;e++)Be.push(null);for(let e=1;e<=Me;e++)Be.push(e);return r.useEffect(()=>{const e=e=>{const s=e.target;ge&&!s.closest(".calendar-container")&&pe(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[ge]),e.jsxs("div",{className:"space-y-5",children:[e.jsx(cs,{variant:"flat",children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center justify-between gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{className:"p-2.5 bg-gray-100 rounded-lg",children:e.jsx(M,{className:"h-5 w-5 text-gray-700"})}),e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsxs("div",{className:"min-w-[140px]",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-0.5",children:t("accounting.net.calculation_date")}),e.jsx("p",{className:"text-xs text-gray-500",children:t("accounting.net.calculation_date_desc")})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative calendar-container",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ts,{type:"date",value:j,onChange:e=>H(e.target.value),className:"w-[200px] pl-3 pr-10 py-2.5 text-sm border border-gray-200 rounded-lg bg-white text-gray-900 placeholder:text-gray-400 focus:outline-none transition-all [&::-webkit-calendar-picker-indicator]:hidden [&::-webkit-calendar-picker-indicator]:appearance-none [&::-webkit-inner-spin-button]:hidden [&::-webkit-outer-spin-button]:hidden",style:{colorScheme:"light"}}),e.jsx("button",{type:"button",onClick:()=>pe(!ge),className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 hover:bg-gray-100 rounded transition-colors",children:e.jsx(M,{className:"h-4 w-4 text-gray-400"})})]}),ge&&e.jsxs("div",{className:"absolute z-50 mt-2 bg-white border border-gray-200 rounded-xl shadow-xl p-4 w-72",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{type:"button",onClick:()=>Le("prev"),className:"p-1.5 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(ce,{className:"h-4 w-4 text-gray-600"})}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:ze}),e.jsx("button",{type:"button",onClick:()=>Le("next"),className:"p-1.5 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(ie,{className:"h-4 w-4 text-gray-600"})})]}),e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(s=>e.jsx("div",{className:"text-xs font-medium text-gray-500 text-center py-1",children:s},s))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:Be.map((s,t)=>{if(null===s)return e.jsx("div",{className:"h-8"},t);const a=Ue.getFullYear()===ke.getFullYear()&&Ue.getMonth()===ke.getMonth()&&Ue.getDate()===s,r=(new Date).getFullYear()===ke.getFullYear()&&(new Date).getMonth()===ke.getMonth()&&(new Date).getDate()===s;return e.jsx("button",{type:"button",onClick:()=>(e=>{const s=new Date(ke.getFullYear(),ke.getMonth(),e);H((e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`)(s)),pe(!1)})(s),className:"h-8 text-sm rounded-lg transition-colors "+(a?"bg-gray-900 text-white font-semibold":r?"bg-gray-100 text-gray-900 font-medium border border-gray-300":"text-gray-700 hover:bg-gray-50"),children:s},t)})})]})]}),e.jsx(os,{variant:"outline",size:"sm",onClick:()=>{const e=(new Date).toISOString().slice(0,10);H(e),Te.info("[Today Button] Date set to today:",e)},disabled:je,className:"whitespace-nowrap border-gray-300 text-gray-700 hover:bg-gray-50",icon:e.jsx(M,{className:"h-4 w-4"}),iconPosition:"left",children:t("accounting.net.today")}),e.jsx(os,{variant:"outline",size:"sm",onClick:$e,className:"whitespace-nowrap text-red-600 hover:text-red-700 hover:border-red-300 border-red-300",icon:e.jsx(Y,{className:"h-4 w-4"}),iconPosition:"left",children:"Delete"}),e.jsx(os,{variant:"primary",size:"sm",onClick:async()=>{if(!j)return void x(t("accounting.net.error_no_date"));ye(!0),Te.info(`[Fetch All] Starting auto-fetch for date: ${j}`);const e={expenses:{success:!1,value:"0",message:""},netCash:{success:!1,value:"0",message:""},commission:{success:!1,value:"0",message:""}};try{const s=a.filter(e=>e.payment_date===j&&"paid"===e.status);if(0===s.length)e.expenses={success:!0,value:"0",message:t("accounting.net.info_no_expenses_found")},N("0");else{const t=s.reduce((e,s)=>e+(s.amount_usd||0),0).toFixed(2);e.expenses={success:!0,value:t,message:`${s.length} expense(s): $${t}`},N(t),Te.info(`[Fetch All] Expenses state updated to: $${t}`)}}catch(r){e.expenses={success:!1,value:"0",message:"Failed to fetch expenses"},N("0"),Te.error("[Fetch All] Expenses fetch failed:",r)}try{const s=localStorage.getItem("pipeline_transactions_data");if(s){const a=JSON.parse(s).filter(e=>e.date===j);if(0===a.length)e.netCash={success:!0,value:"0",message:t("accounting.net.info_no_transactions_for_date")},S("0");else{let s=41.7;try{const e=await Fe.get(`/api/v1/exchange-rates/historical?date=${j}&pair=USDTRY`),t=await Fe.parseResponse(e);t&&t.rate&&!isNaN(parseFloat(t.rate))&&(s=parseFloat(t.rate))}catch(r){}let t=0;a.forEach(e=>{const a=e.amount||0,r=e.currency||"TL";let n=0;"USD"===r?n=a:"TL"===r||"TRY"===r?n=a/s:"EUR"===r&&(n=1.1*a),t+=n});const n=t.toFixed(2);e.netCash={success:!0,value:n,message:`${a.length} transaction(s): $${n}`},S(n),Te.info(`[Fetch All] Net Cash state updated to: $${n}`)}}else e.netCash={success:!0,value:"0",message:t("accounting.net.info_no_transactions_found")},S("0")}catch(r){e.netCash={success:!1,value:"0",message:"Failed to fetch net cash"},S("0"),Te.error("[Fetch All] Net cash fetch failed:",r)}try{const s=localStorage.getItem("pipeline_transactions_data");if(s){const a=JSON.parse(s).filter(e=>e.date===j);if(0===a.length)e.commission={success:!0,value:"0",message:t("accounting.net.info_no_transactions_for_date")},D("0");else{let s=41.7;try{const e=await Fe.get(`/api/v1/exchange-rates/historical?date=${j}&pair=USDTRY`),t=await Fe.parseResponse(e);t&&t.rate&&!isNaN(parseFloat(t.rate))&&(s=parseFloat(t.rate))}catch(r){}let t=0,n=0;a.forEach(e=>{const a=e.commission||0,r=e.currency||"TL";if(0===a)return;n++;let l=0;"USD"===r?l=Math.abs(a):"TL"===r||"TRY"===r?l=Math.abs(a)/s:"EUR"===r&&(l=1.1*Math.abs(a)),t+=l});const l=t.toFixed(2);e.commission={success:!0,value:l,message:`${n} txn(s) with commission: $${l}`},D(l),Te.info(`[Fetch All] Commission state updated to: $${l}`)}}else e.commission={success:!0,value:"0",message:t("accounting.net.info_no_transactions_found")},D("0")}catch(r){e.commission={success:!1,value:"0",message:"Failed to fetch commission"},D("0"),Te.error("[Fetch All] Commission fetch failed:",r)}ye(!1),ue(!1),_e(!0),Te.info("[Fetch All] Protection flag SET - values will be protected from overwrite");const s=[e.expenses.success,e.netCash.success,e.commission.success].filter(Boolean).length;if(Te.info("[Fetch All] Completed:",e),Te.info("[Fetch All] Final state values that were SET:",{expensesUsd:e.expenses.value,netCashUsd:e.netCash.value,commissionUsd:e.commission.value}),Ee({expenses_usd:e.expenses.value,net_cash_usd:e.netCash.value,commissions_usd:e.commission.value}),setTimeout(()=>{_e(!1),Te.info("[Fetch All] Protection flag cleared")},500),3===s){const s=[`✓ Expenses: ${e.expenses.message}`,`✓ Net Cash: ${e.netCash.message}`,`✓ Commission: ${e.commission.message}`];m(`${t("accounting.net.fetch_all_success")}\n${s.join("\n")}\n\n${t("accounting.net.click_calculate_to_proceed")}`)}else if(s>0){const s=[],a=[];e.expenses.success?s.push(`✓ Expenses: ${e.expenses.message}`):a.push(`✗ Expenses: ${e.expenses.message}`),e.netCash.success?s.push(`✓ Net Cash: ${e.netCash.message}`):a.push(`✗ Net Cash: ${e.netCash.message}`),e.commission.success?s.push(`✓ Commission: ${e.commission.message}`):a.push(`✗ Commission: ${e.commission.message}`),h(`${t("accounting.net.fetch_all_partial")}\n${s.join("\n")}\n${a.join("\n")}\n\n${t("accounting.net.click_calculate_to_proceed")}`)}else x(`${t("accounting.net.fetch_all_failed")}\n✗ Expenses: ${e.expenses.message}\n✗ Net Cash: ${e.netCash.message}\n✗ Commission: ${e.commission.message}`)},disabled:je||!j,className:"whitespace-nowrap",icon:e.jsx(B,{className:"h-4 w-4 "+(je?"animate-pulse":"")}),iconPosition:"left",children:t(je?"accounting.net.fetching_all":"accounting.net.fetch_all")})]})]})]}),he&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx(p,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:t("accounting.net.saved")})]})]})})}),oe&&e.jsx(cs,{variant:"flat",children:e.jsx("div",{className:"p-4 bg-red-50 border-l-4 border-red-500",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(l,{className:"h-5 w-5 text-red-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-red-900",children:t("accounting.net.calculation_error")}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:oe})]})]})})}),e.jsx(cs,{variant:"elevated",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:e.jsx(fe,{className:"h-5 w-5 text-gray-700"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900",children:t("accounting.net.transaction_data")}),e.jsx("p",{className:"text-xs text-gray-500",children:t("accounting.net.transaction_data_desc")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 uppercase tracking-wider",children:t("accounting.net.expenses")}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"$"}),e.jsx(ts,{type:"number",value:f,onChange:e=>{N(e.target.value),ue(!1),_e(!1)},onBlur:()=>{we||De()},className:"pl-8 pr-12 h-11 border-gray-200 focus:outline-none",placeholder:"0.00"}),e.jsx("button",{type:"button",onClick:()=>{try{if(ye(!0),Te.info(`[Expenses Fetch] Starting for date: ${j}`),!j)return x(t("accounting.net.error_no_date")),void Te.error("[Expenses Fetch] No date selected");const e=a.filter(e=>e.payment_date===j&&"paid"===e.status);if(Te.info(`[Expenses Fetch] Found ${e.length} paid expenses for ${j}`),0===e.length)return h(t("accounting.net.info_no_expenses_found")),Te.info("[Expenses Fetch] No paid expenses found for this date"),N("0"),ue(!1),_e(!0),void setTimeout(()=>De(),100);const s=e.reduce((e,s)=>{const t=s.amount_usd||0;return isNaN(t)||t<0?(Te.warn(`[Expenses Fetch] Invalid amount for expense ID ${s.id}: ${t}`),e):e+t},0);if(isNaN(s))return x(t("accounting.net.error_invalid_calculation")),void Te.error("[Expenses Fetch] Calculated total is NaN");const r=s.toFixed(2);Te.info(`[Expenses Fetch] Total calculated: $${r}`),N(String(r)),ue(!1),_e(!0),s>0?m(`${t("accounting.net.success_expenses_fetched")}: $${r}`):h(`${t("accounting.net.info_expenses_zero")}: $${r}`),Ee({expenses_usd:r}),setTimeout(()=>{_e(!1),Te.info("[Expenses Fetch] Protection flag cleared")},500)}catch(e){const s=e?.message||"Unknown error";Te.error("[Expenses Fetch] Failed to calculate daily expenses:",{error:s,date:j,expensesCount:a.length}),x(t("accounting.net.error_fetch_expenses"))}finally{ye(!1)}},disabled:je,className:"absolute right-3 top-1/2 -translate-y-1/2 p-1.5 hover:bg-gray-100 rounded transition-colors disabled:opacity-50",title:t("accounting.net.auto_fill_expenses"),children:e.jsx(B,{className:"h-4 w-4 text-gray-600 "+(je?"animate-pulse":"")})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1.5",children:t("accounting.net.expenses_desc")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 uppercase tracking-wider",children:t("accounting.net.rollover_collection")}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"$"}),e.jsx(ts,{type:"number",value:v,onChange:e=>{w(e.target.value),ue(!1)},onBlur:De,className:"pl-8 h-11 border-gray-200 focus:outline-none",placeholder:"0.00"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1.5",children:t("accounting.net.rollover_collection_desc")})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 uppercase tracking-wider",children:t("accounting.net.net_cash_override")}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"$"}),e.jsx(ts,{type:"number",value:_,onChange:e=>{S(e.target.value),ue(!1),_e(!1)},onBlur:()=>{we||De()},className:"pl-8 pr-12 h-11 border-gray-200 focus:outline-none",placeholder:"0.00"}),e.jsx("button",{type:"button",onClick:async()=>{try{if(ye(!0),Te.info(`[Net Cash Fetch] Starting for date: ${j}`),!j)return x(t("accounting.net.error_no_date")),void Te.error("[Net Cash Fetch] No date selected");const a=localStorage.getItem("pipeline_transactions_data");if(!a)return h(t("accounting.net.info_no_transactions_found")),Te.info("[Net Cash Fetch] No transactions found in localStorage"),S("0"),ue(!1),_e(!0),void setTimeout(()=>De(),100);let r;try{if(r=JSON.parse(a),!Array.isArray(r))throw new Error("Invalid transactions data format")}catch(e){return x(t("accounting.net.error_invalid_data")),void Te.error("[Net Cash Fetch] Failed to parse transactions:",e)}const n=r.filter(e=>e.date===j);if(Te.info(`[Net Cash Fetch] Found ${n.length} transactions for ${j}`),0===n.length)return h(t("accounting.net.info_no_transactions_for_date")),Te.info("[Net Cash Fetch] No transactions found for this date"),S("0"),ue(!1),_e(!0),void setTimeout(()=>De(),100);let l=41.7,i="default";try{const e=await Fe.get(`/api/v1/exchange-rates/historical?date=${j}&pair=USDTRY`),s=await Fe.parseResponse(e);s&&s.rate&&(l=parseFloat(s.rate),isNaN(l)||l<=0?(Te.warn("[Net Cash Fetch] Invalid exchange rate from API, using default"),l=41.7):i="api")}catch(s){Te.warn("[Net Cash Fetch] Failed to fetch exchange rate, using default:",l),h(t("accounting.net.info_using_default_rate"))}Te.info(`[Net Cash Fetch] Using exchange rate: ${l} (source: ${i})`);let c=0,o=0;if(n.forEach(e=>{const s=e.amount||0,t=e.currency||"TL";if(isNaN(s))return o++,void Te.warn("[Net Cash Fetch] Invalid amount in transaction:",e);let a=0;if("USD"===t)a=s;else if("TL"===t||"TRY"===t)a=s/l;else{if("EUR"!==t)return Te.warn(`[Net Cash Fetch] Unknown currency: ${t}, skipping transaction`),void o++;a=1.1*s}c+=a}),o>0&&Te.warn(`[Net Cash Fetch] Skipped ${o} invalid transactions`),isNaN(c))return x(t("accounting.net.error_invalid_calculation")),void Te.error("[Net Cash Fetch] Calculated total is NaN");const d=c.toFixed(2);Te.info(`[Net Cash Fetch] Calculated Total USD (gross): $${d}`),S(String(d)),ue(!1),_e(!0),0!==c?m(`${t("accounting.net.success_net_cash_fetched")}: $${d} (${n.length} transactions)`):h(`${t("accounting.net.info_net_cash_zero")}: ${n.length} transactions found but total is $0.00`),Ee({net_cash_usd:d}),setTimeout(()=>{_e(!1),Te.info("[Net Cash Fetch] Protection flag cleared")},500)}catch(s){const e=s?.message||"Unknown error";Te.error("[Net Cash Fetch] Failed to calculate daily net cash:",{error:e,date:j}),x(t("accounting.net.error_fetch_net_cash"))}finally{ye(!1)}},disabled:je,className:"absolute right-3 top-1/2 -translate-y-1/2 p-1.5 hover:bg-gray-100 rounded transition-colors disabled:opacity-50",title:t("accounting.net.auto_fill_net_cash"),children:e.jsx(B,{className:"h-4 w-4 text-gray-600 "+(je?"animate-pulse":"")})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1.5",children:t("accounting.net.net_cash_override_desc")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 uppercase tracking-wider",children:t("accounting.net.commission_override")}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"$"}),e.jsx(ts,{type:"number",value:C,onChange:e=>{D(e.target.value),ue(!1),_e(!1)},onBlur:()=>{we||De()},className:"pl-8 pr-12 h-11 border-gray-200 focus:outline-none",placeholder:"0.00"}),e.jsx("button",{type:"button",onClick:async()=>{try{if(ye(!0),Te.info(`[Commission Fetch] Starting for date: ${j}`),!j)return x(t("accounting.net.error_no_date")),void Te.error("[Commission Fetch] No date selected");const a=localStorage.getItem("pipeline_transactions_data");if(!a)return h(t("accounting.net.info_no_transactions_found")),Te.info("[Commission Fetch] No transactions found in localStorage"),D("0"),ue(!1),_e(!0),void setTimeout(()=>De(),100);let r;try{if(r=JSON.parse(a),!Array.isArray(r))throw new Error("Invalid transactions data format")}catch(e){return x(t("accounting.net.error_invalid_data")),void Te.error("[Commission Fetch] Failed to parse transactions:",e)}const n=r.filter(e=>e.date===j);if(Te.info(`[Commission Fetch] Found ${n.length} transactions for ${j}`),0===n.length)return h(t("accounting.net.info_no_transactions_for_date")),Te.info("[Commission Fetch] No transactions found for this date"),D("0"),ue(!1),_e(!0),void setTimeout(()=>De(),100);let l=41.7,i="default";try{const e=await Fe.get(`/api/v1/exchange-rates/historical?date=${j}&pair=USDTRY`),s=await Fe.parseResponse(e);s&&s.rate&&(l=parseFloat(s.rate),isNaN(l)||l<=0?(Te.warn("[Commission Fetch] Invalid exchange rate from API, using default"),l=41.7):i="api")}catch(s){Te.warn("[Commission Fetch] Failed to fetch exchange rate, using default:",l),h(t("accounting.net.info_using_default_rate"))}Te.info(`[Commission Fetch] Using exchange rate: ${l} (source: ${i})`);let c=0,o=0,d=0;if(n.forEach(e=>{const s=e.commission||0,t=e.currency||"TL";if(isNaN(s))return o++,void Te.warn("[Commission Fetch] Invalid commission in transaction:",e);if(0===s)return;d++;let a=0;if("USD"===t)a=Math.abs(s);else if("TL"===t||"TRY"===t)a=Math.abs(s)/l;else{if("EUR"!==t)return Te.warn(`[Commission Fetch] Unknown currency: ${t}, skipping transaction`),void o++;a=1.1*Math.abs(s)}c+=a}),o>0&&Te.warn(`[Commission Fetch] Skipped ${o} invalid transactions`),Te.info(`[Commission Fetch] ${d} transactions had commissions out of ${n.length}`),isNaN(c))return x(t("accounting.net.error_invalid_calculation")),void Te.error("[Commission Fetch] Calculated total is NaN");const u=c.toFixed(2);Te.info(`[Commission Fetch] Calculated Total Commission USD: $${u}`),D(String(u)),ue(!1),_e(!0),c>0?m(`${t("accounting.net.success_commission_fetched")}: $${u} (${d} txns with commission)`):h(`${t("accounting.net.info_commission_zero")}: No commissions found in ${n.length} transactions`),Ee({commissions_usd:u}),setTimeout(()=>{_e(!1),Te.info("[Commission Fetch] Protection flag cleared")},500)}catch(s){const e=s?.message||"Unknown error";Te.error("[Commission Fetch] Failed to calculate daily commission:",{error:e,date:j}),x(t("accounting.net.error_fetch_commission"))}finally{ye(!1)}},disabled:je,className:"absolute right-3 top-1/2 -translate-y-1/2 p-1.5 hover:bg-gray-100 rounded transition-colors disabled:opacity-50",title:t("accounting.net.auto_fill_commission"),children:e.jsx(B,{className:"h-4 w-4 text-gray-600 "+(je?"animate-pulse":"")})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1.5",children:t("accounting.net.commission_override_desc")})]})]})]})]})}),e.jsx(cs,{variant:"elevated",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:e.jsx(le,{className:"h-5 w-5 text-gray-700"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900",children:t("accounting.net.cash_balance_data")}),e.jsx("p",{className:"text-xs text-gray-500",children:t("accounting.net.cash_balance_data_desc")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 uppercase tracking-wider",children:t("accounting.net.previous_closing")}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"$"}),e.jsx(ts,{type:"number",value:T,onChange:e=>{F(e.target.value),ue(!1)},onBlur:De,className:"pl-8 pr-12 h-11 border-gray-200 focus:outline-none",placeholder:"0.00"}),e.jsx("button",{type:"button",onClick:async()=>{try{Te.info("[Previous Closing] Loading from previous day");const e=new Date(j);e.setDate(e.getDate()-1);const s=e.toISOString().slice(0,10);Te.info(`[Previous Closing] Previous date: ${s}`);const t=await Fe.get(`/accounting/net?date=${s}`),a=await Fe.parseResponse(t);if(a&&a.success&&a.data){const e=(a.data.anlik_kasa_usd||0).toFixed(2);Te.info(`[Previous Closing] Loaded: $${e}`),F(e),ue(!1),m(`Previous Closing Loaded: $${e}`),Ee({onceki_kapanis_usd:e})}else h("No data found for previous day"),F("0")}catch(e){Te.error("[Previous Closing] Failed to load:",e),x(e?.message||"Failed to load previous closing")}},className:"absolute right-3 top-1/2 -translate-y-1/2 p-1.5 hover:bg-gray-100 rounded transition-colors",title:"Load from previous day",children:e.jsx(ce,{className:"h-4 w-4 text-gray-600"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1.5",children:t("accounting.net.previous_closing_desc")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 uppercase tracking-wider",children:"Company Cash (USD)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"$"}),e.jsx(ts,{type:"number",value:E,onChange:e=>{A(e.target.value),ue(!1)},onBlur:De,className:"pl-8 h-11 border-gray-200 focus:outline-none",placeholder:"0.00"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1.5",children:"Physical cash and bank balance"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 uppercase tracking-wider",children:"Crypto Wallets Balance (USD)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"$"}),e.jsx(ts,{type:"number",value:R,readOnly:!0,className:"pl-8 pr-12 h-11 border-gray-200 bg-gray-50 focus:outline-none cursor-not-allowed",placeholder:"0.00"}),e.jsx("button",{type:"button",onClick:()=>Ae(!1),disabled:be,className:"absolute right-3 top-1/2 -translate-y-1/2 p-1.5 hover:bg-gray-100 rounded transition-colors disabled:opacity-50",title:"Refresh crypto balance",children:e.jsx(i,{className:"h-4 w-4 text-gray-600 "+(be?"animate-spin":"")})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1.5",children:"Auto-fetched from Trust wallets • Click refresh to update"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:t("accounting.net.current_cash")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-normal normal-case "+(K?"text-orange-600":"text-gray-500"),children:K?"Manual":"Auto"}),e.jsx("button",{type:"button",onClick:()=>{if(K){W(!1),X("");const e=(parseFloat(E)||0)+(parseFloat(R)||0);I(String(e)),ue(!1)}else q(!0)},className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 "+(K?"bg-orange-600 focus:ring-orange-500":"bg-gray-200 focus:ring-gray-400"),title:K?"Switch to Auto-calculated":"Switch to Manual",children:e.jsx("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform "+(K?"translate-x-6":"translate-x-1")})})]})]})}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"$"}),e.jsx(ts,{type:"number",value:L,readOnly:!K,onChange:e=>{K&&(I(e.target.value),ue(!1))},onBlur:()=>{K&&De()},className:"pl-8 h-11 border-gray-200 focus:outline-none font-medium "+(K?"bg-white border-orange-300 focus:border-orange-500 cursor-text":"bg-gray-50 cursor-not-allowed"),placeholder:"0.00"})]}),e.jsx("p",{className:"text-xs mt-1.5 "+(K?"text-orange-600":"text-gray-500"),children:K?"Manual override active - Enter value directly":`Company Cash + Crypto Balance = $${L||"0.00"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 uppercase tracking-wider",children:t("accounting.net.pending_collection")}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"$"}),e.jsx(ts,{type:"number",value:O,onChange:e=>{z(e.target.value),ue(!1)},onBlur:De,className:"pl-8 h-11 border-gray-200 focus:outline-none",placeholder:"0.00"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1.5",children:t("accounting.net.pending_collection_desc")})]})]})]})]})}),e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[e.jsxs(os,{variant:"outline",onClick:$e,className:"min-w-[140px] text-red-600 hover:text-red-700 hover:border-red-300 border-red-300",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Delete"]}),e.jsxs(os,{variant:"outline",onClick:()=>{_e(!1),De()},disabled:re,className:"min-w-[140px]",children:[e.jsx(i,{className:"h-4 w-4 mr-2 "+(re?"animate-spin":"")}),t(re?"accounting.net.calculating":"accounting.net.calculate")]}),te&&e.jsxs(os,{variant:"primary",onClick:async()=>{if(te)try{xe(!0),de(null);const e=await Fe.post("/api/v1/accounting/net",{date:te.date,net_cash_usd:te.net_cash_usd,expenses_usd:te.expenses_usd,commissions_usd:te.commissions_usd,rollover_usd:te.rollover_usd,net_saglama_usd:te.net_saglama_usd,onceki_kapanis_usd:te.onceki_kapanis_usd,company_cash_usd:te.company_cash_usd,crypto_balance_usd:te.crypto_balance_usd,anlik_kasa_usd:L||te.anlik_kasa_usd,anlik_kasa_manual:K,confirmation_code:K?"4561":"",bekleyen_tahsilat_usd:te.bekleyen_tahsilat_usd,fark_usd:te.fark_usd,fark_bottom_usd:te.fark_bottom_usd}),s=await Fe.parseResponse(e);s&&s.success?(ue(!0),m(t("accounting.net.saved_successfully"))):de(t("accounting.net.calculation_failed"))}catch(e){de(e?.message||t("accounting.net.calculation_failed"))}finally{xe(!1)}else de(t("accounting.net.please_calculate_first"))},disabled:me||re,className:"min-w-[140px]",children:[e.jsx(p,{className:"h-4 w-4 mr-2"}),t(me?"accounting.net.saving":he?"accounting.net.update":"accounting.net.save")]})]}),V&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t("accounting.net.enable_manual_mode")||"Enable Manual Override"}),e.jsx("button",{onClick:()=>{q(!1),X("")},className:"text-gray-400 hover:text-gray-600",children:e.jsx(P,{className:"h-5 w-5"})})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:t("accounting.net.enter_confirmation_code")||"Please enter the 4-digit confirmation code to enable manual override for Current Cash."}),e.jsx("div",{className:"mb-4",children:e.jsx(ts,{type:"text",value:G,onChange:e=>{const s=e.target.value.replace(/\D/g,"").slice(0,4);X(s)},placeholder:"----",className:"text-center text-lg font-mono tracking-widest",maxLength:4,autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&Re()}})}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(os,{variant:"outline",onClick:()=>{q(!1),X("")},children:t("common.cancel")||"Cancel"}),e.jsx(os,{variant:"primary",onClick:Re,disabled:4!==G.length,children:t("common.confirm")||"Confirm"})]})]})}),Q&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete All Values"}),e.jsx("button",{onClick:()=>{Z(!1),se("")},className:"text-gray-400 hover:text-gray-600",children:e.jsx(P,{className:"h-5 w-5"})})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Please enter the security code to delete all values on this page."}),e.jsx("div",{className:"mb-4",children:e.jsx(ts,{type:"text",value:ee,onChange:e=>{const s=e.target.value.replace(/\D/g,"").slice(0,4);se(s)},placeholder:"----",className:"text-center text-lg font-mono tracking-widest",maxLength:4,autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&Pe()}})}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(os,{variant:"outline",onClick:()=>{Z(!1),se("")},children:t("common.cancel")||"Cancel"}),e.jsx(os,{variant:"primary",onClick:Pe,disabled:4!==ee.length,className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})}),te&&e.jsxs("div",{className:"space-y-5",children:[e.jsx(xs,{title:t("accounting.net.calculation_components"),description:t("accounting.net.calculation_components_desc"),children:e.jsxs(hs,{cols:4,gap:"md",children:[e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider mb-2",children:t("accounting.net.net_cash")}),e.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["$",Number(te.net_cash_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsx("div",{className:"p-1.5 bg-gray-100 rounded",children:e.jsx(U,{className:"h-4 w-4 text-gray-700"})})]})}),e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider mb-2",children:t("accounting.net.expenses")}),e.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["$",Number(te.expenses_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsx("div",{className:"p-1.5 bg-gray-100 rounded",children:e.jsx(ve,{className:"h-4 w-4 text-gray-700"})})]})}),e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider mb-2",children:t("accounting.net.commission")}),e.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["$",Number(te.commissions_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsx("div",{className:"p-1.5 bg-gray-100 rounded",children:e.jsx(J,{className:"h-4 w-4 text-gray-700"})})]})}),e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider mb-2",children:t("accounting.net.rollover")}),e.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["$",Number(te.rollover_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsx("div",{className:"p-1.5 bg-gray-100 rounded",children:e.jsx(i,{className:"h-4 w-4 text-gray-700"})})]})})]})}),e.jsx(cs,{variant:"elevated",className:"overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 p-6 border-l-4 border-green-600",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-xl",children:e.jsx(o,{className:"h-6 w-6 text-green-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-green-700 uppercase tracking-wider mb-1",children:t("accounting.net.net_result")}),e.jsxs("h3",{className:"text-3xl font-bold text-green-900",children:["$",Number(te.net_saglama_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:t("accounting.net.net_saglama")})]})]})})})}),e.jsx(xs,{title:t("accounting.net.cash_balance_analysis"),description:t("accounting.net.cash_balance_analysis_desc"),children:e.jsxs(hs,{cols:4,gap:"md",children:[e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider mb-2",children:t("accounting.net.previous_close")}),e.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["$",Number(te.onceki_kapanis_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsx("div",{className:"p-1.5 bg-gray-100 rounded",children:e.jsx(U,{className:"h-4 w-4 text-gray-700"})})]})}),e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider mb-2",children:t("accounting.net.current_cash_balance")}),e.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["$",Number(te.anlik_kasa_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsx("div",{className:"p-1.5 bg-gray-100 rounded",children:e.jsx(le,{className:"h-4 w-4 text-gray-700"})})]})}),e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider mb-2",children:t("accounting.net.pending")}),e.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["$",Number(te.bekleyen_tahsilat_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsx("div",{className:"p-1.5 bg-gray-100 rounded",children:e.jsx(k,{className:"h-4 w-4 text-gray-700"})})]})}),e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider mb-2",children:t("accounting.net.difference")}),e.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["$",Number(te.fark_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsx("div",{className:"p-1.5 bg-gray-100 rounded",children:e.jsx(o,{className:"h-4 w-4 text-gray-700"})})]})})]})}),e.jsx(cs,{variant:"elevated",className:"overflow-hidden",children:e.jsx("div",{className:"p-6 border-l-4 "+(0===Number(te.fark_bottom_usd)?"bg-gradient-to-r from-green-50 to-emerald-50 border-green-600":"bg-gradient-to-r from-red-50 to-rose-50 border-red-600"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl "+(0===Number(te.fark_bottom_usd)?"bg-green-100":"bg-red-100"),children:e.jsx(l,{className:"h-6 w-6 "+(0===Number(te.fark_bottom_usd)?"text-green-700":"text-red-700")})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium uppercase tracking-wider mb-1 "+(0===Number(te.fark_bottom_usd)?"text-green-700":"text-red-700"),children:0===Number(te.fark_bottom_usd)?t("accounting.net.balanced_no_discrepancy"):t("accounting.net.reconciliation_required")}),e.jsxs("h3",{className:"text-3xl font-bold "+(0===Number(te.fark_bottom_usd)?"text-green-900":"text-red-900"),children:["$",Number(te.fark_bottom_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("p",{className:"text-xs mt-1 "+(0===Number(te.fark_bottom_usd)?"text-green-600":"text-red-600"),children:t("accounting.net.reconciliation_difference_desc")})]})]}),0===Number(te.fark_bottom_usd)&&e.jsx("div",{className:"px-4 py-2 bg-green-100 border border-green-300 rounded-lg",children:e.jsx("span",{className:"text-sm font-semibold text-green-800",children:t("accounting.net.perfect_match")})})]})})})]})]})}function Je({onLoadRecord:a}){const[l,c]=r.useState([]),[d,u]=r.useState(!1),[g,j]=r.useState(!1),[y,f]=r.useState(null),[N,v]=r.useState(""),[w,_]=r.useState(""),[k,S]=r.useState(""),[C,D]=r.useState(""),[T,F]=r.useState("all"),[E,A]=r.useState("date"),[R,$]=r.useState("desc"),[L,U]=r.useState(1),[M,I]=r.useState(!1),[z,K]=r.useState(null),[H,J]=r.useState(null),G=async()=>{try{u(!0);const e=await Fe.get("/accounting/net/history"),s=await Fe.parseResponse(e);s&&s.success&&c(s.data||[])}catch(e){x(e?.message||"Failed to load historical records")}finally{u(!1)}},Q=r.useMemo(()=>{let e=[...l];if(k&&(e=e.filter(e=>e.date>=k)),C&&(e=e.filter(e=>e.date<=C)),"balanced"===T?e=e.filter(e=>0===Number(e.fark_bottom_usd)):"unbalanced"===T&&(e=e.filter(e=>0!==Number(e.fark_bottom_usd))),w){const s=w.toLowerCase();e=e.filter(e=>e.date.includes(s)||String(e.net_cash_usd).includes(s)||String(e.net_saglama_usd).includes(s)||String(e.fark_bottom_usd).includes(s))}return e},[l,k,C,T,w]),Z=r.useMemo(()=>{const e=[...Q];return e.sort((e,s)=>{let t,a;switch(E){case"date":default:t=e.date,a=s.date;break;case"net_cash":t=Number(e.net_cash_usd),a=Number(s.net_cash_usd);break;case"expenses":t=Number(e.expenses_usd),a=Number(s.expenses_usd);break;case"commission":t=Number(e.commissions_usd),a=Number(s.commissions_usd);break;case"net_saglama":t=Number(e.net_saglama_usd),a=Number(s.net_saglama_usd);break;case"fark":t=Number(e.fark_bottom_usd),a=Number(s.fark_bottom_usd)}return"asc"===R?t>a?1:-1:t<a?1:-1}),e},[Q,E,R]),ee=r.useMemo(()=>{const e=50*(L-1),s=e+50;return Z.slice(e,s)},[Z,L]),te=Math.ceil(Z.length/50),ae=e=>{E===e?$("asc"===R?"desc":"asc"):(A(e),$("desc")),U(1)},re=r.useMemo(()=>{if(0===Z.length)return null;const e=Z.reduce((e,s)=>e+Number(s.net_saglama_usd),0),s=Z.reduce((e,s)=>e+Number(s.expenses_usd),0),t=Z.reduce((e,s)=>e+Number(s.net_cash_usd),0),a=Z.filter(e=>0===Number(e.fark_bottom_usd)).length;return{totalNetSaglama:e,totalExpenses:s,totalNetCash:t,avgNetSaglama:e/Z.length,balancedCount:a,totalRecords:Z.length,balancedPercentage:a/Z.length*100}},[Z]),ne=r.useMemo(()=>{if(Z.length<2)return null;const e=[...Z].sort((e,s)=>e.date.localeCompare(s.date)),s=[];for(let t=1;t<e.length;t++){const a=e[t-1],r=e[t],n=Number(r.net_saglama_usd)-Number(a.net_saglama_usd),l=n/Number(a.net_saglama_usd)*100;s.push({date:r.date,netSaglamaChange:n,netSaglamaChangePercent:isFinite(l)?l:0})}return s},[Z]),le=async()=>{if("4561"!==N)return alert(t("accounting.net.invalid_confirmation_code")||"Invalid confirmation code. Please enter the correct 4-digit code."),void v("");try{const e=await Fe.delete(`/api/v1/accounting/net/${y.date}`,{confirmation_code:N}),s=await Fe.parseResponse(e);s&&s.success&&(m("Record deleted successfully"),G(),j(!1),f(null),v(""))}catch(e){x(e?.message||"Failed to delete record")}},oe=()=>{K(null),J(null),I(!1)};return s.useEffect(()=>{G()},[]),e.jsxs("div",{className:"space-y-6",children:[e.jsx(cs,{variant:"elevated",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1.5 block",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(ts,{type:"text",placeholder:"Search records...",value:w,onChange:e=>{_(e.target.value),U(1)},className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1.5 block",children:"From Date"}),e.jsx(ts,{type:"date",value:k,onChange:e=>{S(e.target.value),U(1)}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1.5 block",children:"To Date"}),e.jsx(ts,{type:"date",value:C,onChange:e=>{D(e.target.value),U(1)}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1.5 block",children:"Status"}),e.jsxs("select",{value:T,onChange:e=>{F(e.target.value),U(1)},className:"w-full h-10 px-3 border border-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"balanced",children:"Balanced"}),e.jsx("option",{value:"unbalanced",children:"Unbalanced"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",ee.length," of ",Z.length," records",Z.length!==l.length&&` (filtered from ${l.length})`]}),e.jsxs("div",{className:"flex gap-2",children:[z&&e.jsxs(os,{variant:"outline",size:"sm",onClick:oe,children:[e.jsx(P,{className:"h-4 w-4 mr-1"}),"Reset Comparison"]}),e.jsxs(os,{variant:"outline",size:"sm",onClick:()=>{_(""),S(""),D(""),F("all"),U(1)},children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),"Reset Filters"]}),e.jsxs(os,{variant:"outline",size:"sm",onClick:()=>{if(0===Z.length)return;const e=[["Date","Net Cash","Expenses","Commission","Rollover","Net Sağlama","Current Cash","FARK"],...Z.map(e=>[new Date(e.date).toLocaleDateString(),Number(e.net_cash_usd).toFixed(2),Number(e.expenses_usd).toFixed(2),Number(e.commissions_usd).toFixed(2),Number(e.rollover_usd).toFixed(2),Number(e.net_saglama_usd).toFixed(2),Number(e.anlik_kasa_usd).toFixed(2),Number(e.fark_bottom_usd).toFixed(2)])].map(e=>e.join(",")).join("\n"),s=new Blob([e],{type:"text/csv"}),t=window.URL.createObjectURL(s),a=document.createElement("a");a.href=t,a.download=`net_calculations_${(new Date).toISOString().slice(0,10)}.csv`,a.click(),window.URL.revokeObjectURL(t),m(`Exported ${Z.length} records`)},disabled:0===Z.length,children:[e.jsx(B,{className:"h-4 w-4 mr-1"}),"Export"]}),e.jsxs(os,{variant:"outline",size:"sm",onClick:G,disabled:d,children:[e.jsx(i,{className:"h-4 w-4 mr-1 "+(d?"animate-spin":"")}),"Refresh"]})]})]})]})}),re&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(cs,{variant:"elevated",className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Total Net Sağlama"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:["$",re.totalNetSaglama.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Across ",re.totalRecords," records"]})]}),e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(o,{className:"h-5 w-5 text-green-600"})})]})}),e.jsx(cs,{variant:"elevated",className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Avg Net Sağlama"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:["$",re.avgNetSaglama.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Per day average"})]}),e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(b,{className:"h-5 w-5 text-blue-600"})})]})}),e.jsx(cs,{variant:"elevated",className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Total Expenses"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:["$",re.totalExpenses.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Total spent"})]}),e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(q,{className:"h-5 w-5 text-red-600"})})]})}),e.jsx(cs,{variant:"elevated",className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Balanced Days"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:[re.balancedPercentage.toFixed(1),"%"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[re.balancedCount," of ",re.totalRecords," days"]})]}),e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(p,{className:"h-5 w-5 text-purple-600"})})]})})]}),Z.length>=2&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(cs,{variant:"elevated",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold text-gray-900",children:"Net Sağlama Trends"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Historical Net Sağlama over time"})]}),e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(V,{className:"h-5 w-5 text-green-600"})})]}),e.jsx("div",{className:"h-64",children:e.jsx("p",{className:"text-sm text-gray-500 text-center py-20",children:"Chart visualization coming soon with Recharts"})})]})}),e.jsx(cs,{variant:"elevated",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold text-gray-900",children:"Expenses vs Net Cash"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Comparison of expenses and revenue"})]}),e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(n,{className:"h-5 w-5 text-blue-600"})})]}),e.jsx("div",{className:"h-64",children:e.jsx("p",{className:"text-sm text-gray-500 text-center py-20",children:"Chart visualization coming soon with Recharts"})})]})}),ne&&ne.length>0&&e.jsx(cs,{variant:"elevated",className:"lg:col-span-2",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold text-gray-900",children:"Variance Analysis"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Day-over-day Net Sağlama changes"})]}),e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(b,{className:"h-5 w-5 text-purple-600"})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-600 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-600 uppercase",children:"Change (USD)"}),e.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-600 uppercase",children:"Change (%)"}),e.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-600 uppercase",children:"Trend"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:ne.slice(0,10).map((s,t)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-gray-900 font-medium",children:new Date(s.date).toLocaleDateString()}),e.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-right font-semibold "+(s.netSaglamaChange>0?"text-green-600":s.netSaglamaChange<0?"text-red-600":"text-gray-600"),children:[s.netSaglamaChange>0?"+":"","$",s.netSaglamaChange.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-right font-semibold "+(s.netSaglamaChangePercent>0?"text-green-600":s.netSaglamaChangePercent<0?"text-red-600":"text-gray-600"),children:[s.netSaglamaChangePercent>0?"+":"",s.netSaglamaChangePercent.toFixed(2),"%"]}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-center",children:s.netSaglamaChange>0?e.jsx(o,{className:"h-4 w-4 text-green-600 mx-auto"}):s.netSaglamaChange<0?e.jsx(q,{className:"h-4 w-4 text-red-600 mx-auto"}):e.jsx(b,{className:"h-4 w-4 text-gray-400 mx-auto"})})]},t))})]})}),ne.length>10&&e.jsxs("p",{className:"text-xs text-gray-500 text-center mt-3",children:["Showing latest 10 changes out of ",ne.length]})]})})]}),e.jsx(cs,{variant:"elevated",children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Saved Net Calculations"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"View and manage historical net calculation records"})]})}),d?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(i,{className:"h-6 w-6 text-gray-400 animate-spin"}),e.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"Loading records..."})]}):0===Z.length?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(be,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-gray-500",children:0===l.length?"No saved records found":"No records match your filters"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:0===l.length?"Calculate and save to see records here":"Try adjusting your filter criteria"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:e.jsxs("button",{onClick:()=>ae("date"),className:"flex items-center gap-1 hover:text-gray-900 transition-colors",children:["Date","date"===E&&("asc"===R?e.jsx(ie,{className:"h-3 w-3 rotate-[-90deg]"}):e.jsx(ie,{className:"h-3 w-3 rotate-90"}))]})}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-600 uppercase tracking-wider",children:e.jsxs("button",{onClick:()=>ae("net_cash"),className:"flex items-center justify-end gap-1 hover:text-gray-900 transition-colors ml-auto",children:["Net Cash","net_cash"===E&&("asc"===R?e.jsx(ie,{className:"h-3 w-3 rotate-[-90deg]"}):e.jsx(ie,{className:"h-3 w-3 rotate-90"}))]})}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-600 uppercase tracking-wider",children:e.jsxs("button",{onClick:()=>ae("expenses"),className:"flex items-center justify-end gap-1 hover:text-gray-900 transition-colors ml-auto",children:["Expenses","expenses"===E&&("asc"===R?e.jsx(ie,{className:"h-3 w-3 rotate-[-90deg]"}):e.jsx(ie,{className:"h-3 w-3 rotate-90"}))]})}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-600 uppercase tracking-wider",children:e.jsxs("button",{onClick:()=>ae("commission"),className:"flex items-center justify-end gap-1 hover:text-gray-900 transition-colors ml-auto",children:["Commission","commission"===E&&("asc"===R?e.jsx(ie,{className:"h-3 w-3 rotate-[-90deg]"}):e.jsx(ie,{className:"h-3 w-3 rotate-90"}))]})}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Rollover"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-600 uppercase tracking-wider font-semibold",children:e.jsxs("button",{onClick:()=>ae("net_saglama"),className:"flex items-center justify-end gap-1 hover:text-gray-900 transition-colors ml-auto font-semibold",children:["Net Sağlama","net_saglama"===E&&("asc"===R?e.jsx(ie,{className:"h-3 w-3 rotate-[-90deg]"}):e.jsx(ie,{className:"h-3 w-3 rotate-90"}))]})}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Current Cash"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-600 uppercase tracking-wider",children:e.jsxs("button",{onClick:()=>ae("fark"),className:"flex items-center justify-end gap-1 hover:text-gray-900 transition-colors ml-auto",children:["FARK","fark"===E&&("asc"===R?e.jsx(ie,{className:"h-3 w-3 rotate-[-90deg]"}):e.jsx(ie,{className:"h-3 w-3 rotate-90"}))]})}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:ee.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors "+(z?.date===s.date||H?.date===s.date?"bg-blue-50 border-l-4 border-blue-500":""),children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-900 font-medium",children:new Date(s.date).toLocaleDateString()}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-right text-gray-900",children:["$",Number(s.net_cash_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-right text-gray-900",children:["$",Number(s.expenses_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-right text-gray-900",children:["$",Number(s.commissions_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-right text-gray-900",children:["$",Number(s.rollover_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-right font-semibold text-green-700",children:["$",Number(s.net_saglama_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-right text-gray-900",children:["$",Number(s.anlik_kasa_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),s.anlik_kasa_manual&&e.jsx("span",{className:"ml-1 text-xs text-orange-600",children:"(M)"})]}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-right font-medium "+(0===Number(s.fark_bottom_usd)?"text-green-700":"text-red-700"),children:["$",Number(s.fark_bottom_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("button",{onClick:()=>(e=>{z?H||e.date===z.date?e.date===z.date?h("Please select a different date"):(K(e),J(null),h("Select second date to compare")):(J(e),I(!0)):(K(e),h("Select second date to compare"))})(s),className:"p-1.5 hover:bg-gray-100 rounded transition-colors "+(z?.date===s.date||H?.date===s.date?"bg-blue-100":""),title:"Compare",children:e.jsx(X,{className:"h-4 w-4 text-purple-600"})}),e.jsx("button",{onClick:()=>(e=>{a(e)})(s),className:"p-1.5 hover:bg-gray-100 rounded transition-colors",title:"Load to calculator",children:e.jsx(W,{className:"h-4 w-4 text-blue-600"})}),e.jsx("button",{onClick:()=>(e=>{f(e),j(!0)})(s),className:"p-1.5 hover:bg-gray-100 rounded transition-colors",title:"Delete this record",children:e.jsx(Y,{className:"h-4 w-4 text-red-600"})})]})})]},s.id))})]})}),te>1&&e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-6 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",L," of ",te]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(os,{variant:"outline",size:"sm",onClick:()=>U(1),disabled:1===L,children:[e.jsx(ce,{className:"h-4 w-4 mr-1"}),"First"]}),e.jsx(os,{variant:"outline",size:"sm",onClick:()=>U(L-1),disabled:1===L,children:e.jsx(ce,{className:"h-4 w-4"})}),e.jsx("div",{className:"flex items-center gap-1",children:[...Array(Math.min(5,te))].map((s,t)=>{let a;return a=te<=5||L<=3?t+1:L>=te-2?te-4+t:L-2+t,e.jsx("button",{onClick:()=>U(a),className:"px-3 py-1.5 text-sm font-medium rounded transition-colors "+(L===a?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-100 border border-gray-300"),children:a},a)})}),e.jsx(os,{variant:"outline",size:"sm",onClick:()=>U(L+1),disabled:L===te,children:e.jsx(ie,{className:"h-4 w-4"})}),e.jsxs(os,{variant:"outline",size:"sm",onClick:()=>U(te),disabled:L===te,children:["Last",e.jsx(ie,{className:"h-4 w-4 ml-1"})]})]})]})]})]})}),g&&y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Record"}),e.jsx("button",{onClick:()=>{j(!1),f(null),v("")},className:"text-gray-400 hover:text-gray-600",children:e.jsx(P,{className:"h-5 w-5"})})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Are you sure you want to delete the record for:"}),e.jsxs("p",{className:"text-sm font-semibold text-gray-900 mb-4",children:[new Date(y.date).toLocaleDateString()," - Net Sağlama: $",Number(y.net_saglama_usd).toFixed(2)]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Enter security code to confirm deletion:"}),e.jsx("div",{className:"mb-4",children:e.jsx(ts,{type:"text",value:N,onChange:e=>{const s=e.target.value.replace(/\D/g,"").slice(0,4);v(s)},placeholder:"----",className:"text-center text-lg font-mono tracking-widest",maxLength:4,autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&4===N.length&&le()}})}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(os,{variant:"outline",onClick:()=>{j(!1),f(null),v("")},children:"Cancel"}),e.jsx(os,{variant:"primary",onClick:le,disabled:4!==N.length,className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})}),M&&z&&H&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 px-6 py-5 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(X,{className:"h-6 w-6 text-purple-600"}),"Date Comparison"]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Comparing ",new Date(z.date).toLocaleDateString()," vs ",new Date(H.date).toLocaleDateString()]})]}),e.jsx("button",{onClick:()=>I(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(P,{className:"h-5 w-5 text-gray-500"})})]})}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-purple-900 mb-1",children:new Date(z.date).toLocaleDateString()}),e.jsx("p",{className:"text-xs text-purple-600",children:"Date 1"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Net Cash"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-1",children:["$",Number(z.net_cash_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Expenses"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-1",children:["$",Number(z.expenses_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Commission"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-1",children:["$",Number(z.commissions_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Rollover"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-1",children:["$",Number(z.rollover_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-medium text-green-700 uppercase",children:"Net Sağlama"}),e.jsxs("p",{className:"text-2xl font-bold text-green-900 mt-1",children:["$",Number(z.net_saglama_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Current Cash"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-1",children:["$",Number(z.anlik_kasa_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"rounded-lg p-3 "+(0===Number(z.fark_bottom_usd)?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:[e.jsx("p",{className:"text-xs font-medium uppercase "+(0===Number(z.fark_bottom_usd)?"text-green-700":"text-red-700"),children:"FARK"}),e.jsxs("p",{className:"text-lg font-bold mt-1 "+(0===Number(z.fark_bottom_usd)?"text-green-900":"text-red-900"),children:["$",Number(z.fark_bottom_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-blue-900 mb-1",children:new Date(H.date).toLocaleDateString()}),e.jsx("p",{className:"text-xs text-blue-600",children:"Date 2"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Net Cash"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-1",children:["$",Number(H.net_cash_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("p",{className:"text-xs mt-1 font-medium "+(Number(H.net_cash_usd)>Number(z.net_cash_usd)?"text-green-600":Number(H.net_cash_usd)<Number(z.net_cash_usd)?"text-red-600":"text-gray-600"),children:[Number(H.net_cash_usd)>Number(z.net_cash_usd)&&"↑ ",Number(H.net_cash_usd)<Number(z.net_cash_usd)&&"↓ ","$",Math.abs(Number(H.net_cash_usd)-Number(z.net_cash_usd)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Expenses"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-1",children:["$",Number(H.expenses_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("p",{className:"text-xs mt-1 font-medium "+(Number(H.expenses_usd)>Number(z.expenses_usd)?"text-red-600":Number(H.expenses_usd)<Number(z.expenses_usd)?"text-green-600":"text-gray-600"),children:[Number(H.expenses_usd)>Number(z.expenses_usd)&&"↑ ",Number(H.expenses_usd)<Number(z.expenses_usd)&&"↓ ","$",Math.abs(Number(H.expenses_usd)-Number(z.expenses_usd)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Commission"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-1",children:["$",Number(H.commissions_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("p",{className:"text-xs mt-1 font-medium "+(Number(H.commissions_usd)>Number(z.commissions_usd)?"text-red-600":Number(H.commissions_usd)<Number(z.commissions_usd)?"text-green-600":"text-gray-600"),children:[Number(H.commissions_usd)>Number(z.commissions_usd)&&"↑ ",Number(H.commissions_usd)<Number(z.commissions_usd)&&"↓ ","$",Math.abs(Number(H.commissions_usd)-Number(z.commissions_usd)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Rollover"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-1",children:["$",Number(H.rollover_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("p",{className:"text-xs mt-1 font-medium "+(Number(H.rollover_usd)>Number(z.rollover_usd)?"text-green-600":Number(H.rollover_usd)<Number(z.rollover_usd)?"text-red-600":"text-gray-600"),children:[Number(H.rollover_usd)>Number(z.rollover_usd)&&"↑ ",Number(H.rollover_usd)<Number(z.rollover_usd)&&"↓ ","$",Math.abs(Number(H.rollover_usd)-Number(z.rollover_usd)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-medium text-green-700 uppercase",children:"Net Sağlama"}),e.jsxs("p",{className:"text-2xl font-bold text-green-900 mt-1",children:["$",Number(H.net_saglama_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("p",{className:"text-sm mt-1 font-medium "+(Number(H.net_saglama_usd)>Number(z.net_saglama_usd)?"text-green-600":Number(H.net_saglama_usd)<Number(z.net_saglama_usd)?"text-red-600":"text-gray-600"),children:[Number(H.net_saglama_usd)>Number(z.net_saglama_usd)&&"↑ ",Number(H.net_saglama_usd)<Number(z.net_saglama_usd)&&"↓ ","$",Math.abs(Number(H.net_saglama_usd)-Number(z.net_saglama_usd)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})," ","(",(Math.abs(Number(H.net_saglama_usd)-Number(z.net_saglama_usd))/Number(z.net_saglama_usd)*100).toFixed(1),"%)"]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Current Cash"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-1",children:["$",Number(H.anlik_kasa_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("p",{className:"text-xs mt-1 font-medium "+(Number(H.anlik_kasa_usd)>Number(z.anlik_kasa_usd)?"text-green-600":Number(H.anlik_kasa_usd)<Number(z.anlik_kasa_usd)?"text-red-600":"text-gray-600"),children:[Number(H.anlik_kasa_usd)>Number(z.anlik_kasa_usd)&&"↑ ",Number(H.anlik_kasa_usd)<Number(z.anlik_kasa_usd)&&"↓ ","$",Math.abs(Number(H.anlik_kasa_usd)-Number(z.anlik_kasa_usd)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"rounded-lg p-3 "+(0===Number(H.fark_bottom_usd)?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:[e.jsx("p",{className:"text-xs font-medium uppercase "+(0===Number(H.fark_bottom_usd)?"text-green-700":"text-red-700"),children:"FARK"}),e.jsxs("p",{className:"text-lg font-bold mt-1 "+(0===Number(H.fark_bottom_usd)?"text-green-900":"text-red-900"),children:["$",Number(H.fark_bottom_usd).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("p",{className:"text-xs mt-1 font-medium "+(Math.abs(Number(H.fark_bottom_usd))<Math.abs(Number(z.fark_bottom_usd))?"text-green-600":Math.abs(Number(H.fark_bottom_usd))>Math.abs(Number(z.fark_bottom_usd))?"text-red-600":"text-gray-600"),children:[Math.abs(Number(H.fark_bottom_usd))<Math.abs(Number(z.fark_bottom_usd))&&"✓ Better ",Math.abs(Number(H.fark_bottom_usd))>Math.abs(Number(z.fark_bottom_usd))&&"⚠ Worse ",Math.abs(Number(H.fark_bottom_usd))===Math.abs(Number(z.fark_bottom_usd))&&"= Same "]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-blue-900 mb-1",children:new Date(H.date).toLocaleDateString()}),e.jsx("p",{className:"text-xs text-blue-600",children:"Date 2"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-blue-50 border border-purple-200 rounded-lg p-4",children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Overall Comparison"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-600",children:"Net Sağlama Change:"}),e.jsxs("span",{className:"font-bold "+(Number(H.net_saglama_usd)>Number(z.net_saglama_usd)?"text-green-600":"text-red-600"),children:[Number(H.net_saglama_usd)>Number(z.net_saglama_usd)?"+":"","$",(Number(H.net_saglama_usd)-Number(z.net_saglama_usd)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-600",children:"Percentage Change:"}),e.jsxs("span",{className:"font-bold "+(Number(H.net_saglama_usd)>Number(z.net_saglama_usd)?"text-green-600":"text-red-600"),children:[Number(H.net_saglama_usd)>Number(z.net_saglama_usd)?"+":"",((Number(H.net_saglama_usd)-Number(z.net_saglama_usd))/Number(z.net_saglama_usd)*100).toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-600",children:"Expense Change:"}),e.jsxs("span",{className:"font-bold "+(Number(H.expenses_usd)<Number(z.expenses_usd)?"text-green-600":"text-red-600"),children:[Number(H.expenses_usd)>Number(z.expenses_usd)?"+":"","$",(Number(H.expenses_usd)-Number(z.expenses_usd)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-600",children:"Status Comparison:"}),e.jsxs("span",{className:"font-bold",children:[0===Number(z.fark_bottom_usd)?"✓":"✗"," → ",0===Number(H.fark_bottom_usd)?"✓":"✗"]})]})]})]})]})]})}),e.jsx("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200 flex justify-end gap-3",children:e.jsx(os,{variant:"outline",onClick:oe,children:"Close Comparison"})})]})})]})}const[Ge,Xe]=r.useState("");r.useEffect(()=>{(async()=>{if(c&&!d)try{Q(!0),ee(null),Te.debug("Loading expenses from API...");const e=await Fe.get("/accounting/expenses");if(e.ok){const s=await Fe.parseResponse(e);Te.debug("Expenses loaded:",s),s.success&&Array.isArray(s.expenses)?z(s.expenses):(Te.warn("Invalid expenses response structure:",s),z([]))}else Te.error("HTTP error loading expenses:",e.status),ee("Failed to load expenses"),z([])}catch(e){Te.error("Error loading expenses:",e),ee("Error loading expenses"),z([])}finally{Q(!1)}})()},[c,d]),r.useEffect(()=>{const e=setTimeout(()=>{ne(te)},300);return()=>clearTimeout(e)},[te]);const Qe=r.useCallback(()=>{_e(null),je(null),Se(!1),De({description:"",detail:"",amount_try:"",amount_usd:"",status:"pending",cost_period:"",payment_date:"",payment_period:"",source:""}),ge(!0)},[]),Ze=r.useCallback(e=>{je(e),_e(null),Se(!0),De({description:e.description,detail:e.detail,amount_try:e.amount_try.toString(),amount_usd:e.amount_usd.toString(),status:e.status,cost_period:e.cost_period,payment_date:e.payment_date,payment_period:e.payment_period,source:e.source}),ge(!0)},[]),es=r.useCallback(e=>{"4561"===prompt(t("accounting.enter_security_pin"))?(_e(e),je(null),Se(!1),De({description:e.description,detail:e.detail,amount_try:e.amount_try.toString(),amount_usd:e.amount_usd.toString(),status:e.status,cost_period:e.cost_period,payment_date:e.payment_date,payment_period:e.payment_period,source:e.source}),Xe("4561"),ge(!0)):x(t("accounting.invalid_security_pin"))},[t]),ss=r.useCallback(()=>{ge(!1),_e(null),je(null),Se(!1),Re("TRY"),Ue(null),Xe(""),De({description:"",detail:"",amount_try:"",amount_usd:"",status:"pending",cost_period:"",payment_date:"",payment_period:"",source:""})},[]),as=r.useCallback(async()=>{Ve(!0);try{Te.debug("Fetching current exchange rate...");const e=await Fe.get("/exchange-rates/current");if(e.ok){const s=await Fe.parseResponse(e);if(Te.debug("Exchange rate response:",s),s.success&&s.rate&&s.rate.rate){const e=parseFloat(s.rate.rate);return Te.debug("Exchange rate fetched:",e),Ue(e),m(t("accounting.rate_fetched").replace("{rate}",e.toFixed(4))),e}return Te.error("Invalid exchange rate response structure:",s),x(t("accounting.rate_fetch_failed")),null}return Te.error("HTTP error fetching exchange rate:",e.status),x(t("accounting.rate_fetch_failed")),null}catch(e){return Te.error("Error fetching exchange rate:",e),x(t("accounting.rate_fetch_error")),null}finally{Ve(!1)}},[t]),rs=r.useCallback(async()=>{const e=$e||await as();if(e)if("TRY"===Ee){const s=parseFloat(Ce.amount_try);if(!isNaN(s)&&s>0){const a=s/e;De(e=>({...e,amount_usd:a.toFixed(2)})),h(t("accounting.converted_to_usd"))}}else{const s=parseFloat(Ce.amount_usd);if(!isNaN(s)&&s>0){const a=s*e;De(e=>({...e,amount_try:a.toFixed(2)})),h(t("accounting.converted_to_try"))}}},[Ee,$e,Ce.amount_try,Ce.amount_usd,as,t]),ls=r.useCallback(()=>{if(ye)z(I.map(e=>e.id===ye.id?{...e,description:Ce.description,detail:Ce.detail,amount_try:parseFloat(Ce.amount_try)||0,amount_usd:parseFloat(Ce.amount_usd)||0,status:Ce.status,cost_period:Ce.cost_period,payment_date:Ce.payment_date,payment_period:Ce.payment_period,source:Ce.source,updated_at:(new Date).toISOString()}:e)),m(t("accounting.expense_updated_success"));else{const e={id:Math.max(...I.map(e=>e.id),0)+1,description:Ce.description,detail:Ce.detail,amount_try:parseFloat(Ce.amount_try)||0,amount_usd:parseFloat(Ce.amount_usd)||0,status:Ce.status,cost_period:Ce.cost_period,payment_date:Ce.payment_date,payment_period:Ce.payment_period,source:Ce.source,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()};z([...I,e]),m(t("accounting.expense_added_success"))}ss()},[ye,I,Ce,ss,Ge,m,t]),is=r.useCallback(e=>{confirm(t("accounting.confirm_delete_expense"))&&(z(I.filter(s=>s.id!==e)),m(t("accounting.expense_deleted_success")))},[I,m,t]),ms=r.useMemo(()=>I.filter(e=>{const s=e.description.toLowerCase().includes(re.toLowerCase())||e.detail.toLowerCase().includes(re.toLowerCase())||e.source.toLowerCase().includes(re.toLowerCase()),t="all"===oe||e.status===oe;return s&&t}),[I,re,oe]),us=r.useMemo(()=>{const e=(me-1)*he,s=e+he;return ms.slice(e,s)},[ms,me,he]),gs=Math.ceil(ms.length/he);r.useEffect(()=>{xe(1)},[re,oe]);const ps=r.useMemo(()=>({totalTRY:I.reduce((e,s)=>e+s.amount_try,0),totalUSD:I.reduce((e,s)=>e+s.amount_usd,0),count:I.length}),[I]),js=r.useMemo(()=>{const e=I.filter(e=>{if(!e.payment_date||""===e.payment_date.trim()||"paid"!==e.status)return!1;const s=new Date(e.payment_date),t=s.getMonth()+1,a=s.getFullYear();return t===S&&a===D}).reduce((e,s)=>{const t=s.payment_date;return e[t]||(e[t]={date:t,totalTRY:0,totalUSD:0,count:0,expenses:[]}),e[t].totalTRY+=s.amount_try,e[t].totalUSD+=s.amount_usd,e[t].count+=1,e[t].expenses.push(s),e},{});return Object.values(e).sort((e,s)=>{const t=new Date(e.date).getTime(),a=new Date(s.date).getTime();return"desc"===A?a-t:t-a})},[I,S,D,A]),ys=r.useCallback(()=>{const e=ms.map(e=>`"${e.description}","${e.detail}",${e.amount_try},${e.amount_usd},"${e.status}","${e.cost_period}","${e.payment_date}","${e.payment_period}","${e.source}"`).join("\n"),s=new Blob(["Description,Detail,TRY Amount,USD Amount,Status,Cost Period,Payment Date,Payment Period,Source\n"+e],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),r=URL.createObjectURL(s);a.setAttribute("href",r),a.setAttribute("download",`expenses_${(new Date).toISOString().split("T")[0]}.csv`),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),m(t("accounting.exported_expenses").replace("{count}",String(ms.length)))},[ms,m,t]);return r.useEffect(()=>{window.scrollTo({top:0,behavior:"instant"})},[]),r.useEffect(()=>{I.length>0&&localStorage.setItem("accounting_expenses",JSON.stringify(I))},[I]),r.useEffect(()=>{const e=e=>{if((e.ctrlKey||e.metaKey)&&"k"===e.key){e.preventDefault();const s=document.querySelector('input[placeholder*="Search expenses"]');s?.focus(),h("Search activated (Ctrl+K)")}!e.ctrlKey&&!e.metaKey||"n"!==e.key||ue||(e.preventDefault(),Qe(),h("New expense form opened (Ctrl+N)"))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[ue,Qe]),d?e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"h-10 w-64 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-4 w-96 bg-gray-100 rounded animate-pulse mt-2"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"h-12 bg-gray-100 rounded animate-pulse"}),e.jsx("div",{className:"h-96 bg-gray-50 rounded animate-pulse"})]})]}):e.jsxs("div",{className:"p-6 animate-in fade-in duration-300",children:[e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(be,{className:"h-8 w-8 text-gray-600"}),"Accounting"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Financial records and accounting management"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded border border-gray-200 font-mono",children:"Ctrl+K"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Search"}),e.jsx("span",{className:"text-gray-300",children:"•"}),e.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded border border-gray-200 font-mono",children:"Ctrl+N"}),e.jsx("span",{className:"text-xs text-gray-500",children:"New Expense"})]})]})})}),e.jsxs(Oe,{value:u,onValueChange:g,className:"w-full",children:[e.jsxs(ze,{className:"grid w-full grid-cols-4 bg-gray-50/80 border border-gray-200/60 rounded-lg shadow-sm",children:[e.jsxs(Be,{value:"overview",className:"flex items-center gap-2",children:[e.jsx(n,{className:"h-4 w-4"}),t("tabs.overview")]}),e.jsxs(Be,{value:"expenses",className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4"}),t("tabs.expenses")]}),e.jsxs(Be,{value:"net",className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4"}),t("tabs.net")]}),e.jsxs(Be,{value:"analytics",className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4"}),t("tabs.analytics")]})]}),e.jsx(Ke,{value:"overview",className:"mt-6",children:e.jsx("div",{className:"p-6",children:e.jsxs(cs,{variant:"elevated",children:[e.jsxs(Ye,{children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5 text-blue-600"}),"Accounting Overview"]}),e.jsx(He,{children:"Your accounting dashboard overview"})]}),e.jsx(Me,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(be,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Welcome to the Accounting section"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Select a tab above to get started"})]})})]})})}),e.jsx(Ke,{value:"expenses",className:"mt-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"relative w-full",children:e.jsxs("div",{className:"relative bg-gradient-to-r from-slate-50/90 via-white/80 to-slate-50/90 backdrop-blur-sm border border-slate-200/60 rounded-xl shadow-lg shadow-slate-200/20 p-1.5",children:[e.jsx("div",{className:"absolute top-1.5 bottom-1.5 w-[calc(50%-0.375rem)] bg-gradient-to-r from-blue-500/10 via-blue-600/15 to-blue-500/10 backdrop-blur-sm border border-blue-200/40 rounded-lg shadow-sm transition-all duration-300 ease-out "+("all"===j?"left-1.5":"right-1.5")}),e.jsxs("div",{className:"relative grid grid-cols-2 gap-1.5",children:[e.jsxs("button",{onClick:()=>y("all"),className:"group relative flex items-center justify-center gap-2.5 px-5 py-3.5 rounded-lg font-semibold text-sm transition-all duration-300 ease-out outline-none focus:outline-none focus:ring-0 "+("all"===j?"text-blue-700 shadow-sm":"text-slate-600 hover:text-slate-800 hover:bg-slate-50/50"),children:[e.jsx(fe,{className:"h-4 w-4 transition-all duration-300 "+("all"===j?"text-blue-600 scale-110":"text-slate-500 group-hover:text-slate-700 group-hover:scale-105")}),e.jsx("span",{className:"relative z-10 transition-all duration-300",children:t("accounting.all_expenses")}),"all"===j&&e.jsx("div",{className:"absolute inset-0 rounded-lg bg-gradient-to-r from-blue-400/5 to-blue-600/5 animate-pulse"})]}),e.jsxs("button",{onClick:()=>y("daily"),className:"group relative flex items-center justify-center gap-2.5 px-5 py-3.5 rounded-lg font-semibold text-sm transition-all duration-300 ease-out outline-none focus:outline-none focus:ring-0 "+("daily"===j?"text-blue-700 shadow-sm":"text-slate-600 hover:text-slate-800 hover:bg-slate-50/50"),children:[e.jsx(M,{className:"h-4 w-4 transition-all duration-300 "+("daily"===j?"text-blue-600 scale-110":"text-slate-500 group-hover:text-slate-700 group-hover:scale-105")}),e.jsx("span",{className:"relative z-10 transition-all duration-300",children:t("accounting.daily_summary")}),"daily"===j&&e.jsx("div",{className:"absolute inset-0 rounded-lg bg-gradient-to-r from-blue-400/5 to-blue-600/5 animate-pulse"})]})]})]})}),"all"===j&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-gray-50 px-6 py-5 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(fe,{className:"h-5 w-5 text-blue-600"})}),"Company Expenses"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Track and manage all company expenses"})]}),e.jsxs(ns,{onClick:Qe,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 shadow-sm hover:shadow-md transition-all",children:[e.jsx(H,{className:"h-4 w-4"}),"Add Expense"]})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(ts,{type:"text",placeholder:"Search expenses...",className:"pl-10 w-full border-gray-200 focus:border-blue-500 focus:ring-blue-500",value:te,onChange:e=>ae(e.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"}),e.jsxs("select",{value:oe,onChange:e=>de(e.target.value),className:"w-full pl-10 pr-8 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white appearance-none",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"paid",children:"Ödendi"}),e.jsx("option",{value:"pending",children:"Beklemede"}),e.jsx("option",{value:"cancelled",children:"İptal"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Actions"}),e.jsxs(ns,{onClick:ys,variant:"outline",className:"w-full border-gray-200 hover:border-gray-300 hover:bg-gray-50 flex items-center gap-2",disabled:0===ms.length,children:[e.jsx(B,{className:"h-4 w-4"}),"Export CSV"]})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-gray-50 px-6 py-4 border-b border-gray-100",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(b,{className:"h-5 w-5 text-blue-600"}),"Expense Records"]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Showing ",(me-1)*he+1," to ",Math.min(me*he,ms.length)," of ",ms.length," ",1===ms.length?"expense":"expenses"]})]})})}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"#"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("accounting.description")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("accounting.detail")}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"TRY"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"USD"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("accounting.status")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("accounting.cost_period")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("accounting.payment_date")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("accounting.payment_period")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("accounting.source")}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("common.actions")})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:us.map((s,t)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors group",children:[e.jsx("td",{className:"py-5 px-6 text-center",children:e.jsx("span",{className:"text-sm font-medium text-gray-600",children:(me-1)*he+t+1})}),e.jsx("td",{className:"py-5 px-6",children:e.jsx("p",{className:"font-semibold text-gray-900 group-hover:text-blue-700 transition-colors",children:s.description})}),e.jsx("td",{className:"py-5 px-6",children:e.jsx("p",{className:"text-sm text-gray-600 max-w-xs truncate",title:s.detail,children:s.detail})}),e.jsx("td",{className:"py-5 px-6 text-right",children:e.jsx("p",{className:"font-bold text-gray-900 font-mono",children:Js(s.amount_try,"₺")})}),e.jsx("td",{className:"py-5 px-6 text-right",children:e.jsxs("p",{className:"font-semibold text-gray-700 font-mono",children:["$",s.amount_usd.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})}),e.jsx("td",{className:"py-5 px-6 text-center",children:e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-semibold transition-all "+("paid"===s.status?"bg-green-100 text-green-700 border border-green-200":"pending"===s.status?"bg-yellow-100 text-yellow-700 border border-yellow-200":"bg-red-100 text-red-700 border border-red-200"),children:["paid"===s.status&&e.jsx(p,{className:"h-3.5 w-3.5"}),"pending"===s.status&&e.jsx(k,{className:"h-3.5 w-3.5"}),"cancelled"===s.status&&e.jsx(Ne,{className:"h-3.5 w-3.5"}),"paid"===s.status?"Ödendi":"pending"===s.status?"Beklemede":"İptal"]})}),e.jsx("td",{className:"py-5 px-6",children:e.jsx("p",{className:"text-sm text-gray-700",children:s.cost_period})}),e.jsx("td",{className:"py-5 px-6",children:e.jsx("p",{className:"text-sm text-gray-700",children:s.payment_date?new Date(s.payment_date).toLocaleDateString("tr-TR"):"-"})}),e.jsx("td",{className:"py-5 px-6",children:e.jsx("p",{className:"text-sm text-gray-700",children:s.payment_period})}),e.jsx("td",{className:"py-5 px-6",children:e.jsx("p",{className:"text-sm text-gray-700",children:s.source})}),e.jsx("td",{className:"py-5 px-6",children:e.jsxs("div",{className:"flex items-center justify-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx(ns,{variant:"ghost",size:"sm",onClick:()=>Ze(s),className:"h-9 w-9 p-0 hover:bg-blue-100 hover:text-blue-700 rounded-lg transition-all",title:"View expense details (read-only)","aria-label":"View expense",children:e.jsx(F,{className:"h-4 w-4"})}),e.jsx(ns,{variant:"ghost",size:"sm",onClick:()=>es(s),className:"h-9 w-9 p-0 hover:bg-blue-100 hover:text-blue-700 rounded-lg transition-all",title:"Edit this expense","aria-label":"Edit expense",children:e.jsx(K,{className:"h-4 w-4"})}),e.jsx(ns,{variant:"ghost",size:"sm",onClick:()=>is(s.id),className:"h-9 w-9 p-0 hover:bg-red-100 hover:text-red-700 rounded-lg transition-all",title:"Delete this expense (cannot be undone)","aria-label":"Delete expense",children:e.jsx(Y,{className:"h-4 w-4"})})]})})]},s.id))})]}),0===ms.length&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-50 to-blue-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(ve,{className:"h-10 w-10 text-blue-500"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No expenses found"}),e.jsx("p",{className:"text-sm text-gray-600 max-w-md mx-auto mb-6",children:te||"all"!==oe?"No expenses match your current search or filter criteria. Try adjusting your filters to see more results.":"You haven't added any expenses yet. Start tracking your company expenses by adding your first entry."}),!te&&"all"===oe&&e.jsxs(ns,{onClick:Qe,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 mx-auto shadow-sm hover:shadow-md transition-all",children:[e.jsx(H,{className:"h-4 w-4"}),"Add Your First Expense"]}),(te||"all"!==oe)&&e.jsxs(ns,{variant:"outline",onClick:()=>{ae(""),de("all")},className:"border-gray-200 hover:border-gray-300 hover:bg-gray-50 px-4 py-2 rounded-lg flex items-center gap-2 mx-auto",children:[e.jsx(P,{className:"h-4 w-4"}),"Clear Filters"]})]}),ms.length>he&&e.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",me," of ",gs]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ns,{variant:"outline",size:"sm",onClick:()=>xe(e=>Math.max(e-1,1)),disabled:1===me,className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),"Previous"]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,gs)},(s,t)=>{let a;return a=gs<=5||me<=3?t+1:me>=gs-2?gs-4+t:me-2+t,e.jsx(ns,{variant:me===a?"default":"outline",size:"sm",onClick:()=>xe(a),className:"min-w-[40px] h-9",children:a},a)})}),e.jsxs(ns,{variant:"outline",size:"sm",onClick:()=>xe(e=>Math.min(e+1,gs)),disabled:me===gs,className:"flex items-center gap-2",children:["Next",e.jsx(ie,{className:"h-4 w-4"})]})]})]})})]})]}),I.length>0&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200 group",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-slate-50 to-slate-100 border border-slate-200 rounded-xl flex items-center justify-center group-hover:from-slate-100 group-hover:to-slate-200 transition-all duration-200",children:e.jsx(we,{className:"h-7 w-7 text-slate-700 group-hover:text-slate-800 transition-colors"})}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Total TRY"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-3xl font-bold text-slate-900 font-mono tracking-tight",children:Js(ps.totalTRY,"₺")}),e.jsx("p",{className:"text-sm text-slate-600 font-medium",children:"Turkish Lira"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200 group",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-slate-50 to-slate-100 border border-slate-200 rounded-xl flex items-center justify-center group-hover:from-slate-100 group-hover:to-slate-200 transition-all duration-200",children:e.jsx(U,{className:"h-7 w-7 text-slate-700 group-hover:text-slate-800 transition-colors"})}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Total USD"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-3xl font-bold text-slate-900 font-mono tracking-tight",children:["$",ps.totalUSD.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("p",{className:"text-sm text-slate-600 font-medium",children:"US Dollar"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200 group",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-slate-50 to-slate-100 border border-slate-200 rounded-xl flex items-center justify-center group-hover:from-slate-100 group-hover:to-slate-200 transition-all duration-200",children:e.jsx(fe,{className:"h-7 w-7 text-slate-700 group-hover:text-slate-800 transition-colors"})}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Total Entries"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:ps.count}),e.jsx("p",{className:"text-sm text-slate-600 font-medium",children:"Expense Records"})]})]})})]})]}),"daily"===j&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-gray-50 px-6 py-5 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(M,{className:"h-5 w-5 text-blue-600"})}),t("accounting.daily_expenses")]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t("accounting.daily_breakdown")})]}),e.jsx(ds,{variant:"info",size:"md",children:t("accounting.payment_date_grouped")})]})}),e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(M,{className:"h-5 w-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:t("accounting.select_period")}),e.jsx("p",{className:"text-xs text-gray-600",children:"Choose month and year for analysis"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Month"}),e.jsxs("select",{value:S,onChange:e=>C(parseInt(e.target.value)),className:"px-3 py-2 text-sm border border-gray-300 rounded-md bg-white focus:ring-2 focus:ring-gray-500 focus:border-gray-500 font-medium min-w-[120px]",children:[e.jsx("option",{value:1,children:t("accounting.january")}),e.jsx("option",{value:2,children:t("accounting.february")}),e.jsx("option",{value:3,children:t("accounting.march")}),e.jsx("option",{value:4,children:t("accounting.april")}),e.jsx("option",{value:5,children:t("accounting.may")}),e.jsx("option",{value:6,children:t("accounting.june")}),e.jsx("option",{value:7,children:t("accounting.july")}),e.jsx("option",{value:8,children:t("accounting.august")}),e.jsx("option",{value:9,children:t("accounting.september")}),e.jsx("option",{value:10,children:t("accounting.october")}),e.jsx("option",{value:11,children:t("accounting.november")}),e.jsx("option",{value:12,children:t("accounting.december")})]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Year"}),e.jsx("select",{value:D,onChange:e=>T(parseInt(e.target.value)),className:"px-3 py-2 text-sm border border-gray-300 rounded-md bg-white focus:ring-2 focus:ring-gray-500 focus:border-gray-500 font-medium min-w-[100px]",children:Array.from({length:5},(s,t)=>{const a=(new Date).getFullYear()-2+t;return e.jsx("option",{value:a,children:a},a)})})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide opacity-0",children:"Action"}),e.jsx("button",{onClick:()=>{C((new Date).getMonth()+1),T((new Date).getFullYear())},className:"px-4 py-2 text-sm bg-gray-800 text-white rounded-md hover:bg-gray-900 transition-colors font-medium",children:t("accounting.current_month")})]})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:js.length>0?e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4 text-gray-500"}),t("accounting.payment_date"),e.jsx("button",{onClick:()=>R("desc"===A?"asc":"desc"),className:"p-1 hover:bg-gray-200 rounded transition-colors",title:t("desc"===A?"accounting.sort_ascending":"accounting.sort_descending"),children:"desc"===A?e.jsx("svg",{className:"h-3 w-3 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):e.jsx("svg",{className:"h-3 w-3 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})})]})}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(we,{className:"h-4 w-4 text-gray-500"}),"TRY"]})}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(we,{className:"h-4 w-4 text-gray-500"}),"USD"]})})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:js.map((r,n)=>e.jsxs(s.Fragment,{children:[e.jsxs("tr",{onClick:()=>L($===r.date?null:r.date),className:"hover:bg-gray-50 transition-colors group cursor-pointer",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(M,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 text-base",children:new Date(r.date).toLocaleDateString("tr"===a?"tr-TR":"en-US",{day:"2-digit",month:"long",year:"numeric"})}),e.jsxs("p",{className:"text-sm text-gray-600 mt-0.5",children:[r.count," ",1===r.count?"transaction":"transactions"]})]})]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("p",{className:"text-lg font-semibold text-gray-900 font-mono",children:Js(r.totalTRY,"₺")})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsxs("p",{className:"text-lg font-semibold text-gray-900 font-mono",children:["$",r.totalUSD.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("div",{className:"transition-transform duration-200 "+($===r.date?"rotate-180":""),children:e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})})]},r.date),$===r.date&&e.jsx("tr",{className:"bg-slate-50",children:e.jsx("td",{colSpan:3,className:"px-6 py-6",children:e.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 bg-slate-50 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsx(fe,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 text-sm",children:t("accounting.expenses_for_date").replace("{count}",r.count.toString())}),e.jsx("p",{className:"text-xs text-slate-600 mt-0.5",children:"Detailed transaction breakdown"})]})]}),e.jsxs("div",{className:"flex items-center gap-6 text-xs",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-slate-500 font-medium uppercase tracking-wide",children:"Total TRY"}),e.jsx("p",{className:"text-slate-900 font-semibold text-sm mt-0.5 font-mono",children:Js(r.totalTRY,"₺")})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-slate-500 font-medium uppercase tracking-wide",children:"Total USD"}),e.jsxs("p",{className:"text-slate-900 font-semibold text-sm mt-0.5 font-mono",children:["$",r.totalUSD.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]})}),e.jsx("div",{className:"overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider w-[40%]",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider w-[30%]",children:"Details"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-700 uppercase tracking-wider w-[12%]",children:"TRY"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-700 uppercase tracking-wider w-[12%]",children:"USD"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider w-[6%]",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-100",children:r.expenses.map((s,a)=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:e.jsx(fe,{className:"h-4 w-4 text-slate-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-semibold text-slate-900 text-sm leading-tight",children:s.description}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1 font-medium",children:["ID: ",s.id]})]})]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("p",{className:"text-xs text-slate-600 leading-relaxed line-clamp-2",children:s.detail})}),e.jsx("td",{className:"px-4 py-4 text-right",children:e.jsx("p",{className:"text-sm font-semibold text-slate-900 font-mono tabular-nums",children:Js(s.amount_try,"₺")})}),e.jsx("td",{className:"px-4 py-4 text-right",children:e.jsxs("p",{className:"text-sm font-semibold text-slate-900 font-mono tabular-nums",children:["$",s.amount_usd.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-md text-xs font-semibold uppercase tracking-wide "+("paid"===s.status?"bg-emerald-50 text-emerald-700 border border-emerald-200":"pending"===s.status?"bg-amber-50 text-amber-700 border border-amber-200":"bg-rose-50 text-rose-700 border border-rose-200"),children:"paid"===s.status?t("accounting.paid"):"pending"===s.status?t("accounting.pending"):t("accounting.cancelled")})})})]},s.id))})]})})]})})})]},r.date))}),e.jsx("tfoot",{className:"bg-gray-100 border-t border-gray-300",children:e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 text-lg",children:"Grand Total"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-0.5",children:[js.length," ",1===js.length?"day":"days"," • ",js.reduce((e,s)=>e+s.count,0)," total transactions"]})]})]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("p",{className:"text-xl font-semibold text-gray-900 font-mono",children:Js(js.reduce((e,s)=>e+s.totalTRY,0),"₺")})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("p",{className:"text-xl font-semibold text-gray-900 font-mono",children:["$",js.reduce((e,s)=>e+s.totalUSD,0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]})})]}):e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-50 to-blue-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(M,{className:"h-10 w-10 text-blue-500"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:t("accounting.no_daily_data")}),e.jsx("p",{className:"text-sm text-gray-600 max-w-md mx-auto mb-6",children:t("accounting.no_daily_data_desc")}),e.jsxs(ns,{onClick:()=>y("all"),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 mx-auto shadow-sm hover:shadow-md transition-all",children:[e.jsx(fe,{className:"h-4 w-4"}),t("accounting.all_expenses")]})]})})]})})]})}),e.jsx(Ke,{value:"analytics",className:"mt-6",children:"analytics"===u&&e.jsx("div",{className:"p-6 animate-in fade-in duration-300",children:e.jsxs(cs,{variant:"elevated",children:[e.jsxs(Ye,{children:[e.jsx(We,{children:"Accounting Analytics"}),e.jsx(He,{children:"Financial analytics and reporting"})]}),e.jsx(Me,{children:e.jsx("p",{className:"text-gray-600",children:"Accounting analytics will be displayed here."})})]})})}),e.jsx(Ke,{value:"net",className:"mt-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"relative w-full",children:e.jsxs("div",{className:"relative bg-gradient-to-r from-slate-50/90 via-white/80 to-slate-50/90 backdrop-blur-sm border border-slate-200/60 rounded-xl shadow-lg shadow-slate-200/20 p-1.5",children:[e.jsx("div",{className:"absolute top-1.5 bottom-1.5 w-[calc(50%-0.375rem)] bg-gradient-to-r from-green-500/10 via-green-600/15 to-green-500/10 backdrop-blur-sm border border-green-200/40 rounded-lg shadow-sm transition-all duration-300 ease-out "+("calculator"===N?"left-1.5":"right-1.5")}),e.jsxs("div",{className:"relative grid grid-cols-2 gap-1.5",children:[e.jsxs("button",{onClick:()=>v("calculator"),className:"group relative flex items-center justify-center gap-2.5 px-5 py-3.5 rounded-lg font-semibold text-sm transition-all duration-300 ease-out outline-none focus:outline-none focus:ring-0 "+("calculator"===N?"text-green-700 shadow-sm":"text-slate-600 hover:text-slate-800 hover:bg-slate-50/50"),children:[e.jsx(be,{className:"h-4 w-4 transition-all duration-300 "+("calculator"===N?"text-green-600 scale-110":"text-slate-500 group-hover:text-slate-700 group-hover:scale-105")}),e.jsx("span",{className:"relative z-10 transition-all duration-300",children:"Net Calculator"}),"calculator"===N&&e.jsx("div",{className:"absolute inset-0 rounded-lg bg-gradient-to-r from-green-400/5 to-green-600/5 animate-pulse"})]}),e.jsxs("button",{onClick:()=>v("daily"),className:"group relative flex items-center justify-center gap-2.5 px-5 py-3.5 rounded-lg font-semibold text-sm transition-all duration-300 ease-out outline-none focus:outline-none focus:ring-0 "+("daily"===N?"text-green-700 shadow-sm":"text-slate-600 hover:text-slate-800 hover:bg-slate-50/50"),children:[e.jsx(M,{className:"h-4 w-4 transition-all duration-300 "+("daily"===N?"text-green-600 scale-110":"text-slate-500 group-hover:text-slate-700 group-hover:scale-105")}),e.jsx("span",{className:"relative z-10 transition-all duration-300",children:"Daily Net"}),"daily"===N&&e.jsx("div",{className:"absolute inset-0 rounded-lg bg-gradient-to-r from-green-400/5 to-green-600/5 animate-pulse"})]})]})]})}),"calculator"===N&&e.jsx("div",{className:"animate-in fade-in duration-300",children:e.jsxs(cs,{variant:"elevated",children:[e.jsxs(Ye,{children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-5 w-5 text-green-700"}),t("accounting.net.title")]}),e.jsx(He,{children:t("accounting.net.subtitle")})]}),e.jsx(Me,{children:e.jsx(qe,{expenses:I,recordToLoad:w,onRecordLoaded:()=>_(null)})})]})}),"daily"===N&&e.jsx("div",{className:"animate-in fade-in duration-300",children:e.jsx(Je,{onLoadRecord:e=>{_(e),v("calculator")}})})]})})]}),ue&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:e=>{e.target===e.currentTarget&&ss()},onKeyDown:e=>{"Escape"===e.key&&ss()},tabIndex:-1,children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-gray-50 px-6 py-5 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(fe,{className:"h-5 w-5 text-blue-600"})}),ke?"View Expense":ye?"Edit Expense":"Add New Expense"]}),e.jsx("button",{onClick:ss,className:"w-8 h-8 rounded-lg hover:bg-gray-100 flex items-center justify-center transition-colors",children:e.jsx(P,{className:"h-5 w-5 text-gray-500"})})]})}),e.jsx("div",{className:"overflow-y-auto max-h-[calc(90vh-140px)]",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-900 uppercase tracking-wide flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-4 bg-blue-600 rounded-full"}),"Basic Information"]}),e.jsxs("div",{className:"pl-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[t("accounting.description")," ",!ke&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ts,{type:"text",placeholder:t("accounting.description_placeholder"),value:Ce.description,onChange:e=>De({...Ce,description:e.target.value}),className:"w-full h-11 text-base",disabled:ke})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:t("accounting.detail")}),e.jsx(ts,{type:"text",placeholder:t("accounting.detail_placeholder"),value:Ce.detail,onChange:e=>De({...Ce,detail:e.target.value}),className:"w-full h-11 text-base",disabled:ke})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-900 uppercase tracking-wide flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-4 bg-blue-600 rounded-full"}),"Financial Details"]}),e.jsxs("div",{className:"pl-4 space-y-4",children:[!ke&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-semibold text-gray-700",children:t("accounting.auto_convert")}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"TRY",checked:"TRY"===Ee,onChange:e=>Re(e.target.value),className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"₺ TRY → $ USD"})]}),e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"USD",checked:"USD"===Ee,onChange:e=>Re(e.target.value),className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"$ USD → ₺ TRY"})]})]}),e.jsx(ns,{type:"button",onClick:rs,disabled:Ie||!Ce.amount_try&&!Ce.amount_usd,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-1.5 h-auto text-sm",size:"sm",children:Ie?e.jsxs(e.Fragment,{children:[e.jsx(i,{className:"h-3.5 w-3.5 mr-1.5 animate-spin"}),t("accounting.fetching")]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-3.5 w-3.5 mr-1.5"}),t("accounting.convert")]})})]})]}),$e&&e.jsxs("div",{className:"text-xs text-gray-600 flex items-center gap-1.5",children:[e.jsx(E,{className:"h-3.5 w-3.5"}),e.jsxs("span",{children:[t("accounting.current_rate"),": 1 USD = ",$e.toFixed(4)," TRY"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[t("accounting.try_amount")," ",!ke&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-semibold",children:"₺"}),e.jsx(ts,{type:"number",step:"0.01",placeholder:"0.00",value:Ce.amount_try,onChange:e=>De({...Ce,amount_try:e.target.value}),className:"w-full h-11 pl-8 text-base font-mono",disabled:ke})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[t("accounting.usd_amount")," ",!ke&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-semibold",children:"$"}),e.jsx(ts,{type:"number",step:"0.01",placeholder:"0.00",value:Ce.amount_usd,onChange:e=>De({...Ce,amount_usd:e.target.value}),className:"w-full h-11 pl-8 text-base font-mono",disabled:ke})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:t("accounting.status")}),e.jsxs("select",{value:Ce.status,onChange:e=>De({...Ce,status:e.target.value}),className:"w-full h-11 px-3 py-2 border border-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed text-base",disabled:ke,children:[e.jsx("option",{value:"pending",children:t("accounting.status_pending")}),e.jsx("option",{value:"paid",children:t("accounting.status_paid")}),e.jsx("option",{value:"cancelled",children:t("accounting.status_cancelled")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:t("accounting.source")}),e.jsx(ts,{type:"text",placeholder:t("accounting.source_placeholder"),value:Ce.source,onChange:e=>De({...Ce,source:e.target.value}),className:"w-full h-11 text-base",disabled:ke})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-900 uppercase tracking-wide flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-4 bg-blue-600 rounded-full"}),"Period Information"]}),e.jsxs("div",{className:"pl-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:t("accounting.cost_period")}),e.jsx(ts,{type:"text",placeholder:t("accounting.period_placeholder"),value:Ce.cost_period,onChange:e=>De({...Ce,cost_period:e.target.value}),className:"w-full h-11 text-base",disabled:ke})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:t("accounting.payment_date")}),e.jsx(ts,{type:"date",value:Ce.payment_date,onChange:e=>De({...Ce,payment_date:e.target.value}),className:"w-full h-11 text-base",disabled:ke})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:t("accounting.payment_period")}),e.jsx(ts,{type:"text",placeholder:t("accounting.period_placeholder"),value:Ce.payment_period,onChange:e=>De({...Ce,payment_period:e.target.value}),className:"w-full h-11 text-base",disabled:ke})]})]})]})]})]})}),e.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-100 flex items-center justify-end gap-3",children:[!ke&&e.jsxs(e.Fragment,{children:[e.jsxs(ns,{variant:"outline",onClick:ss,className:"px-4 py-2 border-gray-200 hover:border-gray-300 hover:bg-gray-50",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsxs(ns,{onClick:ls,disabled:!Ce.description||!Ce.amount_try||!Ce.amount_usd,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(p,{className:"h-4 w-4 mr-2"}),ye?"Update Expense":"Add Expense"]})]}),ke&&e.jsxs(ns,{variant:"outline",onClick:ss,className:"px-4 py-2 border-gray-200 hover:border-gray-300 hover:bg-gray-50",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Close"]})]})]})})]})}},Symbol.toStringTag,{value:"Module"})),ft=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{Pe();const[s,t]=r.useState(!1);return r.useEffect(()=>{window.scrollTo({top:0,behavior:"instant"})},[]),e.jsxs("div",{className:"p-6 animate-in fade-in duration-300",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(_e,{className:"h-8 w-8 text-gray-600"}),"AI Assistant"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Ask questions and get intelligent insights about your business"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-semibold "+(s?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"),children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full "+(s?"bg-yellow-500":"bg-green-500 animate-pulse")}),s?"Paused":"Active"]}),e.jsx(ns,{variant:"outline",size:"sm",onClick:()=>{t(!s)},className:"h-8 w-8 p-0",title:s?"Resume":"Pause",children:s?e.jsx(ke,{className:"w-4 h-4"}):e.jsx(Se,{className:"w-4 h-4"})}),e.jsx(ns,{variant:"outline",size:"sm",onClick:()=>{t(!1)},className:"h-8 w-8 p-0",title:"Reset",children:e.jsx(Ce,{className:"w-4 h-4"})})]})]})}),e.jsx("div",{className:"rounded-lg overflow-hidden min-h-[calc(100vh-200px)]",children:e.jsx(Re,{apiKey:$e.API_KEY,className:"future-chat-interface h-full"})})]})}},Symbol.toStringTag,{value:"Module"}));export{Ys as A,nt as C,ft as F,Es as L,Rs as M,it as S,Ws as a,ct as b,mt as c,gt as d,yt as e,bt as f,$s as u};
